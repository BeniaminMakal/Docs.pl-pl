---
uid: identity/overview/getting-started/developing-aspnet-apps-with-windows-azure-active-directory
title: "Tworzenie aplikacji ASP.NET w usłudze Azure Active Directory | Dokumentacja firmy Microsoft"
author: Rick-Anderson
description: "Narzędzia Microsoft ASP.NET dla usługi Azure Active Directory upraszcza do włączenia uwierzytelniania dla aplikacji sieci web hostowanej na platformie Azure. Można użyć Azure Authenti..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 08/14/2014
ms.topic: article
ms.assetid: 457d7eaf-ee76-4ceb-9082-c7c1721435ad
ms.technology: 
ms.prod: .net-framework
msc.legacyurl: /identity/overview/getting-started/developing-aspnet-apps-with-windows-azure-active-directory
msc.type: authoredcontent
ms.openlocfilehash: 1ef0468d5f5c17480b23ac88983f30fe6f4979c0
ms.sourcegitcommit: 060879fcf3f73d2366b5c811986f8695fff65db8
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 01/24/2018
---
<a name="developing-aspnet-apps-with-azure-active-directory"></a><span data-ttu-id="4f036-104">Tworzenie aplikacji ASP.NET w usłudze Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="4f036-104">Developing ASP.NET Apps with Azure Active Directory</span></span>
====================
<span data-ttu-id="4f036-105">Przez [Rick Anderson](https://github.com/Rick-Anderson)</span><span class="sxs-lookup"><span data-stu-id="4f036-105">by [Rick Anderson](https://github.com/Rick-Anderson)</span></span>

> <span data-ttu-id="4f036-106">Narzędzia Microsoft ASP.NET dla usługi Azure Active Directory upraszcza włączyć uwierzytelnianie dla aplikacji sieci web znajdującej się na [Azure](https://www.windowsazure.com/home/features/web-sites/).</span><span class="sxs-lookup"><span data-stu-id="4f036-106">Microsoft ASP.NET tools for Azure Active Directory makes it simple to enable authentication for web applications hosted on [Azure](https://www.windowsazure.com/home/features/web-sites/).</span></span> <span data-ttu-id="4f036-107">Azure Authentication służy do uwierzytelniania użytkowników usługi Office 365 z organizacji, użytkownicy utworzeni w własne niestandardowe domeny usługi Azure Active Directory lub kont firmowych synchronizowane z lokalnej usługi Active Directory.</span><span class="sxs-lookup"><span data-stu-id="4f036-107">You can use Azure Authentication to authenticate Office 365 users from your organization, corporate accounts synced from your on-premise Active Directory or users created in your own custom Azure Active Directory domain.</span></span> <span data-ttu-id="4f036-108">Włączenie uwierzytelniania systemu Windows Azure konfiguruje aplikację do uwierzytelniania użytkowników za pomocą pojedynczej [usługi Azure Active Directory](https://docs.microsoft.com/azure/active-directory/) dzierżawy.</span><span class="sxs-lookup"><span data-stu-id="4f036-108">Enabling Windows Azure Authentication configures your application to authenticate users using a single [Azure Active Directory](https://docs.microsoft.com/azure/active-directory/) tenant.</span></span>
> 
>  <span data-ttu-id="4f036-109">W tym samouczku zapisał Rick Anderson[@RickAndMSFT](https://twitter.com/#!/RickAndMSFT)</span><span class="sxs-lookup"><span data-stu-id="4f036-109">This tutorial was written by Rick Anderson [@RickAndMSFT](https://twitter.com/#!/RickAndMSFT)</span></span>


<span data-ttu-id="4f036-110">Ten samouczek przedstawia sposób tworzenia aplikacji ASP.NET, która jest skonfigurowana dla logowania z [usługi Azure Active Directory](https://msdn.microsoft.com/library/azure/mt168838.aspx) (Azure AD).</span><span class="sxs-lookup"><span data-stu-id="4f036-110">This tutorial will show you how to create an ASP.NET application that is configured for sign-on with [Azure Active Directory](https://msdn.microsoft.com/library/azure/mt168838.aspx) (Azure AD).</span></span> <span data-ttu-id="4f036-111">Także przedstawiono sposób wywołania interfejsu API programu Graph, aby uzyskać informacje o aktualnie zalogowanego użytkownika oraz sposobu wdrażania aplikacji na platformie Azure.</span><span class="sxs-lookup"><span data-stu-id="4f036-111">You will also learn how to call the Graph API to get information about the currently signed-in user and how to deploy the application to Azure.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="4f036-112">Wymagania wstępne</span><span class="sxs-lookup"><span data-stu-id="4f036-112">Prerequisites</span></span>

1. <span data-ttu-id="4f036-113">[Program Visual Studio Express 2013 for Web](https://www.microsoft.com/visualstudio/eng/2013-downloads#d-2013-express) lub [programu Visual Studio 2013](https://www.microsoft.com/visualstudio/eng/2013-downloads).</span><span class="sxs-lookup"><span data-stu-id="4f036-113">[Visual Studio Express 2013 for Web](https://www.microsoft.com/visualstudio/eng/2013-downloads#d-2013-express) or [Visual Studio 2013](https://www.microsoft.com/visualstudio/eng/2013-downloads).</span></span>
2. <span data-ttu-id="4f036-114">[Visual Studio 2013 Update 4](https://www.microsoft.com/download/details.aspx?id=44921) — wymagana jest aktualizacja 3 lub nowszej.</span><span class="sxs-lookup"><span data-stu-id="4f036-114">[Visual Studio 2013 Update 4](https://www.microsoft.com/download/details.aspx?id=44921) - Update 3 or higher is required.</span></span>
3. <span data-ttu-id="4f036-115">Konto platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="4f036-115">An Azure account.</span></span> <span data-ttu-id="4f036-116">[Kliknij tutaj](https://azure.microsoft.com/pricing/free-trial/) bezpłatnej wersji próbnej, jeśli nie masz już konto.</span><span class="sxs-lookup"><span data-stu-id="4f036-116">[Click here](https://azure.microsoft.com/pricing/free-trial/) for a free trial if you do not already have an account.</span></span>

## <a name="add-a-global-administrator-to-your-active-directory"></a><span data-ttu-id="4f036-117">Dodaj rolę administratora globalnego do usługi Active Directory</span><span class="sxs-lookup"><span data-stu-id="4f036-117">Add a Global Administrator to your Active Directory</span></span>

1. <span data-ttu-id="4f036-118">Zaloguj się do [portalu zarządzania Azure](https://manage.windowsazure.com/).</span><span class="sxs-lookup"><span data-stu-id="4f036-118">Sign in to the [Azure Management Portal](https://manage.windowsazure.com/).</span></span>
2. <span data-ttu-id="4f036-119">Wszystkie konta platformy Azure zawierają **katalog domyślny** — kliknij go, a następnie kliknij przycisk **użytkowników** kartę w górnej części strony (zobacz obraz poniżej).</span><span class="sxs-lookup"><span data-stu-id="4f036-119">All Azure accounts contain a **Default Directory** -- click on it, then click the **Users** tab at the top of the page (see image below).</span></span>
3. <span data-ttu-id="4f036-120">Kliknij przycisk Dodaj użytkownika.</span><span class="sxs-lookup"><span data-stu-id="4f036-120">Click Add User.</span></span>  
    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image1.png)
4. <span data-ttu-id="4f036-121">Utwórz nowego użytkownika z **administratora globalnego** roli.</span><span class="sxs-lookup"><span data-stu-id="4f036-121">Create a new user with the **Global Administrator** role.</span></span> <span data-ttu-id="4f036-122">Kliknij przycisk **użytkowników** z menu u góry, a następnie kliknij przycisk **Dodaj użytkownika** przycisk paska poleceń.</span><span class="sxs-lookup"><span data-stu-id="4f036-122">Click **Users** from the top menu, and then click the **Add User** button on the command bar.</span></span>
5. <span data-ttu-id="4f036-123">W **Dodaj użytkownika** okna dialogowego, wprowadź nazwę dla nowego użytkownika, a następnie kliknij strzałkę w prawo.</span><span class="sxs-lookup"><span data-stu-id="4f036-123">In the **Add User** dialog, enter a name for the new user and then click the right arrow.</span></span>  
  
    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image2.png)
6. <span data-ttu-id="4f036-124">Wprowadź nazwę użytkownika i rolę ustaw **administratora globalnego**.</span><span class="sxs-lookup"><span data-stu-id="4f036-124">Enter the user name and set the role to **Global Administrator**.</span></span> <span data-ttu-id="4f036-125">Administratorzy globalni wymagają alternatywnego adresu e-mail na potrzeby odzyskiwania hasła.</span><span class="sxs-lookup"><span data-stu-id="4f036-125">Global administrators require an alternate email address for password recovery purposes.</span></span> <span data-ttu-id="4f036-126">Po zakończeniu kliknij strzałkę w prawo.</span><span class="sxs-lookup"><span data-stu-id="4f036-126">After you're finished, click the right arrow.</span></span>  
  
    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image3.png)
7. <span data-ttu-id="4f036-127">Na następnej stronie okna dialogowego, kliknij przycisk **Utwórz**.</span><span class="sxs-lookup"><span data-stu-id="4f036-127">On the next page of the dialog, click **Create**.</span></span> <span data-ttu-id="4f036-128">Hasło tymczasowe, zostanie utworzona dla nowego użytkownika i wyświetlane w oknie dialogowym.</span><span class="sxs-lookup"><span data-stu-id="4f036-128">A temporary password will be created for the new user and displayed in the dialog.</span></span>   
  
    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image4.png)  
  
 <span data-ttu-id="4f036-129">Zapisz hasło konieczna będzie zmiana hasła po pierwszego logowania.</span><span class="sxs-lookup"><span data-stu-id="4f036-129">Save the password, you will be required to change the password after the first log in.</span></span> <span data-ttu-id="4f036-130">Na poniższej ilustracji przedstawiono nowe konto administratora.</span><span class="sxs-lookup"><span data-stu-id="4f036-130">The following image shows the new admin account.</span></span> <span data-ttu-id="4f036-131">Aby zalogować się do aplikacji, nie na koncie Microsoft, które są także wyświetlane na tej stronie, należy użyć usługi Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="4f036-131">You must use the Azure Active Directory to log into your app, not the Microsoft account also shown on this page.</span></span>  
  
    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image5.png)

## <a name="create-an-aspnet-application"></a><span data-ttu-id="4f036-132">Tworzenie aplikacji ASP.NET</span><span class="sxs-lookup"><span data-stu-id="4f036-132">Create an ASP.NET Application</span></span>

<span data-ttu-id="4f036-133">Następujące kroki użyj [programu Visual Studio Express 2013 for Web](https://www.microsoft.com/download/details.aspx?id=40747)i wymaga [Visual Studio 2013 Update 3](https://www.microsoft.com/download/details.aspx?id=43721).</span><span class="sxs-lookup"><span data-stu-id="4f036-133">The following steps use [Visual Studio Express 2013 for Web](https://www.microsoft.com/download/details.aspx?id=40747), and requires [Visual Studio 2013 Update 3](https://www.microsoft.com/download/details.aspx?id=43721).</span></span>

1. <span data-ttu-id="4f036-134">W programie Visual Studio, kliknij przycisk **pliku** , a następnie **nowy projekt**.</span><span class="sxs-lookup"><span data-stu-id="4f036-134">In Visual Studio, click **File** and then **New Project**.</span></span> <span data-ttu-id="4f036-135">Na **nowy projekt** okno dialogowe, wybierz Visual C# sieci Web projektu z menu po lewej stronie i kliknij przycisk **OK**.</span><span class="sxs-lookup"><span data-stu-id="4f036-135">On the **New Project** dialog, select the Visual C# Web project from the left menu and click **OK**.</span></span> <span data-ttu-id="4f036-136">Można również usunąć zaznaczenie pola wyboru **Dodaj usługę Application Insights do projektu** Jeśli nie chcesz funkcjonalności aplikacji.</span><span class="sxs-lookup"><span data-stu-id="4f036-136">You may also want to uncheck the **Add Application Insights to Project** if you don't want the functionality for your application.</span></span>
2. <span data-ttu-id="4f036-137">W **nowy projekt ASP.NET** okno dialogowe, wybierz opcję **MVC**, a następnie kliknij przycisk **Zmień uwierzytelnianie**.</span><span class="sxs-lookup"><span data-stu-id="4f036-137">In the **New ASP.NET Project** dialog, select **MVC**, and then click **Change Authentication**.</span></span>   
  
    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image6.png)
3. <span data-ttu-id="4f036-138">Na **Zmień uwierzytelnianie** okno dialogowe, wybierz opcję **konta organizacyjne**.</span><span class="sxs-lookup"><span data-stu-id="4f036-138">On the **Change Authentication** dialog, select **Organizational Accounts**.</span></span> <span data-ttu-id="4f036-139">Te opcje można automatycznie zarejestrować aplikację w usłudze Azure AD, a także automatycznie skonfigurować aplikację do integracji z usługą Azure AD.</span><span class="sxs-lookup"><span data-stu-id="4f036-139">These options can be used to automatically register your application with Azure AD as well as automatically configure your application to integrate with Azure AD.</span></span> <span data-ttu-id="4f036-140">Nie trzeba używać **Zmień uwierzytelnianie** okna dialogowego do rejestracji i konfiguracji aplikacji, ale ułatwia.</span><span class="sxs-lookup"><span data-stu-id="4f036-140">You don't have to use the **Change Authentication** dialog to register and configure your application, but it makes it much easier.</span></span> <span data-ttu-id="4f036-141">Jeśli na przykład używasz programu Visual Studio 2012, można nadal ręcznie zarejestrować aplikację w portalu zarządzania Azure i zaktualizuj jego konfigurację do integracji z usługą Azure AD.</span><span class="sxs-lookup"><span data-stu-id="4f036-141">If you are using Visual Studio 2012 for example, you can still manually register the application in the Azure Management Portal and update its configuration to integrate with Azure AD.</span></span>  
 <span data-ttu-id="4f036-142">W menu rozwijanego wybierz **Cloud - jednej organizacji** i **jednokrotne, Czytaj dane katalogu**.</span><span class="sxs-lookup"><span data-stu-id="4f036-142">In the drop-down menus, select **Cloud - Single Organization** and **Single Sign On, Read directory data**.</span></span> <span data-ttu-id="4f036-143">Wprowadź domenę katalogu usługi Azure AD, na przykład (w obrazach poniżej) *aricka0yahoo.onmicrosoft.com*, a następnie kliknij przycisk **OK**.</span><span class="sxs-lookup"><span data-stu-id="4f036-143">Enter the domain for your Azure AD directory, for example (in the images below) *aricka0yahoo.onmicrosoft.com*, and then click **OK**.</span></span> <span data-ttu-id="4f036-144">Możesz też uzyskać nazwę domeny na karcie domen katalog domyślny, w portalu azure (zobacz następny obraz w dół).</span><span class="sxs-lookup"><span data-stu-id="4f036-144">You can get the domain name from the Domains tab for the Default Directory on the azure portal (see the next image down).</span></span>   
  
    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image7.png)  
  
 <span data-ttu-id="4f036-145">Na poniższej ilustracji przedstawiono nazwę domeny w portalu Azure.</span><span class="sxs-lookup"><span data-stu-id="4f036-145">The following image shows the domain name from the Azure portal.</span></span>  
  
    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image8.png)  

    > [!NOTE]
    > <span data-ttu-id="4f036-146">Opcjonalnie można skonfigurować identyfikator URI aplikacji, która zostanie zarejestrowana w usłudze Azure AD, klikając **więcej opcji**.</span><span class="sxs-lookup"><span data-stu-id="4f036-146">You can optionally configure the Application ID URI that will be registered in Azure AD by clicking **More Options**.</span></span> <span data-ttu-id="4f036-147">Identyfikator URI aplikacji jest unikatowym identyfikatorem dla aplikacji, która jest zarejestrowana w usłudze Azure AD i używane przez aplikację do identyfikacji podczas komunikacji z usługą Azure AD.</span><span class="sxs-lookup"><span data-stu-id="4f036-147">The App ID URI is the unique identifier for an application, which is registered in Azure AD and used by the application to identify itself when communicating with Azure AD.</span></span> <span data-ttu-id="4f036-148">Aby uzyskać więcej informacji na temat identyfikator URI aplikacji i innych właściwości zarejestrowanych aplikacji, zobacz [w tym temacie](https://msdn.microsoft.com/library/azure/dn499820.aspx#BKMK_Registering).</span><span class="sxs-lookup"><span data-stu-id="4f036-148">For more information about the App ID URI and other properties of registered applications, see [this topic](https://msdn.microsoft.com/library/azure/dn499820.aspx#BKMK_Registering).</span></span> <span data-ttu-id="4f036-149">Kliknij pole wyboru poniżej pola Identyfikator URI aplikacji, można również zastąpić istniejący rejestracji w usłudze Azure AD, który korzysta z takim samym Identyfikatorem URI aplikacji.</span><span class="sxs-lookup"><span data-stu-id="4f036-149">By clicking the checkbox below the App ID URI field, you can also choose to overwrite an existing registration in Azure AD that uses the same App ID URI.</span></span>
4. <span data-ttu-id="4f036-150">Po kliknięciu przycisku **OK**, wyświetli się okno dialogowe logowania i konieczne będzie zalogowanie się przy użyciu konta administratora globalnego (nie konta Microsoft skojarzonego z subskrypcją).</span><span class="sxs-lookup"><span data-stu-id="4f036-150">After clicking **OK**, a sign-in dialog will appear, and you'll need to sign in using a Global Administrator account (not the Microsoft account associated with your subscription).</span></span> <span data-ttu-id="4f036-151">Jeśli wcześniej utworzono nowe konto administratora, będzie trzeba zmienić hasło, a następnie zaloguj się ponownie przy użyciu nowego hasła.</span><span class="sxs-lookup"><span data-stu-id="4f036-151">If you created a new Administrator account earlier, you'll be required to change the password and then sign in again using the new password.</span></span>   
  
    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image9.png)
5. <span data-ttu-id="4f036-152">Po pomyślnie uwierzytelniono, **nowy projekt ASP.NET** okna dialogowego zostaną wyświetlone wybór uwierzytelniania (**organizacyjnej** ) i katalog, w której będzie nowa aplikacja zarejestrowany (*aricka0yahoo.onmicrosoft.com* na poniższej ilustracji).</span><span class="sxs-lookup"><span data-stu-id="4f036-152">After you've successfully authenticated, the **New ASP.NET Project** dialog will show your authentication choice (**Organizational** ) and the directory where the new application will be registered (*aricka0yahoo.onmicrosoft.com* in the image below).</span></span> <span data-ttu-id="4f036-153">Poniżej tych informacji, zaznacz pole wyboru **Hostuj w chmurze**.</span><span class="sxs-lookup"><span data-stu-id="4f036-153">Below this information, select the checkbox labeled **Host in the cloud**.</span></span> <span data-ttu-id="4f036-154">Jeśli to pole wyboru jest zaznaczone, projekt zostanie zainicjowana jako aplikacja sieci web platformy Azure i będzie można później łatwo publikowania.</span><span class="sxs-lookup"><span data-stu-id="4f036-154">If this checkbox is selected, the project will be provisioned as an Azure web app and will be enabled for easy publishing later.</span></span> <span data-ttu-id="4f036-155">Kliknij przycisk **OK**.</span><span class="sxs-lookup"><span data-stu-id="4f036-155">Click **OK**.</span></span>   
  
    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image10.png)
6. <span data-ttu-id="4f036-156">**Azure konfigurowania witryny sieci Web** wyświetli się okno dialogowe, przy użyciu nazwy lokacji wygenerowany automatycznie i regionu.</span><span class="sxs-lookup"><span data-stu-id="4f036-156">The **Configure Azure Website** dialog will appear, using an auto-generated site name and region.</span></span> <span data-ttu-id="4f036-157">Należy również zauważyć konta, które jest aktualnie zalogowany do w oknie dialogowym.</span><span class="sxs-lookup"><span data-stu-id="4f036-157">Also note the account you're currently signed into in the dialog.</span></span> <span data-ttu-id="4f036-158">Aby upewnić się, że to konto jest dołączona subskrypcji platformy Azure, zwykle konta Microsoft.</span><span class="sxs-lookup"><span data-stu-id="4f036-158">You want to make sure that this account is the one that your Azure subscription is attached to, typically a Microsoft account.</span></span>

    > [!NOTE]
    > <span data-ttu-id="4f036-159">Ten projekt wymaga bazy danych.</span><span class="sxs-lookup"><span data-stu-id="4f036-159">This project requires a database.</span></span> <span data-ttu-id="4f036-160">Należy wybrać jedną z istniejących baz danych lub Utwórz nową.</span><span class="sxs-lookup"><span data-stu-id="4f036-160">You need to select one of your existing databases, or create a new one.</span></span> <span data-ttu-id="4f036-161">Bazy danych jest wymagana, ponieważ projekt już korzysta z plików lokalnej bazy danych do przechowywania niewielką ilość danych konfiguracji uwierzytelniania.</span><span class="sxs-lookup"><span data-stu-id="4f036-161">A database is required because the project already uses a local database file to store a small amount of authentication configuration data.</span></span> <span data-ttu-id="4f036-162">Podczas wdrażania aplikacji do witryny sieci Web platformy Azure tej bazy danych nie jest dostarczana z wdrożeniem, należy wybrać jedną, która jest dostępna w chmurze.</span><span class="sxs-lookup"><span data-stu-id="4f036-162">When you deploy the application to an Azure Website, this database isn't packaged with the deployment, so you need to choose one that's accessible in the cloud.</span></span> <span data-ttu-id="4f036-163">Kliknij przycisk **OK**.</span><span class="sxs-lookup"><span data-stu-id="4f036-163">Click **OK**.</span></span>

    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image11.png)
7. <span data-ttu-id="4f036-164">Projekt zostanie utworzony i opcje aplikacji sieci web i opcje uwierzytelniania, na których zostanie automatycznie skonfigurowany z projektem.</span><span class="sxs-lookup"><span data-stu-id="4f036-164">The project will be created, and your authentication options and web app options will be automatically configured with the project.</span></span> <span data-ttu-id="4f036-165">Po zakończeniu tego procesu uruchamianie projektu lokalnie, naciskając **^ F5**.</span><span class="sxs-lookup"><span data-stu-id="4f036-165">Once this process has completed, run the project locally by pressing **^F5**.</span></span> <span data-ttu-id="4f036-166">Będą musieli logować się za pomocą konta organizacyjnego.</span><span class="sxs-lookup"><span data-stu-id="4f036-166">You will be required to sign in using your organizational account.</span></span> <span data-ttu-id="4f036-167">Podaj nazwę użytkownika i hasło dla konta utworzonego wcześniej, a następnie kliknij przycisk **Zaloguj**.</span><span class="sxs-lookup"><span data-stu-id="4f036-167">Provide the username and password for the account you created earlier and click **Sign in**.</span></span>   
  
    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image12.png)
8. <span data-ttu-id="4f036-168">Po pomyślnego logowania witryny ASP.NET wykaże, że uwierzytelniono za pomocą wyświetlania nazwy użytkownika w prawym górnym rogu strony.</span><span class="sxs-lookup"><span data-stu-id="4f036-168">After successful sign in, the ASP.NET site will show that you've authenticated by displaying the username in the top right corner of the page.</span></span>  
  
    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image13.png)  
  
 <span data-ttu-id="4f036-169">Jeśli zostanie wyświetlony błąd:</span><span class="sxs-lookup"><span data-stu-id="4f036-169">If you get the error:</span></span>  
 <span data-ttu-id="4f036-170">Wartość nie może być zerowa ani pusta.</span><span class="sxs-lookup"><span data-stu-id="4f036-170">Value cannot be null or empty.</span></span> <span data-ttu-id="4f036-171">Nazwa parametru: linkText</span><span class="sxs-lookup"><span data-stu-id="4f036-171">Parameter name: linkText</span></span>   
    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image14.png)  
  
 <span data-ttu-id="4f036-172">zobacz [debugowania](#dbg) sekcji na końcu samouczka.</span><span class="sxs-lookup"><span data-stu-id="4f036-172">see the [debug](#dbg) section at the end of the tutorial.</span></span>

## <a name="basics-of-the-graph-api"></a><span data-ttu-id="4f036-173">Podstawy interfejs API Graph</span><span class="sxs-lookup"><span data-stu-id="4f036-173">Basics of the Graph API</span></span>

<span data-ttu-id="4f036-174">[Interfejsu API programu Graph](https://msdn.microsoft.com/library/azure/hh974476.aspx) jest interfejs programistyczny używanych do wykonywania CRUD i inne operacje na obiektach w katalogu usługi Azure AD.</span><span class="sxs-lookup"><span data-stu-id="4f036-174">[The Graph API](https://msdn.microsoft.com/library/azure/hh974476.aspx) is the programmatic interface used to perform CRUD and other operations on objects in your Azure AD directory.</span></span> <span data-ttu-id="4f036-175">Jeśli wybrano opcję konta organizacyjnego do uwierzytelniania podczas tworzenia nowego projektu programu Visual Studio 2013, aplikacja już zostanie skonfigurowana do wywołania interfejsu API programu Graph.</span><span class="sxs-lookup"><span data-stu-id="4f036-175">If you select an Organizational Account option for authentication when creating a new project in Visual Studio 2013, your application will already be configured to call the Graph API.</span></span> <span data-ttu-id="4f036-176">W tej sekcji krótko opisano sposób działania interfejsu API programu Graph.</span><span class="sxs-lookup"><span data-stu-id="4f036-176">This section briefly shows you how the Graph API works.</span></span>

1. <span data-ttu-id="4f036-177">W uruchomionej aplikacji, kliknij nazwę użytkownika zalogowanego na początku prawej części strony.</span><span class="sxs-lookup"><span data-stu-id="4f036-177">In your running application, click on the name of the signed-in user at the top right of the page.</span></span> <span data-ttu-id="4f036-178">Spowoduje to przejście do strony profilu użytkownika, czyli akcji w kontrolerze Home.</span><span class="sxs-lookup"><span data-stu-id="4f036-178">This will take you to the User Profile page, which is an action on the Home Controller.</span></span> <span data-ttu-id="4f036-179">Można zauważyć, że tabela zawiera informacje użytkownika o konta administratora, które wcześniej utworzony.</span><span class="sxs-lookup"><span data-stu-id="4f036-179">You'll notice that the table contains user information about the administrator account you created earlier.</span></span> <span data-ttu-id="4f036-180">Te informacje są przechowywane w katalogu i interfejsu API programu Graph jest wywoływana, aby pobrać te informacje podczas ładowania strony.</span><span class="sxs-lookup"><span data-stu-id="4f036-180">This information is stored in your directory, and the Graph API is called to retrieve this information when the page loads.</span></span>   
  
    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image15.png)
2. <span data-ttu-id="4f036-181">Wróć do programu Visual Studio i rozwiń **kontrolerów** , a następnie otwórz folder **HomeController.cs** pliku.</span><span class="sxs-lookup"><span data-stu-id="4f036-181">Go back to Visual Studio and expand the **Controllers** folder and then open the **HomeController.cs** file.</span></span> <span data-ttu-id="4f036-182">Zobaczysz **UserProfile()** akcji, który zawiera kod, aby pobrać token, a następnie wywołać interfejsu API programu Graph.</span><span class="sxs-lookup"><span data-stu-id="4f036-182">You'll see a **UserProfile()** action that contains code to retrieve a token and then call the Graph API.</span></span> <span data-ttu-id="4f036-183">Ten kod jest zduplikowany poniżej:</span><span class="sxs-lookup"><span data-stu-id="4f036-183">This code is duplicated below:</span></span> 

    [!code-csharp[Main](developing-aspnet-apps-with-windows-azure-active-directory/samples/sample1.cs?highlight=22)]

    <span data-ttu-id="4f036-184">Aby wywołać interfejsu API programu Graph, należy najpierw pobrać tokenu.</span><span class="sxs-lookup"><span data-stu-id="4f036-184">To call the Graph API, you first need to retrieve a token.</span></span> <span data-ttu-id="4f036-185">Po pobraniu tokenu jego wartość ciągu musi być przypisany w nagłówku autoryzacji dla wszystkich kolejnych żądań interfejsu API programu Graph.</span><span class="sxs-lookup"><span data-stu-id="4f036-185">When the token is retrieved, its string value must be appended in the Authorization header for all subsequent requests to the Graph API.</span></span> <span data-ttu-id="4f036-186">Większość kodu powyżej obsługuje dane do usługi Azure AD w celu pobrania tokenu uwierzytelniania, przy użyciu tokenu do wywoływania interfejsu API programu Graph i następnie Przekształcanie odpowiedzi, dzięki czemu mogą być przedstawiane w widoku.</span><span class="sxs-lookup"><span data-stu-id="4f036-186">Most of the code above handles the details of authenticating to Azure AD to get a token, using the token to make a call to the Graph API, and then transforming the response so that it can be presented in the View.</span></span>

    <span data-ttu-id="4f036-187">Najbardziej odpowiedniej części omówienie jest następujący wyróżniony wiersz: `UserProfile profile = JsonConvert.DeserializeObject<UserProfile>(responseString);`.</span><span class="sxs-lookup"><span data-stu-id="4f036-187">The most relevant portion for discussion is the following highlighted line: `UserProfile profile = JsonConvert.DeserializeObject<UserProfile>(responseString);`.</span></span> <span data-ttu-id="4f036-188">Ten wiersz reprezentuje nazwę użytkownika, który został zdeserializowany z odpowiedzi JSON i są prezentowane w widoku.</span><span class="sxs-lookup"><span data-stu-id="4f036-188">This line represents the name of the user, which has been deserialized from the JSON response and is presented in the View.</span></span>

    <span data-ttu-id="4f036-189">Można wywołać interfejsu API programu Graph, za pomocą elementu HttpClient i obsługiwać nieprzetworzone dane, samodzielnie, ale łatwiej metodą jest użycie [biblioteki klienta wykresu, który jest dostępny za pośrednictwem pakietu NuGet](http://www.nuget.org/packages/Microsoft.Azure.ActiveDirectory.GraphClient/).</span><span class="sxs-lookup"><span data-stu-id="4f036-189">You can call the Graph API using HttpClient and handle the raw data yourself, but an easier way is to use the [Graph Client Library which is available via NuGet](http://www.nuget.org/packages/Microsoft.Azure.ActiveDirectory.GraphClient/).</span></span> <span data-ttu-id="4f036-190">Biblioteka klienta obsługuje pierwotne żądania HTTP i transformacja dane zwrotne dla Ciebie i ułatwia do pracy z interfejsu API programu Graph w środowisku .NET.</span><span class="sxs-lookup"><span data-stu-id="4f036-190">The Client Library handles the raw HTTP requests and the transformation of the returned data for you, and makes it much easier to work with the Graph API in a .NET environment.</span></span> <span data-ttu-id="4f036-191">Zobacz powiązane przykłady kodu interfejsu API programu Graph w [GitHub.](https://github.com/AzureADSamples)</span><span class="sxs-lookup"><span data-stu-id="4f036-191">See the related Graph API code samples on [GitHub.](https://github.com/AzureADSamples)</span></span>

## <a name="deploy-the-application-to-azure"></a><span data-ttu-id="4f036-192">Wdrażanie aplikacji na platformie Azure</span><span class="sxs-lookup"><span data-stu-id="4f036-192">Deploy the Application to Azure</span></span>

<span data-ttu-id="4f036-193">Poniższe kroki pokazują jak wdrożyć aplikację na platformie Azure.</span><span class="sxs-lookup"><span data-stu-id="4f036-193">The following steps will show you how to deploy the application to Azure.</span></span> <span data-ttu-id="4f036-194">We wcześniejszych krokach zostanie połączony nowego projektu z aplikacją sieci web na platformie Azure, więc jest gotowy do opublikowania w kilku kroków.</span><span class="sxs-lookup"><span data-stu-id="4f036-194">In the earlier steps, you connected your new project with a web app on Azure, so it's ready to be published in just a few steps.</span></span>

1. <span data-ttu-id="4f036-195">W programie Visual Studio, kliknij prawym przyciskiem myszy projekt i wybierz **publikowania**.</span><span class="sxs-lookup"><span data-stu-id="4f036-195">In Visual Studio, right-click on the project and select **Publish**.</span></span> <span data-ttu-id="4f036-196">**Publikowanie w sieci Web** wyświetli się okno dialogowe z każdego ustawienia już skonfigurowane.</span><span class="sxs-lookup"><span data-stu-id="4f036-196">The **Publish Web** dialog will appear with each setting already configured.</span></span> <span data-ttu-id="4f036-197">Polecenie **dalej** przycisk, aby przejść do **ustawienia** strony.</span><span class="sxs-lookup"><span data-stu-id="4f036-197">Click on the **Next** button to go to the **Settings** page.</span></span> <span data-ttu-id="4f036-198">Może pojawić się prośba do uwierzytelniania; Upewnij się, że należy przeprowadzić uwierzytelnianie przy użyciu konta subskrypcji platformy Azure (zazwyczaj kontem Microsoft), a nie konta organizacyjnego utworzony wcześniej.</span><span class="sxs-lookup"><span data-stu-id="4f036-198">You may be prompted to authenticate; make sure you authenticate using your Azure subscription account (typically a Microsoft account) and not the organizational account you created earlier.</span></span>  
  
    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image16.png)
2. <span data-ttu-id="4f036-199">Sprawdź **Włączanie uwierzytelniania organizacyjnego** opcji.</span><span class="sxs-lookup"><span data-stu-id="4f036-199">Check the **Enable Organizational Authentication** option.</span></span> <span data-ttu-id="4f036-200">W **domeny** wprowadź domeny dla katalogu.</span><span class="sxs-lookup"><span data-stu-id="4f036-200">In the **Domain** field, enter the domain for your directory.</span></span> <span data-ttu-id="4f036-201">Z **poziom dostępu** listy rozwijanej, wybierz pozycję **jednokrotne, Czytaj dane katalogu**.</span><span class="sxs-lookup"><span data-stu-id="4f036-201">From the **Access Level** drop-down, select **Single Sign On, Read directory data**.</span></span> <span data-ttu-id="4f036-202">Można zauważyć, że poprzednie bazy danych, możesz użyć znajduje się już w **baz danych** sekcji.</span><span class="sxs-lookup"><span data-stu-id="4f036-202">You'll notice that the previous database you used is already populated in the **Databases** section.</span></span> <span data-ttu-id="4f036-203">Kliknij przycisk **publikowania**.</span><span class="sxs-lookup"><span data-stu-id="4f036-203">Click **Publish**.</span></span>  
  
    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image17.png)
3. <span data-ttu-id="4f036-204">Visual Studio będzie rozpocząć wdrażanie witryny sieci Web, a następnie pojawi się nowe okno przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="4f036-204">Visual Studio will begin deploying your website, and then a new browser window will appear.</span></span> <span data-ttu-id="4f036-205">Może pojawić się prośba do uwierzytelniania katalogu jeszcze raz.</span><span class="sxs-lookup"><span data-stu-id="4f036-205">You may be prompted to authenticate to your directory once again.</span></span> <span data-ttu-id="4f036-206">Po uwierzytelniono, użytkownik będzie przekierowany do nowo opublikowana witryny sieci Web na platformie Azure.</span><span class="sxs-lookup"><span data-stu-id="4f036-206">Once you've authenticated, you'll be redirected to your newly published website on Azure.</span></span>  
  
    ![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image18.png)

<a id="dbg"></a>
## <a name="debugging-the-app"></a><span data-ttu-id="4f036-207">Debugowanie aplikacji</span><span class="sxs-lookup"><span data-stu-id="4f036-207">Debugging the app</span></span>

<span data-ttu-id="4f036-208">Jeśli zostanie wyświetlony następujący błąd:</span><span class="sxs-lookup"><span data-stu-id="4f036-208">If you get the following error:</span></span>   
 <span data-ttu-id="4f036-209">Wartość nie może być zerowa ani pusta.</span><span class="sxs-lookup"><span data-stu-id="4f036-209">Value cannot be null or empty.</span></span> <span data-ttu-id="4f036-210">Nazwa parametru: linkText</span><span class="sxs-lookup"><span data-stu-id="4f036-210">Parameter name: linkText</span></span>   
   
![](developing-aspnet-apps-with-windows-azure-active-directory/_static/image19.png)  
  

<span data-ttu-id="4f036-211">Zastąp kod w *Views\Shared\\_LoginPartial.cshtml* pliku następującym kodem:</span><span class="sxs-lookup"><span data-stu-id="4f036-211">Replace the code in the *Views\Shared\\_LoginPartial.cshtml* file with the following:</span></span>

[!code-cshtml[Main](developing-aspnet-apps-with-windows-azure-active-directory/samples/sample2.cshtml?highlight=1-8,15-16)]

<span data-ttu-id="4f036-212">Po uruchomieniu aplikacji, jeśli zalogowanego użytkownika zawiera "Użytkownika o wartości Null", wyloguj się i zaloguj się ponownie przy użyciu utworzonego wcześniej konta usługi Active Directory.</span><span class="sxs-lookup"><span data-stu-id="4f036-212">After running the app, if the logged in user shows "Null User", sign out, and sign back in with the Active Directory account you created earlier.</span></span>

<span data-ttu-id="4f036-213">Znakomity samouczkiem, aby wykonać to Rick Rainey [nowości: witryny sieci Web platformy Azure i organizacji uwierzytelnianie przy użyciu usługi Azure AD](http://rickrainey.com/2014/08/19/deep-dive-azure-websites-and-organizational-authentication-using-azure-ad/).</span><span class="sxs-lookup"><span data-stu-id="4f036-213">An excellent tutorial to follow is Rick Rainey's [Deep Dive: Azure Websites and Organizational Authentication using Azure AD](http://rickrainey.com/2014/08/19/deep-dive-azure-websites-and-organizational-authentication-using-azure-ad/).</span></span>

## <a name="more-information"></a><span data-ttu-id="4f036-214">Więcej informacji</span><span class="sxs-lookup"><span data-stu-id="4f036-214">More Information</span></span>

- [<span data-ttu-id="4f036-215">Szczegółowe informacje na temat: Witryn sieci Web Azure i organizacyjne uwierzytelniania za pomocą usługi Azure AD</span><span class="sxs-lookup"><span data-stu-id="4f036-215">Deep Dive: Azure Websites and Organizational Authentication using Azure AD</span></span>](http://rickrainey.com/2014/08/19/deep-dive-azure-websites-and-organizational-authentication-using-azure-ad/)
- [<span data-ttu-id="4f036-216">Przegląd interfejsu API Graph usługi Azure AD</span><span class="sxs-lookup"><span data-stu-id="4f036-216">Azure AD Graph API Overview</span></span>](https://msdn.microsoft.com/library/azure/hh974476.aspx)
- [<span data-ttu-id="4f036-217">Scenariusze uwierzytelniania w usłudze Azure AD</span><span class="sxs-lookup"><span data-stu-id="4f036-217">Authentication Scenarios in Azure AD</span></span>](https://msdn.microsoft.com/library/azure/dn499820.aspx)
- [<span data-ttu-id="4f036-218">Przykłady kodu usługi Azure AD w witrynie GitHub</span><span class="sxs-lookup"><span data-stu-id="4f036-218">Azure AD Code Samples on GitHub</span></span>](https://github.com/AzureADSamples)
