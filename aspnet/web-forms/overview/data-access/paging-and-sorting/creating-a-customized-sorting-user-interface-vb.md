---
uid: web-forms/overview/data-access/paging-and-sorting/creating-a-customized-sorting-user-interface-vb
title: Tworzenie interfejsu użytkownika sortowania dostosowanych (VB) | Dokumentacja firmy Microsoft
author: rick-anderson
description: Podczas wyświetlania długą listę sortowania danych, może być bardzo przydatne do grupowania powiązanych danych dzięki zastosowaniu separator wierszy. W tym samouczku zajmiemy się tym, jak uż...
ms.author: aspnetcontent
manager: wpickett
ms.date: 08/15/2006
ms.topic: article
ms.assetid: f3897a74-cc6a-4032-8f68-465f155e296a
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/paging-and-sorting/creating-a-customized-sorting-user-interface-vb
msc.type: authoredcontent
ms.openlocfilehash: 35144907aceda6ece56d91b24aba15ef951ed99a
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/06/2018
---
<a name="creating-a-customized-sorting-user-interface-vb"></a><span data-ttu-id="4d84d-104">Tworzenie interfejsu użytkownika sortowania dostosowanych (VB)</span><span class="sxs-lookup"><span data-stu-id="4d84d-104">Creating a Customized Sorting User Interface (VB)</span></span>
====================
<span data-ttu-id="4d84d-105">przez [Bento Scott](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="4d84d-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="4d84d-106">[Pobierz przykładową aplikację](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_27_VB.exe) lub [pobierania plików PDF](creating-a-customized-sorting-user-interface-vb/_static/datatutorial27vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="4d84d-106">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_27_VB.exe) or [Download PDF](creating-a-customized-sorting-user-interface-vb/_static/datatutorial27vb1.pdf)</span></span>

> <span data-ttu-id="4d84d-107">Podczas wyświetlania długą listę sortowania danych, może być bardzo przydatne do grupowania powiązanych danych dzięki zastosowaniu separator wierszy.</span><span class="sxs-lookup"><span data-stu-id="4d84d-107">When displaying a long list of sorted data, it can be very helpful to group related data by introducing separator rows.</span></span> <span data-ttu-id="4d84d-108">W tym samouczku będzie przedstawiono sposób tworzenia takich sortowania interfejsu użytkownika.</span><span class="sxs-lookup"><span data-stu-id="4d84d-108">In this tutorial we'll see how to create such a sorting user interface.</span></span>


## <a name="introduction"></a><span data-ttu-id="4d84d-109">Wprowadzenie</span><span class="sxs-lookup"><span data-stu-id="4d84d-109">Introduction</span></span>

<span data-ttu-id="4d84d-110">Podczas wyświetlania długą listę sortowania danych w przypadku, gdy istnieją tylko kilka różnych wartości w kolumnie posortowana, użytkownik końcowy może być bardzo trudne do wykrycia, dokładnie, granice różnica mieć miejsce.</span><span class="sxs-lookup"><span data-stu-id="4d84d-110">When displaying a long list of sorted data where there are only a handful of different values in the sorted column, an end user might find it hard to discern where, exactly, the difference boundaries occur.</span></span> <span data-ttu-id="4d84d-111">Na przykład istnieją 81 produktów w bazie danych, ale tylko dziewięć opcji różnych kategorii (osiem kategorii unikatowy plus `NULL` opcja).</span><span class="sxs-lookup"><span data-stu-id="4d84d-111">For example, there are 81 products in the database, but only nine different category choices (eight unique categories plus the `NULL` option).</span></span> <span data-ttu-id="4d84d-112">Rozważmy przypadek użytkownik chcący badanie produktów, które są objęte kategorii ryby.</span><span class="sxs-lookup"><span data-stu-id="4d84d-112">Consider the case of a user who is interested in examining the products that fall under the Seafood category.</span></span> <span data-ttu-id="4d84d-113">Ze strony, która zawiera *wszystkie* produktów w jednym widoku GridView, użytkownik może zdecydować, jej najlepiej Sortuj wyniki według kategorii, które zostaną zgrupowane wszystkich produktów ryby razem.</span><span class="sxs-lookup"><span data-stu-id="4d84d-113">From a page that lists *all* of the products in a single GridView, the user might decide her best bet is to sort the results by category, which will group together all of the Seafood products together.</span></span> <span data-ttu-id="4d84d-114">Po posortowaniu według kategorii, następnie należy wyszukiwania za pomocą listy, wyszukiwanie gdzie produktów pogrupowane ryby rozpoczęcia i zakończenia.</span><span class="sxs-lookup"><span data-stu-id="4d84d-114">After sorting by category, the user then needs to hunt through the list, looking for where the Seafood-grouped products start and end.</span></span> <span data-ttu-id="4d84d-115">Ponieważ wyniki są w kolejności alfabetycznej przez nazwę kategorii produktów ryby wyszukiwanie nie jest trudne, ale nadal wymaga skanowania ściśle listę elementów w siatce.</span><span class="sxs-lookup"><span data-stu-id="4d84d-115">Since the results are ordered alphabetically by the category name finding the Seafood products is not difficult, but it still requires closely scanning the list of items in the grid.</span></span>

<span data-ttu-id="4d84d-116">Aby wyróżnić granice między grupami posortowane, wiele witryn sieci Web stosować interfejsu użytkownika, który dodaje znak oddzielający takich grup.</span><span class="sxs-lookup"><span data-stu-id="4d84d-116">To help highlight the boundaries between sorted groups, many websites employ a user interface that adds a separator between such groups.</span></span> <span data-ttu-id="4d84d-117">Separatory, jak pokazano na rysunku 1 te umożliwia użytkownikowi szybciej znaleźć określonej grupy i zidentyfikować jego granic, a także ustalić, jakie różne grupy istnieje w danych.</span><span class="sxs-lookup"><span data-stu-id="4d84d-117">Separators like the ones shown in Figure 1 enables a user to more quickly find a particular group and identify its boundaries, as well as ascertain what distinct groups exist in the data.</span></span>


<span data-ttu-id="4d84d-118">[![Każda grupa kategorii jest jasno określone](creating-a-customized-sorting-user-interface-vb/_static/image2.png)](creating-a-customized-sorting-user-interface-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="4d84d-118">[![Each Category Group is Clearly Identified](creating-a-customized-sorting-user-interface-vb/_static/image2.png)](creating-a-customized-sorting-user-interface-vb/_static/image1.png)</span></span>

<span data-ttu-id="4d84d-119">**Rysunek 1**: każdy grupy kategorii jest zidentyfikowane ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](creating-a-customized-sorting-user-interface-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="4d84d-119">**Figure 1**: Each Category Group is Clearly Identified ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image3.png))</span></span>


<span data-ttu-id="4d84d-120">W tym samouczku będzie przedstawiono sposób tworzenia takich sortowania interfejsu użytkownika.</span><span class="sxs-lookup"><span data-stu-id="4d84d-120">In this tutorial we'll see how to create such a sorting user interface.</span></span>

## <a name="step-1-creating-a-standard-sortable-gridview"></a><span data-ttu-id="4d84d-121">Krok 1: Tworzenie standardowych, sortowanie widoku GridView</span><span class="sxs-lookup"><span data-stu-id="4d84d-121">Step 1: Creating a Standard, Sortable GridView</span></span>

<span data-ttu-id="4d84d-122">Zanim firma Microsoft Eksploruj jak rozszerzyć GridView zapewnienie udoskonalony interfejs sortowania, chętnie s najpierw utworzyć GridView standardowe, sortowanie, który zawiera listę produktów.</span><span class="sxs-lookup"><span data-stu-id="4d84d-122">Before we explore how to augment the GridView to provide the enhanced sorting interface, let s first create a standard, sortable GridView that lists the products.</span></span> <span data-ttu-id="4d84d-123">Uruchamianie przez otwarcie `CustomSortingUI.aspx` strony `PagingAndSorting` folderu.</span><span class="sxs-lookup"><span data-stu-id="4d84d-123">Start by opening the `CustomSortingUI.aspx` page in the `PagingAndSorting` folder.</span></span> <span data-ttu-id="4d84d-124">Na stronie Dodaj element GridView, ustaw jej `ID` właściwości `ProductList`i powiązać ją z nowego elementu ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="4d84d-124">Add a GridView to the page, set its `ID` property to `ProductList`, and bind it to a new ObjectDataSource.</span></span> <span data-ttu-id="4d84d-125">Element ObjectDataSource umożliwia konfigurowanie `ProductsBLL` klasy s `GetProducts()` metoda wybierania rekordów.</span><span class="sxs-lookup"><span data-stu-id="4d84d-125">Configure the ObjectDataSource to use the `ProductsBLL` class s `GetProducts()` method for selecting records.</span></span>

<span data-ttu-id="4d84d-126">Następnie skonfiguruj widoku GridView, tak aby zawierała tylko `ProductName`, `CategoryName`, `SupplierName`, i `UnitPrice` BoundFields i CheckBoxField przerywane.</span><span class="sxs-lookup"><span data-stu-id="4d84d-126">Next, configure the GridView such that it only contains the `ProductName`, `CategoryName`, `SupplierName`, and `UnitPrice` BoundFields and the Discontinued CheckBoxField.</span></span> <span data-ttu-id="4d84d-127">Na koniec skonfiguruj GridView do obsługuje sortowanie, zaznaczając pole wyboru Włącz sortowanie w tagu s GridView (lub przez ustawienie jej `AllowSorting` właściwości `true`).</span><span class="sxs-lookup"><span data-stu-id="4d84d-127">Finally, configure the GridView to support sorting by checking the Enable Sorting checkbox in the GridView s smart tag (or by setting its `AllowSorting` property to `true`).</span></span> <span data-ttu-id="4d84d-128">Po wprowadzeniu tych dodatków do `CustomSortingUI.aspx` strony, deklaratywne znaczników powinien wyglądać podobnie do następującego:</span><span class="sxs-lookup"><span data-stu-id="4d84d-128">After making these additions to the `CustomSortingUI.aspx` page, the declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](creating-a-customized-sorting-user-interface-vb/samples/sample1.aspx)]

<span data-ttu-id="4d84d-129">Poświęć chwilę, aby wyświetlić postęp naszych dotychczasowych w przeglądarce.</span><span class="sxs-lookup"><span data-stu-id="4d84d-129">Take a moment to view our progress thus far in a browser.</span></span> <span data-ttu-id="4d84d-130">Na rysunku 2 przedstawiono sortowanie widoku GridView, gdy jego dane są sortowane według kategorii w kolejności alfabetycznej.</span><span class="sxs-lookup"><span data-stu-id="4d84d-130">Figure 2 shows the sortable GridView when its data is sorted by category in alphabetical order.</span></span>


<span data-ttu-id="4d84d-131">[![S GridView można sortować według kategorii porządkowania danych](creating-a-customized-sorting-user-interface-vb/_static/image5.png)](creating-a-customized-sorting-user-interface-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="4d84d-131">[![The Sortable GridView s Data is Ordered by Category](creating-a-customized-sorting-user-interface-vb/_static/image5.png)](creating-a-customized-sorting-user-interface-vb/_static/image4.png)</span></span>

<span data-ttu-id="4d84d-132">**Rysunek 2**: s sortowania w widoku GridView danych porządkowania według kategorii ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](creating-a-customized-sorting-user-interface-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="4d84d-132">**Figure 2**: The Sortable GridView s Data is Ordered by Category ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image6.png))</span></span>


## <a name="step-2-exploring-techniques-for-adding-the-separator-rows"></a><span data-ttu-id="4d84d-133">Krok 2: Poszukiwania techniki Dodawanie wierszy separatora</span><span class="sxs-lookup"><span data-stu-id="4d84d-133">Step 2: Exploring Techniques for Adding the Separator Rows</span></span>

<span data-ttu-id="4d84d-134">Z ogólnym, sortowanie widoku GridView pełną liście nie zostanie aby można było dodać separator wierszy w widoku GridView przed każdej unikatowej grupy posortowane.</span><span class="sxs-lookup"><span data-stu-id="4d84d-134">With the generic, sortable GridView complete, all that remains is to be able to add the separator rows in the GridView before each unique sorted group.</span></span> <span data-ttu-id="4d84d-135">Jednak jak można te wiersze można wprowadzić do widoku GridView?</span><span class="sxs-lookup"><span data-stu-id="4d84d-135">But how can such rows be injected into the GridView?</span></span> <span data-ttu-id="4d84d-136">Zasadniczo firma Microsoft należy do iteracji w widoku GridView wierszy s, określić, gdzie wystąpić różnice między wartościami w sortowanej kolumny, a następnie dodaj odpowiedni separator wierszy.</span><span class="sxs-lookup"><span data-stu-id="4d84d-136">Essentially, we need to iterate through the GridView s rows, determine where the differences occur between the values in the sorted column, and then add the appropriate separator row.</span></span> <span data-ttu-id="4d84d-137">W przypadku informacje o tym problemie, prawdopodobnie fizyczne, czy rozwiązanie znajduje się gdzieś w widoku GridView s `RowDataBound` program obsługi zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="4d84d-137">When thinking about this problem, it seems natural that the solution lies somewhere in the GridView s `RowDataBound` event handler.</span></span> <span data-ttu-id="4d84d-138">Jak wspomniano w [niestandardowe formatowanie oparte na danych](../custom-formatting/custom-formatting-based-upon-data-vb.md) samouczek, ten program obsługi zdarzeń jest często stosowany podczas formatowania poziomu wierszy na podstawie wiersze danych.</span><span class="sxs-lookup"><span data-stu-id="4d84d-138">As we discussed in the [Custom Formatting Based Upon Data](../custom-formatting/custom-formatting-based-upon-data-vb.md) tutorial, this event handler is commonly used when applying row-level formatting based on the row s data.</span></span> <span data-ttu-id="4d84d-139">Jednak `RowDataBound` program obsługi zdarzeń nie jest rozwiązaniem w tym miejscu wierszy można dodać do widoku GridView programowo z tej obsługi zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="4d84d-139">However, the `RowDataBound` event handler is not the solution here, as rows cannot be added to the GridView programmatically from this event handler.</span></span> <span data-ttu-id="4d84d-140">GridView s `Rows` kolekcji, w rzeczywistości jest tylko do odczytu.</span><span class="sxs-lookup"><span data-stu-id="4d84d-140">The GridView s `Rows` collection, in fact, is read-only.</span></span>

<span data-ttu-id="4d84d-141">Aby dodać dodatkowe wiersze do widoku GridView mamy trzy opcje:</span><span class="sxs-lookup"><span data-stu-id="4d84d-141">To add additional rows to the GridView we have three choices:</span></span>

- <span data-ttu-id="4d84d-142">Dodaj te metadane separator wierszy do danych rzeczywistych, który jest powiązany z widoku GridView</span><span class="sxs-lookup"><span data-stu-id="4d84d-142">Add these metadata separator rows to the actual data that is bound to the GridView</span></span>
- <span data-ttu-id="4d84d-143">Po widoku GridView został powiązany z danymi, dodać dodatkowe `TableRow` wystąpień GridView s kontrolować kolekcji</span><span class="sxs-lookup"><span data-stu-id="4d84d-143">After the GridView has been bound to the data, add additional `TableRow` instances to the GridView s control collection</span></span>
- <span data-ttu-id="4d84d-144">Tworzenie formantu niestandardowego serwera kontrolki widoku siatki i zastępuje te metody odpowiedzialny za utworzenie struktury s widoku GridView</span><span class="sxs-lookup"><span data-stu-id="4d84d-144">Create a custom server control that extends the GridView control and overrides those methods responsible for constructing the GridView s structure</span></span>

<span data-ttu-id="4d84d-145">Tworzenie formantu niestandardowego serwera będzie najlepszym rozwiązaniem, jeśli ta funkcja było wymagane na wielu stronach sieci web lub w kilku witryn sieci Web.</span><span class="sxs-lookup"><span data-stu-id="4d84d-145">Creating a custom server control would be the best approach if this functionality was needed on many web pages or across several websites.</span></span> <span data-ttu-id="4d84d-146">Jednak pociąga dość bit kodu i dokładne badań do głębokości wewnętrzne działanie s widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="4d84d-146">However, it would entail quite a bit of code and a thorough exploration into the depths of the GridView s internal workings.</span></span> <span data-ttu-id="4d84d-147">Dlatego firma Microsoft nie przyjrzymy się tej opcji w przypadku tego samouczka.</span><span class="sxs-lookup"><span data-stu-id="4d84d-147">Therefore, we'll not consider that option for this tutorial.</span></span>

<span data-ttu-id="4d84d-148">Dodawanie wierszy separatora do trwa rzeczywiste dane innych dwie opcje powiązane z widoku GridView i operowanie nimi kolekcji formantów s GridView po jego został powiązany — inaczej ataki problemu i wymagają dyskusji.</span><span class="sxs-lookup"><span data-stu-id="4d84d-148">The other two options adding separator rows to the actual data being bound to the GridView and manipulating the GridView s control collection after its been bound - attack the problem differently and merit a discussion.</span></span>

## <a name="adding-rows-to-the-data-bound-to-the-gridview"></a><span data-ttu-id="4d84d-149">Dodawanie wierszy do dane powiązane z widoku GridView</span><span class="sxs-lookup"><span data-stu-id="4d84d-149">Adding Rows to the Data Bound to the GridView</span></span>

<span data-ttu-id="4d84d-150">Gdy widoku GridView jest powiązana ze źródłem danych, tworzy `GridViewRow` dla każdego rekordu zwracanego przez źródło danych.</span><span class="sxs-lookup"><span data-stu-id="4d84d-150">When the GridView is bound to a data source, it creates a `GridViewRow` for each record returned by the data source.</span></span> <span data-ttu-id="4d84d-151">W związku z tym można używamy wierszy separatora wymagane przez dodanie separatora rekordy w źródle danych przed jego powiązanie z widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="4d84d-151">Therefore, we can inject the needed separator rows by adding separator records to the data source before binding it to the GridView.</span></span> <span data-ttu-id="4d84d-152">Rysunek 3 ilustruje tę koncepcję.</span><span class="sxs-lookup"><span data-stu-id="4d84d-152">Figure 3 illustrates this concept.</span></span>


![Techniki co obejmuje dodawanie Separator wierszy w źródle danych](creating-a-customized-sorting-user-interface-vb/_static/image7.png)

<span data-ttu-id="4d84d-154">**Rysunek 3**: jeden technika obejmuje dodawanie Separator wierszy w źródle danych</span><span class="sxs-lookup"><span data-stu-id="4d84d-154">**Figure 3**: One Technique Involves Adding Separator Rows to the Data Source</span></span>


<span data-ttu-id="4d84d-155">Używać rekordów separatora termin w cudzysłowie, ponieważ nie istnieje rekord specjalny separatora; zamiast firma Microsoft musi jakiś sposób Flaga które określonego rekordu w źródle danych służy jako separator zamiast wiersz danych normalnego.</span><span class="sxs-lookup"><span data-stu-id="4d84d-155">I use the term separator records in quotes because there is no special separator record; rather, we must somehow flag that a particular record in the data source serves as a separator rather than a normal data row.</span></span> <span data-ttu-id="4d84d-156">Dla naszych przykładach, możemy re powiązania `ProductsDataTable` wystąpienie GridView, który składa się z `ProductRows`.</span><span class="sxs-lookup"><span data-stu-id="4d84d-156">For our examples, we re binding a `ProductsDataTable` instance to the GridView, which is composed of `ProductRows`.</span></span> <span data-ttu-id="4d84d-157">Firma Microsoft może Flaga rekord jako wiersz separatora, ustawiając jego `CategoryID` właściwości `-1` (ponieważ taki wartość t włączoną istnieje zwykle).</span><span class="sxs-lookup"><span data-stu-id="4d84d-157">We might flag a record as a separator row by setting its `CategoryID` property to `-1` (since such a value couldn t exist normally).</span></span>

<span data-ttu-id="4d84d-158">Korzystanie z tej techniki d należy wykonać następujące czynności:</span><span class="sxs-lookup"><span data-stu-id="4d84d-158">To utilize this technique we d need to perform the following steps:</span></span>

1. <span data-ttu-id="4d84d-159">Programowane pobieranie danych, aby powiązać z widoku GridView ( `ProductsDataTable` wystąpienia)</span><span class="sxs-lookup"><span data-stu-id="4d84d-159">Programmatically retrieve the data to bind to the GridView (a `ProductsDataTable` instance)</span></span>
2. <span data-ttu-id="4d84d-160">Sortowanie danych w oparciu GridView s `SortExpression` i `SortDirection` właściwości</span><span class="sxs-lookup"><span data-stu-id="4d84d-160">Sort the data based on the GridView s `SortExpression` and `SortDirection` properties</span></span>
3. <span data-ttu-id="4d84d-161">Iterowanie za pomocą `ProductsRows` w `ProductsDataTable`poszukujący gdzie znajdują się różnic w sortowanej kolumny</span><span class="sxs-lookup"><span data-stu-id="4d84d-161">Iterate through the `ProductsRows` in the `ProductsDataTable`, looking for where the differences in the sorted column lie</span></span>
4. <span data-ttu-id="4d84d-162">W każdej grupy granic, Wstaw rekord separatora `ProductsRow` wystąpienie do elementu DataTable, jeden zawierający s `CategoryID` ustawioną `-1` (lub niezależnie od oznaczenia została podjęta podczas zaznaczania rekord jako rekord separatora)</span><span class="sxs-lookup"><span data-stu-id="4d84d-162">At each group boundary, inject a separator record `ProductsRow` instance into the DataTable, one that has it s `CategoryID` set to `-1` (or whatever designation was decided upon to mark a record as a separator record )</span></span>
5. <span data-ttu-id="4d84d-163">Po wstrzyknięcie separator wierszy, programowo powiązać dane z widoku GridView</span><span class="sxs-lookup"><span data-stu-id="4d84d-163">After injecting the separator rows, programmatically bind the data to the GridView</span></span>

<span data-ttu-id="4d84d-164">Oprócz tych kroków pięć, d również potrzebujemy zapewnienie obsługi zdarzeń dla widoku GridView s `RowDataBound` zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="4d84d-164">In addition to these five steps, we d also need to provide an event handler for the GridView s `RowDataBound` event.</span></span> <span data-ttu-id="4d84d-165">W tym miejscu d sprawdzamy każdego `DataRow` i określenie, czy separator wierszy jedną których `CategoryID` ustawienie zostało `-1`.</span><span class="sxs-lookup"><span data-stu-id="4d84d-165">Here, we d check each `DataRow` and determine if it was a separator row, one whose `CategoryID` setting was `-1`.</span></span> <span data-ttu-id="4d84d-166">Jeśli tak, d prawdopodobnie chcemy dopasować, formatowanie lub tekst wyświetlany w komórkach.</span><span class="sxs-lookup"><span data-stu-id="4d84d-166">If so, we d probably want to adjust its formatting or the text displayed in the cell(s).</span></span>

<span data-ttu-id="4d84d-167">Ta technika wstrzyknięcie sortowania granice grupy wymaga nieco więcej pracy niż opisane powyżej, jak należy również podać program obsługi zdarzeń dla widoku GridView s `Sorting` zdarzeń i Zachowaj prowadnicy `SortExpression` i `SortDirection` wartości.</span><span class="sxs-lookup"><span data-stu-id="4d84d-167">Using this technique for injecting the sorting group boundaries requires a bit more work than outlined above, as you need to also provide an event handler for the GridView s `Sorting` event and keep track of the `SortExpression` and `SortDirection` values.</span></span>

## <a name="manipulating-the-gridview-s-control-collection-after-it-s-been-databound"></a><span data-ttu-id="4d84d-168">Manipulowanie GridView s kontrolować kolekcji po nim s został powiązany z danymi</span><span class="sxs-lookup"><span data-stu-id="4d84d-168">Manipulating the GridView s Control Collection After It s Been Databound</span></span>

<span data-ttu-id="4d84d-169">Zamiast wiadomości danych przed jego powiązanie z widoku GridView, można dodać separator wierszy *po* danych została powiązana z widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="4d84d-169">Rather than messaging the data before binding it to the GridView, we can add the separator rows *after* the data has been bound to the GridView.</span></span> <span data-ttu-id="4d84d-170">Proces wiązania z danymi kompilacje w widoku GridView s kontroli hierarchii, które w rzeczywistości jest po prostu `Table` wystąpienia składa się z kolekcji wierszy, z których każdy składa się z kolekcji komórek.</span><span class="sxs-lookup"><span data-stu-id="4d84d-170">The process of data binding builds up the GridView s control hierarchy, which in reality is simply a `Table` instance composed of a collection of rows, each of which is composed of a collection of cells.</span></span> <span data-ttu-id="4d84d-171">W szczególności zawiera kolekcji formantów s GridView `Table` obiektem głównym, `GridViewRow` (która jest pochodną `TableRow` klasy) dla każdego rekordu w `DataSource` powiązany Element GridView i `TableCell` obiektu w każdym `GridViewRow` wystąpienia dla każdego pola danych w `DataSource`.</span><span class="sxs-lookup"><span data-stu-id="4d84d-171">Specifically, the GridView s control collection contains a `Table` object at its root, a `GridViewRow` (which is derived from the `TableRow` class) for each record in the `DataSource` bound to the GridView, and a `TableCell` object in each `GridViewRow` instance for each data field in the `DataSource`.</span></span>

<span data-ttu-id="4d84d-172">Aby dodać separator wierszy między wszystkimi grupami sortowania, firma Microsoft bezpośrednio manipulować tej hierarchii kontroli po jego utworzeniu.</span><span class="sxs-lookup"><span data-stu-id="4d84d-172">To add separator rows between each sorting group, we can directly manipulate this control hierarchy once it has been created.</span></span> <span data-ttu-id="4d84d-173">Możemy mieć pewność, że utworzono hierarchii kontrolki GridView s po raz ostatni w czasie, który jest renderowany strony.</span><span class="sxs-lookup"><span data-stu-id="4d84d-173">We can be confident that the GridView s control hierarchy has been created for the last time by the time the page is being rendered.</span></span> <span data-ttu-id="4d84d-174">W związku z tym ta metoda zastępuje `Page` klasy s `Render` metody w takim przypadku hierarchia końcowej kontroli s widoku GridView zostanie zaktualizowany wymagane separator wierszy.</span><span class="sxs-lookup"><span data-stu-id="4d84d-174">Therefore, this approach overrides the `Page` class s `Render` method, at which point the GridView s final control hierarchy is updated to include the needed separator rows.</span></span> <span data-ttu-id="4d84d-175">Rysunek 4 przedstawia tego procesu.</span><span class="sxs-lookup"><span data-stu-id="4d84d-175">Figure 4 illustrates this process.</span></span>


<span data-ttu-id="4d84d-176">[![Technikę alternatywny manipuluje hierarchii kontroli s widoku GridView](creating-a-customized-sorting-user-interface-vb/_static/image9.png)](creating-a-customized-sorting-user-interface-vb/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="4d84d-176">[![An Alternate Technique Manipulates the GridView s Control Hierarchy](creating-a-customized-sorting-user-interface-vb/_static/image9.png)](creating-a-customized-sorting-user-interface-vb/_static/image8.png)</span></span>

<span data-ttu-id="4d84d-177">**Rysunek 4**: technikę alternatywny manipuluje s GridView hierarchii formantu ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](creating-a-customized-sorting-user-interface-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="4d84d-177">**Figure 4**: An Alternate Technique Manipulates the GridView s Control Hierarchy ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image10.png))</span></span>


<span data-ttu-id="4d84d-178">W tym samouczku użyjemy tego podejścia to drugie dostosowywaniu sortowania środowiska użytkownika.</span><span class="sxs-lookup"><span data-stu-id="4d84d-178">For this tutorial, we'll use this latter approach to customize the sorting user experience.</span></span>

> [!NOTE]
> <span data-ttu-id="4d84d-179">Kod I m umożliwienie korzystania z tego samouczka jest oparta na przykładzie przedstawionym w [Teemu Keiski](http://aspadvice.com/blogs/joteke/default.aspx) wpis w blogu s [odtwarzanie z bitowego grupowanie sortowania w widoku GridView](http://aspadvice.com/blogs/joteke/archive/2006/02/11/15130.aspx).</span><span class="sxs-lookup"><span data-stu-id="4d84d-179">The code I m presenting in this tutorial is based on the example provided in [Teemu Keiski](http://aspadvice.com/blogs/joteke/default.aspx) s blog entry, [Playing a Bit with GridView Sort Grouping](http://aspadvice.com/blogs/joteke/archive/2006/02/11/15130.aspx).</span></span>


## <a name="step-3-adding-the-separator-rows-to-the-gridview-s-control-hierarchy"></a><span data-ttu-id="4d84d-180">Krok 3: Dodawanie Separator wierszy w widoku GridView s kontroli hierarchii</span><span class="sxs-lookup"><span data-stu-id="4d84d-180">Step 3: Adding the Separator Rows to the GridView s Control Hierarchy</span></span>

<span data-ttu-id="4d84d-181">Ponieważ chcemy tylko dodać separator wierszy w widoku GridView s kontroli hierarchii po hierarchii formantu został utworzony i jest tworzone po raz ostatni w tym odwiedź stronę, chcemy, aby wykonać to dodawanie na końcu cyklu życia strony, ale przed rzeczywiste c widoku GridView Hierarchia kontrolne zostało wyrenderowane w kodzie HTML.</span><span class="sxs-lookup"><span data-stu-id="4d84d-181">Since we only want to add the separator rows to the GridView s control hierarchy after its control hierarchy has been created and created for the last time on that page visit, we want to perform this addition at the end of the page lifecycle, but before the actual GridView control hierarchy has been rendered into HTML.</span></span> <span data-ttu-id="4d84d-182">Najnowszy punkt możliwe, w którym możemy w tym celu jest `Page` klasy s `Render` zdarzenie, które firma Microsoft mogą zastąpić w naszej klasy związane z kodem przy użyciu następujących podpis metody:</span><span class="sxs-lookup"><span data-stu-id="4d84d-182">The latest possible point at which we can accomplish this is the `Page` class s `Render` event, which we can override in our code-behind class using the following method signature:</span></span>


[!code-vb[Main](creating-a-customized-sorting-user-interface-vb/samples/sample2.vb)]

<span data-ttu-id="4d84d-183">Gdy `Page` klasy s oryginalnego `Render` wywoływana jest metoda `base.Render(writer)` każdej kontrolki na stronie są wyświetlane, generowania znaczników na podstawie ich hierarchii formantu.</span><span class="sxs-lookup"><span data-stu-id="4d84d-183">When the `Page` class s original `Render` method is invoked `base.Render(writer)` each of the controls in the page will be rendered, generating the markup based on their control hierarchy.</span></span> <span data-ttu-id="4d84d-184">W związku z tym jest konieczne, że oba nazywamy `base.Render(writer)`, dzięki czemu realizacją strony hierarchii przed wywołaniem kontrolę i czy możemy manipulować GridView s `base.Render(writer)`, dzięki czemu separator wierszy zostały dodane do hierarchii formantu widoku GridView s przed s zostały renderowane.</span><span class="sxs-lookup"><span data-stu-id="4d84d-184">Therefore it is imperative that we both call `base.Render(writer)`, so that the page is rendered, and that we manipulate the GridView s control hierarchy prior to calling `base.Render(writer)`, so that the separator rows have been added to the GridView s control hierarchy before it s been rendered.</span></span>

<span data-ttu-id="4d84d-185">Iniekcję nagłówków grup sortowania najpierw musimy upewnij się, że użytkownik zażądał sortowania danych.</span><span class="sxs-lookup"><span data-stu-id="4d84d-185">To inject the sort group headers we first need to ensure that the user has requested that the data be sorted.</span></span> <span data-ttu-id="4d84d-186">Domyślnie zawartość widoku GridView s nie są sortowane i w związku z tym możemy ADAM t trzeba wprowadzić dowolną grupę sortowania nagłówków.</span><span class="sxs-lookup"><span data-stu-id="4d84d-186">By default, the GridView s contents are not sorted, and therefore we don t need to enter any group sorting headers.</span></span>

> [!NOTE]
> <span data-ttu-id="4d84d-187">Widoku GridView ma zostać posortowana według określonej kolumny po pierwszym załadowaniu strony należy wywołać metodę GridView `Sort` metody pierwszej wizyty strony (ale nie znajduje się w kolejnych ogłaszania zwrotnego).</span><span class="sxs-lookup"><span data-stu-id="4d84d-187">If you want the GridView to be sorted by a particular column when the page is first loaded, call the GridView s `Sort` method on the first page visit (but not on subsequent postbacks).</span></span> <span data-ttu-id="4d84d-188">W tym celu należy dodać to wywołanie w `Page_Load` obsługi zdarzeń w `if (!Page.IsPostBack)` warunkowego.</span><span class="sxs-lookup"><span data-stu-id="4d84d-188">To accomplish this, add this call in the `Page_Load` event handler within an `if (!Page.IsPostBack)` conditional.</span></span> <span data-ttu-id="4d84d-189">Odwołaj się do [stronicowania i sortowania danych raportów](paging-and-sorting-report-data-vb.md) samouczka informacji, aby uzyskać więcej informacji na temat `Sort` metody.</span><span class="sxs-lookup"><span data-stu-id="4d84d-189">Refer back to the [Paging and Sorting Report Data](paging-and-sorting-report-data-vb.md) tutorial information for more on the `Sort` method.</span></span>


<span data-ttu-id="4d84d-190">Przy założeniu, że dane zostały posortowane, naszych następne zadanie ma na celu określenie kolumny danych został posortowane według i następnie skanowanie wierszy wyszukiwanie różnice w tej kolumnie s wartości.</span><span class="sxs-lookup"><span data-stu-id="4d84d-190">Assuming that the data has been sorted, our next task is to determine what column the data was sorted by and then to scan the rows looking for differences in that column s values.</span></span> <span data-ttu-id="4d84d-191">Poniższy kod zapewnia, że dane zostały posortowane i znajdzie kolumny, według której zostały posortowane dane:</span><span class="sxs-lookup"><span data-stu-id="4d84d-191">The following code ensures that the data has been sorted and finds the column by which the data has been sorted:</span></span>


[!code-vb[Main](creating-a-customized-sorting-user-interface-vb/samples/sample3.vb)]

<span data-ttu-id="4d84d-192">Jeśli w widoku GridView jest jeszcze być sortowana, s widoku GridView `SortExpression` zostanie nie ustawiono właściwości.</span><span class="sxs-lookup"><span data-stu-id="4d84d-192">If the GridView has yet to be sorted, the GridView s `SortExpression` property will not have been set.</span></span> <span data-ttu-id="4d84d-193">W związku z tym będą tylko dodać separator wierszy, jeśli ta właściwość nie ma wartości.</span><span class="sxs-lookup"><span data-stu-id="4d84d-193">Therefore, we only want to add the separator rows if this property has some value.</span></span> <span data-ttu-id="4d84d-194">Jeśli tak, obok należy określić indeks kolumny za pomocą którego została posortowane dane.</span><span class="sxs-lookup"><span data-stu-id="4d84d-194">If it does, we next need to determine the index of the column by which the data was sorted.</span></span> <span data-ttu-id="4d84d-195">Jest to osiągane przez pętli GridView s `Columns` kolekcji wyszukiwania dla kolumny, których `SortExpression` s widoku GridView jest równa właściwości `SortExpression` właściwości.</span><span class="sxs-lookup"><span data-stu-id="4d84d-195">This is accomplished by looping through the GridView s `Columns` collection, searching for the column whose `SortExpression` property equals the GridView s `SortExpression` property.</span></span> <span data-ttu-id="4d84d-196">Oprócz indeks kolumny s, będziemy również pobrania `HeaderText` właściwość, która jest używana podczas wyświetlania separator wierszy.</span><span class="sxs-lookup"><span data-stu-id="4d84d-196">In addition to the column s index, we also grab the `HeaderText` property, which is used when displaying the separator rows.</span></span>

<span data-ttu-id="4d84d-197">Indeks kolumny za pomocą którego dane są sortowane ostatnim krokiem jest wyliczyć wierszach widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="4d84d-197">With the index of the column by which the data is sorted, the final step is to enumerate the rows of the GridView.</span></span> <span data-ttu-id="4d84d-198">Dla każdego wiersza należy ustalić, czy wartość s sortowanej kolumny różni się od poprzedniej wartości s kolumny wiersza s sortowane.</span><span class="sxs-lookup"><span data-stu-id="4d84d-198">For each row we need to determine whether the sorted column s value differs from the previous row s sorted column s value.</span></span> <span data-ttu-id="4d84d-199">Jeśli tak, musimy wprowadzić nowy `GridViewRow` wystąpienia w hierarchii formantu.</span><span class="sxs-lookup"><span data-stu-id="4d84d-199">If so, we need to inject a new `GridViewRow` instance into the control hierarchy.</span></span> <span data-ttu-id="4d84d-200">Jest to realizowane przy użyciu następującego kodu:</span><span class="sxs-lookup"><span data-stu-id="4d84d-200">This is accomplished with the following code:</span></span>


[!code-vb[Main](creating-a-customized-sorting-user-interface-vb/samples/sample4.vb)]

<span data-ttu-id="4d84d-201">Ten kod uruchamia programowo odwołując `Table` obiekt znalezione w głównym hierarchii kontrolki GridView s i tworzenia zmiennej ciągu o nazwie `lastValue`.</span><span class="sxs-lookup"><span data-stu-id="4d84d-201">This code starts by programmatically referencing the `Table` object found at the root of the GridView s control hierarchy and creating a string variable named `lastValue`.</span></span> <span data-ttu-id="4d84d-202">`lastValue` Służy do porównywania wartości bieżącego wiersza s sortowana kolumna z poprzedniej wartości wiersza s.</span><span class="sxs-lookup"><span data-stu-id="4d84d-202">`lastValue` is used to compare the current row s sorted column value with the previous row s value.</span></span> <span data-ttu-id="4d84d-203">Następnie, w widoku GridView s `Rows` wyliczeniu kolekcji i dla każdego wiersza wartości sortowanej kolumny jest przechowywany w `currentValue` zmiennej.</span><span class="sxs-lookup"><span data-stu-id="4d84d-203">Next, the GridView s `Rows` collection is enumerated and for each row the value of the sorted column is stored in the `currentValue` variable.</span></span>

> [!NOTE]
> <span data-ttu-id="4d84d-204">Aby określić wartość kolumny s sortowane określonego wiersza I Użyj komórki s `Text` właściwości.</span><span class="sxs-lookup"><span data-stu-id="4d84d-204">To determine the value of the particular row s sorted column I use the cell s `Text` property.</span></span> <span data-ttu-id="4d84d-205">To dobrze się sprawdza BoundFields, ale będzie nie działają zgodnie z potrzebami dla TemplateFields, CheckBoxFields itd.</span><span class="sxs-lookup"><span data-stu-id="4d84d-205">This works well for BoundFields, but will not work as desired for TemplateFields, CheckBoxFields, and so on.</span></span> <span data-ttu-id="4d84d-206">Wyjaśniono, jak konta alternatywne pól widoku GridView wkrótce.</span><span class="sxs-lookup"><span data-stu-id="4d84d-206">We'll look at how to account for alternate GridView fields shortly.</span></span>


<span data-ttu-id="4d84d-207">`currentValue` i `lastValue` zmienne są porównywane.</span><span class="sxs-lookup"><span data-stu-id="4d84d-207">The `currentValue` and `lastValue` variables are then compared.</span></span> <span data-ttu-id="4d84d-208">Jeśli będą się różnić musimy dodać nowy wiersz separatora do hierarchii kontroli.</span><span class="sxs-lookup"><span data-stu-id="4d84d-208">If they differ we need to add a new separator row to the control hierarchy.</span></span> <span data-ttu-id="4d84d-209">Jest to osiągane przez określenie indeks `GridViewRow` w `Table` obiektu s `Rows` kolekcji, tworzenie nowych `GridViewRow` i `TableCell` wystąpienia, a następnie dodanie `TableCell` i `GridViewRow` do Hierarchia formantu.</span><span class="sxs-lookup"><span data-stu-id="4d84d-209">This is accomplished by determining the index of the `GridViewRow` in the `Table` object s `Rows` collection, creating new `GridViewRow` and `TableCell` instances, and then adding the `TableCell` and `GridViewRow` to the control hierarchy.</span></span>

<span data-ttu-id="4d84d-210">Należy pamiętać, że separator wierszy s pojedynczy `TableCell` jest sformatowany w taki sposób, że obejmuje całą szerokość GridView, jest sformatowany przy użyciu `SortHeaderRowStyle` klasy CSS i ma jego `Text` właściwości takie zawiera grupy sortowania nazwę (na przykład kategoria) i Wartość s grupy (na przykład napoje).</span><span class="sxs-lookup"><span data-stu-id="4d84d-210">Note that the separator row s lone `TableCell` is formatted such that it spans the entire width of the GridView, is formatted using the `SortHeaderRowStyle` CSS class, and has its `Text` property such that it shows both the sort group name (such as Category ) and the group s value (such as Beverages ).</span></span> <span data-ttu-id="4d84d-211">Na koniec `lastValue` zostaną zmienione na wartość `currentValue`.</span><span class="sxs-lookup"><span data-stu-id="4d84d-211">Finally, `lastValue` is updated to the value of `currentValue`.</span></span>

<span data-ttu-id="4d84d-212">Klasa CSS używany do formatowania sortowania wiersz nagłówka grupy `SortHeaderRowStyle` musi być określone w `Styles.css` pliku.</span><span class="sxs-lookup"><span data-stu-id="4d84d-212">The CSS class used to format the sorting group header row `SortHeaderRowStyle` needs to be specified in the `Styles.css` file.</span></span> <span data-ttu-id="4d84d-213">Możesz także użyć niezależnie od ustawień stylu odwołania Po użyciu następujące czynności:</span><span class="sxs-lookup"><span data-stu-id="4d84d-213">Feel free to use whatever style settings appeal to you; I used the following:</span></span>


[!code-css[Main](creating-a-customized-sorting-user-interface-vb/samples/sample5.css)]

<span data-ttu-id="4d84d-214">Bieżący kod sortowania interfejsu dodaje nagłówki grup sortowania podczas sortowania według dowolnego elementu BoundField (patrz rysunek 5, która zawiera zrzut ekranu podczas sortowania przez dostawcę).</span><span class="sxs-lookup"><span data-stu-id="4d84d-214">With the current code, the sorting interface adds sort group headers when sorting by any BoundField (see Figure 5, which shows a screenshot when sorting by supplier).</span></span> <span data-ttu-id="4d84d-215">Niemniej jednak podczas sortowania według dowolnego typu pola (na przykład CheckBoxField lub TemplateField), nagłówki grupy sortowania są nigdzie nie można odnaleźć (patrz rysunek 6).</span><span class="sxs-lookup"><span data-stu-id="4d84d-215">However, when sorting by any other field type (such as a CheckBoxField or TemplateField), the sort group headers are nowhere to be found (see Figure 6).</span></span>


<span data-ttu-id="4d84d-216">[![Interfejs sortowania zawiera nagłówki grup sortowania podczas sortowania według BoundFields](creating-a-customized-sorting-user-interface-vb/_static/image12.png)](creating-a-customized-sorting-user-interface-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="4d84d-216">[![The Sorting Interface Includes Sort Group Headers When Sorting by BoundFields](creating-a-customized-sorting-user-interface-vb/_static/image12.png)](creating-a-customized-sorting-user-interface-vb/_static/image11.png)</span></span>

<span data-ttu-id="4d84d-217">**Rysunek 5**: sortowanie interfejsu obejmuje sortowania grupy nagłówków podczas sortowania według BoundFields ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](creating-a-customized-sorting-user-interface-vb/_static/image13.png))</span><span class="sxs-lookup"><span data-stu-id="4d84d-217">**Figure 5**: The Sorting Interface Includes Sort Group Headers When Sorting by BoundFields ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image13.png))</span></span>


<span data-ttu-id="4d84d-218">[![Nagłówki grupy sortowania są, Brak podczas sortowania CheckBoxField](creating-a-customized-sorting-user-interface-vb/_static/image15.png)](creating-a-customized-sorting-user-interface-vb/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="4d84d-218">[![The Sort Group Headers are Missing When Sorting a CheckBoxField](creating-a-customized-sorting-user-interface-vb/_static/image15.png)](creating-a-customized-sorting-user-interface-vb/_static/image14.png)</span></span>

<span data-ttu-id="4d84d-219">**Rysunek 6**: sortowanie grupy nagłówki są Brak podczas sortowania CheckBoxField ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](creating-a-customized-sorting-user-interface-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="4d84d-219">**Figure 6**: The Sort Group Headers are Missing When Sorting a CheckBoxField ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image16.png))</span></span>


<span data-ttu-id="4d84d-220">Przyczyna nagłówków grup sortowania brakuje podczas sortowania według CheckBoxField jest ponieważ kod aktualnie używa tylko `TableCell` s `Text` właściwości w celu określenia wartości sortowanej kolumny dla każdego wiersza.</span><span class="sxs-lookup"><span data-stu-id="4d84d-220">The reason the sort group headers are missing when sorting by a CheckBoxField is because the code currently uses just the `TableCell` s `Text` property to determine the value of the sorted column for each row.</span></span> <span data-ttu-id="4d84d-221">Dla CheckBoxFields `TableCell` s `Text` właściwości to ciąg pusty; zamiast tego wartość jest dostępna za pośrednictwem formant wyboru sieci Web, który znajduje się w `TableCell` s `Controls` kolekcji.</span><span class="sxs-lookup"><span data-stu-id="4d84d-221">For CheckBoxFields, the `TableCell` s `Text` property is an empty string; instead, the value is available through a CheckBox Web control that resides within the `TableCell` s `Controls` collection.</span></span>

<span data-ttu-id="4d84d-222">Aby obsłużyć pola typu innego niż BoundFields, musimy rozszerzyć kod gdzie `currentValue` zmienna jest przypisana do sprawdzenia istnienia CheckBox w `TableCell` s `Controls` kolekcji.</span><span class="sxs-lookup"><span data-stu-id="4d84d-222">To handle field types other than BoundFields, we need to augment the code where the `currentValue` variable is assigned to check for the existence of a CheckBox in the `TableCell` s `Controls` collection.</span></span> <span data-ttu-id="4d84d-223">Zamiast `currentValue = gvr.Cells(sortColumnIndex).Text`, Zastąp kod następującym kodem:</span><span class="sxs-lookup"><span data-stu-id="4d84d-223">Instead of using `currentValue = gvr.Cells(sortColumnIndex).Text`, replace this code with the following:</span></span>


[!code-vb[Main](creating-a-customized-sorting-user-interface-vb/samples/sample6.vb)]

<span data-ttu-id="4d84d-224">Ten kod sprawdza, czy kolumna posortowana `TableCell` dla bieżącego wiersza ustalić, czy formanty w `Controls` kolekcji.</span><span class="sxs-lookup"><span data-stu-id="4d84d-224">This code examines the sorted column `TableCell` for the current row to determine if there are any controls in the `Controls` collection.</span></span> <span data-ttu-id="4d84d-225">Jeśli istnieje, i pierwszą kontrolkę pola wyboru, `currentValue` zmienna jest ustawiona na tak lub nie, w zależności od wyboru s `Checked` właściwości.</span><span class="sxs-lookup"><span data-stu-id="4d84d-225">If there are, and the first control is a CheckBox, the `currentValue` variable is set to Yes or No, depending on the CheckBox s `Checked` property.</span></span> <span data-ttu-id="4d84d-226">W przeciwnym razie wartość jest pobierana z `TableCell` s `Text` właściwości.</span><span class="sxs-lookup"><span data-stu-id="4d84d-226">Otherwise, the value is taken from the `TableCell` s `Text` property.</span></span> <span data-ttu-id="4d84d-227">Tej logiki można replikować do obsługi sortowania dla dowolnego TemplateFields, który może znajdować się w widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="4d84d-227">This logic can be replicated to handle sorting for any TemplateFields that may exist in the GridView.</span></span>

<span data-ttu-id="4d84d-228">Z uwzględnieniem powyższych kodu, nagłówki grupy sortowania występują teraz podczas sortowania w polu CheckBoxField zaprzestać (patrz rysunek 7).</span><span class="sxs-lookup"><span data-stu-id="4d84d-228">With the above code addition, the sort group headers are now present when sorting by the Discontinued CheckBoxField (see Figure 7).</span></span>


<span data-ttu-id="4d84d-229">[![Nagłówki grupy sortowania są teraz obecny podczas sortowania CheckBoxField](creating-a-customized-sorting-user-interface-vb/_static/image18.png)](creating-a-customized-sorting-user-interface-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="4d84d-229">[![The Sort Group Headers are Now Present When Sorting a CheckBoxField](creating-a-customized-sorting-user-interface-vb/_static/image18.png)](creating-a-customized-sorting-user-interface-vb/_static/image17.png)</span></span>

<span data-ttu-id="4d84d-230">**Rysunek 7**: sortowanie grupy nagłówki są teraz obecny podczas sortowania CheckBoxField ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](creating-a-customized-sorting-user-interface-vb/_static/image19.png))</span><span class="sxs-lookup"><span data-stu-id="4d84d-230">**Figure 7**: The Sort Group Headers are Now Present When Sorting a CheckBoxField ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image19.png))</span></span>


> [!NOTE]
> <span data-ttu-id="4d84d-231">Jeśli masz w produktach `NULL` bazy danych wartości `CategoryID`, `SupplierID`, lub `UnitPrice` pola, te wartości będą wyświetlane jako puste ciągi w widoku GridView domyślnie, co oznacza tekst wiersza s separatora dla tych produktów z `NULL`odczyta wartości podobnie jak kategoria: (to znaczy występują s bez nazwy po kategorii: o kategorii, takich jak: napoje).</span><span class="sxs-lookup"><span data-stu-id="4d84d-231">If you have products with `NULL` database values for the `CategoryID`, `SupplierID`, or `UnitPrice` fields, those values will appear as empty strings in the GridView by default, meaning the separator row s text for those products with `NULL` values will read like Category: (that is, there s no name after Category: like with Category: Beverages ).</span></span> <span data-ttu-id="4d84d-232">Jeśli chcesz użyć wartości wyświetlane w tym miejscu można ustawić BoundFields [ `NullDisplayText` właściwości](https://msdn.microsoft.com/library/system.web.ui.webcontrols.boundfield.nulldisplaytext.aspx) tekst ma być wyświetlany lub dodać instrukcji warunkowej w metodzie renderowania podczas przypisywania `currentValue` do tego separatora. Wiersz s `Text` właściwości.</span><span class="sxs-lookup"><span data-stu-id="4d84d-232">If you want a value displayed here you can either set the BoundFields [`NullDisplayText` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.boundfield.nulldisplaytext.aspx) to the text you want displayed or you can add a conditional statement in the Render method when assigning the `currentValue` to the separator row s `Text` property.</span></span>


## <a name="summary"></a><span data-ttu-id="4d84d-233">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="4d84d-233">Summary</span></span>

<span data-ttu-id="4d84d-234">Widoku GridView nie zawiera wiele wbudowanych opcji Dostosowywanie sortowania interfejsu.</span><span class="sxs-lookup"><span data-stu-id="4d84d-234">The GridView does not include many built-in options for customizing the sorting interface.</span></span> <span data-ttu-id="4d84d-235">Jednak z bitowego kodu niskiego poziomu jego s można dostosować hierarchię GridView s kontroli w celu utworzenia bardziej dostosowanego interfejsu.</span><span class="sxs-lookup"><span data-stu-id="4d84d-235">However, with a bit of low-level code, it s possible to tweak the GridView s control hierarchy to create a more customized interface.</span></span> <span data-ttu-id="4d84d-236">W tym samouczku widzieliśmy sposób dodawania sortowania grupy separatora wiersza elementu GridView sortowanie, które łatwo identyfikuje różne grupy i tych grup granic.</span><span class="sxs-lookup"><span data-stu-id="4d84d-236">In this tutorial we saw how to add a sort group separator row for a sortable GridView, which more easily identifies the distinct groups and those groups boundaries.</span></span> <span data-ttu-id="4d84d-237">Aby uzyskać dodatkowe przykłady interfejsów sortowania dostosowanych, zapoznaj się z [Scott Guthrie](https://weblogs.asp.net/scottgu/) s [kilka ASP.NET 2.0 GridView sortowanie porady i wskazówki](https://weblogs.asp.net/scottgu/archive/2006/02/11/437995.aspx) wpis w blogu.</span><span class="sxs-lookup"><span data-stu-id="4d84d-237">For additional examples of customized sorting interfaces, check out [Scott Guthrie](https://weblogs.asp.net/scottgu/) s [A Few ASP.NET 2.0 GridView Sorting Tips and Tricks](https://weblogs.asp.net/scottgu/archive/2006/02/11/437995.aspx) blog entry.</span></span>

<span data-ttu-id="4d84d-238">Programowanie przyjemność!</span><span class="sxs-lookup"><span data-stu-id="4d84d-238">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="4d84d-239">Informacje o autorze</span><span class="sxs-lookup"><span data-stu-id="4d84d-239">About the Author</span></span>

<span data-ttu-id="4d84d-240">[Scott Bento](http://www.4guysfromrolla.com/ScottMitchell.shtml), autora siedmiu książek ASP/ASP.NET i twórcę z [4GuysFromRolla.com](http://www.4guysfromrolla.com), pracuje z technologii Microsoft Web od 1998.</span><span class="sxs-lookup"><span data-stu-id="4d84d-240">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="4d84d-241">Scott działa jako niezależnego konsultanta trainer i składnika zapisywania.</span><span class="sxs-lookup"><span data-stu-id="4d84d-241">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="4d84d-242">Jest jego najnowszej książki [ *Sams nauczyć się ASP.NET 2.0 w ciągu 24 godzin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="4d84d-242">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="4d84d-243">Piotr można uzyskać pod adresem [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) lub za pośrednictwem jego blog, który znajduje się w temacie [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="4d84d-243">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="4d84d-244">Poprzednie</span><span class="sxs-lookup"><span data-stu-id="4d84d-244">Previous</span></span>](sorting-custom-paged-data-vb.md)
