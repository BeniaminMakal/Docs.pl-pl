---
title: Wprowadzenie do ochrony danych
author: rick-anderson
description: "Ten dokument pojęcia związane z ochroną danych i opisano zasady projektowania skojarzone podstawowych interfejsów API platformy ASP.NET."
ms.author: riande
manager: wpickett
ms.date: 10/14/2016
ms.topic: article
ms.technology: aspnet
ms.prod: asp.net-core
uid: security/data-protection/introduction
ms.openlocfilehash: b02ef9121e50ab9d9f24032d32f1e65fe73049c0
ms.sourcegitcommit: 060879fcf3f73d2366b5c811986f8695fff65db8
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 01/24/2018
---
# <a name="introduction-to-data-protection"></a><span data-ttu-id="2a96e-103">Wprowadzenie do ochrony danych</span><span class="sxs-lookup"><span data-stu-id="2a96e-103">Introduction to Data Protection</span></span>

<span data-ttu-id="2a96e-104">Aplikacje sieci Web często muszą przechowywać dane dotyczące zabezpieczeń.</span><span class="sxs-lookup"><span data-stu-id="2a96e-104">Web applications often need to store security-sensitive data.</span></span> <span data-ttu-id="2a96e-105">System Windows udostępnia DPAPI aplikacji klasycznych, ale to nie nadaje się do aplikacji sieci web.</span><span class="sxs-lookup"><span data-stu-id="2a96e-105">Windows provides DPAPI for desktop applications but this is unsuitable for web applications.</span></span> <span data-ttu-id="2a96e-106">Stos ochrony danych platformy ASP.NET Core zapewniają prosty i łatwy w użyciu API kryptograficznych deweloper może użyć do ochrony danych, w tym zarządzania kluczami i obrotu.</span><span class="sxs-lookup"><span data-stu-id="2a96e-106">The ASP.NET Core data protection stack provide a simple, easy to use cryptographic API a developer can use to protect data, including key management and rotation.</span></span>

<span data-ttu-id="2a96e-107">Stos ochrony danych platformy ASP.NET Core zaprojektowano jako długoterminowej zastępuje <machineKey> elementu w programie ASP.NET 1.x - 4.x.</span><span class="sxs-lookup"><span data-stu-id="2a96e-107">The ASP.NET Core data protection stack is designed to serve as the long-term replacement for the <machineKey> element in ASP.NET 1.x - 4.x.</span></span> <span data-ttu-id="2a96e-108">Została zaprojektowana w celu rozwiązania wiele niedociągnięć starego stosu kryptograficznych zapewniając poza gotowe rozwiązanie dla większości przypadków użycia, które nowoczesne aplikacje są prawdopodobnie mogą wystąpić.</span><span class="sxs-lookup"><span data-stu-id="2a96e-108">It was designed to address many of the shortcomings of the old cryptographic stack while providing an out-of-the-box solution for the majority of use cases modern applications are likely to encounter.</span></span>

## <a name="problem-statement"></a><span data-ttu-id="2a96e-109">Opis problemu</span><span class="sxs-lookup"><span data-stu-id="2a96e-109">Problem statement</span></span>

<span data-ttu-id="2a96e-110">Instrukcja zasadniczy problem może być krótkiej formie wyrażona w pojedynczym zdaniu: musisz utrwalić zaufanych informacje dotyczące pobierania nowszej, ale nie można zaufać mechanizmu stanu trwałego.</span><span class="sxs-lookup"><span data-stu-id="2a96e-110">The overall problem statement can be succinctly stated in a single sentence: I need to persist trusted information for later retrieval, but I don't trust the persistence mechanism.</span></span> <span data-ttu-id="2a96e-111">W warunkach sieci web to mogą być zapisane jako "Musisz obustronne zaufanego stanu za pomocą niezaufanego klienta."</span><span class="sxs-lookup"><span data-stu-id="2a96e-111">In web terms, this might be written as "I need to round-trip trusted state via an untrusted client."</span></span>

<span data-ttu-id="2a96e-112">Canonical przykład to jest plik cookie uwierzytelniania lub elementu nośnego tokenu.</span><span class="sxs-lookup"><span data-stu-id="2a96e-112">The canonical example of this is an authentication cookie or bearer token.</span></span> <span data-ttu-id="2a96e-113">Generuje serwer "Mam Groot i uprawnień xyz" token i przekazuje ją do klienta.</span><span class="sxs-lookup"><span data-stu-id="2a96e-113">The server generates an "I am Groot and have xyz permissions" token and hands it to the client.</span></span> <span data-ttu-id="2a96e-114">W przyszłości klienta przedstawi token do serwera, ale serwer musi mieć określonego rodzaju gwarancji, że klient nie sfałszowane tokenu.</span><span class="sxs-lookup"><span data-stu-id="2a96e-114">At some future date the client will present that token back to the server, but the server needs some kind of assurance that the client hasn't forged the token.</span></span> <span data-ttu-id="2a96e-115">W związku z tym pierwszego zapotrzebowania: autentyczności ()</span><span class="sxs-lookup"><span data-stu-id="2a96e-115">Thus the first requirement: authenticity (a.k.a.</span></span> <span data-ttu-id="2a96e-116">integralność, sprawdzające odporne na próby).</span><span class="sxs-lookup"><span data-stu-id="2a96e-116">integrity, tamper-proofing).</span></span>

<span data-ttu-id="2a96e-117">Ponieważ stanu utrwalonego jest uważany za zaufany przez serwer, przewidujemy, że ten stan może zawierać informacje, które są specyficzne dla środowiska pracy.</span><span class="sxs-lookup"><span data-stu-id="2a96e-117">Since the persisted state is trusted by the server, we anticipate that this state might contain information that's specific to the operating environment.</span></span> <span data-ttu-id="2a96e-118">Może to być w postaci ścieżki do pliku, uprawnienia, dojścia lub innych pośrednie odwołanie, lub inne dane specyficzne dla serwera.</span><span class="sxs-lookup"><span data-stu-id="2a96e-118">This could be in the form of a file path, a permission, a handle or other indirect reference, or some other piece of server-specific data.</span></span> <span data-ttu-id="2a96e-119">Zazwyczaj takie informacje nie zostać ujawnione osobom niezaufanego klienta.</span><span class="sxs-lookup"><span data-stu-id="2a96e-119">Such information should generally not be disclosed to an untrusted client.</span></span> <span data-ttu-id="2a96e-120">W związku z tym drugie wymaganie: poufności.</span><span class="sxs-lookup"><span data-stu-id="2a96e-120">Thus the second requirement: confidentiality.</span></span>

<span data-ttu-id="2a96e-121">Ponadto ponieważ nowoczesne aplikacje są składnikowa, co możemy w tym samouczku jest pojedynczych składników spowoduje chcesz skorzystać z tego systemu, niezależnie od innych składników w systemie.</span><span class="sxs-lookup"><span data-stu-id="2a96e-121">Finally, since modern applications are componentized, what we've seen is that individual components will want to take advantage of this system without regard to other components in the system.</span></span> <span data-ttu-id="2a96e-122">Na przykład jeśli składnik tokenu elementu nośnego używa tego stosu, powinien działać bez zakłóceń z mechanizm anti-CSRF, który może również korzystać z tym samym stosie.</span><span class="sxs-lookup"><span data-stu-id="2a96e-122">For instance, if a bearer token component is using this stack, it should operate without interference from an anti-CSRF mechanism that might also be using the same stack.</span></span> <span data-ttu-id="2a96e-123">W związku z tym ostatnim wymaganie: izolacji.</span><span class="sxs-lookup"><span data-stu-id="2a96e-123">Thus the final requirement: isolation.</span></span>

<span data-ttu-id="2a96e-124">Firma Microsoft może dostarczyć więcej ograniczenia Aby zawęzić zakres bieżących wymagań.</span><span class="sxs-lookup"><span data-stu-id="2a96e-124">We can provide further constraints in order to narrow the scope of our requirements.</span></span> <span data-ttu-id="2a96e-125">Przyjęto założenie, że wszystkie usługi działające w ramach cryptosystem są równie zaufane i że dane nie musi zostać wygenerowany lub używane poza usług w naszym bezpośrednią kontrolę.</span><span class="sxs-lookup"><span data-stu-id="2a96e-125">We assume that all services operating within the cryptosystem are equally trusted and that the data doesn't need to be generated or consumed outside of the services under our direct control.</span></span> <span data-ttu-id="2a96e-126">Ponadto wymagane operacje są tak szybko, jak to możliwe, ponieważ każde żądanie usługi sieci web może przejść cryptosystem jeden lub więcej razy.</span><span class="sxs-lookup"><span data-stu-id="2a96e-126">Furthermore, we require that operations are as fast as possible since each request to the web service might go through the cryptosystem one or more times.</span></span> <span data-ttu-id="2a96e-127">Dzięki temu Kryptografia symetryczna idealny dla naszej scenariusza i firma Microsoft discount kryptografii asymetrycznej do taki czas, który jest potrzebna.</span><span class="sxs-lookup"><span data-stu-id="2a96e-127">This makes symmetric cryptography ideal for our scenario, and we can discount asymmetric cryptography until such a time that it's needed.</span></span>

## <a name="design-philosophy"></a><span data-ttu-id="2a96e-128">Zasady projektowania klas</span><span class="sxs-lookup"><span data-stu-id="2a96e-128">Design philosophy</span></span>

<span data-ttu-id="2a96e-129">Firma Microsoft jest uruchomiony przez identyfikowania problemów z istniejącego stosu.</span><span class="sxs-lookup"><span data-stu-id="2a96e-129">We started by identifying problems with the existing stack.</span></span> <span data-ttu-id="2a96e-130">Po było który, możemy badaniu pozioma istniejących rozwiązań i wykazał, że żadne istniejące rozwiązanie dość miał możliwości, które firma Microsoft poszukiwane.</span><span class="sxs-lookup"><span data-stu-id="2a96e-130">Once we had that, we surveyed the landscape of existing solutions and concluded that no existing solution quite had the capabilities we sought.</span></span> <span data-ttu-id="2a96e-131">Firma Microsoft następnie odtwarzane rozwiązania opartego na kilka wytyczne.</span><span class="sxs-lookup"><span data-stu-id="2a96e-131">We then engineered a solution based on several guiding principles.</span></span>

* <span data-ttu-id="2a96e-132">System powinno oferować łatwość konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="2a96e-132">The system should offer simplicity of configuration.</span></span> <span data-ttu-id="2a96e-133">W idealnym przypadku system będzie niewymagającą konfiguracji i deweloperzy mogą trafień podstaw uruchamiania.</span><span class="sxs-lookup"><span data-stu-id="2a96e-133">Ideally the system would be zero-configuration and developers could hit the ground running.</span></span> <span data-ttu-id="2a96e-134">W sytuacjach, gdy deweloperzy należy skonfigurować określonej proporcji (na przykład klucza repozytorium) należy zwrócić szczególną uwagę do tworzenia prostych tych określonej konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="2a96e-134">In situations where developers need to configure a specific aspect (such as the key repository), consideration should be given to making those specific configurations simple.</span></span>

* <span data-ttu-id="2a96e-135">Zapewniają prosty interfejs API dla użytkownika.</span><span class="sxs-lookup"><span data-stu-id="2a96e-135">Offer a simple consumer-facing API.</span></span> <span data-ttu-id="2a96e-136">Interfejsy API powinno być łatwe w użyciu poprawnie i trudny do wykorzystania niepoprawnie.</span><span class="sxs-lookup"><span data-stu-id="2a96e-136">The APIs should be easy to use correctly and difficult to use incorrectly.</span></span>

* <span data-ttu-id="2a96e-137">Deweloperzy nie należy dowiedzieć się zasady zarządzania kluczami.</span><span class="sxs-lookup"><span data-stu-id="2a96e-137">Developers shouldn't learn key management principles.</span></span> <span data-ttu-id="2a96e-138">System powinna obsługiwać wybór algorytmu i okresu istnienia klucza w imieniu dewelopera.</span><span class="sxs-lookup"><span data-stu-id="2a96e-138">The system should handle algorithm selection and key lifetime on the developer's behalf.</span></span> <span data-ttu-id="2a96e-139">Najlepiej dewelopera nigdy nie nawet ma dostęp do nieprzetworzonej materiału klucza.</span><span class="sxs-lookup"><span data-stu-id="2a96e-139">Ideally the developer should never even have access to the raw key material.</span></span>

* <span data-ttu-id="2a96e-140">Klucze powinny być chronione w stanie spoczynku, gdy jest to możliwe.</span><span class="sxs-lookup"><span data-stu-id="2a96e-140">Keys should be protected at rest when possible.</span></span> <span data-ttu-id="2a96e-141">System powinien ustalić odpowiedni mechanizm ochrony i zastosować je automatycznie.</span><span class="sxs-lookup"><span data-stu-id="2a96e-141">The system should figure out an appropriate default protection mechanism and apply it automatically.</span></span>

<span data-ttu-id="2a96e-142">Z tych zasad, pamiętając opracowaliśmy prosty, [łatwy w użyciu](using-data-protection.md) stosu ochrony danych.</span><span class="sxs-lookup"><span data-stu-id="2a96e-142">With these principles in mind we developed a simple, [easy to use](using-data-protection.md) data protection stack.</span></span>

<span data-ttu-id="2a96e-143">Interfejsy API ochrony danych platformy ASP.NET Core nie są głównie przeznaczone do nieograniczonego trwałość ładunki poufne.</span><span class="sxs-lookup"><span data-stu-id="2a96e-143">The ASP.NET Core data protection APIs are not primarily intended for indefinite persistence of confidential payloads.</span></span> <span data-ttu-id="2a96e-144">Innych technologii, takich jak [Windows CNG DPAPI](https://msdn.microsoft.com/library/windows/desktop/hh706794%28v=vs.85%29.aspx) i [usługi Azure Rights Management](https://docs.microsoft.com/rights-management/) są bardziej odpowiednie do scenariusza nieograniczonego magazynu i mają możliwości odpowiednio silne zarządzania kluczami.</span><span class="sxs-lookup"><span data-stu-id="2a96e-144">Other technologies like [Windows CNG DPAPI](https://msdn.microsoft.com/library/windows/desktop/hh706794%28v=vs.85%29.aspx) and [Azure Rights Management](https://docs.microsoft.com/rights-management/) are more suited to the scenario of indefinite storage, and they have correspondingly strong key management capabilities.</span></span> <span data-ttu-id="2a96e-145">Inaczej mówiąc, nic nie uniemożliwiają dewelopera przy użyciu interfejsy API ochrony danych platformy ASP.NET Core dla długoterminowej ochrony poufnych danych.</span><span class="sxs-lookup"><span data-stu-id="2a96e-145">That said, there's nothing prohibiting a developer from using the ASP.NET Core data protection APIs for long-term protection of confidential data.</span></span>

## <a name="audience"></a><span data-ttu-id="2a96e-146">Odbiorcy</span><span class="sxs-lookup"><span data-stu-id="2a96e-146">Audience</span></span>

<span data-ttu-id="2a96e-147">System ochrony danych jest podzielona na pięć głównych pakietów.</span><span class="sxs-lookup"><span data-stu-id="2a96e-147">The data protection system is divided into five main packages.</span></span> <span data-ttu-id="2a96e-148">Różne aspekty te interfejsy API target trzy główne odbiorców;</span><span class="sxs-lookup"><span data-stu-id="2a96e-148">Various aspects of these APIs target three main audiences;</span></span>

1. <span data-ttu-id="2a96e-149">[Omówienie interfejsów API klienta](consumer-apis/overview.md) deweloperzy aplikacji i platforma docelowa.</span><span class="sxs-lookup"><span data-stu-id="2a96e-149">The [Consumer APIs Overview](consumer-apis/overview.md) target application and framework developers.</span></span>

   <span data-ttu-id="2a96e-150">"Nie chcę dowiedzieć się więcej o sposób działania stosu lub jego konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="2a96e-150">"I don't want to learn about how the stack operates or about how it's configured.</span></span> <span data-ttu-id="2a96e-151">Po prostu chcę do wykonania niektórych operacji w jako prosty sposób możliwie z dużym prawdopodobieństwem z użyciem interfejsów API pomyślnie."</span><span class="sxs-lookup"><span data-stu-id="2a96e-151">I simply want to perform some operation in as simple a manner as possible with high probability of using the APIs successfully."</span></span>

2. <span data-ttu-id="2a96e-152">[Interfejsy API konfiguracji](configuration/overview.md) docelowe deweloperzy aplikacji i administratorów systemu.</span><span class="sxs-lookup"><span data-stu-id="2a96e-152">The [configuration APIs](configuration/overview.md) target application developers and system administrators.</span></span>

   <span data-ttu-id="2a96e-153">"Potrzebuję systemu ochrony danych stwierdzić, że moje środowisko wymaga ustawienia lub innych niż domyślne ścieżki".</span><span class="sxs-lookup"><span data-stu-id="2a96e-153">"I need to tell the data protection system that my environment requires non-default paths or settings."</span></span>

3. <span data-ttu-id="2a96e-154">Deweloperzy docelowy interfejsów API rozszerzalności odpowiedzialnych za wdrażanie zasad niestandardowych.</span><span class="sxs-lookup"><span data-stu-id="2a96e-154">The extensibility APIs target developers in charge of implementing custom policy.</span></span> <span data-ttu-id="2a96e-155">Użycie tych interfejsów API czy ograniczone do rzadkich sytuacji i napotkał pamiętać deweloperów zabezpieczeń.</span><span class="sxs-lookup"><span data-stu-id="2a96e-155">Usage of these APIs would be limited to rare situations and experienced, security aware developers.</span></span>

   <span data-ttu-id="2a96e-156">"Należy zastąpić cały składnika w systemie, ponieważ naprawdę unikatowe wymagania funkcjonalne.</span><span class="sxs-lookup"><span data-stu-id="2a96e-156">"I need to replace an entire component within the system because I have truly unique behavioral requirements.</span></span> <span data-ttu-id="2a96e-157">Chcę Dowiedz się uncommonly używane części powierzchni interfejsu API do zbudowania wtyczkę, która spełnia wymagania Mój."</span><span class="sxs-lookup"><span data-stu-id="2a96e-157">I am willing to learn uncommonly-used parts of the API surface in order to build a plugin that fulfills my requirements."</span></span>

## <a name="package-layout"></a><span data-ttu-id="2a96e-158">Układ pakietu</span><span class="sxs-lookup"><span data-stu-id="2a96e-158">Package Layout</span></span>

<span data-ttu-id="2a96e-159">Stos ochrony danych składa się z pięciu pakietów.</span><span class="sxs-lookup"><span data-stu-id="2a96e-159">The data protection stack consists of five packages.</span></span>

* <span data-ttu-id="2a96e-160">Microsoft.AspNetCore.DataProtection.Abstractions zawiera podstawowe interfejsy IDataProtectionProvider i interfejsu IDataProtector.</span><span class="sxs-lookup"><span data-stu-id="2a96e-160">Microsoft.AspNetCore.DataProtection.Abstractions contains the basic IDataProtectionProvider and IDataProtector interfaces.</span></span> <span data-ttu-id="2a96e-161">Zawiera również metody przydatne rozszerzenia, które mogą ułatwić pracę z tych typów (np. przeciążenia IDataProtector.Protect).</span><span class="sxs-lookup"><span data-stu-id="2a96e-161">It also contains useful extension methods that can assist working with these types (e.g., overloads of IDataProtector.Protect).</span></span> <span data-ttu-id="2a96e-162">Zobacz sekcję interfejsy konsumenta, aby uzyskać więcej informacji.</span><span class="sxs-lookup"><span data-stu-id="2a96e-162">See the consumer interfaces section for more information.</span></span> <span data-ttu-id="2a96e-163">Jeśli ktoś inny włączył jest odpowiedzialny za tworzenie wystąpień systemu ochrony danych i po prostu zużywają interfejsy API, należy do odwołania Microsoft.AspNetCore.DataProtection.Abstractions.</span><span class="sxs-lookup"><span data-stu-id="2a96e-163">If somebody else is responsible for instantiating the data protection system and you are simply consuming the APIs, you'll want to reference Microsoft.AspNetCore.DataProtection.Abstractions.</span></span>

* <span data-ttu-id="2a96e-164">Microsoft.AspNetCore.DataProtection zawiera implementację core systemu ochrony danych, w tym podstawowe operacje kryptograficzne, zarządzania kluczami, konfiguracji i rozszerzeń.</span><span class="sxs-lookup"><span data-stu-id="2a96e-164">Microsoft.AspNetCore.DataProtection contains the core implementation of the data protection system, including the core cryptographic operations, key management, configuration, and extensibility.</span></span> <span data-ttu-id="2a96e-165">Kto jest odpowiedzialny za tworzenie wystąpień systemu ochrony danych (np. dodanie go do IServiceCollection) lub modyfikowania lub rozszerzanie ich zachowania, należy Microsoft.AspNetCore.DataProtection odwołania.</span><span class="sxs-lookup"><span data-stu-id="2a96e-165">If you're responsible for instantiating the data protection system (e.g., adding it to an IServiceCollection) or modifying or extending its behavior, you'll want to reference Microsoft.AspNetCore.DataProtection.</span></span>

* <span data-ttu-id="2a96e-166">Microsoft.AspNetCore.DataProtection.Extensions zawiera dodatkowe interfejsy API, które deweloperzy mogą być przydatne, ale które nie powinny znajdować się w pakiecie core.</span><span class="sxs-lookup"><span data-stu-id="2a96e-166">Microsoft.AspNetCore.DataProtection.Extensions contains additional APIs which developers might find useful but which don't belong in the core package.</span></span> <span data-ttu-id="2a96e-167">Na przykład ten pakiet zawiera proste "wystąpienia systemu, wskazując katalogu określonego klucza magazynu bez ustawień iniekcji zależności" API (więcej informacji).</span><span class="sxs-lookup"><span data-stu-id="2a96e-167">For instance, this package contains a simple "instantiate the system pointing at a specific key storage directory with no dependency injection setup" API (more info).</span></span> <span data-ttu-id="2a96e-168">Zawiera również metody rozszerzenia dla ograniczanie okresu istnienia chronionych ładunków (więcej informacji).</span><span class="sxs-lookup"><span data-stu-id="2a96e-168">It also contains extension methods for limiting the lifetime of protected payloads (more info).</span></span>

* <span data-ttu-id="2a96e-169">Microsoft.AspNetCore.DataProtection.SystemWeb można zainstalować w istniejącej aplikacji ASP.NET 4.x przekierować jego <machineKey> operacje, aby zamiast tego użyć nowego stosu ochrony danych.</span><span class="sxs-lookup"><span data-stu-id="2a96e-169">Microsoft.AspNetCore.DataProtection.SystemWeb can be installed into an existing ASP.NET 4.x application to redirect its <machineKey> operations to instead use the new data protection stack.</span></span> <span data-ttu-id="2a96e-170">Zobacz [zgodności](compatibility/replacing-machinekey.md#compatibility-replacing-machinekey) Aby uzyskać więcej informacji.</span><span class="sxs-lookup"><span data-stu-id="2a96e-170">See [compatibility](compatibility/replacing-machinekey.md#compatibility-replacing-machinekey) for more information.</span></span>

* <span data-ttu-id="2a96e-171">Microsoft.AspNetCore.Cryptography.KeyDerivation dostarcza implementację tego hasła PBKDF2 mieszania procedury i mogą być używane przez systemy, które musi obsłużyć bezpiecznego hasła użytkownika.</span><span class="sxs-lookup"><span data-stu-id="2a96e-171">Microsoft.AspNetCore.Cryptography.KeyDerivation provides an implementation of the PBKDF2 password hashing routine and can be used by systems which need to handle user passwords securely.</span></span> <span data-ttu-id="2a96e-172">Zobacz [tworzenia skrótu hasła](consumer-apis/password-hashing.md) Aby uzyskać więcej informacji.</span><span class="sxs-lookup"><span data-stu-id="2a96e-172">See [Password Hashing](consumer-apis/password-hashing.md) for more information.</span></span>
