---
uid: web-forms/overview/older-versions-security/admin/building-an-interface-to-select-one-user-account-from-many-vb
title: Tworzenie interfejsu, aby wybrać jedno konto użytkownika z wielu (VB) | Dokumentacja firmy Microsoft
author: rick-anderson
description: W tym samouczku budujemy interfejs użytkownika z siatką stronicowanej, można filtrować. W szczególności naszych interfejsu użytkownika będzie składać się z szeregu LinkButtons dla...
ms.author: aspnetcontent
manager: wpickett
ms.date: 04/01/2008
ms.topic: article
ms.assetid: da53380c-a16b-41c7-a20d-24343c735c52
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/older-versions-security/admin/building-an-interface-to-select-one-user-account-from-many-vb
msc.type: authoredcontent
ms.openlocfilehash: 56f4d72993bfcb9629d6b4cd08efe0da6dea2486
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/06/2018
ms.locfileid: "30891207"
---
<a name="building-an-interface-to-select-one-user-account-from-many-vb"></a><span data-ttu-id="11226-104">Tworzenie interfejsu, aby wybrać jedno konto użytkownika z wielu (VB)</span><span class="sxs-lookup"><span data-stu-id="11226-104">Building an Interface to Select One User Account from Many (VB)</span></span>
====================
<span data-ttu-id="11226-105">przez [Bento Scott](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="11226-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="11226-106">[Pobierz kod](http://download.microsoft.com/download/6/0/e/60e1bd94-e5f9-4d5a-a079-f23c98f4f67d/VB.12.zip) lub [pobierania plików PDF](http://download.microsoft.com/download/6/0/e/60e1bd94-e5f9-4d5a-a079-f23c98f4f67d/aspnet_tutorial12_SelectUser_vb.pdf)</span><span class="sxs-lookup"><span data-stu-id="11226-106">[Download Code](http://download.microsoft.com/download/6/0/e/60e1bd94-e5f9-4d5a-a079-f23c98f4f67d/VB.12.zip) or [Download PDF](http://download.microsoft.com/download/6/0/e/60e1bd94-e5f9-4d5a-a079-f23c98f4f67d/aspnet_tutorial12_SelectUser_vb.pdf)</span></span>

> <span data-ttu-id="11226-107">W tym samouczku budujemy interfejs użytkownika z siatką stronicowanej, można filtrować.</span><span class="sxs-lookup"><span data-stu-id="11226-107">In this tutorial we will build a user interface with a paged, filterable grid.</span></span> <span data-ttu-id="11226-108">W szczególności naszych interfejs użytkownika zostanie składają się z szeregu LinkButtons filtrowania wyników na podstawie początkowej litery nazwy użytkownika i kontrolce GridView pokazanie zgodnych użytkowników.</span><span class="sxs-lookup"><span data-stu-id="11226-108">In particular, our user interface will consist of a series of LinkButtons for filtering the results based on the starting letter of the username, and a GridView control to show the matching users.</span></span> <span data-ttu-id="11226-109">Zaczniemy poprzez wyszczególnienie wszystkich kont użytkowników w widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="11226-109">We'll start by listing all of the user accounts in a GridView.</span></span> <span data-ttu-id="11226-110">Następnie w kroku 3 dodamy filtru LinkButtons.</span><span class="sxs-lookup"><span data-stu-id="11226-110">Then, in Step 3, we will add the filter LinkButtons.</span></span> <span data-ttu-id="11226-111">Krok 4 analizuje stronicowania wyników filtrowania.</span><span class="sxs-lookup"><span data-stu-id="11226-111">Step 4 looks at paging the filtered results.</span></span> <span data-ttu-id="11226-112">Interfejs wykonane kroki od 2 do 4 będzie używany w kolejnych samouczkach do wykonywania zadań administracyjnych dla określonego konta użytkownika.</span><span class="sxs-lookup"><span data-stu-id="11226-112">The interface constructed in Steps 2 through 4 will be used in the subsequent tutorials to perform administrative tasks for a particular user account.</span></span>


## <a name="introduction"></a><span data-ttu-id="11226-113">Wprowadzenie</span><span class="sxs-lookup"><span data-stu-id="11226-113">Introduction</span></span>

<span data-ttu-id="11226-114">W <a id="_msoanchor_1"> </a> [ *przypisywanie ról użytkowników* ](../roles/assigning-roles-to-users-vb.md) samouczek, utworzyliśmy podstawowe interfejs dla administratora, wybierz użytkownika i zarządzać jego role.</span><span class="sxs-lookup"><span data-stu-id="11226-114">In the <a id="_msoanchor_1"></a>[*Assigning Roles to Users*](../roles/assigning-roles-to-users-vb.md) tutorial, we created a rudimentary interface for an administrator to select a user and manage her roles.</span></span> <span data-ttu-id="11226-115">W szczególności interfejsu przedstawione administrator z listy rozwijanej wszystkich użytkowników.</span><span class="sxs-lookup"><span data-stu-id="11226-115">Specifically, the interface presented the administrator with a drop-down list of all of the users.</span></span> <span data-ttu-id="11226-116">Takiego interfejsu jest odpowiednia w przypadku, gdy istnieją, ale użytkownik dwanaście lub tak kont, ale jest niewygodna witryn z setkami lub tysiącami kont.</span><span class="sxs-lookup"><span data-stu-id="11226-116">Such an interface is suitable when there are but a dozen or so user accounts, but is unwieldy for sites with hundreds or thousands of accounts.</span></span> <span data-ttu-id="11226-117">Siatka stronicowanej, filtrowanie jest odpowiedniejsze interfejsu użytkownika dla witryny sieci Web z typów podstawowych dużej liczby użytkowników.</span><span class="sxs-lookup"><span data-stu-id="11226-117">A paged, filterable grid is more suitable user interface for websites with large user bases.</span></span>

<span data-ttu-id="11226-118">W tym samouczku budujemy interfejsu użytkownika.</span><span class="sxs-lookup"><span data-stu-id="11226-118">In this tutorial we will build such a user interface.</span></span> <span data-ttu-id="11226-119">W szczególności naszych interfejs użytkownika zostanie składają się z szeregu LinkButtons filtrowania wyników na podstawie początkowej litery nazwy użytkownika i kontrolce GridView pokazanie zgodnych użytkowników.</span><span class="sxs-lookup"><span data-stu-id="11226-119">In particular, our user interface will consist of a series of LinkButtons for filtering the results based on the starting letter of the username, and a GridView control to show the matching users.</span></span> <span data-ttu-id="11226-120">Zaczniemy poprzez wyszczególnienie wszystkich kont użytkowników w widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="11226-120">We'll start by listing all of the user accounts in a GridView.</span></span> <span data-ttu-id="11226-121">Następnie w kroku 3 dodamy filtru LinkButtons.</span><span class="sxs-lookup"><span data-stu-id="11226-121">Then, in Step 3, we will add the filter LinkButtons.</span></span> <span data-ttu-id="11226-122">Krok 4 analizuje stronicowania wyników filtrowania.</span><span class="sxs-lookup"><span data-stu-id="11226-122">Step 4 looks at paging the filtered results.</span></span> <span data-ttu-id="11226-123">Interfejs wykonane kroki od 2 do 4 będzie używany w kolejnych samouczkach do wykonywania zadań administracyjnych dla określonego konta użytkownika.</span><span class="sxs-lookup"><span data-stu-id="11226-123">The interface constructed in Steps 2 through 4 will be used in the subsequent tutorials to perform administrative tasks for a particular user account.</span></span>

<span data-ttu-id="11226-124">Dzieła!</span><span class="sxs-lookup"><span data-stu-id="11226-124">Let's get started!</span></span>

## <a name="step-1-adding-new-aspnet-pages"></a><span data-ttu-id="11226-125">Krok 1: Dodawanie nowych stron ASP.NET</span><span class="sxs-lookup"><span data-stu-id="11226-125">Step 1: Adding New ASP.NET Pages</span></span>

<span data-ttu-id="11226-126">W tym samouczku i dwie firma Microsoft będzie można badanie różnych funkcji związanych z administracją i możliwości.</span><span class="sxs-lookup"><span data-stu-id="11226-126">In this tutorial and the next two we will be examining various administration-related functions and capabilities.</span></span> <span data-ttu-id="11226-127">Szereg stron ASP.NET do zaimplementowania tematy zbadać w całym te samouczki są wymagane.</span><span class="sxs-lookup"><span data-stu-id="11226-127">We will need a series of ASP.NET pages to implement the topics examined throughout these tutorials.</span></span> <span data-ttu-id="11226-128">Umożliwia tworzenie tych stron i zaktualizuj mapy witryny.</span><span class="sxs-lookup"><span data-stu-id="11226-128">Let's create these pages and update the site map.</span></span>

<span data-ttu-id="11226-129">Rozpocznij od utworzenia nowego folderu do projektu o nazwie `Administration`.</span><span class="sxs-lookup"><span data-stu-id="11226-129">Start by creating a new folder in the project named `Administration`.</span></span> <span data-ttu-id="11226-130">Następnie dodaj do folderu, łączenie każdej strony z dwóch nowych stron ASP.NET `Site.master` strony wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="11226-130">Next, add two new ASP.NET pages to the folder, linking each page with the `Site.master` master page.</span></span> <span data-ttu-id="11226-131">Nazwa strony:</span><span class="sxs-lookup"><span data-stu-id="11226-131">Name the pages:</span></span>

- `ManageUsers.aspx`
- `UserInformation.aspx`

<span data-ttu-id="11226-132">Również dodać dwie strony do katalogu głównego witryny sieci Web: `ChangePassword.aspx` i `RecoverPassword.aspx`.</span><span class="sxs-lookup"><span data-stu-id="11226-132">Also add two pages to the website's root directory: `ChangePassword.aspx` and `RecoverPassword.aspx`.</span></span>

<span data-ttu-id="11226-133">Te cztery strony w tym momencie powinna mieć dwóch formantów zawartości, jeden dla każdej strony wzorcowej Elementy ContentPlaceHolders: `MainContent` i `LoginContent`.</span><span class="sxs-lookup"><span data-stu-id="11226-133">These four pages should, at this point, have two Content controls, one for each of the master page's ContentPlaceHolders: `MainContent` and `LoginContent`.</span></span>

[!code-aspx[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample1.aspx)]

<span data-ttu-id="11226-134">Chcemy wyświetlić kod znaczników domyślnej strony wzorcowej dla `LoginContent` elementu ContentPlaceHolder na tych stronach.</span><span class="sxs-lookup"><span data-stu-id="11226-134">We want to show the master page's default markup for the `LoginContent` ContentPlaceHolder for these pages.</span></span> <span data-ttu-id="11226-135">W związku z tym usunąć deklaratywne kod znaczników dla `Content2` zawartości formantu.</span><span class="sxs-lookup"><span data-stu-id="11226-135">Therefore, remove the declarative markup for the `Content2` Content control.</span></span> <span data-ttu-id="11226-136">Po wykonaniu tej czynności, znaczników stron powinna zawierać tylko jeden formant zawartości.</span><span class="sxs-lookup"><span data-stu-id="11226-136">After doing so, the pages' markup should contain just one Content control.</span></span>

<span data-ttu-id="11226-137">Strony ASP.NET w `Administration` folderu są przeznaczone wyłącznie do użytkowników administracyjnych.</span><span class="sxs-lookup"><span data-stu-id="11226-137">The ASP.NET pages in the `Administration` folder are intended solely for administrative users.</span></span> <span data-ttu-id="11226-138">Dodaliśmy roli administratora systemu w <a id="_msoanchor_2"> </a> [ *tworzenie i zarządzanie rolami* ](../roles/creating-and-managing-roles-vb.md) samouczek; ograniczyć dostęp do tych dwóch stron do tej roli.</span><span class="sxs-lookup"><span data-stu-id="11226-138">We added an Administrators role to the system in the <a id="_msoanchor_2"></a>[*Creating and Managing Roles*](../roles/creating-and-managing-roles-vb.md) tutorial; restrict access to these two pages to this role.</span></span> <span data-ttu-id="11226-139">W tym celu należy dodać `Web.config` pliku `Administration` folder i skonfigurować jej `<authorization>` element przyjmowania użytkowników w roli administratora, aby odmówić wszystkich innych.</span><span class="sxs-lookup"><span data-stu-id="11226-139">To accomplish this, add a `Web.config` file to the `Administration` folder and configure its `<authorization>` element to admit users in the Administrators role and to deny all others.</span></span>

[!code-xml[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample2.xml)]

<span data-ttu-id="11226-140">W tym momencie projektu Eksploratora rozwiązań powinien wyglądać podobnie do ekranu zrzut pokazano na rysunku 1.</span><span class="sxs-lookup"><span data-stu-id="11226-140">At this point your project's Solution Explorer should look similar to the screen shot shown in Figure 1.</span></span>


<span data-ttu-id="11226-141">[![Dodano czterech nowych stron i pliku Web.config witryny sieci Web](building-an-interface-to-select-one-user-account-from-many-vb/_static/image2.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="11226-141">[![Four New Pages and a Web.config File Have Been Added to the Website](building-an-interface-to-select-one-user-account-from-many-vb/_static/image2.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image1.png)</span></span>

<span data-ttu-id="11226-142">**Rysunek 1**: czterech nowych stron i `Web.config` pliku zostały dodane do witryny sieci Web ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](building-an-interface-to-select-one-user-account-from-many-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="11226-142">**Figure 1**: Four New Pages and a `Web.config` File Have Been Added to the Website ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-vb/_static/image3.png))</span></span>


<span data-ttu-id="11226-143">Na koniec zaktualizuj mapy witryny (`Web.sitemap`) do uwzględnienia wpis do `ManageUsers.aspx` strony.</span><span class="sxs-lookup"><span data-stu-id="11226-143">Finally, update the site map (`Web.sitemap`) to include an entry to the `ManageUsers.aspx` page.</span></span> <span data-ttu-id="11226-144">Dodaj następujący kod XML po `<siteMapNode>` dodaliśmy samouczki ról.</span><span class="sxs-lookup"><span data-stu-id="11226-144">Add the following XML after the `<siteMapNode>` we added for the Roles tutorials.</span></span>

[!code-xml[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample3.xml)]

<span data-ttu-id="11226-145">Z mapy witryny zaktualizowany odwiedź witrynę za pośrednictwem przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="11226-145">With the site map updated, visit the site through a browser.</span></span> <span data-ttu-id="11226-146">Jak pokazano na rysunku 2, nawigacji po lewej stronie teraz obejmuje elementy samouczki administracji.</span><span class="sxs-lookup"><span data-stu-id="11226-146">As Figure 2 shows, the navigation on the left now includes items for the Administration tutorials.</span></span>


<span data-ttu-id="11226-147">[![Mapy witryny zawiera węzeł zatytułowany Administracja użytkownikami](building-an-interface-to-select-one-user-account-from-many-vb/_static/image5.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="11226-147">[![The Site Map Includes a Node Titled User Administration](building-an-interface-to-select-one-user-account-from-many-vb/_static/image5.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image4.png)</span></span>

<span data-ttu-id="11226-148">**Rysunek 2**: mapy witryny obejmuje Administracja użytkownikami zatytułowany węzła ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](building-an-interface-to-select-one-user-account-from-many-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="11226-148">**Figure 2**: The Site Map Includes a Node Titled User Administration ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-vb/_static/image6.png))</span></span>


## <a name="step-2-listing-all-user-accounts-in-a-gridview"></a><span data-ttu-id="11226-149">Krok 2: Lista wszystkich kont użytkowników w widoku GridView</span><span class="sxs-lookup"><span data-stu-id="11226-149">Step 2: Listing All User Accounts in a GridView</span></span>

<span data-ttu-id="11226-150">Naszym celem zakończenia na potrzeby tego samouczka jest tworzenie stronicowanej, filtrowanie siatki, za pomocą którego administrator może wybrać konto użytkownika do zarządzania.</span><span class="sxs-lookup"><span data-stu-id="11226-150">Our end goal for this tutorial is to create a paged, filterable grid through which an administrator can select a user account to manage.</span></span> <span data-ttu-id="11226-151">Zacznijmy od listy *wszystkie* użytkowników w widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="11226-151">Let's start by listing *all* users in a GridView.</span></span> <span data-ttu-id="11226-152">Po zakończeniu tej operacji, dodamy filtrowania stronicowania interfejsów oraz funkcji i możliwości.</span><span class="sxs-lookup"><span data-stu-id="11226-152">Once this is complete, we will add the filtering and paging interfaces and functionality.</span></span>

<span data-ttu-id="11226-153">Otwórz `ManageUsers.aspx` strony `Administration` folderu i Dodaj element GridView ustawienie jej `ID` do `UserAccounts` za chwilę, firma Microsoft będzie napisać kod, aby powiązać zestaw kont użytkowników przy użyciu widoku GridView `Membership` klasy `GetAllUsers` — metoda.</span><span class="sxs-lookup"><span data-stu-id="11226-153">Open the `ManageUsers.aspx` page in the `Administration` folder and add a GridView, setting its `ID` to `UserAccounts` In a moment, we will write code to bind the set of user accounts to the GridView using the `Membership` class's `GetAllUsers` method.</span></span> <span data-ttu-id="11226-154">Zgodnie z opisem w starszych samouczki `GetAllUsers` metoda zwraca `MembershipUserCollection` obiektu, który jest kolekcją z `MembershipUser` obiektów.</span><span class="sxs-lookup"><span data-stu-id="11226-154">As discussed in earlier tutorials, the `GetAllUsers` method returns a `MembershipUserCollection` object, which is a collection of `MembershipUser` objects.</span></span> <span data-ttu-id="11226-155">Każdy `MembershipUser` w kolekcji zawiera właściwości, takie jak `UserName`, `Email`, `IsApproved`i tak dalej.</span><span class="sxs-lookup"><span data-stu-id="11226-155">Each `MembershipUser` in the collection includes properties like `UserName`, `Email`, `IsApproved`, and so on.</span></span>

<span data-ttu-id="11226-156">Aby wyświetlić informacje o koncie odpowiedniego użytkownika w widoku GridView, należy ustawić w widoku GridView `AutoGenerateColumns` wartość False dla właściwości i dodać BoundFields dla `UserName`, `Email`, i `Comment` właściwości i CheckBoxFields dla `IsApproved`, `IsLockedOut`, i `IsOnline` właściwości.</span><span class="sxs-lookup"><span data-stu-id="11226-156">In order to display the desired user account information in the GridView, set the GridView's `AutoGenerateColumns` property to False and add BoundFields for the `UserName`, `Email`, and `Comment` properties and CheckBoxFields for the `IsApproved`, `IsLockedOut`, and `IsOnline` properties.</span></span> <span data-ttu-id="11226-157">Ta konfiguracja może odnosić się za pomocą formantu deklaratywne znaczników lub za pomocą okna dialogowego pól.</span><span class="sxs-lookup"><span data-stu-id="11226-157">This configuration can be applied through the control's declarative markup or via the Fields dialog box.</span></span> <span data-ttu-id="11226-158">Rysunek 3 przedstawia zrzut ekranu: pola — okno dialogowe po usunięto zaznaczenie pola wyboru pola automatycznego generowania i BoundFields i CheckBoxFields zostały dodane i skonfigurowane.</span><span class="sxs-lookup"><span data-stu-id="11226-158">Figure 3 shows a screen shot of the Fields dialog box after the Auto-generate fields checkbox has been unchecked and the BoundFields and CheckBoxFields have been added and configured.</span></span>


<span data-ttu-id="11226-159">[![Dodaj trzy BoundFields i trzy CheckBoxFields do widoku GridView](building-an-interface-to-select-one-user-account-from-many-vb/_static/image8.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="11226-159">[![Add Three BoundFields and Three CheckBoxFields to the GridView](building-an-interface-to-select-one-user-account-from-many-vb/_static/image8.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image7.png)</span></span>

<span data-ttu-id="11226-160">**Rysunek 3**: Dodaj trzy BoundFields i trzy CheckBoxFields do widoku GridView ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](building-an-interface-to-select-one-user-account-from-many-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="11226-160">**Figure 3**: Add Three BoundFields and Three CheckBoxFields to the GridView ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-vb/_static/image9.png))</span></span>


<span data-ttu-id="11226-161">Po skonfigurowaniu sieci GridView, upewnij się, że jego deklaratywne znaczników podobny do następującego:</span><span class="sxs-lookup"><span data-stu-id="11226-161">After configuring your GridView, ensure that its declarative markup resembles the following:</span></span>

[!code-aspx[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample4.aspx)]

<span data-ttu-id="11226-162">Następnie należy napisać kod, który wiąże kont użytkowników z widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="11226-162">Next, we need to write code that binds the user accounts to the GridView.</span></span> <span data-ttu-id="11226-163">Utwórz metodę o nazwie `BindUserAccounts` do wykonania tego zadania, a następnie wywołać ją z `Page_Load` obsługi zdarzeń pierwszej wizyty strony.</span><span class="sxs-lookup"><span data-stu-id="11226-163">Create a method named `BindUserAccounts` to perform this task and then call it from the `Page_Load` event handler on the first page visit.</span></span>

[!code-vb[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample5.vb)]

<span data-ttu-id="11226-164">Poświęć chwilę, aby przetestować za pośrednictwem przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="11226-164">Take a moment to test the page through a browser.</span></span> <span data-ttu-id="11226-165">Jak pokazano na rysunku 4, `UserAccounts` GridView Wyświetla nazwę użytkownika, adres e-mail i inne informacje istotne konta dla wszystkich użytkowników w systemie.</span><span class="sxs-lookup"><span data-stu-id="11226-165">As Figure 4 shows, the `UserAccounts` GridView lists the username, email address, and other pertinent account information for all users in the system.</span></span>


<span data-ttu-id="11226-166">[![Konta użytkowników są wyświetlane w widoku GridView](building-an-interface-to-select-one-user-account-from-many-vb/_static/image11.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="11226-166">[![The User Accounts are Listed in the GridView](building-an-interface-to-select-one-user-account-from-many-vb/_static/image11.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image10.png)</span></span>

<span data-ttu-id="11226-167">**Rysunek 4**: konta użytkowników są wyświetlane w widoku GridView ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](building-an-interface-to-select-one-user-account-from-many-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="11226-167">**Figure 4**: The User Accounts are Listed in the GridView ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-vb/_static/image12.png))</span></span>


## <a name="step-3-filtering-the-results-by-the-first-letter-of-the-username"></a><span data-ttu-id="11226-168">Krok 3: Filtrowanie wyników przez pierwszą literę nazwy użytkownika</span><span class="sxs-lookup"><span data-stu-id="11226-168">Step 3: Filtering the Results by the First Letter of the Username</span></span>

<span data-ttu-id="11226-169">Obecnie `UserAccounts` pokazuje GridView *wszystkie* kont użytkowników.</span><span class="sxs-lookup"><span data-stu-id="11226-169">Currently the `UserAccounts` GridView shows *all* of the user accounts.</span></span> <span data-ttu-id="11226-170">Dla witryn sieci Web z setkami lub tysiącami kont użytkowników konieczne jest ten użytkownik mieć szybko nawiasu dół wyświetlane konta.</span><span class="sxs-lookup"><span data-stu-id="11226-170">For websites with hundreds or thousands of user accounts, it is imperative that user be able to quickly pare down the displayed accounts.</span></span> <span data-ttu-id="11226-171">Można to zrobić przez dodanie filtrowania LinkButtons do strony.</span><span class="sxs-lookup"><span data-stu-id="11226-171">This can be accomplished by adding filtering LinkButtons to the page.</span></span> <span data-ttu-id="11226-172">Dodajmy 27 LinkButtons do strony: jeden zatytułowany wszystkie wraz z jednego LinkButton dla każdej litery alfabetu.</span><span class="sxs-lookup"><span data-stu-id="11226-172">Let's add 27 LinkButtons to the page: one titled All along with one LinkButton for each letter of the alphabet.</span></span> <span data-ttu-id="11226-173">Po kliknięciu wszystkich LinkButton widoku GridView będzie pokazywać wszystkich użytkowników.</span><span class="sxs-lookup"><span data-stu-id="11226-173">If a visitor clicks the All LinkButton, the GridView will show all of the users.</span></span> <span data-ttu-id="11226-174">Jeśli odbiorca kliknie konkretną literę, będą wyświetlane tylko tych użytkowników, których nazw rozpoczyna się od wybranej litery.</span><span class="sxs-lookup"><span data-stu-id="11226-174">If they click a particular letter, only those users whose username starts with the selected letter will be displayed.</span></span>

<span data-ttu-id="11226-175">Naszym pierwszym zadaniem jest Dodaj formanty LinkButton 27.</span><span class="sxs-lookup"><span data-stu-id="11226-175">Our first task is to add the 27 LinkButton controls.</span></span> <span data-ttu-id="11226-176">Jedną z opcji byłoby deklaratywnie, Utwórz 27 LinkButtons pojedynczo.</span><span class="sxs-lookup"><span data-stu-id="11226-176">One option would be to create the 27 LinkButtons declaratively, one at a time.</span></span> <span data-ttu-id="11226-177">Bardziej elastyczne rozwiązaniem jest użycie kontrolce elementu powtarzanego z `ItemTemplate` która renderuje element LinkButton i następnie wiąże opcje filtrowania powtarzanego jako `String` tablicy.</span><span class="sxs-lookup"><span data-stu-id="11226-177">A more flexible approach is to use a Repeater control with an `ItemTemplate` that renders a LinkButton and then binds the filtering options to the Repeater as a `String` array.</span></span>

<span data-ttu-id="11226-178">Start, dodając kontrolce elementu powtarzanego do strony powyżej `UserAccounts` widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="11226-178">Start by adding a Repeater control to the page above the `UserAccounts` GridView.</span></span> <span data-ttu-id="11226-179">Ustaw elemencie powtarzanym `ID` właściwości `FilteringUI` Konfigurowanie szablonów w elemencie powtarzanym, aby jego `ItemTemplate` renderuje element LinkButton których `Text` i `CommandName` właściwości są powiązane z bieżącego elementu tablicy.</span><span class="sxs-lookup"><span data-stu-id="11226-179">Set the Repeater's `ID` property to `FilteringUI` Configure the Repeater's templates so that its `ItemTemplate` renders a LinkButton whose `Text` and `CommandName` properties are bound to the current array element.</span></span> <span data-ttu-id="11226-180">Jak widzieliśmy w <a id="_msoanchor_3"> </a> [ *przypisywanie ról użytkowników* ](../roles/assigning-roles-to-users-vb.md) samouczek, można to zrobić przy użyciu `Container.DataItem` składnia wiązania z danymi.</span><span class="sxs-lookup"><span data-stu-id="11226-180">As we saw in the <a id="_msoanchor_3"></a>[*Assigning Roles to Users*](../roles/assigning-roles-to-users-vb.md) tutorial, this can be accomplished using the `Container.DataItem` databinding syntax.</span></span> <span data-ttu-id="11226-181">Użyj elementu powtarzanego `SeparatorTemplate` do wyświetlenia pionowych linii między każdego łącza.</span><span class="sxs-lookup"><span data-stu-id="11226-181">Use the Repeater's `SeparatorTemplate` to display a vertical line between each link.</span></span>

[!code-aspx[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample6.aspx)]

<span data-ttu-id="11226-182">Aby wypełnić tego elementu powtarzanego z żądanymi opcjami filtrowania, Utwórz metodę o nazwie `BindFilteringUI`.</span><span class="sxs-lookup"><span data-stu-id="11226-182">To populate this Repeater with the desired filtering options, create a method named `BindFilteringUI`.</span></span> <span data-ttu-id="11226-183">Pamiętaj wywołać tę metodę z `Page_Load` obsługi zdarzeń pierwszy ładowania strony.</span><span class="sxs-lookup"><span data-stu-id="11226-183">Be sure to call this method from the `Page_Load` event handler on the first page load.</span></span>

[!code-vb[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample7.vb)]

<span data-ttu-id="11226-184">Ta metoda określa opcje filtrowania jako elementy `String` tablicy `filterOptions` dla każdego elementu w tablicy powtarzanego spowoduje, że element LinkButton z jego `Text` i `CommandName` właściwości, przypisane do wartości w tablicy element.</span><span class="sxs-lookup"><span data-stu-id="11226-184">This method specifies the filtering options as elements in the `String` array `filterOptions` For each element in the array, the Repeater will render a LinkButton with its `Text` and `CommandName` properties assigned to the value of the array element.</span></span>

<span data-ttu-id="11226-185">Rysunek 5. pokazuje `ManageUsers.aspx` strony podczas wyświetlania za pośrednictwem przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="11226-185">Figure 5 shows the `ManageUsers.aspx` page when viewed through a browser.</span></span>


<span data-ttu-id="11226-186">[![Powtarzanego wymieniono 27 LinkButtons filtrowania](building-an-interface-to-select-one-user-account-from-many-vb/_static/image14.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="11226-186">[![The Repeater Lists 27 Filtering LinkButtons](building-an-interface-to-select-one-user-account-from-many-vb/_static/image14.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image13.png)</span></span>

<span data-ttu-id="11226-187">**Rysunek 5**: elementu powtarzanego wymieniono 27 filtrowania LinkButtons ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](building-an-interface-to-select-one-user-account-from-many-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="11226-187">**Figure 5**: The Repeater Lists 27 Filtering LinkButtons ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-vb/_static/image15.png))</span></span>


> [!NOTE]
> <span data-ttu-id="11226-188">Nazwy użytkowników mogą rozpoczynać się od znaków, łącznie z cyfr i znaków interpunkcyjnych.</span><span class="sxs-lookup"><span data-stu-id="11226-188">Usernames may start with any character, including numbers and punctuation.</span></span> <span data-ttu-id="11226-189">Aby wyświetlić te konta, administrator będzie musiał użyć opcji wszystkie LinkButton.</span><span class="sxs-lookup"><span data-stu-id="11226-189">In order to view these accounts, the administrator will have to use the All LinkButton option.</span></span> <span data-ttu-id="11226-190">Alternatywnie można dodać LinkButton do zwrócenia wszystkich kont użytkowników rozpoczynających się od numeru.</span><span class="sxs-lookup"><span data-stu-id="11226-190">Alternatively, you could add a LinkButton to return all user accounts that start with a number.</span></span> <span data-ttu-id="11226-191">I pozostaw to wykonywania dla czytnika.</span><span class="sxs-lookup"><span data-stu-id="11226-191">I leave this as an exercise for the reader.</span></span>


<span data-ttu-id="11226-192">Kliknięcie dowolnej z filtrowania LinkButtons powoduje odświeżenie strony i zgłasza elemencie powtarzanym `ItemCommand` zdarzenia, ale nie ma żadnej zmiany w siatce, ponieważ jeszcze mamy do pisania kodu do filtrowania wyników.</span><span class="sxs-lookup"><span data-stu-id="11226-192">Clicking any of the filtering LinkButtons causes a postback and raises the Repeater's `ItemCommand` event, but there's no change in the grid because we've yet to write any code to filter the results.</span></span> <span data-ttu-id="11226-193">`Membership` Klasa zawiera [ `FindUsersByName` metody](https://technet.microsoft.com/library/system.web.security.membership.findusersbyname.aspx) zwracającą kont użytkowników, których nazwa użytkownika jest zgodna z wzorcem wyszukiwania.</span><span class="sxs-lookup"><span data-stu-id="11226-193">The `Membership` class includes a [`FindUsersByName` method](https://technet.microsoft.com/library/system.web.security.membership.findusersbyname.aspx) that returns those user accounts whose username matches a specified search pattern.</span></span> <span data-ttu-id="11226-194">Możemy użyć tej metody do pobrania tylko tych kont użytkowników, których nazwy użytkowników rozpoczynać się od litery, określony przez `CommandName` z filtrowanych LinkButton, który został kliknięty.</span><span class="sxs-lookup"><span data-stu-id="11226-194">We can use this method to retrieve just those user accounts whose usernames start with the letter specified by the `CommandName` of the filtered LinkButton that was clicked.</span></span>

<span data-ttu-id="11226-195">Uruchom aktualizując `ManageUser.aspx` kodem strony klasy co zawierają one właściwość o nazwie `UsernameToMatch` tej właściwości będzie się powtarzał username — ciąg filtru między ogłaszania zwrotnego:</span><span class="sxs-lookup"><span data-stu-id="11226-195">Start by updating the `ManageUser.aspx` page's code-behind class so that it includes a property named `UsernameToMatch` This property persists the username filter string across postbacks:</span></span>

[!code-vb[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample8.vb)]

<span data-ttu-id="11226-196">`UsernameToMatch` Właściwość przechowuje wartość jest przypisany do `ViewState` kolekcji przy użyciu klucza UsernameToMatch.</span><span class="sxs-lookup"><span data-stu-id="11226-196">The `UsernameToMatch` property stores its value it is assigned into the `ViewState` collection using the key �UsernameToMatch�.</span></span> <span data-ttu-id="11226-197">Jeśli wartość tej właściwości jest do odczytu, sprawdza, czy wartość istnieje w `ViewState` kolekcji; w przeciwnym razie go zwraca wartość domyślna to ciąg pusty.</span><span class="sxs-lookup"><span data-stu-id="11226-197">When this property's value is read, it checks to see if a value exists in the `ViewState` collection; if not, it returns the default value, an empty string.</span></span> <span data-ttu-id="11226-198">`UsernameToMatch` Właściwość wykazuje wspólnego wzorca, czyli utrwalanie wartość, aby wyświetlić stan, tak aby zmiany właściwości są zachowywane między ogłaszania zwrotnego.</span><span class="sxs-lookup"><span data-stu-id="11226-198">The `UsernameToMatch` property exhibits a common pattern, namely persisting a value to view state so that any changes to the property are persisted across postbacks.</span></span> <span data-ttu-id="11226-199">Aby uzyskać więcej informacji na ten wzorzec odczytu [stan widoku ASP.NET opis](https://msdn.microsoftn-us/library/ms972976.aspx).</span><span class="sxs-lookup"><span data-stu-id="11226-199">For more information on this pattern, read [Understanding ASP.NET View State](https://msdn.microsoftn-us/library/ms972976.aspx).</span></span>

<span data-ttu-id="11226-200">Następnie zaktualizuj `BindUserAccounts` tak to zamiast metod wywoływania `Membership.GetAllUsers`, wywołuje `Membership.FindUsersByName`, przekazując wartość `UsernameToMatch` właściwość dołączona z symbolem wieloznacznym SQL %.</span><span class="sxs-lookup"><span data-stu-id="11226-200">Next, update the `BindUserAccounts` method so that instead of calling `Membership.GetAllUsers`, it calls `Membership.FindUsersByName`, passing in the value of the `UsernameToMatch` property appended with the SQL wildcard character, %.</span></span>

[!code-vb[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample9.vb)]

<span data-ttu-id="11226-201">Aby wyświetlić tylko tych użytkowników, których nazw rozpoczyna się od litery A, ustaw `UsernameToMatch` A dla właściwości, a następnie wywołać `BindUserAccounts` spowodowałoby wywołanie `Membership.FindUsersByName("A%")`, którego zostanie zwrócona wszystkich użytkowników, których nazw rozpoczyna się od A. podobnie do zwrócenia *wszystkie* pusty ciąg, aby przypisać użytkowników, `UsernameToMatch` właściwości, aby `BindUserAccounts` wywoła metodę `Membership.FindUsersByName("%")`, a tym samym zwracanie wszystkich kont użytkowników.</span><span class="sxs-lookup"><span data-stu-id="11226-201">To display just those users whose username starts with the letter A, set the `UsernameToMatch` property to A and then call `BindUserAccounts` This would result in a call to `Membership.FindUsersByName("A%")`, which will return all users whose username starts with A. Likewise, to return *all* users, assign an empty string to the `UsernameToMatch` property so that the `BindUserAccounts` method will invoke `Membership.FindUsersByName("%")`, thereby returning all user accounts.</span></span>

<span data-ttu-id="11226-202">Utwórz program obsługi zdarzeń dla elementu powtarzanego `ItemCommand` zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="11226-202">Create an event handler for the Repeater's `ItemCommand` event.</span></span> <span data-ttu-id="11226-203">To zdarzenie jest wywoływane zawsze, gdy zostanie kliknięty jeden z filtrów LinkButtons; jest przekazywany klikniętej LinkButton `CommandName` wartości za pośrednictwem `RepeaterCommandEventArgs` obiektu.</span><span class="sxs-lookup"><span data-stu-id="11226-203">This event is raised whenever one of the filter LinkButtons is clicked; it is passed the clicked LinkButton's `CommandName` value through the `RepeaterCommandEventArgs` object.</span></span> <span data-ttu-id="11226-204">Musimy odpowiednią wartość, aby przypisać `UsernameToMatch` właściwości, a następnie wywołania `BindUserAccounts` metody.</span><span class="sxs-lookup"><span data-stu-id="11226-204">We need to assign the appropriate value to the `UsernameToMatch` property and then call the `BindUserAccounts` method.</span></span> <span data-ttu-id="11226-205">Jeśli `CommandName` , jest pusty ciąg, aby przypisać `UsernameToMatch` tak, aby wszystkie konta użytkowników są wyświetlane.</span><span class="sxs-lookup"><span data-stu-id="11226-205">If the `CommandName` is All, assign an empty string to `UsernameToMatch` so that all user accounts are displayed.</span></span> <span data-ttu-id="11226-206">W przeciwnym razie przypisać `CommandName` do wartości `UsernameToMatch`</span><span class="sxs-lookup"><span data-stu-id="11226-206">Otherwise, assign the `CommandName` value to `UsernameToMatch`</span></span>

[!code-vb[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample10.vb)]

<span data-ttu-id="11226-207">Z tego kodu w miejscu należy przetestować funkcji filtrowania.</span><span class="sxs-lookup"><span data-stu-id="11226-207">With this code in place, test out the filtering functionality.</span></span> <span data-ttu-id="11226-208">Po pierwsze odwiedzenia strony, są wyświetlane wszystkie konta użytkowników (odwołują się do rysunek 5).</span><span class="sxs-lookup"><span data-stu-id="11226-208">When the page is first visited, all user accounts are displayed (refer back to Figure 5).</span></span> <span data-ttu-id="11226-209">Kliknięcie przycisku A LinkButton powoduje odświeżenie strony i filtruje wyniki, wyświetlanie tylko tych kont użytkowników, które zaczynają się A.</span><span class="sxs-lookup"><span data-stu-id="11226-209">Clicking the A LinkButton causes a postback and filters the results, displaying only those user accounts that start with A .</span></span>


<span data-ttu-id="11226-210">[![Umożliwia wyświetlanie tych użytkowników, których nazw rozpoczyna się od określonej litery LinkButtons filtrowania](building-an-interface-to-select-one-user-account-from-many-vb/_static/image17.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="11226-210">[![Use the Filtering LinkButtons to Display those Users Whose Username Starts with a Certain Letter](building-an-interface-to-select-one-user-account-from-many-vb/_static/image17.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image16.png)</span></span>

<span data-ttu-id="11226-211">**Rysunek 6**: Użyj LinkButtons filtrowania, aby wyświetlić te użytkowników Whose Username zaczynał się literą niektórych ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](building-an-interface-to-select-one-user-account-from-many-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="11226-211">**Figure 6**: Use the Filtering LinkButtons to Display those Users Whose Username Starts with a Certain Letter ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-vb/_static/image18.png))</span></span>


## <a name="step-4-updating-the-gridview-to-use-paging"></a><span data-ttu-id="11226-212">Krok 4: Aktualizowanie widoku GridView do użycia stronicowania</span><span class="sxs-lookup"><span data-stu-id="11226-212">Step 4: Updating the GridView to Use Paging</span></span>

<span data-ttu-id="11226-213">GridView pokazano wartości 5 i 6 zawiera listę wszystkich rekordów zwróconych z `FindUsersByName` metody.</span><span class="sxs-lookup"><span data-stu-id="11226-213">The GridView shown in Figures 5 and 6 lists all of the records returned from the `FindUsersByName` method.</span></span> <span data-ttu-id="11226-214">Jeśli istnieją setek lub tysięcy kont użytkowników może to prowadzić do przeciążenia informacji podczas wyświetlania wszystkich kont (tak jak w przypadku po kliknięciu przycisku wszystkie LinkButton lub podczas odwiedzania początkowo strony).</span><span class="sxs-lookup"><span data-stu-id="11226-214">If there are hundreds or thousands of user accounts this can lead to information overload when viewing all of the accounts (as is the case when clicking the All LinkButton or when initially visiting the page).</span></span> <span data-ttu-id="11226-215">Aby przedstawić kont użytkowników na łatwiejsze w zarządzaniu fragmentów, Skonfigurujmy widoku GridView, aby wyświetlić 10 kont użytkownika w czasie.</span><span class="sxs-lookup"><span data-stu-id="11226-215">To help present the user accounts in more manageable chunks, let's configure the GridView to display 10 user accounts at a time.</span></span>

<span data-ttu-id="11226-216">Kontrolki widoku siatki oferuje dwa rodzaje stronicowania:</span><span class="sxs-lookup"><span data-stu-id="11226-216">The GridView control offers two types of paging:</span></span>

- <span data-ttu-id="11226-217">**Domyślne stronicowania** — łatwa do wdrożenia, ale nieefektywne.</span><span class="sxs-lookup"><span data-stu-id="11226-217">**Default paging** - easy to implement, but inefficient.</span></span> <span data-ttu-id="11226-218">Mówiąc, z domyślnymi stronicowanie w widoku GridView oczekuje *wszystkie* rekordy ze źródła danych.</span><span class="sxs-lookup"><span data-stu-id="11226-218">In a nutshell, with default paging the GridView expects *all* of the records from its data source.</span></span> <span data-ttu-id="11226-219">Następnie wyświetla jedynie odpowiednie strony rekordów.</span><span class="sxs-lookup"><span data-stu-id="11226-219">It then only displays the appropriate page of records.</span></span>
- <span data-ttu-id="11226-220">**Stronicowania niestandardowego** -wymaga więcej pracy, aby zaimplementować, ale jest bardziej efektywne niż domyślne stronicowania, ponieważ z niestandardowych stronicowania danych źródła zwraca dokładny zestaw rekordów do wyświetlenia.</span><span class="sxs-lookup"><span data-stu-id="11226-220">**Custom paging** - requires more work to implement, but is more efficient than default paging because with custom paging the data source returns only the precise set of records to display.</span></span>

<span data-ttu-id="11226-221">Różnica w wydajności domyślne i niestandardowe stronicowania może być bardzo istotne, gdy stronicowania za pośrednictwem tysiące rekordów.</span><span class="sxs-lookup"><span data-stu-id="11226-221">The performance difference between default and custom paging can be quite substantial when paging through thousands of records.</span></span> <span data-ttu-id="11226-222">Ponieważ firma Microsoft budowania ten interfejs, zakładając, że mogą być setek lub tysięcy kont użytkowników, Użyjmy stronicowania niestandardowego.</span><span class="sxs-lookup"><span data-stu-id="11226-222">Because we are building this interface assuming that there may be hundreds or thousands of user accounts, let's use custom paging.</span></span>

> [!NOTE]
> <span data-ttu-id="11226-223">Dokładniejsze omówienie na temat różnic między domyślne i niestandardowe stronicowania, a także wyzwania związane z implementującej stronicowania niestandardowego, można znaleźć w temacie [wydajnie stronicowania za pośrednictwem dużych ilości danych](https://asp.net/learn/data-access/tutorial-25-vb.aspx).</span><span class="sxs-lookup"><span data-stu-id="11226-223">For a more thorough discussion on the differences between default and custom paging, as well as the challenges involved in implementing custom paging, refer to [Efficiently Paging Through Large Amounts of Data](https://asp.net/learn/data-access/tutorial-25-vb.aspx).</span></span> <span data-ttu-id="11226-224">Dla niektórych analizy różnicy wydajności między domyślnymi i stronicowania niestandardowego [stronicowania niestandardowego w programie ASP.NET z programu SQL Server 2005](http://aspnet.4guysfromrolla.com/articles/031506-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="11226-224">For some analysis of the performance difference between default and custom paging, see [Custom Paging in ASP.NET with SQL Server 2005](http://aspnet.4guysfromrolla.com/articles/031506-1.aspx).</span></span>


<span data-ttu-id="11226-225">Aby zaimplementować stronicowania niestandardowego, najpierw musimy mechanizmu za pomocą którego można pobrać dokładne podzestaw będzie wyświetlany w widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="11226-225">To implement custom paging we first need some mechanism by which to retrieve the precise subset of records being displayed by the GridView.</span></span> <span data-ttu-id="11226-226">Dobre wieści jest to, że `Membership` klasy `FindUsersByName` metody przeciążenia, które pozwala określić indeks strony i rozmiar strony i zwraca tylko tych kont użytkowników, które wchodzi w zakres rekordów.</span><span class="sxs-lookup"><span data-stu-id="11226-226">The good news is that the `Membership` class's `FindUsersByName` method has an overload that allows us to specify the page index and page size, and returns only those user accounts that fall within that range of records.</span></span>

<span data-ttu-id="11226-227">W szczególności tego przeciążenia ma następującą sygnaturą: [ `FindUsersByName(usernameToMatch, pageIndex, pageSize, totalRecords)` ](https://msdn.microsoft.com/library/fa5st8b2.aspx).</span><span class="sxs-lookup"><span data-stu-id="11226-227">In particular, this overload has the following signature: [`FindUsersByName(usernameToMatch, pageIndex, pageSize, totalRecords)`](https://msdn.microsoft.com/library/fa5st8b2.aspx).</span></span>

<span data-ttu-id="11226-228">*PageIndex* parametr określa strony kont użytkowników ma być zwrócona. *pageSize* wskazuje liczbę rekordów do wyświetlenia na jednej stronie.</span><span class="sxs-lookup"><span data-stu-id="11226-228">The *pageIndex* parameter specifies the page of user accounts to return; *pageSize* indicates how many records to display per page.</span></span> <span data-ttu-id="11226-229">*TotalRecords* parametr jest `ByRef` parametr, który zwraca liczbę całkowitą konta w magazynie użytkownika.</span><span class="sxs-lookup"><span data-stu-id="11226-229">The *totalRecords* parameter is a `ByRef` parameter that returns the number of total user accounts in the user store.</span></span>

> [!NOTE]
> <span data-ttu-id="11226-230">Dane zwrócone przez `FindUsersByName` są sortowane według nazwy użytkownika; nie można dostosować kryteriów sortowania.</span><span class="sxs-lookup"><span data-stu-id="11226-230">The data returned by `FindUsersByName` is sorted by username; the sort criteria cannot be customized.</span></span>


<span data-ttu-id="11226-231">Korzystanie z stronicowania niestandardowego, ale po powiązany tylko z kontrolki ObjectDataSource można skonfigurować widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="11226-231">The GridView can be configured to utilize custom paging, but only when bound to an ObjectDataSource control.</span></span> <span data-ttu-id="11226-232">Kontrolki ObjectDataSource do implementowania stronicowania niestandardowego, wymaga dwóch metod: klucz, który jest przekazywany indeks wiersza początkowego i maksymalną liczbę rekordów do wyświetlenia, i zwraca dokładne podzestaw należące do tego zakresu; i metoda, która zwraca całkowita liczba rekordów jest stronicowana za pośrednictwem.</span><span class="sxs-lookup"><span data-stu-id="11226-232">For the ObjectDataSource control to implement custom paging, it requires two methods: one that is passed a start row index and the maximum number of records to display, and returns the precise subset of records that fall within that span; and a method that returns the total number of records being paged through.</span></span> <span data-ttu-id="11226-233">`FindUsersByName` Przeciążenie akceptuje indeksu strony i rozmiar strony i zwraca całkowita liczba rekordów za pośrednictwem `ByRef` parametru.</span><span class="sxs-lookup"><span data-stu-id="11226-233">The `FindUsersByName` overload accepts a page index and page size, and returns the total number of records through a `ByRef` parameter.</span></span> <span data-ttu-id="11226-234">Dlatego jest tutaj niezgodność interfejsu.</span><span class="sxs-lookup"><span data-stu-id="11226-234">So there is an interface mismatch here.</span></span>

<span data-ttu-id="11226-235">Jedną z opcji będzie można utworzyć klasy proxy, która uwidacznia interfejs ObjectDataSource oczekuje, a następnie wewnętrznie wywołuje `FindUsersByName` metody.</span><span class="sxs-lookup"><span data-stu-id="11226-235">One option would be to create a proxy class that exposes the interface the ObjectDataSource expects, and then internally calls the `FindUsersByName` method.</span></span> <span data-ttu-id="11226-236">Inną opcją - i, użyjemy tego artykułu - ma Utwórz swój własny interfejs stronicowania i używać zamiast wbudowanego interfejsu stronicowania w widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="11226-236">Another option - and the one we'll use for this article - is to create our own paging interface and use that instead of the GridView's built-in paging interface.</span></span>

### <a name="creating-a-first-previous-next-last-paging-interface"></a><span data-ttu-id="11226-237">Tworzenie pierwszej, poprzedniej, następnie ostatni stronicowania — interfejs</span><span class="sxs-lookup"><span data-stu-id="11226-237">Creating a First, Previous, Next, Last Paging Interface</span></span>

<span data-ttu-id="11226-238">Z pierwszej, poprzedni dalej i ostatniego LinkButtons utworzymy interfejsu stronicowania.</span><span class="sxs-lookup"><span data-stu-id="11226-238">Let's build a paging interface with First, Previous, Next, and Last LinkButtons.</span></span> <span data-ttu-id="11226-239">Pierwszy LinkButton, po kliknięciu potrwa użytkownika do pierwszej strony danych, natomiast wstecz zostanie mu powrót do poprzedniej strony.</span><span class="sxs-lookup"><span data-stu-id="11226-239">The First LinkButton, when clicked, will take the user to the first page of data, whereas Previous will return him to the previous page.</span></span> <span data-ttu-id="11226-240">Podobnie następny i ostatni przeniesie użytkownika do następnej i ostatniej strony, odpowiednio.</span><span class="sxs-lookup"><span data-stu-id="11226-240">Likewise, Next and Last will move the user to the next and last page, respectively.</span></span> <span data-ttu-id="11226-241">Dodaj formanty cztery LinkButton poniżej `UserAccounts` widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="11226-241">Add the four LinkButton controls beneath the `UserAccounts` GridView.</span></span>

[!code-aspx[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample11.aspx)]

<span data-ttu-id="11226-242">Następnie należy utworzyć program obsługi zdarzeń dla każdego element LinkButton `Click` zdarzenia.</span><span class="sxs-lookup"><span data-stu-id="11226-242">Next, create an event handler for each of the LinkButton's `Click` events.</span></span>

<span data-ttu-id="11226-243">Na rysunku nr 7 przedstawiono cztery LinkButtons podczas wyświetlania za pośrednictwem widoku Visual Web Developer projektu.</span><span class="sxs-lookup"><span data-stu-id="11226-243">Figure 7 shows the four LinkButtons when viewed through the Visual Web Developer Design view.</span></span>


<span data-ttu-id="11226-244">[![Dodaj pierwszej, poprzedniej, obok, a ostatni LinkButtons poniżej widoku GridView](building-an-interface-to-select-one-user-account-from-many-vb/_static/image20.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="11226-244">[![Add First, Previous, Next, and Last LinkButtons Beneath the GridView](building-an-interface-to-select-one-user-account-from-many-vb/_static/image20.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image19.png)</span></span>

<span data-ttu-id="11226-245">**Rysunek 7**: Dodaj pierwszy, poprzedni dalej i ostatniego LinkButtons poniżej widok GridView ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](building-an-interface-to-select-one-user-account-from-many-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="11226-245">**Figure 7**: Add First, Previous, Next, and Last LinkButtons Beneath the GridView ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-vb/_static/image21.png))</span></span>


### <a name="keeping-track-of-the-current-page-index"></a><span data-ttu-id="11226-246">Rejestrowanie informacji o bieżącego indeksu strony</span><span class="sxs-lookup"><span data-stu-id="11226-246">Keeping Track of the Current Page Index</span></span>

<span data-ttu-id="11226-247">Gdy użytkownik odwiedza najpierw `ManageUsers.aspx` strony lub kliknięcia przycisków jedną filtrowania, chcemy wyświetlić dane na pierwszej stronie w widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="11226-247">When a user first visits the `ManageUsers.aspx` page or clicks one of the filtering buttons, we want to display the first page of data in the GridView.</span></span> <span data-ttu-id="11226-248">Gdy użytkownik kliknie nawigacji LinkButtons, jednak należy zaktualizować indeks strony.</span><span class="sxs-lookup"><span data-stu-id="11226-248">When the user clicks one of the navigation LinkButtons, however, we need to update the page index.</span></span> <span data-ttu-id="11226-249">Aby zachować indeksu strony i liczba rekordów wyświetlanych na każdej stronie, Dodaj następujące dwie właściwości do klasy związane z kodem strony:</span><span class="sxs-lookup"><span data-stu-id="11226-249">To maintain the page index and the number of records to display per page, add the following two properties to the page's code-behind class:</span></span>

[!code-vb[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample12.vb)]

<span data-ttu-id="11226-250">Podobnie jak `UsernameToMatch` właściwość `PageIndex` właściwości jego wartość, aby wyświetlić stan będzie się utrzymywał.</span><span class="sxs-lookup"><span data-stu-id="11226-250">Like the `UsernameToMatch` property, the `PageIndex` property persists its value to view state.</span></span> <span data-ttu-id="11226-251">Tylko do odczytu `PageSize` właściwość zwraca wartość wpisaną na stałe, 10.</span><span class="sxs-lookup"><span data-stu-id="11226-251">The read-only `PageSize` property returns a hard-coded value, 10.</span></span> <span data-ttu-id="11226-252">Zaprosić zainteresowanych czytnika, aby zaktualizować tę właściwość, aby użyć tego samego wzorca jako `PageIndex`, a następnie rozszerzyć `ManageUsers.aspx` strony w taki sposób, że osoby, odwiedzając stronę można określić, jak wiele kont użytkowników do wyświetlenia na jednej stronie.</span><span class="sxs-lookup"><span data-stu-id="11226-252">I invite the interested reader to update this property to use the same pattern as `PageIndex`, and then to augment the `ManageUsers.aspx` page such that the person visiting the page can specify how many user accounts to display per page.</span></span>

### <a name="retrieving-just-the-current-pages-records-updating-the-page-index-and-enabling-and-disabling-the-paging-interface-linkbuttons"></a><span data-ttu-id="11226-253">Pobieranie tylko bieżącej strony rekordy, aktualizowania indeksu strony i włączanie i wyłączanie LinkButtons interfejsu stronicowania</span><span class="sxs-lookup"><span data-stu-id="11226-253">Retrieving Just the Current Page's Records, Updating the Page Index, and Enabling and Disabling the Paging Interface LinkButtons</span></span>

<span data-ttu-id="11226-254">Przy użyciu interfejsu stronicowania w miejscu i `PageIndex` i `PageSize` dodać właściwości, możemy gotowości do zaktualizowania `BindUserAccounts` metodę, tak że używa odpowiednie `FindUsersByName` przeciążenia.</span><span class="sxs-lookup"><span data-stu-id="11226-254">With the paging interface in place and the `PageIndex` and `PageSize` properties added, we are ready to update the `BindUserAccounts` method so that it uses the appropriate `FindUsersByName` overload.</span></span> <span data-ttu-id="11226-255">Ponadto firma Microsoft musi być tej metody, włączanie lub wyłączanie interfejsu stronicowania w zależności od tego, jaką strona jest wyświetlany.</span><span class="sxs-lookup"><span data-stu-id="11226-255">Additionally, we need to have this method enable or disable the paging interface depending on what page is being displayed.</span></span> <span data-ttu-id="11226-256">Podczas wyświetlania na pierwszej stronie danych, powinny być wyłączone łącza pierwszy i poprzedni; Następnie i ostatnio powinny być wyłączone podczas wyświetlania ostatniej strony.</span><span class="sxs-lookup"><span data-stu-id="11226-256">When viewing the first page of data, the First and Previous links should be disabled; Next and Last should be disabled when viewing the last page.</span></span>

<span data-ttu-id="11226-257">Aktualizacja `BindUserAccounts` metodę z następującym kodem:</span><span class="sxs-lookup"><span data-stu-id="11226-257">Update the `BindUserAccounts` method with the following code:</span></span>

[!code-vb[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample13.vb)]

<span data-ttu-id="11226-258">Należy pamiętać, że całkowita liczba rekordów jest stronicowana za pośrednictwem jest określany przez ostatni parametr `FindUsersByName` metody.</span><span class="sxs-lookup"><span data-stu-id="11226-258">Note that the total number of records being paged through is determined by the last parameter of the `FindUsersByName` method.</span></span> <span data-ttu-id="11226-259">Po zwróceniu określonej strony kont użytkowników, cztery LinkButtons są włączone lub wyłączone w zależności od tego, czy jest wyświetlany pierwszej lub ostatniej strony danych.</span><span class="sxs-lookup"><span data-stu-id="11226-259">After the specified page of user accounts are returned, the four LinkButtons are either enabled or disabled, depending on whether the first or last page of data is being viewed.</span></span>

<span data-ttu-id="11226-260">Ostatnim krokiem jest napisanie kodu dla LinkButtons cztery `Click` procedury obsługi zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="11226-260">The last step is to write the code for the four LinkButtons' `Click` event handlers.</span></span> <span data-ttu-id="11226-261">Te programy obsługi zdarzeń należy zaktualizować `PageIndex` właściwości, a następnie ponownie powiązać dane do widoku GridView za pośrednictwem wywołania `BindUserAccounts` pierwszy Wstecz i dalej obsługi zdarzeń są bardzo proste.</span><span class="sxs-lookup"><span data-stu-id="11226-261">These event handlers need to update the `PageIndex` property and then rebind the data to the GridView via a call to `BindUserAccounts` The First, Previous, and Next event handlers are very simple.</span></span> <span data-ttu-id="11226-262">`Click` Programu obsługi zdarzeń dla ostatniego LinkButton, jest jednak nieco bardziej skomplikowane ponieważ potrzebujemy określić liczbę rekordów są wyświetlane w celu określenia indeksu ostatniej strony.</span><span class="sxs-lookup"><span data-stu-id="11226-262">The `Click` event handler for the Last LinkButton, however, is a bit more complex because we need to determine how many records are being displayed in order to determine the last page index.</span></span>

[!code-vb[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample14.vb)]

<span data-ttu-id="11226-263">Rysunki 8 do 9 Pokaż niestandardowy interfejs stronicowania w akcji.</span><span class="sxs-lookup"><span data-stu-id="11226-263">Figures 8 and 9 show the custom paging interface in action.</span></span> <span data-ttu-id="11226-264">Rysunek nr 8 przedstawia `ManageUsers.aspx` stronie podczas przeglądania na pierwszej stronie danych dla wszystkich kont użytkowników.</span><span class="sxs-lookup"><span data-stu-id="11226-264">Figure 8 shows the `ManageUsers.aspx` page when viewing the first page of data for all user accounts.</span></span> <span data-ttu-id="11226-265">Należy pamiętać, że są wyświetlane tylko 10 kont 13.</span><span class="sxs-lookup"><span data-stu-id="11226-265">Note that only 10 of the 13 accounts are displayed.</span></span> <span data-ttu-id="11226-266">Kliknięcie łącza Dalej lub ostatniego powoduje odświeżenie strony, aktualizacje `PageIndex` 1 i powiązania przy użyciu konta użytkownika na drugiej stronie do siatki (patrz rysunek 9).</span><span class="sxs-lookup"><span data-stu-id="11226-266">Clicking the Next or Last link causes a postback, updates the `PageIndex` to 1, and binds the second page of user accounts to the grid (see Figure 9).</span></span>


<span data-ttu-id="11226-267">[![Pierwszy 10 konta użytkowników są wyświetlane.](building-an-interface-to-select-one-user-account-from-many-vb/_static/image23.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="11226-267">[![The First 10 User Accounts are Displayed](building-an-interface-to-select-one-user-account-from-many-vb/_static/image23.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image22.png)</span></span>

<span data-ttu-id="11226-268">**Rysunek 8**: pierwszego konta użytkownika 10 są wyświetlane ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](building-an-interface-to-select-one-user-account-from-many-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="11226-268">**Figure 8**: The First 10 User Accounts are Displayed ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-vb/_static/image24.png))</span></span>


<span data-ttu-id="11226-269">[![Klikając łącze do następnej zostanie wyświetlona strona druga kont użytkowników](building-an-interface-to-select-one-user-account-from-many-vb/_static/image26.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="11226-269">[![Clicking the Next Link Displays the Second Page of User Accounts](building-an-interface-to-select-one-user-account-from-many-vb/_static/image26.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image25.png)</span></span>

<span data-ttu-id="11226-270">**Rysunek 9**: klikając łącze do następnej Wyświetla drugiej strony konta użytkowników ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](building-an-interface-to-select-one-user-account-from-many-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="11226-270">**Figure 9**: Clicking the Next Link Displays the Second Page of User Accounts ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-vb/_static/image27.png))</span></span>


## <a name="summary"></a><span data-ttu-id="11226-271">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="11226-271">Summary</span></span>

<span data-ttu-id="11226-272">Administratorzy często muszą wybierz użytkownika z listy kont.</span><span class="sxs-lookup"><span data-stu-id="11226-272">Administrators often need to select a user from the list of accounts.</span></span> <span data-ttu-id="11226-273">W samouczkach poprzedniej analizujemy przy użyciu listy rozwijanej wypełnione z użytkownikami, ale ta metoda nie obsługuje również.</span><span class="sxs-lookup"><span data-stu-id="11226-273">In previous tutorials we looked at using a drop-down list populated with the users, but this approach does not scale well.</span></span> <span data-ttu-id="11226-274">W tym samouczku będziemy przedstawione lepszym: interfejs można filtrować, których wyniki są wyświetlane w stronicowanych widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="11226-274">In this tutorial we explored a better alternative: a filterable interface whose results are displayed in a paged GridView.</span></span> <span data-ttu-id="11226-275">Z tym interfejsem użytkownika administratorzy mogą szybkie i skuteczne Znajdź i zaznacz jedno konto użytkownika między tysięcy.</span><span class="sxs-lookup"><span data-stu-id="11226-275">With this user interface, administrators can quickly and efficiently locate and select one user account among thousands.</span></span>

<span data-ttu-id="11226-276">Programowanie przyjemność!</span><span class="sxs-lookup"><span data-stu-id="11226-276">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="11226-277">Dalsze informacje</span><span class="sxs-lookup"><span data-stu-id="11226-277">Further Reading</span></span>

<span data-ttu-id="11226-278">Więcej informacji dotyczących tematów omówionych w tym samouczku można znaleźć w następujących zasobach:</span><span class="sxs-lookup"><span data-stu-id="11226-278">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="11226-279">Stronicowania niestandardowego w programie ASP.NET z programem SQL Server 2005</span><span class="sxs-lookup"><span data-stu-id="11226-279">Custom Paging in ASP.NET with SQL Server 2005</span></span>](http://aspnet.4guysfromrolla.com/articles/031506-1.aspx)
- [<span data-ttu-id="11226-280">Efektywne stronicowania z dużą ilością danych</span><span class="sxs-lookup"><span data-stu-id="11226-280">Efficiently Paging Through Large Amounts of Data</span></span>](https://asp.net/learn/data-access/tutorial-25-vb.aspx)
- [<span data-ttu-id="11226-281">Wycofanie własne narzędzia administracyjnego witryny sieci Web</span><span class="sxs-lookup"><span data-stu-id="11226-281">Rolling Your Own Website Administration Tool</span></span>](http://aspnet.4guysfromrolla.com/articles/052307-1.aspx)

### <a name="about-the-author"></a><span data-ttu-id="11226-282">Informacje o autorze</span><span class="sxs-lookup"><span data-stu-id="11226-282">About the Author</span></span>

<span data-ttu-id="11226-283">Scott Bento, Utwórz wiele książek ASP/ASP.NET i twórcę 4GuysFromRolla.com, pracuje z technologii Microsoft Web od 1998.</span><span class="sxs-lookup"><span data-stu-id="11226-283">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="11226-284">Scott działa jako niezależnego konsultanta trainer i składnika zapisywania.</span><span class="sxs-lookup"><span data-stu-id="11226-284">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="11226-285">Jest jego najnowszej książki  *[Sams nauczyć się ASP.NET 2.0 w ciągu 24 godzin](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span><span class="sxs-lookup"><span data-stu-id="11226-285">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="11226-286">Scott jest osiągalny w [ mitchell@4guysfromrolla.com ](mailto:mitchell@4guysfromrolla.com) lub za pośrednictwem jego blogu w [ http://ScottOnWriting.NET ](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="11226-286">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="11226-287">Specjalne podziękowania dla</span><span class="sxs-lookup"><span data-stu-id="11226-287">Special Thanks To</span></span>

<span data-ttu-id="11226-288">Ten samouczek serii zostało sprawdzone przez wiele recenzentów przydatne.</span><span class="sxs-lookup"><span data-stu-id="11226-288">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="11226-289">Recenzenta realizacji w tym samouczku został Alicja Maziarz.</span><span class="sxs-lookup"><span data-stu-id="11226-289">Lead reviewer for this tutorial was Alicja Maziarz.</span></span> <span data-ttu-id="11226-290">Zainteresowani recenzowania Moje nadchodzących artykuły MSDN?</span><span class="sxs-lookup"><span data-stu-id="11226-290">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="11226-291">Jeśli tak, Porzuć mnie linii w</span><span class="sxs-lookup"><span data-stu-id="11226-291">If so, drop me a line at</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="11226-292">[Poprzednie](unlocking-and-approving-user-accounts-cs.md)
> [dalej](recovering-and-changing-passwords-vb.md)</span><span class="sxs-lookup"><span data-stu-id="11226-292">[Previous](unlocking-and-approving-user-accounts-cs.md)
[Next](recovering-and-changing-passwords-vb.md)</span></span>
