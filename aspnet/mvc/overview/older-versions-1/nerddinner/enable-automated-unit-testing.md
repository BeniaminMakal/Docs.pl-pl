---
uid: mvc/overview/older-versions-1/nerddinner/enable-automated-unit-testing
title: Włącz automatyczne testy jednostkowe | Dokumentacja firmy Microsoft
author: microsoft
description: Krok 12 pokazano, jak utworzyć zestaw testów jednostkowych automatycznych, który Sprawdź naszych funkcje NerdDinner i który będzie Prześlij nam zaufania, aby wprowadzić zmiany...
ms.author: aspnetcontent
manager: wpickett
ms.date: 07/27/2010
ms.topic: article
ms.assetid: a19ff2ce-3f7e-4358-9a51-a1403da9c63e
ms.technology: dotnet-mvc
ms.prod: .net-framework
msc.legacyurl: /mvc/overview/older-versions-1/nerddinner/enable-automated-unit-testing
msc.type: authoredcontent
ms.openlocfilehash: fede08be7e06327c6d04fa5d36f7dd818d79b380
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/06/2018
---
<a name="enable-automated-unit-testing"></a><span data-ttu-id="60500-103">Włącz automatyczne testy jednostkowe</span><span class="sxs-lookup"><span data-stu-id="60500-103">Enable Automated Unit Testing</span></span>
====================
<span data-ttu-id="60500-104">przez [firmy Microsoft](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="60500-104">by [Microsoft](https://github.com/microsoft)</span></span>

[<span data-ttu-id="60500-105">Pobierz plik PDF</span><span class="sxs-lookup"><span data-stu-id="60500-105">Download PDF</span></span>](http://aspnetmvcbook.s3.amazonaws.com/aspnetmvc-nerdinner_v1.pdf)

> <span data-ttu-id="60500-106">Jest to krok 12 bezpłatny ["NerdDinner" samouczek aplikacji](introducing-the-nerddinner-tutorial.md) który przeszukiwań przez proces kompilacji mały, ale ukończyć, aplikacji sieci web przy użyciu platformy ASP.NET MVC 1.</span><span class="sxs-lookup"><span data-stu-id="60500-106">This is step 12 of a free ["NerdDinner" application tutorial](introducing-the-nerddinner-tutorial.md) that walks-through how to build a small, but complete, web application using ASP.NET MVC 1.</span></span>
> 
> <span data-ttu-id="60500-107">Krok 12 pokazano, jak utworzyć zestaw testów jednostkowych automatycznych, który Sprawdź naszych funkcje NerdDinner i który będzie Prześlij nam zaufania do wprowadzania zmian i ulepszeń do aplikacji w przyszłości.</span><span class="sxs-lookup"><span data-stu-id="60500-107">Step 12 shows how to develop a suite of automated unit tests that verify our NerdDinner functionality, and which will give us the confidence to make changes and improvements to the application in the future.</span></span>
> 
> <span data-ttu-id="60500-108">Jeśli używasz programu ASP.NET MVC 3, zaleca się wykonanie [pobierania uruchomiona z MVC 3](../../older-versions/getting-started-with-aspnet-mvc3/cs/intro-to-aspnet-mvc-3.md) lub [magazynu utworów muzycznych MVC](../../older-versions/mvc-music-store/mvc-music-store-part-1.md) samouczki.</span><span class="sxs-lookup"><span data-stu-id="60500-108">If you are using ASP.NET MVC 3, we recommend you follow the [Getting Started With MVC 3](../../older-versions/getting-started-with-aspnet-mvc3/cs/intro-to-aspnet-mvc-3.md) or [MVC Music Store](../../older-versions/mvc-music-store/mvc-music-store-part-1.md) tutorials.</span></span>


## <a name="nerddinner-step-12-unit-testing"></a><span data-ttu-id="60500-109">NerdDinner krok 12: Testy jednostkowe</span><span class="sxs-lookup"><span data-stu-id="60500-109">NerdDinner Step 12: Unit Testing</span></span>

<span data-ttu-id="60500-110">Umożliwia tworzenie zestawu testów jednostkowych automatycznych, który Sprawdź naszych funkcje NerdDinner i który będzie Prześlij nam zaufania do wprowadzania zmian i ulepszeń do aplikacji w przyszłości.</span><span class="sxs-lookup"><span data-stu-id="60500-110">Let's develop a suite of automated unit tests that verify our NerdDinner functionality, and which will give us the confidence to make changes and improvements to the application in the future.</span></span>

### <a name="why-unit-test"></a><span data-ttu-id="60500-111">Dlaczego testu jednostkowego?</span><span class="sxs-lookup"><span data-stu-id="60500-111">Why Unit Test?</span></span>

<span data-ttu-id="60500-112">Na dysku do pracy rano co masz nagłym flash z inspirującymi o aplikacji, w którym pracujesz na.</span><span class="sxs-lookup"><span data-stu-id="60500-112">On the drive into work one morning you have a sudden flash of inspiration about an application you are working on.</span></span> <span data-ttu-id="60500-113">Okazuje się, że zmiany nie można zaimplementować spowoduje, że aplikacja znacznie lepszą.</span><span class="sxs-lookup"><span data-stu-id="60500-113">You realize there is a change you can implement that will make the application dramatically better.</span></span> <span data-ttu-id="60500-114">Może to być refaktoryzacji, czyści kod, dodaje nową funkcję lub rozwiązuje usterki.</span><span class="sxs-lookup"><span data-stu-id="60500-114">It might be a refactoring that cleans up the code, adds a new feature, or fixes a bug.</span></span>

<span data-ttu-id="60500-115">Pytania, na które należy confronts po przyjeździe do komputera — "jak bezpieczne jest aby temu usprawnieniu?"</span><span class="sxs-lookup"><span data-stu-id="60500-115">The question that confronts you when you arrive at your computer is – "how safe is it to make this improvement?"</span></span> <span data-ttu-id="60500-116">Co zrobić, jeśli wprowadzenie zmian ma efekty uboczne lub coś dzieli?</span><span class="sxs-lookup"><span data-stu-id="60500-116">What if making the change has side effects or breaks something?</span></span> <span data-ttu-id="60500-117">Zmiana może być prosty i przyjmuje tylko kilka minut, aby zaimplementować, ale co zrobić, jeśli trwa godziny ręcznie przetestować we wszystkich scenariuszach aplikacji?</span><span class="sxs-lookup"><span data-stu-id="60500-117">The change might be simple and only take a few minutes to implement, but what if it takes hours to manually test out all of the application scenarios?</span></span> <span data-ttu-id="60500-118">Co zrobić, Jeśli zapomnisz obejmuje scenariusz i przerwana aplikacja przechodzi w środowisku produkcyjnym?</span><span class="sxs-lookup"><span data-stu-id="60500-118">What if you forget to cover a scenario and a broken application goes into production?</span></span> <span data-ttu-id="60500-119">Sprawia to ulepszenie naprawdę warto nakładu pracy?</span><span class="sxs-lookup"><span data-stu-id="60500-119">Is making this improvement really worth all the effort?</span></span>

<span data-ttu-id="60500-120">Testy jednostkowe automatycznych może udostępniać zabezpieczenie, umożliwiający stale ulepszanie aplikacji i przed obawiasz się kod, który użytkownik pracuje.</span><span class="sxs-lookup"><span data-stu-id="60500-120">Automated unit tests can provide a safety net that enables you to continually enhance your applications, and avoid being afraid of the code you are working on.</span></span> <span data-ttu-id="60500-121">Wykonywanie testów, które szybko sprawdzić, czy funkcje umożliwiają kodu bez obaw — i dają poprawiają użytkownik może w przeciwnym razie nie ma mieli świadomość doświadczenia o automatycznych.</span><span class="sxs-lookup"><span data-stu-id="60500-121">Having automated tests that quickly verify functionality enables you to code with confidence – and empower you to make improvements you might otherwise not have felt comfortable doing.</span></span> <span data-ttu-id="60500-122">Ułatwiają również tworzenie rozwiązań, które są łatwiejsze do utrzymania i dłuższy okres istnienia — która prowadzi do znacznie wyższa zwrotu z inwestycji.</span><span class="sxs-lookup"><span data-stu-id="60500-122">They also help create solutions that are more maintainable and have a longer lifetime - which leads to a much higher return on investment.</span></span>

<span data-ttu-id="60500-123">Platforma ASP.NET MVC ułatwia fizyczne do funkcjonalności aplikacji testów jednostkowych.</span><span class="sxs-lookup"><span data-stu-id="60500-123">The ASP.NET MVC Framework makes it easy and natural to unit test application functionality.</span></span> <span data-ttu-id="60500-124">Umożliwia również przepływ pracy Test Driven Development (TDD), który umożliwia programowanie oparte na wcześniejsze testowanie.</span><span class="sxs-lookup"><span data-stu-id="60500-124">It also enables a Test Driven Development (TDD) workflow that enables test-first based development.</span></span>

### <a name="nerddinnertests-project"></a><span data-ttu-id="60500-125">NerdDinner.Tests Project</span><span class="sxs-lookup"><span data-stu-id="60500-125">NerdDinner.Tests Project</span></span>

<span data-ttu-id="60500-126">Gdy utworzyliśmy naszej aplikacji NerdDinner na początku tego samouczka zostały możemy monit okno dialogowe z pytaniem, czy trzeba utworzyć jednostkowy projekt testowy, aby przejść wraz z projektu aplikacji:</span><span class="sxs-lookup"><span data-stu-id="60500-126">When we created our NerdDinner application at the beginning of this tutorial, we were prompted with a dialog asking whether we wanted to create a unit test project to go along with the application project:</span></span>

![](enable-automated-unit-testing/_static/image1.png)

<span data-ttu-id="60500-127">Firma Microsoft przechowywane "Tak, Utwórz jednostkowy projekt testowy" przycisk radiowy zaznaczono — co spowodowało w projekcie "NerdDinner.Tests" dodawany do naszego rozwiązania:</span><span class="sxs-lookup"><span data-stu-id="60500-127">We kept the "Yes, create a unit test project" radio button selected – which resulted in a "NerdDinner.Tests" project being added to our solution:</span></span>

![](enable-automated-unit-testing/_static/image2.png)

<span data-ttu-id="60500-128">Projekt NerdDinner.Tests odwołuje się do zestawu projektów aplikacji NerdDinner i pozwala na łatwe dodawanie zautomatyzowanych testów, aby sprawdzić funkcjonalność aplikacji.</span><span class="sxs-lookup"><span data-stu-id="60500-128">The NerdDinner.Tests project references the NerdDinner application project assembly, and enables us to easily add automated tests to it that verify the application functionality.</span></span>

### <a name="creating-unit-tests-for-our-dinner-model-class"></a><span data-ttu-id="60500-129">Tworzenie testów jednostkowych dla klasy modelu nasze obiad</span><span class="sxs-lookup"><span data-stu-id="60500-129">Creating Unit Tests for our Dinner Model Class</span></span>

<span data-ttu-id="60500-130">Dodajmy niektórych testów naszych NerdDinner.Tests projekt, który zweryfikować klasy obiad, tworzone budujemy nasze warstwy modelu.</span><span class="sxs-lookup"><span data-stu-id="60500-130">Let's add some tests to our NerdDinner.Tests project that verify the Dinner class we created when we built our model layer.</span></span>

<span data-ttu-id="60500-131">Zaczniemy tworząc nowy folder w naszym projekt testowy o nazwie "Modele" gdzie będzie umieszczać testów związanych z modelu.</span><span class="sxs-lookup"><span data-stu-id="60500-131">We'll start by creating a new folder within our test project called "Models" where we'll place our model-related tests.</span></span> <span data-ttu-id="60500-132">Firma Microsoft będzie następnie kliknij prawym przyciskiem folder i wybierz **Add -&gt;nowego testu** polecenia menu.</span><span class="sxs-lookup"><span data-stu-id="60500-132">We'll then right-click on the folder and choose the **Add-&gt;New Test** menu command.</span></span> <span data-ttu-id="60500-133">Zostanie wyświetlone okno dialogowe "Dodaj nowy Test".</span><span class="sxs-lookup"><span data-stu-id="60500-133">This will bring up the "Add New Test" dialog.</span></span>

<span data-ttu-id="60500-134">Wybrano do tworzenia "Unit Test" i nadaj jej nazwę na "DinnerTest.cs":</span><span class="sxs-lookup"><span data-stu-id="60500-134">We'll choose to create a "Unit Test" and name it "DinnerTest.cs":</span></span>

![](enable-automated-unit-testing/_static/image3.png)

<span data-ttu-id="60500-135">Po kliknięciu przycisku "ok" przycisk Visual Studio spowoduje dodanie (i otworzyć) DinnerTest.cs plik do projektu:</span><span class="sxs-lookup"><span data-stu-id="60500-135">When we click the "ok" button Visual Studio will add (and open) a DinnerTest.cs file to the project:</span></span>

![](enable-automated-unit-testing/_static/image4.png)

<span data-ttu-id="60500-136">Domyślny szablon testu jednostki programu Visual Studio ma licznych płytkę kocioł kodu wewnątrz znaleźć nieco lepiej.</span><span class="sxs-lookup"><span data-stu-id="60500-136">The default Visual Studio unit test template has a bunch of boiler-plate code within it that I find a little messy.</span></span> <span data-ttu-id="60500-137">Załóżmy Oczyść je tylko zawierać poniższy kod:</span><span class="sxs-lookup"><span data-stu-id="60500-137">Let's clean it up to just contain the code below:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample1.cs)]

<span data-ttu-id="60500-138">Atrybut [TestClass] w klasie DinnerTest powyżej identyfikuje ją jako klasa, która będzie zawierać testów, oraz opcjonalne badanie inicjowania i usuwania kodu.</span><span class="sxs-lookup"><span data-stu-id="60500-138">The [TestClass] attribute on the DinnerTest class above identifies it as a class that will contain tests, as well as optional test initialization and teardown code.</span></span> <span data-ttu-id="60500-139">Firma Microsoft można zdefiniować testy znajdujące się w nim przez dodanie metody publiczne, których atrybut [TestMethod].</span><span class="sxs-lookup"><span data-stu-id="60500-139">We can define tests within it by adding public methods that have a [TestMethod] attribute on them.</span></span>

<span data-ttu-id="60500-140">Poniżej przedstawiono pierwszy z dwóch testów, który zostanie dodany, które wykonuje klasy Nasze obiad.</span><span class="sxs-lookup"><span data-stu-id="60500-140">Below are the first of two tests we'll add that exercise our Dinner class.</span></span> <span data-ttu-id="60500-141">Pierwszego testu weryfikuje, czy naszych obiad nieprawidłowy nowe obiad zostanie utworzony bez wszystkich właściwości poprawnie ustawiona.</span><span class="sxs-lookup"><span data-stu-id="60500-141">The first test verifies that our Dinner is invalid if a new Dinner is created without all properties being set correctly.</span></span> <span data-ttu-id="60500-142">Drugi test sprawdza naszych obiad jest prawidłowa, gdy obiad ma wszystkie właściwości prawidłowymi wartościami:</span><span class="sxs-lookup"><span data-stu-id="60500-142">The second test verifies that our Dinner is valid when a Dinner has all properties set with valid values:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample2.cs)]

<span data-ttu-id="60500-143">Można zauważyć powyżej czy nazwy naszych testów są bardzo jawnego (i nieco pełne).</span><span class="sxs-lookup"><span data-stu-id="60500-143">You'll notice above that our test names are very explicit (and somewhat verbose).</span></span> <span data-ttu-id="60500-144">Są to robimy ponieważ możemy tworzenia setek lub tysięcy testów małych i chcemy ułatwić szybko określić opcje i zachowanie każdego z nich (szczególnie w przypadku czekamy na liście błędów w programie test runner).</span><span class="sxs-lookup"><span data-stu-id="60500-144">We are doing this because we might end up creating hundreds or thousands of small tests, and we want to make it easy to quickly determine the intent and behavior of each of them (especially when we are looking through a list of failures in a test runner).</span></span> <span data-ttu-id="60500-145">Nazwy testu powinno być nazwanym po funkcji, które są one testowania.</span><span class="sxs-lookup"><span data-stu-id="60500-145">The test names should be named after the functionality they are testing.</span></span> <span data-ttu-id="60500-146">Powyżej użyto "rzeczownik\_powinien\_zlecenie" Wzorzec nazewnictwa.</span><span class="sxs-lookup"><span data-stu-id="60500-146">Above we are using a "Noun\_Should\_Verb" naming pattern.</span></span>

<span data-ttu-id="60500-147">Firma Microsoft struktury testy za pomocą "AAA" testowania wzorca — oznaczającą "Rozmieść, Act, Assert":</span><span class="sxs-lookup"><span data-stu-id="60500-147">We are structuring the tests using the "AAA" testing pattern – which stands for "Arrange, Act, Assert":</span></span>

- <span data-ttu-id="60500-148">Rozmieść: Konfiguracja jednostki poddawana testom</span><span class="sxs-lookup"><span data-stu-id="60500-148">Arrange: Setup the unit being tested</span></span>
- <span data-ttu-id="60500-149">Działanie: Wykonywanie jednostki w ramach testu i przechwytywania wyników</span><span class="sxs-lookup"><span data-stu-id="60500-149">Act: Exercise the unit under test and capture results</span></span>
- <span data-ttu-id="60500-150">Assert: Sprawdzić działanie</span><span class="sxs-lookup"><span data-stu-id="60500-150">Assert: Verify the behavior</span></span>

<span data-ttu-id="60500-151">Pisząc testy chcemy, aby uniknąć poszczególne testy są zbyt szybko.</span><span class="sxs-lookup"><span data-stu-id="60500-151">When we write tests we want to avoid having the individual tests do too much.</span></span> <span data-ttu-id="60500-152">Zamiast tego każdy test należy sprawdzić tylko jednej koncepcji (co stanie się on łatwiej wskazać przyczynę niepowodzenia).</span><span class="sxs-lookup"><span data-stu-id="60500-152">Instead each test should verify only a single concept (which will make it much easier to pinpoint the cause of failures).</span></span> <span data-ttu-id="60500-153">Dobrą praktyką jest spróbuj i może zawierać tylko jeden assert instrukcji dla każdego z testów.</span><span class="sxs-lookup"><span data-stu-id="60500-153">A good guideline is to try and only have a single assert statement for each test.</span></span> <span data-ttu-id="60500-154">Jeśli masz więcej niż jeden assert instrukcji w metodzie testowej, upewnij się, że są one wszystkie używane do testowania tego samego pojęcia.</span><span class="sxs-lookup"><span data-stu-id="60500-154">If you have more than one assert statement in a test method, make sure they are all being used to test the same concept.</span></span> <span data-ttu-id="60500-155">W razie wątpliwości, należy innego testu.</span><span class="sxs-lookup"><span data-stu-id="60500-155">When in doubt, make another test.</span></span>

### <a name="running-tests"></a><span data-ttu-id="60500-156">Uruchamianie testów</span><span class="sxs-lookup"><span data-stu-id="60500-156">Running Tests</span></span>

<span data-ttu-id="60500-157">Visual Studio 2008 Professional (i nowsze wersje) zawiera wbudowane uruchamiający, który może służyć do uruchamiania programu Visual Studio jednostki Test projektów w środowisku IDE.</span><span class="sxs-lookup"><span data-stu-id="60500-157">Visual Studio 2008 Professional (and higher editions) includes a built-in test runner that can be used to run Visual Studio Unit Test projects within the IDE.</span></span> <span data-ttu-id="60500-158">Firma Microsoft może wybrać **Test -&gt;Uruchom -&gt;wszystkie testy z rozwiązania** polecenia menu (lub typu Ctrl R, A) do wszystkich naszych testów jednostkowych.</span><span class="sxs-lookup"><span data-stu-id="60500-158">We can select the **Test-&gt;Run-&gt;All Tests in Solution** menu command (or type Ctrl R, A) to run all of our unit tests.</span></span> <span data-ttu-id="60500-159">Lub też możemy Ustaw naszych kursor w metodzie klasy lub testowym specyficznego testu i użyj **Test -&gt;Uruchom -&gt;testy z bieżącego kontekstu** polecenia menu (lub typ Ctrl R T) do uruchomienia podzbioru testów jednostkowych.</span><span class="sxs-lookup"><span data-stu-id="60500-159">Or alternatively we can position our cursor within a specific test class or test method and use the **Test-&gt;Run-&gt;Tests in Current Context** menu command (or type Ctrl R, T) to run a subset of the unit tests.</span></span>

<span data-ttu-id="60500-160">Teraz umieść naszych kursora w klasie DinnerTest a wpisz "Ctrl R, T" uruchamianie dwóch testów, wystarczy zdefiniowanego.</span><span class="sxs-lookup"><span data-stu-id="60500-160">Let's position our cursor within the DinnerTest class and type "Ctrl R, T" to run the two tests we just defined.</span></span> <span data-ttu-id="60500-161">Gdy firma Microsoft tym okno "Wyników testu" będą wyświetlane w programie Visual Studio i zajmiemy się tym wyniki uruchomienia wymienionych w niej naszych testu:</span><span class="sxs-lookup"><span data-stu-id="60500-161">When we do this a "Test Results" window will appear within Visual Studio and we'll see the results of our test run listed within it:</span></span>

![](enable-automated-unit-testing/_static/image5.png)

<span data-ttu-id="60500-162">*Uwaga: Okno wyników testu VS nie są wyświetlane kolumny Nazwa klasy domyślnie. Możesz dodać to przez kliknięcie prawym przyciskiem myszy w oknie wyników testu i za pomocą polecenia menu Dodaj/Usuń kolumny.*</span><span class="sxs-lookup"><span data-stu-id="60500-162">*Note: The VS test results window does not show the Class Name column by default. You can add this by right-clicking within the Test Results window and using the Add/Remove Columns menu command.*</span></span>

<span data-ttu-id="60500-163">Nasze testy dwóch trwało tylko ułamek sekund do uruchomienia —, a użytkownik może zobacz obydwie przekazany.</span><span class="sxs-lookup"><span data-stu-id="60500-163">Our two tests took only a fraction of a second to run – and as you can see they both passed.</span></span> <span data-ttu-id="60500-164">Firma Microsoft teraz Przejdź i rozszerzyć je, tworząc dodatkowe testy, które sprawdzić poprawności określonej reguły, a także opisano dwie metody pomocnika - IsUserHost() i IsUserRegisterd() — dodaną do klasy obiad.</span><span class="sxs-lookup"><span data-stu-id="60500-164">We can now go on and augment them by creating additional tests that verify specific rule validations, as well as cover the two helper methods - IsUserHost() and IsUserRegisterd() – that we added to the Dinner class.</span></span> <span data-ttu-id="60500-165">Posiadanie tych testów w klasie obiad, spowoduje to znacznie łatwiejsze i bezpieczniejsze dodać nowe reguły biznesowe i sprawdzanie poprawności do niego w przyszłości.</span><span class="sxs-lookup"><span data-stu-id="60500-165">Having all these tests in place for the Dinner class will make it much easier and safer to add new business rules and validations to it in the future.</span></span> <span data-ttu-id="60500-166">Możemy dodać nowe logiki reguły do obiad, a następnie w ciągu kilku sekund Sprawdź, czy go nie uszkodzony żadnego z naszych poprzednie funkcjonalności logiki.</span><span class="sxs-lookup"><span data-stu-id="60500-166">We can add our new rule logic to Dinner, and then within seconds verify that it hasn't broken any of our previous logic functionality.</span></span>

<span data-ttu-id="60500-167">Zwróć uwagę, jak przy użyciu nazwy opisowej testu ułatwia szybkie zrozumieć, co sprawdza każdego z testów.</span><span class="sxs-lookup"><span data-stu-id="60500-167">Notice how using a descriptive test name makes it easy to quickly understand what each test is verifying.</span></span> <span data-ttu-id="60500-168">Zaleca się **narzędzia —&gt;opcje** polecenie otwarcia Test Tools —&gt;ekranie konfiguracji wykonywania testów i sprawdzanie, czy "dwukrotne kliknięcie wyniku testu jednostkowego nie powiodło się lub niejednoznaczny Wyświetla pole wyboru punktu awarii w teście".</span><span class="sxs-lookup"><span data-stu-id="60500-168">I recommend using the **Tools-&gt;Options** menu command, opening the Test Tools-&gt;Test Execution configuration screen, and checking the "Double-clicking a failed or inconclusive unit test result displays the point of failure in the test" checkbox.</span></span> <span data-ttu-id="60500-169">Pozwoli to na kliknij dwukrotnie z powodu błędu w oknie wyników testu i od razu przejść do awarii potwierdzenia.</span><span class="sxs-lookup"><span data-stu-id="60500-169">This will allow you to double-click on a failure in the test results window and jump immediately to the assert failure.</span></span>

### <a name="creating-dinnerscontroller-unit-tests"></a><span data-ttu-id="60500-170">Tworzenie testów jednostkowych DinnersController</span><span class="sxs-lookup"><span data-stu-id="60500-170">Creating DinnersController Unit Tests</span></span>

<span data-ttu-id="60500-171">Teraz Utwórzmy niektórych testów jednostkowych, weryfikujących naszej funkcji DinnersController.</span><span class="sxs-lookup"><span data-stu-id="60500-171">Let's now create some unit tests that verify our DinnersController functionality.</span></span> <span data-ttu-id="60500-172">Firma Microsoft będzie uruchomić, klikając prawym przyciskiem myszy folder "Kontrolery" w ramach naszych projektu testowego, a następnie wybierz pozycję **Add -&gt;nowego testu** polecenia menu.</span><span class="sxs-lookup"><span data-stu-id="60500-172">We'll start by right-clicking on the "Controllers" folder within our Test project and then choose the **Add-&gt;New Test** menu command.</span></span> <span data-ttu-id="60500-173">Firma Microsoft będzie utworzyć "Unit Test" i nadaj jej nazwę na "DinnersControllerTest.cs".</span><span class="sxs-lookup"><span data-stu-id="60500-173">We'll create a "Unit Test" and name it "DinnersControllerTest.cs".</span></span>

<span data-ttu-id="60500-174">Utwórz dwie metody testowe, które Sprawdź metody akcji Details() na DinnersController.</span><span class="sxs-lookup"><span data-stu-id="60500-174">We'll create two test methods that verify the Details() action method on the DinnersController.</span></span> <span data-ttu-id="60500-175">Pierwszy sprawdzi, czy widok jest zwracany, jeśli istniejące obiad jest wymagane.</span><span class="sxs-lookup"><span data-stu-id="60500-175">The first will verify that a View is returned when an existing Dinner is requested.</span></span> <span data-ttu-id="60500-176">Drugi sprawdzi, czy widok "NotFound" jest zwracany, jeśli wymagany jest obiad nieistniejącą:</span><span class="sxs-lookup"><span data-stu-id="60500-176">The second will verify that a "NotFound" view is returned when a non-existent Dinner is requested:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample3.cs)]

<span data-ttu-id="60500-177">Powyższy kod kompiluje oczyszczania.</span><span class="sxs-lookup"><span data-stu-id="60500-177">The above code compiles clean.</span></span> <span data-ttu-id="60500-178">Uruchamianych testów, jednak mogą zakończyć się niepowodzeniem:</span><span class="sxs-lookup"><span data-stu-id="60500-178">When we run the tests, though, they both fail:</span></span>

![](enable-automated-unit-testing/_static/image6.png)

<span data-ttu-id="60500-179">Przyjrzymy się komunikaty o błędach, możemy Zobacz, czy został powodu testy nie powiodło się, ponieważ klasy Nasze DinnersRepository nie mógł połączyć się z bazą danych.</span><span class="sxs-lookup"><span data-stu-id="60500-179">If we look at the error messages, we'll see that the reason the tests failed was because our DinnersRepository class was unable to connect to a database.</span></span> <span data-ttu-id="60500-180">Naszej aplikacji NerdDinner używa parametrów połączenia do lokalnego pliku programu SQL Server Express, który znajduje się w obszarze \App\_katalog danych NerdDinner projekt aplikacji.</span><span class="sxs-lookup"><span data-stu-id="60500-180">Our NerdDinner application is using a connection-string to a local SQL Server Express file which lives under the \App\_Data directory of the NerdDinner application project.</span></span> <span data-ttu-id="60500-181">Ponieważ naszych projektu NerdDinner.Tests kompiluje i uruchamia w innym katalogu następnie projekt aplikacji, lokalizację ścieżki względnej naszych ciągu połączenia jest niepoprawna.</span><span class="sxs-lookup"><span data-stu-id="60500-181">Because our NerdDinner.Tests project compiles and runs in a different directory then the application project, the relative path location of our connection-string is incorrect.</span></span>

<span data-ttu-id="60500-182">Firma Microsoft *można* rozwiązać ten problem przez skopiowanie pliku bazy danych programu SQL Express do naszej projektu testowego, a następnie dodaj parametry połączenia testowego odpowiednie do niego w pliku App.config projektu testu w naszym.</span><span class="sxs-lookup"><span data-stu-id="60500-182">We *could* fix this by copying the SQL Express database file to our test project, and then add an appropriate test connection-string to it in the App.config of our test project.</span></span> <span data-ttu-id="60500-183">Jak to powyższe testy odblokowany i uruchomiona.</span><span class="sxs-lookup"><span data-stu-id="60500-183">This would get the above tests unblocked and running.</span></span>

<span data-ttu-id="60500-184">Kod przy użyciu rzeczywistego bazy danych, testy jednostkowe łączy z nim jednak wiele wyzwań.</span><span class="sxs-lookup"><span data-stu-id="60500-184">Unit testing code using a real database, though, brings with it a number of challenges.</span></span> <span data-ttu-id="60500-185">W szczególności:</span><span class="sxs-lookup"><span data-stu-id="60500-185">Specifically:</span></span>

- <span data-ttu-id="60500-186">Znacznie zmniejsza czas wykonania testów jednostkowych.</span><span class="sxs-lookup"><span data-stu-id="60500-186">It significantly slows down the execution time of unit tests.</span></span> <span data-ttu-id="60500-187">Już trwa uruchamianie testów, tym mniej prawdopodobne są często je wykonać.</span><span class="sxs-lookup"><span data-stu-id="60500-187">The longer it takes to run tests, the less likely you are to execute them frequently.</span></span> <span data-ttu-id="60500-188">W idealnym przypadku ma testy jednostkowe mógł działać w sekundach — i została ona być coś, co należy zrobić, naturalny sposób jako Kompilowanie projektu.</span><span class="sxs-lookup"><span data-stu-id="60500-188">Ideally you want your unit tests to be able to be run in seconds – and have it be something you do as naturally as compiling the project.</span></span>
- <span data-ttu-id="60500-189">Utrudnia to ustawień i czyszczenia logiki w ramach testów.</span><span class="sxs-lookup"><span data-stu-id="60500-189">It complicates the setup and cleanup logic within tests.</span></span> <span data-ttu-id="60500-190">Chcesz, aby każdy test jednostkowy być izolowane i niezależnie od innych użytkowników (z nie efektów ubocznych lub zależności).</span><span class="sxs-lookup"><span data-stu-id="60500-190">You want each unit test to be isolated and independent of others (with no side effects or dependencies).</span></span> <span data-ttu-id="60500-191">Podczas pracy w rzeczywistych bazy danych należy zachować ostrożność, stanu i resetuje je między testy.</span><span class="sxs-lookup"><span data-stu-id="60500-191">When working against a real database you have to be mindful of state and reset it between tests.</span></span>

<span data-ttu-id="60500-192">Przyjrzyjmy się wzorca projektowego o nazwie "iniekcji zależności", które mogą pomóc nam obejścia tych problemów i uniknąć konieczności korzystanie z testów rzeczywistych bazy danych.</span><span class="sxs-lookup"><span data-stu-id="60500-192">Let's look at a design pattern called "dependency injection" that can help us work around these issues and avoid the need to use a real database with our tests.</span></span>

### <a name="dependency-injection"></a><span data-ttu-id="60500-193">Iniekcji zależności</span><span class="sxs-lookup"><span data-stu-id="60500-193">Dependency Injection</span></span>

<span data-ttu-id="60500-194">W tej chwili DinnersController jest ściśle "powiązane" do klasy DinnerRepository.</span><span class="sxs-lookup"><span data-stu-id="60500-194">Right now DinnersController is tightly "coupled" to the DinnerRepository class.</span></span> <span data-ttu-id="60500-195">"Sprzężenia" odwołuje się do sytuacji, gdy klasa jawnie zależy od innej klasy funkcjonowania:</span><span class="sxs-lookup"><span data-stu-id="60500-195">"Coupling" refers to a situation where a class explicitly relies on another class in order to work:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample4.cs)]

<span data-ttu-id="60500-196">Ponieważ klasa DinnerRepository wymaga dostępu do bazy danych, silnie sprzężonego zależności DinnersController klasa ma na końcach DinnerRepository się wymagające nam w celu zapewnienia bazy danych dla metody akcji DinnersController do sprawdzenia.</span><span class="sxs-lookup"><span data-stu-id="60500-196">Because the DinnerRepository class requires access to a database, the tightly coupled dependency the DinnersController class has on the DinnerRepository ends up requiring us to have a database in order for the DinnersController action methods to be tested.</span></span>

<span data-ttu-id="60500-197">Można pobrać obejścia tego problemu przez zastosowanie wzorca projektowego o nazwie "iniekcji zależności" — czyli podejście, gdzie zależności (takich jak klasy repozytorium, które zapewniają dostęp do danych) nie jest już niejawnie są tworzone w ramach klasy, które z nich korzystają.</span><span class="sxs-lookup"><span data-stu-id="60500-197">We can get around this by employing a design pattern called "dependency injection" – which is an approach where dependencies (like repository classes that provide data access) are no longer implicitly created within classes that use them.</span></span> <span data-ttu-id="60500-198">Zamiast tego zależności można jawnie przekazany do klasy, która używa ich przy użyciu argumentów konstruktora.</span><span class="sxs-lookup"><span data-stu-id="60500-198">Instead, dependencies can be explicitly passed to the class that uses them using constructor arguments.</span></span> <span data-ttu-id="60500-199">Jeśli zależności są zdefiniowane przy użyciu interfejsów, następnie mamy elastyczność do przekazania w implementacjach zależności "fałszywych" scenariusze testowania jednostki.</span><span class="sxs-lookup"><span data-stu-id="60500-199">If the dependencies are defined using interfaces, we then have the flexibility to pass in "fake" dependency implementations for unit test scenarios.</span></span> <span data-ttu-id="60500-200">Pozwala na tworzenie implementacje zależności specyficzne dla testów, które faktycznie nie wymagają dostępu do bazy danych.</span><span class="sxs-lookup"><span data-stu-id="60500-200">This enables us to create test-specific dependency implementations that do not actually require access to a database.</span></span>

<span data-ttu-id="60500-201">Aby wyświetlić to działanie, umożliwia wdrożenie iniekcji zależności z naszych DinnersController.</span><span class="sxs-lookup"><span data-stu-id="60500-201">To see this in action, let's implement dependency injection with our DinnersController.</span></span>

#### <a name="extracting-an-idinnerrepository-interface"></a><span data-ttu-id="60500-202">Wyodrębnianie IDinnerRepository — interfejs</span><span class="sxs-lookup"><span data-stu-id="60500-202">Extracting an IDinnerRepository interface</span></span>

<span data-ttu-id="60500-203">Naszym pierwszym krokiem będzie można utworzyć nowy interfejs IDinnerRepository, który hermetyzuje kontrakt repozytorium, który naszych kontrolery wymagają pobierania i aktualizowania kolacji.</span><span class="sxs-lookup"><span data-stu-id="60500-203">Our first step will be to create a new IDinnerRepository interface that encapsulates the repository contract our controllers require to retrieve and update Dinners.</span></span>

<span data-ttu-id="60500-204">Firma Microsoft można ręcznie zdefiniować tego interfejsu kontraktu prawym przyciskiem myszy \Models folder, a następnie wybierając **Add -&gt;nowy element** polecenia menu i tworzenie nowy interfejs o nazwie IDinnerRepository.cs.</span><span class="sxs-lookup"><span data-stu-id="60500-204">We can define this interface contract manually by right-clicking on the \Models folder, and then choosing the **Add-&gt;New Item** menu command and creating a new interface named IDinnerRepository.cs.</span></span>

<span data-ttu-id="60500-205">Firma Microsoft możesz też Użyj automatycznie refaktoryzacji narzędzia wbudowane w program Visual Studio Professional (i nowsze wersje) do wyodrębniania i utworzyć interfejs dla nas z naszych istniejącej klasy DinnerRepository.</span><span class="sxs-lookup"><span data-stu-id="60500-205">Alternatively we can use the refactoring tools built-into Visual Studio Professional (and higher editions) to automatically extract and create an interface for us from our existing DinnerRepository class.</span></span> <span data-ttu-id="60500-206">Aby wyodrębnić ten interfejs, za pomocą programu VS, po prostu umieść kursor w edytorze tekstu w klasie DinnerRepository, a następnie kliknij prawym przyciskiem myszy i wybierz **Zrefaktoryzuj -&gt;wyodrębniania interfejsu** polecenie:</span><span class="sxs-lookup"><span data-stu-id="60500-206">To extract this interface using VS, simply position the cursor in the text editor on the DinnerRepository class, and then right-click and choose the **Refactor-&gt;Extract Interface** menu command:</span></span>

![](enable-automated-unit-testing/_static/image7.png)

<span data-ttu-id="60500-207">Spowoduje to Uruchom okno dialogowe "Wyodrębnij Interface" i monitować nam Nazwa interfejsu, aby utworzyć.</span><span class="sxs-lookup"><span data-stu-id="60500-207">This will launch the "Extract Interface" dialog and prompt us for the name of the interface to create.</span></span> <span data-ttu-id="60500-208">Go spowoduje domyślne ustawienie IDinnerRepository i automatycznie wybrać wszystkie metody publiczne na istniejącej klasy DinnerRepository, aby dodać do interfejsu:</span><span class="sxs-lookup"><span data-stu-id="60500-208">It will default to IDinnerRepository and automatically select all public methods on the existing DinnerRepository class to add to the interface:</span></span>

![](enable-automated-unit-testing/_static/image8.png)

<span data-ttu-id="60500-209">Kliknięcie przycisku "ok", Visual Studio spowoduje dodanie nowego interfejsu IDinnerRepository do naszej aplikacji:</span><span class="sxs-lookup"><span data-stu-id="60500-209">When we click the "ok" button, Visual Studio will add a new IDinnerRepository interface to our application:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample5.cs)]

<span data-ttu-id="60500-210">I naszych istniejącej klasy DinnerRepository zostaną zaktualizowane, aby ją implementuje interfejs:</span><span class="sxs-lookup"><span data-stu-id="60500-210">And our existing DinnerRepository class will be updated so that it implements the interface:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample6.cs)]

#### <a name="updating-dinnerscontroller-to-support-constructor-injection"></a><span data-ttu-id="60500-211">Aktualizowanie DinnersController w celu obsługi iniekcji konstruktora</span><span class="sxs-lookup"><span data-stu-id="60500-211">Updating DinnersController to support constructor injection</span></span>

<span data-ttu-id="60500-212">Firma Microsoft będzie teraz aktualizować klasę DinnersController, aby korzystać z nowego interfejsu.</span><span class="sxs-lookup"><span data-stu-id="60500-212">We'll now update the DinnersController class to use the new interface.</span></span>

<span data-ttu-id="60500-213">Obecnie DinnersController jest ustalony tak, aby jego pola "dinnerRepository" jest zawsze klasy DinnerRepository:</span><span class="sxs-lookup"><span data-stu-id="60500-213">Currently DinnersController is hard-coded such that its "dinnerRepository" field is always a DinnerRepository class:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample7.cs)]

<span data-ttu-id="60500-214">Zmienimy go tak, aby w polu "dinnerRepository" jest typu IDinnerRepository zamiast DinnerRepository.</span><span class="sxs-lookup"><span data-stu-id="60500-214">We'll change it so that the "dinnerRepository" field is of type IDinnerRepository instead of DinnerRepository.</span></span> <span data-ttu-id="60500-215">Następnie dodamy dwa konstruktory DinnersController publiczne.</span><span class="sxs-lookup"><span data-stu-id="60500-215">We'll then add two public DinnersController constructors.</span></span> <span data-ttu-id="60500-216">Jeden z konstruktorów umożliwia IDinnerRepository przekazywany jako argument.</span><span class="sxs-lookup"><span data-stu-id="60500-216">One of the constructors allows an IDinnerRepository to be passed as an argument.</span></span> <span data-ttu-id="60500-217">Druga to domyślny konstruktor używający naszych istniejącej implementacji DinnerRepository:</span><span class="sxs-lookup"><span data-stu-id="60500-217">The other is a default constructor that uses our existing DinnerRepository implementation:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample8.cs)]

<span data-ttu-id="60500-218">Ponieważ ASP.NET MVC domyślnie tworzy klasy kontrolera przy użyciu domyślnych konstruktorów, naszych DinnersController w czasie wykonywania będzie klasa DinnerRepository służy do uzyskania dostępu do danych.</span><span class="sxs-lookup"><span data-stu-id="60500-218">Because ASP.NET MVC by default creates controller classes using default constructors, our DinnersController at runtime will continue to use the DinnerRepository class to perform data access.</span></span>

<span data-ttu-id="60500-219">Mamy teraz zaktualizować Nasze testy jednostek, do przekazania w implementacji repozytorium obiad "fałszywych" za pomocą parametru konstruktora.</span><span class="sxs-lookup"><span data-stu-id="60500-219">We can now update our unit tests, though, to pass in a "fake" dinner repository implementation using the parameter constructor.</span></span> <span data-ttu-id="60500-220">To repozytorium obiad "fałszywych" nie wymaga dostępu do rzeczywistego bazy danych, a zamiast tego użyje danych przykładowych w pamięci.</span><span class="sxs-lookup"><span data-stu-id="60500-220">This "fake" dinner repository will not require access to a real database, and instead will use in-memory sample data.</span></span>

#### <a name="creating-the-fakedinnerrepository-class"></a><span data-ttu-id="60500-221">Tworzenie klasy FakeDinnerRepository</span><span class="sxs-lookup"><span data-stu-id="60500-221">Creating the FakeDinnerRepository class</span></span>

<span data-ttu-id="60500-222">Ta funkcja pozwala utworzyć klasę FakeDinnerRepository.</span><span class="sxs-lookup"><span data-stu-id="60500-222">Let's create a FakeDinnerRepository class.</span></span>

<span data-ttu-id="60500-223">Firma Microsoft będzie Rozpocznij od utworzenia katalogu "Elementów sztucznych" w ramach naszych NerdDinner.Tests projektu, a następnie dodaj nową klasę FakeDinnerRepository do niego (kliknij prawym przyciskiem myszy folder, a następnie wybierz pozycję **Add -&gt;nowa klasa**):</span><span class="sxs-lookup"><span data-stu-id="60500-223">We'll begin by creating a "Fakes" directory within our NerdDinner.Tests project and then add a new FakeDinnerRepository class to it (right-click on the folder and choose **Add-&gt;New Class**):</span></span>

![](enable-automated-unit-testing/_static/image9.png)

<span data-ttu-id="60500-224">Będziemy informować kod, aby FakeDinnerRepository klasa implementuje interfejs IDinnerRepository.</span><span class="sxs-lookup"><span data-stu-id="60500-224">We'll update the code so that the FakeDinnerRepository class implements the IDinnerRepository interface.</span></span> <span data-ttu-id="60500-225">Następnie możemy kliknij prawym przyciskiem myszy na nim i wybierz polecenie "Implementuje interfejs IDinnerRepository" z menu kontekstowego:</span><span class="sxs-lookup"><span data-stu-id="60500-225">We can then right-click on it and choose the "Implement interface IDinnerRepository" context menu command:</span></span>

![](enable-automated-unit-testing/_static/image10.png)

<span data-ttu-id="60500-226">Spowoduje to Visual Studio, aby automatycznie dodać wszystkie elementy członkowskie interfejsu IDinnerRepository do naszej klasy FakeDinnerRepository z domyślnej implementacji "stub out":</span><span class="sxs-lookup"><span data-stu-id="60500-226">This will cause Visual Studio to automatically add all of the IDinnerRepository interface members to our FakeDinnerRepository class with default "stub out" implementations:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample9.cs)]

<span data-ttu-id="60500-227">Następnie zaktualizowania implementacji FakeDinnerRepository pracy wylogowuje na liście w pamięci&lt;obiad&gt; kolekcji do niej przekazany jako argument konstruktora:</span><span class="sxs-lookup"><span data-stu-id="60500-227">We can then update the FakeDinnerRepository implementation to work off of an in-memory List&lt;Dinner&gt; collection passed to it as a constructor argument:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample10.cs)]

<span data-ttu-id="60500-228">Mamy teraz fałszywych implementację IDinnerRepository, która nie wymaga bazy danych, a zamiast tego można pracować poza listę obiad obiektów w pamięci.</span><span class="sxs-lookup"><span data-stu-id="60500-228">We now have a fake IDinnerRepository implementation that does not require a database, and can instead work off an in-memory list of Dinner objects.</span></span>

#### <a name="using-the-fakedinnerrepository-with-unit-tests"></a><span data-ttu-id="60500-229">Przy użyciu FakeDinnerRepository przy użyciu testów jednostkowych</span><span class="sxs-lookup"><span data-stu-id="60500-229">Using the FakeDinnerRepository with Unit Tests</span></span>

<span data-ttu-id="60500-230">Teraz wróć do testów jednostkowych DinnersController, których nie powiodła się wcześniej, ponieważ w bazie danych nie była dostępna.</span><span class="sxs-lookup"><span data-stu-id="60500-230">Let's return to the DinnersController unit tests that failed earlier because the database wasn't available.</span></span> <span data-ttu-id="60500-231">Aktualizujemy metody testu FakeDinnerRepository wypełniane przy użyciu przykładowych danych obiad w pamięci, aby DinnersController przy użyciu kodu poniżej:</span><span class="sxs-lookup"><span data-stu-id="60500-231">We can update the test methods to use a FakeDinnerRepository populated with sample in-memory Dinner data to the DinnersController using the code below:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample11.cs)]

<span data-ttu-id="60500-232">I teraz możemy uruchomienie tych testów zarówno przekazują:</span><span class="sxs-lookup"><span data-stu-id="60500-232">And now when we run these tests they both pass:</span></span>

![](enable-automated-unit-testing/_static/image11.png)

<span data-ttu-id="60500-233">Najlepsze ich podjąć tylko ułamek sekund do uruchomienia i nie wymagają wszelka logika skomplikowane instalacji/czyszczenia.</span><span class="sxs-lookup"><span data-stu-id="60500-233">Best of all, they take only a fraction of a second to run, and do not require any complicated setup/cleanup logic.</span></span> <span data-ttu-id="60500-234">Możemy teraz testu jednostkowego wszystkich naszych DinnersController metody kodu działania (takie jak lista, stronicowanie, uzyskać szczegółowe informacje, tworzenie, aktualizowanie i usuwanie) bez konieczności kiedykolwiek nawiązać połączenia z bazą danych rzeczywistych.</span><span class="sxs-lookup"><span data-stu-id="60500-234">We can now unit test all of our DinnersController action method code (including listing, paging, details, create, update and delete) without ever needing to connect to a real database.</span></span>

| <span data-ttu-id="60500-235">**Temat po stronie: Struktury iniekcji zależności**</span><span class="sxs-lookup"><span data-stu-id="60500-235">**Side Topic: Dependency Injection Frameworks**</span></span> |
| --- |
| <span data-ttu-id="60500-236">Iniekcji zależności ręczne (np. pracujemy nad) działa prawidłowo, ale coraz trudniej Obsługa jako liczba zależności i zwiększa składników w aplikacji.</span><span class="sxs-lookup"><span data-stu-id="60500-236">Performing manual dependency injection (like we are above) works fine, but does become harder to maintain as the number of dependencies and components in an application increases.</span></span> <span data-ttu-id="60500-237">Istnieje kilka struktur iniekcji zależności dla platformy .NET, które mogą ułatwić zapewniają większą elastyczność zarządzania zależności.</span><span class="sxs-lookup"><span data-stu-id="60500-237">Several dependency injection frameworks exist for .NET that can help provide even more dependency management flexibility.</span></span> <span data-ttu-id="60500-238">Tych struktur, nazywanych także kontenery "Inwersja kontroli" (IoC) zapewniają mechanizmy, które umożliwiają dodatkowy poziom obsługi konfiguracji dotyczące określania i przekazywanie zależności do obiektów w czasie wykonywania (w większości przypadków przy użyciu iniekcji konstruktora ).</span><span class="sxs-lookup"><span data-stu-id="60500-238">These frameworks, also sometimes called "Inversion of Control" (IoC) containers, provide mechanisms that enable an additional level of configuration support for specifying and passing dependencies to objects at runtime (most often using constructor injection).</span></span> <span data-ttu-id="60500-239">Niektóre z bardziej popularnych iniekcji zależności OSS / include platform Inwersja kontroli w .NET: AutoFac, Ninject Spring.NET, StructureMap i Windsor.</span><span class="sxs-lookup"><span data-stu-id="60500-239">Some of the more popular OSS Dependency Injection / IOC frameworks in .NET include: AutoFac, Ninject, Spring.NET, StructureMap, and Windsor.</span></span> <span data-ttu-id="60500-240">ASP.NET MVC udostępnia rozszerzalności interfejsów API, które umożliwiają deweloperom uczestniczyć w rozdzielczość i konkretyzacji kontrolerów, a co pozwala iniekcji zależności / platform Inwersja kontroli powinny zostać prawidłowo włączone w ramach tego procesu.</span><span class="sxs-lookup"><span data-stu-id="60500-240">ASP.NET MVC exposes extensibility APIs that enable developers to participate in the resolution and instantiation of controllers, and which enables Dependency Injection / IoC frameworks to be cleanly integrated within this process.</span></span> <span data-ttu-id="60500-241">Przy użyciu platformy Podpisane/Inwersja kontroli będzie również umożliwiają usunięcie domyślnego konstruktora z naszych DinnersController — która całkowicie usunąć sprzężenia między nim a DinnerRepositorys.</span><span class="sxs-lookup"><span data-stu-id="60500-241">Using a DI/IOC framework would also enable us to remove the default constructor from our DinnersController – which would completely remove the coupling between it and the DinnerRepositorys.</span></span> <span data-ttu-id="60500-242">Firma Microsoft nie będzie używany iniekcji zależności / framework Inwersja kontroli z naszą aplikacją NerdDinner.</span><span class="sxs-lookup"><span data-stu-id="60500-242">We won't be using a dependency injection / IOC framework with our NerdDinner application.</span></span> <span data-ttu-id="60500-243">Ale coś, co możemy można rozważyć w przyszłości, jeśli zwiększył Baza kodów NerdDinner i możliwości.</span><span class="sxs-lookup"><span data-stu-id="60500-243">But it is something we could consider for the future if the NerdDinner code-base and capabilities grew.</span></span> |

### <a name="creating-edit-action-unit-tests"></a><span data-ttu-id="60500-244">Tworzenie testów jednostkowych akcji edycji</span><span class="sxs-lookup"><span data-stu-id="60500-244">Creating Edit Action Unit Tests</span></span>

<span data-ttu-id="60500-245">Teraz Utwórzmy niektóre testy jednostek, które sprawdzają funkcje edycji DinnersController.</span><span class="sxs-lookup"><span data-stu-id="60500-245">Let's now create some unit tests that verify the Edit functionality of the DinnersController.</span></span> <span data-ttu-id="60500-246">Zaczniemy testując wersji HTTP GET nasze działania edycji:</span><span class="sxs-lookup"><span data-stu-id="60500-246">We'll start by testing the HTTP-GET version of our Edit action:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample12.cs)]

<span data-ttu-id="60500-247">Utworzymy test, który sprawdza renderowania widoku obsługiwanej przez obiekt DinnerFormViewModel Wstecz, gdy wymagane jest prawidłowe obiad:</span><span class="sxs-lookup"><span data-stu-id="60500-247">We'll create a test that verifies that a View backed by a DinnerFormViewModel object is rendered back when a valid dinner is requested:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample13.cs)]

<span data-ttu-id="60500-248">Uruchomienie testu, jednak firma Microsoft znajdziesz będzie ponieważ wyjątek odwołania zerowego jest zgłaszany, gdy właściwość User.Identity.Name sprawdzania Dinner.IsHostedBy() uzyskuje dostęp do metody edycji.</span><span class="sxs-lookup"><span data-stu-id="60500-248">When we run the test, though, we'll find that it fails because a null reference exception is thrown when the Edit method accesses the User.Identity.Name property to perform the Dinner.IsHostedBy() check.</span></span>

<span data-ttu-id="60500-249">Obiekt użytkownika w klasie podstawowej kontrolera hermetyzuje szczegółów dotyczących zalogowanego użytkownika i wypełnione przez platformę ASP.NET MVC, podczas tworzenia kontrolera w czasie wykonywania.</span><span class="sxs-lookup"><span data-stu-id="60500-249">The User object on the Controller base class encapsulates details about the logged-in user, and is populated by ASP.NET MVC when it creates the controller at runtime.</span></span> <span data-ttu-id="60500-250">Ponieważ testujemy DinnersController poza środowiskiem serwera sieci web, obiekt użytkownika nie jest ustawiony (stąd wyjątek odwołania zerowego).</span><span class="sxs-lookup"><span data-stu-id="60500-250">Because we are testing the DinnersController outside of a web-server environment, the User object isn't set (hence the null reference exception).</span></span>

### <a name="mocking-the-useridentityname-property"></a><span data-ttu-id="60500-251">Właściwość User.Identity.Name mocking</span><span class="sxs-lookup"><span data-stu-id="60500-251">Mocking the User.Identity.Name property</span></span>

<span data-ttu-id="60500-252">Struktury mocking ułatwić testowanie włączając firmie Microsoft w celu dynamicznego tworzenia fałszywych wersji obiektów zależnych, które obsługują Nasze testy.</span><span class="sxs-lookup"><span data-stu-id="60500-252">Mocking frameworks make testing easier by enabling us to dynamically create fake versions of dependent objects that support our tests.</span></span> <span data-ttu-id="60500-253">Na przykład zastosowanie mocking framework w naszym teście akcji edycji można dynamicznie utworzyć obiekt użytkownika, który naszych DinnersController można użyć do wyszukania symulowane nazwy użytkownika.</span><span class="sxs-lookup"><span data-stu-id="60500-253">For example, we can use a mocking framework in our Edit action test to dynamically create a User object that our DinnersController can use to lookup a simulated username.</span></span> <span data-ttu-id="60500-254">Pozwoli to uniknąć odwołanie o wartości null z jest generowany, gdy przeprowadzana naszym teście.</span><span class="sxs-lookup"><span data-stu-id="60500-254">This will avoid a null reference from being thrown when we run our test.</span></span>

<span data-ttu-id="60500-255">Istnieje wiele .NET mocking struktury, których można użyć z platformą ASP.NET MVC (wyświetlana lista z nich w tym miejscu: [ http://www.mockframeworks.com/ ](http://www.mockframeworks.com/)).</span><span class="sxs-lookup"><span data-stu-id="60500-255">There are many .NET mocking frameworks that can be used with ASP.NET MVC (you can see a list of them here: [http://www.mockframeworks.com/](http://www.mockframeworks.com/)).</span></span> <span data-ttu-id="60500-256">Do testowania aplikacji NerdDinner użyjemy typu open source mocking framework o nazwie "Moq", który można pobrać bezpłatnie z [ http://www.mockframeworks.com/moq ](http://www.mockframeworks.com/moq).</span><span class="sxs-lookup"><span data-stu-id="60500-256">For testing our NerdDinner application we'll use an open source mocking framework called "Moq", which can be downloaded for free from [http://www.mockframeworks.com/moq](http://www.mockframeworks.com/moq).</span></span>

<span data-ttu-id="60500-257">Po pobraniu, dodamy odwołanie w naszym NerdDinner.Tests projektu do zestawu Moq.dll:</span><span class="sxs-lookup"><span data-stu-id="60500-257">Once downloaded, we'll add a reference in our NerdDinner.Tests project to the Moq.dll assembly:</span></span>

![](enable-automated-unit-testing/_static/image12.png)

<span data-ttu-id="60500-258">Następnie dodamy "CreateDinnersControllerAs(username)" metody pomocnika do naszej klasy testowej, która przyjmuje jako parametr, a które nazwę użytkownika, a następnie "mocks" User.Identity.Name właściwość w wystąpieniu DinnersController:</span><span class="sxs-lookup"><span data-stu-id="60500-258">We'll then add a "CreateDinnersControllerAs(username)" helper method to our test class that takes a username as a parameter, and which then "mocks" the User.Identity.Name property on the DinnersController instance:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample14.cs)]

<span data-ttu-id="60500-259">Powyżej użyto Moq Aby utworzyć obiekt makiety elementów sztucznych obiektu kontekstem ControllerContext (czyli ASP.NET MVC przekazuje do klas kontrolera na uwidocznienie obiektów czasu wykonywania, takie jak użytkownika, żądania, odpowiedzi i sesji).</span><span class="sxs-lookup"><span data-stu-id="60500-259">Above we are using Moq to create a Mock object that fakes a ControllerContext object (which is what ASP.NET MVC passes to Controller classes to expose runtime objects like User, Request, Response, and Session).</span></span> <span data-ttu-id="60500-260">Wywołania metody "SetupGet" na makiety, aby wskazać, że właściwość HttpContext.User.Identity.Name kontekstem ControllerContext powinien zwrócić przekazane do metody pomocnika ciąg nazwy użytkownika.</span><span class="sxs-lookup"><span data-stu-id="60500-260">We are calling the "SetupGet" method on the Mock to indicate that the HttpContext.User.Identity.Name property on ControllerContext should return the username string we passed to the helper method.</span></span>

<span data-ttu-id="60500-261">Firma Microsoft może mock dowolną liczbę kontekstem ControllerContext właściwości i metody.</span><span class="sxs-lookup"><span data-stu-id="60500-261">We can mock any number of ControllerContext properties and methods.</span></span> <span data-ttu-id="60500-262">Aby zilustrować to również zostały dodane wywołanie SetupGet() dla właściwości Request.IsAuthenticated (której faktycznie nie jest potrzebny do testów poniżej — ale umożliwiająca zilustrować, jak można mock właściwości żądania).</span><span class="sxs-lookup"><span data-stu-id="60500-262">To illustrate this I've also added a SetupGet() call for the Request.IsAuthenticated property (which isn't actually needed for the tests below – but which helps illustrate how you can mock Request properties).</span></span> <span data-ttu-id="60500-263">Gdy firma Microsoft gotowe możemy przypisać wystąpienia makiety kontekstem ControllerContext DinnersController zwraca naszych metody pomocnika.</span><span class="sxs-lookup"><span data-stu-id="60500-263">When we are done we assign an instance of the ControllerContext mock to the DinnersController our helper method returns.</span></span>

<span data-ttu-id="60500-264">Możemy teraz zapisać testy jednostek, które ta metoda pomocnika do testowania scenariuszy edycji obejmujące różnych użytkowników:</span><span class="sxs-lookup"><span data-stu-id="60500-264">We can now write unit tests that use this helper method to test Edit scenarios involving different users:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample15.cs)]

<span data-ttu-id="60500-265">I teraz możemy uruchamianych testów przekazują:</span><span class="sxs-lookup"><span data-stu-id="60500-265">And now when we run the tests they pass:</span></span>

![](enable-automated-unit-testing/_static/image13.png)

### <a name="testing-updatemodel-scenarios"></a><span data-ttu-id="60500-266">UpdateModel() scenariuszy testowania</span><span class="sxs-lookup"><span data-stu-id="60500-266">Testing UpdateModel() scenarios</span></span>

<span data-ttu-id="60500-267">Utworzyliśmy testy, które obejmują wersji HTTP GET akcji edycji.</span><span class="sxs-lookup"><span data-stu-id="60500-267">We've created tests that cover the HTTP-GET version of the Edit action.</span></span> <span data-ttu-id="60500-268">Teraz Utwórzmy niektórych testów, które pozwalają sprawdzić wersji protokołu HTTP POST akcji edycji:</span><span class="sxs-lookup"><span data-stu-id="60500-268">Let's now create some tests that verify the HTTP-POST version of the Edit action:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample16.cs)]

<span data-ttu-id="60500-269">Nowe interesujące scenariuszu testowania firmie Microsoft w celu obsługi przy użyciu tej metody akcji jest jej użycie metody pomocnika UpdateModel() w klasie podstawowej kontrolera.</span><span class="sxs-lookup"><span data-stu-id="60500-269">The interesting new testing scenario for us to support with this action method is its usage of the UpdateModel() helper method on the Controller base class.</span></span> <span data-ttu-id="60500-270">Ta metoda pomocnika jest używany do powiązania wartości post formularza do naszej obiad wystąpienia obiektu.</span><span class="sxs-lookup"><span data-stu-id="60500-270">We are using this helper method to bind form-post values to our Dinner object instance.</span></span>

<span data-ttu-id="60500-271">Poniżej przedstawiono dwa testy, które pokazuje, jak firma Microsoft mogła dostarczyć Formularz ogłoszony wartości UpdateModel() metody pomocnika do użycia.</span><span class="sxs-lookup"><span data-stu-id="60500-271">Below are two tests that demonstrates how we can supply form posted values for the UpdateModel() helper method to use.</span></span> <span data-ttu-id="60500-272">Firma Microsoft będzie to zrobić, tworzenie i wypełnianie obiektu FormCollection, a następnie przypisać je do właściwości "ValueProvider" na kontrolerze.</span><span class="sxs-lookup"><span data-stu-id="60500-272">We'll do this by creating and populating a FormCollection object, and then assign it to the "ValueProvider" property on the Controller.</span></span>

<span data-ttu-id="60500-273">Pierwszego testu sprawdza, czy na pomyślne Zapisz przeglądarki jest przekierowywany do wykonania akcji details.</span><span class="sxs-lookup"><span data-stu-id="60500-273">The first test verifies that on a successful save the browser is redirected to the details action.</span></span> <span data-ttu-id="60500-274">Drugi test sprawdza, czy podczas nieprawidłowe dane wejściowe akcji zostanie ponownie widoku edycji ponownie z komunikatem o błędzie.</span><span class="sxs-lookup"><span data-stu-id="60500-274">The second test verifies that when invalid input is posted the action redisplays the edit view again with an error message.</span></span>


[!code-csharp[Main](enable-automated-unit-testing/samples/sample17.cs)]

### <a name="testing-wrap-up"></a><span data-ttu-id="60500-275">Testowanie Wrap-Up</span><span class="sxs-lookup"><span data-stu-id="60500-275">Testing Wrap-Up</span></span>

<span data-ttu-id="60500-276">Firma Microsoft zostały objęte podstawowe koncepcje związane z klas kontrolera testowania jednostek.</span><span class="sxs-lookup"><span data-stu-id="60500-276">We've covered the core concepts involved in unit testing controller classes.</span></span> <span data-ttu-id="60500-277">Możemy użyć tych metod, można łatwo utworzyć setki proste testy weryfikujące działanie aplikacji.</span><span class="sxs-lookup"><span data-stu-id="60500-277">We can use these techniques to easily create hundreds of simple tests that verify the behavior of our application.</span></span>

<span data-ttu-id="60500-278">Ponieważ naszych kontrolera i testy modelu nie wymagają rzeczywistych bazy danych, są one bardzo szybki i łatwy do uruchomienia.</span><span class="sxs-lookup"><span data-stu-id="60500-278">Because our controller and model tests do not require a real database, they are extremely fast and easy to run.</span></span> <span data-ttu-id="60500-279">Firma Microsoft będzie można wykonać setki testów automatycznych w sekundach i natychmiast Uzyskaj opinie określające, czy zmiany, które wprowadziliśmy spowodowało przerwanie coś.</span><span class="sxs-lookup"><span data-stu-id="60500-279">We'll be able to execute hundreds of automated tests in seconds, and immediately get feedback as to whether a change we made broke something.</span></span> <span data-ttu-id="60500-280">Dzięki temu, podaj nam zaufania do stale poprawy refaktoryzacji i Dostosuj naszej aplikacji.</span><span class="sxs-lookup"><span data-stu-id="60500-280">This will help provide us the confidence to continually improve, refactor, and refine our application.</span></span>

<span data-ttu-id="60500-281">Firma Microsoft pasuje do testowania jako ostatni tematu w tym rozdziale —, ale ponieważ testy są coś zrobić pod koniec procesu projektowania!</span><span class="sxs-lookup"><span data-stu-id="60500-281">We covered testing as the last topic in this chapter – but not because testing is something you should do at the end of a development process!</span></span> <span data-ttu-id="60500-282">Przeciwnie należy zapisać testów automatycznych możliwie jak najszybciej w procesie tworzenia aplikacji.</span><span class="sxs-lookup"><span data-stu-id="60500-282">On the contrary, you should write automated tests as early as possible in your development process.</span></span> <span data-ttu-id="60500-283">Wykonanie tej tak pozwala uzyskać natychmiast uzyskuje opinie podczas opracowywania, pomaga odnoszącej zastanowić scenariuszy przypadków zastosowań aplikacji i ułatwia projektowanie aplikacji z czystą Układanie warstwowo i sprzężenia pamiętać.</span><span class="sxs-lookup"><span data-stu-id="60500-283">Doing so enables you to get immediate feedback as you develop, helps you think thoughtfully about your application's use case scenarios, and guides you to design your application with clean layering and coupling in mind.</span></span>

<span data-ttu-id="60500-284">Nowsze rozdziału w książce przedstawimy testu Driven Development (TDD) i jak z niego korzystać z platformy ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="60500-284">A later chapter in the book will discuss Test Driven Development (TDD), and how to use it with ASP.NET MVC.</span></span> <span data-ttu-id="60500-285">TDD jest iteracyjne praktyk kodowania, gdzie najpierw zapisać testów, które będą spełniały warunki wynikowy kod.</span><span class="sxs-lookup"><span data-stu-id="60500-285">TDD is an iterative coding practice where you first write the tests that your resulting code will satisfy.</span></span> <span data-ttu-id="60500-286">Z TDD rozpoczęciem każdej funkcji, tworząc test, który sprawdza, czy funkcje, które zamierzasz wdrożyć.</span><span class="sxs-lookup"><span data-stu-id="60500-286">With TDD you begin each feature by creating a test that verifies the functionality you are about to implement.</span></span> <span data-ttu-id="60500-287">Pisanie jednostki test ułatwia najpierw upewnij się, że wyraźnie rozumiesz funkcji i jak powinien pracować.</span><span class="sxs-lookup"><span data-stu-id="60500-287">Writing the unit test first helps ensure that you clearly understand the feature and how it is supposed to work.</span></span> <span data-ttu-id="60500-288">Tylko po testu są zapisywane (i upewnieniu się, że nie jest on) czy, a następnie wdrożyć sprawdza rzeczywistej funkcji testu.</span><span class="sxs-lookup"><span data-stu-id="60500-288">Only after the test is written (and you have verified that it fails) do you then implement the actual functionality the test verifies.</span></span> <span data-ttu-id="60500-289">Ponieważ został już poświęconego czasu planowania jak funkcja powinien działać w przypadku użycia, trzeba będzie lepiej zrozumieć wymagania i jak najlepiej ich wdrażania.</span><span class="sxs-lookup"><span data-stu-id="60500-289">Because you've already spent time thinking about the use case of how the feature is supposed to work, you will have a better understanding of the requirements and how best to implement them.</span></span> <span data-ttu-id="60500-290">Po zakończeniu wdrożenia można ponownie uruchomić test — i natychmiast uzyskuje opinie, aby uzyskać Określa, czy ta funkcja działa prawidłowo.</span><span class="sxs-lookup"><span data-stu-id="60500-290">When you are done with the implementation you can re-run the test – and get immediate feedback as to whether the feature works correctly.</span></span> <span data-ttu-id="60500-291">Firma Microsoft będzie obejmować TDD więcej w rozdziale 10.</span><span class="sxs-lookup"><span data-stu-id="60500-291">We'll cover TDD more in Chapter 10.</span></span>

### <a name="next-step"></a><span data-ttu-id="60500-292">Następny krok</span><span class="sxs-lookup"><span data-stu-id="60500-292">Next Step</span></span>

<span data-ttu-id="60500-293">Niektóre końcowego zawijania komentarze.</span><span class="sxs-lookup"><span data-stu-id="60500-293">Some final wrap up comments.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="60500-294">[Poprzednie](use-ajax-to-implement-mapping-scenarios.md)
> [dalej](nerddinner-wrap-up.md)</span><span class="sxs-lookup"><span data-stu-id="60500-294">[Previous](use-ajax-to-implement-mapping-scenarios.md)
[Next](nerddinner-wrap-up.md)</span></span>
