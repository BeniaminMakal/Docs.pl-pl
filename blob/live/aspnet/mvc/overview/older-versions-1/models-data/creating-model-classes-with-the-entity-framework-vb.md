---
uid: mvc/overview/older-versions-1/models-data/creating-model-classes-with-the-entity-framework-vb
title: Tworzenie klasy modelu Entity Framework (VB) | Dokumentacja firmy Microsoft
author: microsoft
description: "W tym samouczku Dowiedz się jak używać programu ASP.NET MVC Microsoft Entity Framework. Jak utworzyć Da jednostki ADO.NET za pomocą kreatora jednostki..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 01/27/2009
ms.topic: article
ms.assetid: ff8322c9-12f3-4e24-aba6-a38046b9bb0d
ms.technology: dotnet-mvc
ms.prod: .net-framework
msc.legacyurl: /mvc/overview/older-versions-1/models-data/creating-model-classes-with-the-entity-framework-vb
msc.type: authoredcontent
ms.openlocfilehash: efc190d856fe9ebf1c09e0ae4758aabb1e3254dc
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 11/10/2017
---
<a name="creating-model-classes-with-the-entity-framework-vb"></a><span data-ttu-id="8716f-104">Tworzenie klasy modelu Entity Framework (VB)</span><span class="sxs-lookup"><span data-stu-id="8716f-104">Creating Model Classes with the Entity Framework (VB)</span></span>
====================
<span data-ttu-id="8716f-105">przez [firmy Microsoft](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="8716f-105">by [Microsoft](https://github.com/microsoft)</span></span>

> <span data-ttu-id="8716f-106">W tym samouczku Dowiedz się jak używać programu ASP.NET MVC Microsoft Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="8716f-106">In this tutorial, you learn how to use ASP.NET MVC with the Microsoft Entity Framework.</span></span> <span data-ttu-id="8716f-107">Jak używać Kreatora jednostki do tworzenia modelu danych jednostki ADO.NET.</span><span class="sxs-lookup"><span data-stu-id="8716f-107">You learn how to use the Entity Wizard to create an ADO.NET Entity Data Model.</span></span> <span data-ttu-id="8716f-108">W trakcie tego samouczka możemy utworzyć aplikacji sieci web, która ilustruje sposób Wybierz, wstawiania, aktualizowania i usuwania danych w bazie danych przy użyciu programu Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="8716f-108">Over the course of this tutorial, we build a web application that illustrates how to select, insert, update, and delete database data by using the Entity Framework.</span></span>


<span data-ttu-id="8716f-109">Celem tego samouczka jest opisano sposób tworzenia klas dostępu do danych za pomocą programu Microsoft Entity Framework, podczas tworzenia aplikacji platformy ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="8716f-109">The goal of this tutorial is to explain how you can create data access classes using the Microsoft Entity Framework when building an ASP.NET MVC application.</span></span> <span data-ttu-id="8716f-110">Ten samouczek zakłada nie wcześniejsza wiedza Microsoft Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="8716f-110">This tutorial assumes no previous knowledge of the Microsoft Entity Framework.</span></span> <span data-ttu-id="8716f-111">Na koniec tego samouczka będziesz zrozumienie, jak Entity Framework umożliwia wybranie, wstawianie, aktualizowanie i usuwanie rekordów bazy danych.</span><span class="sxs-lookup"><span data-stu-id="8716f-111">By the end of this tutorial, you'll understand how to use the Entity Framework to select, insert, update, and delete database records.</span></span>

<span data-ttu-id="8716f-112">Microsoft Entity Framework jest narzędziem obiektów relacyjnych mapowania (O/RM) umożliwia automatyczne generowanie Warstwa dostępu do danych z bazy danych.</span><span class="sxs-lookup"><span data-stu-id="8716f-112">The Microsoft Entity Framework is an Object Relational Mapping (O/RM) tool that enables you to generate a data access layer from a database automatically.</span></span> <span data-ttu-id="8716f-113">Entity Framework pozwala uniknąć konieczność ręcznego tworzenia klas dostępu do danych.</span><span class="sxs-lookup"><span data-stu-id="8716f-113">The Entity Framework enables you to avoid the tedious work of building your data access classes by hand.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="8716f-114">Brak istotnych połączenia między ASP.NET MVC i Microsoft Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="8716f-114">There is no essential connection between ASP.NET MVC and the Microsoft Entity Framework.</span></span> <span data-ttu-id="8716f-115">Istnieje kilka rozwiązań alternatywnych do narzędzia Entity Framework, korzystających z platformy ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="8716f-115">There are several alternatives to the Entity Framework that you can use with ASP.NET MVC.</span></span> <span data-ttu-id="8716f-116">Na przykład można tworzyć przy użyciu innych narzędzi O/RM, takich jak Microsoft LINQ to SQL, NHibernate lub SubSonic klasach modeli MVC.</span><span class="sxs-lookup"><span data-stu-id="8716f-116">For example, you can build your MVC Model classes using other O/RM tools such as Microsoft LINQ to SQL, NHibernate, or SubSonic.</span></span>


<span data-ttu-id="8716f-117">Aby zilustrować, jak za pomocą programu Entity Framework Microsoft ASP.NET MVC, firma Microsoft będzie Tworzenie prostego przykładowej aplikacji.</span><span class="sxs-lookup"><span data-stu-id="8716f-117">In order to illustrate how you can use the Microsoft Entity Framework with ASP.NET MVC, we'll build a simple sample application.</span></span> <span data-ttu-id="8716f-118">Utworzymy aplikację filmu bazy danych, która umożliwia wyświetlanie i edytowanie filmu rekordów bazy danych.</span><span class="sxs-lookup"><span data-stu-id="8716f-118">We'll create a Movie Database application that enables you to display and edit movie database records.</span></span>

<span data-ttu-id="8716f-119">Ten samouczek zakłada, że masz program Visual Studio 2008 lub Visual Web Developer 2008 z dodatkiem Service Pack 1.</span><span class="sxs-lookup"><span data-stu-id="8716f-119">This tutorial assumes that you have Visual Studio 2008 or Visual Web Developer 2008 with Service Pack 1.</span></span> <span data-ttu-id="8716f-120">Należy z dodatkiem Service Pack 1, aby można było używać programu Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="8716f-120">You need Service Pack 1 in order to use the Entity Framework.</span></span> <span data-ttu-id="8716f-121">Visual Studio 2008 z dodatkiem Service Pack 1 lub Visual Web Developer z dodatkiem Service Pack 1 można pobrać z następującego adresu:</span><span class="sxs-lookup"><span data-stu-id="8716f-121">You can download Visual Studio 2008 Service Pack 1 or Visual Web Developer with Service Pack 1 from the following address:</span></span>

> [<span data-ttu-id="8716f-122">https://www.asp.NET/downloads/</span><span class="sxs-lookup"><span data-stu-id="8716f-122">https://www.asp.net/downloads/</span></span>](https://www.asp.net/downloads)


## <a name="creating-the-movie-sample-database"></a><span data-ttu-id="8716f-123">Tworzenie przykładowej bazy danych film</span><span class="sxs-lookup"><span data-stu-id="8716f-123">Creating the Movie Sample Database</span></span>

<span data-ttu-id="8716f-124">Aplikacja filmu bazy danych korzysta z tabeli bazy danych o nazwie filmów, który zawiera następujące kolumny:</span><span class="sxs-lookup"><span data-stu-id="8716f-124">The Movie Database application uses a database table named Movies that contains the following columns:</span></span>

| <span data-ttu-id="8716f-125">Nazwa kolumny</span><span class="sxs-lookup"><span data-stu-id="8716f-125">Column Name</span></span> | <span data-ttu-id="8716f-126">Typ danych</span><span class="sxs-lookup"><span data-stu-id="8716f-126">Data Type</span></span> | <span data-ttu-id="8716f-127">Dopuszcza wartości null?</span><span class="sxs-lookup"><span data-stu-id="8716f-127">Allow Nulls?</span></span> | <span data-ttu-id="8716f-128">To jest klucz podstawowy?</span><span class="sxs-lookup"><span data-stu-id="8716f-128">Is Primary Key?</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="8716f-129">Identyfikator</span><span class="sxs-lookup"><span data-stu-id="8716f-129">Id</span></span> | <span data-ttu-id="8716f-130">int</span><span class="sxs-lookup"><span data-stu-id="8716f-130">int</span></span> | <span data-ttu-id="8716f-131">False</span><span class="sxs-lookup"><span data-stu-id="8716f-131">False</span></span> | <span data-ttu-id="8716f-132">Wartość true</span><span class="sxs-lookup"><span data-stu-id="8716f-132">True</span></span> |
| <span data-ttu-id="8716f-133">Tytuł</span><span class="sxs-lookup"><span data-stu-id="8716f-133">Title</span></span> | <span data-ttu-id="8716f-134">Nvarchar(100)</span><span class="sxs-lookup"><span data-stu-id="8716f-134">nvarchar(100)</span></span> | <span data-ttu-id="8716f-135">False</span><span class="sxs-lookup"><span data-stu-id="8716f-135">False</span></span> | <span data-ttu-id="8716f-136">False</span><span class="sxs-lookup"><span data-stu-id="8716f-136">False</span></span> |
| <span data-ttu-id="8716f-137">Dyrektor</span><span class="sxs-lookup"><span data-stu-id="8716f-137">Director</span></span> | <span data-ttu-id="8716f-138">Nvarchar(100)</span><span class="sxs-lookup"><span data-stu-id="8716f-138">nvarchar(100)</span></span> | <span data-ttu-id="8716f-139">False</span><span class="sxs-lookup"><span data-stu-id="8716f-139">False</span></span> | <span data-ttu-id="8716f-140">False</span><span class="sxs-lookup"><span data-stu-id="8716f-140">False</span></span> |

<span data-ttu-id="8716f-141">W tej tabeli można dodać do projektu programu ASP.NET MVC, wykonując następujące czynności:</span><span class="sxs-lookup"><span data-stu-id="8716f-141">You can add this table to an ASP.NET MVC project by following these steps:</span></span>

1. <span data-ttu-id="8716f-142">Kliknij prawym przyciskiem myszy aplikację\_folderu danych w oknie Eksploratora rozwiązań i wybierz opcję menu **Dodaj, nowy element.**</span><span class="sxs-lookup"><span data-stu-id="8716f-142">Right-click the App\_Data folder in the Solution Explorer window and select the menu option **Add, New Item.**</span></span>
2. <span data-ttu-id="8716f-143">Z **Dodaj nowy element** okno dialogowe, wybierz opcję **bazy danych programu SQL Server**, nazwę bazy danych MoviesDB.mdf i kliknij przycisk **Dodaj** przycisku.</span><span class="sxs-lookup"><span data-stu-id="8716f-143">From the **Add New Item** dialog box, select **SQL Server Database**, give the database the name MoviesDB.mdf, and click the **Add** button.</span></span>
3. <span data-ttu-id="8716f-144">Kliknij dwukrotnie plik MoviesDB.mdf, aby otworzyć okno Eksploratora Explorer/bazy danych serwera.</span><span class="sxs-lookup"><span data-stu-id="8716f-144">Double-click the MoviesDB.mdf file to open the Server Explorer/Database Explorer window.</span></span>
4. <span data-ttu-id="8716f-145">Rozwiń węzeł MoviesDB.mdf połączenie z bazą danych, kliknij prawym przyciskiem myszy folder Tabele i wybierz opcję menu **Dodaj nową tabelę**.</span><span class="sxs-lookup"><span data-stu-id="8716f-145">Expand the MoviesDB.mdf database connection, right-click the Tables folder, and select the menu option **Add New Table**.</span></span>
5. <span data-ttu-id="8716f-146">Przy użyciu projektanta tabeli Dodaj identyfikator, tytuł i dyrektora kolumny.</span><span class="sxs-lookup"><span data-stu-id="8716f-146">In the Table Designer, add the Id, Title, and Director columns.</span></span>
6. <span data-ttu-id="8716f-147">Kliknij przycisk **zapisać** przycisk (ma ikony dyskietek) aby zapisać nową tabelę z filmów nazwy.</span><span class="sxs-lookup"><span data-stu-id="8716f-147">Click the **Save** button (it has the icon of the floppy) to save the new table with the name Movies.</span></span>

<span data-ttu-id="8716f-148">Po utworzeniu filmów tabeli bazy danych, należy dodać przykładowych danych do tabeli.</span><span class="sxs-lookup"><span data-stu-id="8716f-148">After you create the Movies database table, you should add some sample data to the table.</span></span> <span data-ttu-id="8716f-149">Kliknij prawym przyciskiem myszy tabelę filmy i wybierz opcję menu **Pokaż dane tabeli**.</span><span class="sxs-lookup"><span data-stu-id="8716f-149">Right-click the Movies table and select the menu option **Show Table Data**.</span></span> <span data-ttu-id="8716f-150">Do siatki, którą można wprowadzić filmu fałszywych danych.</span><span class="sxs-lookup"><span data-stu-id="8716f-150">You can enter fake movie data into the grid that appears.</span></span>

## <a name="creating-the-adonet-entity-data-model"></a><span data-ttu-id="8716f-151">Tworzenie modelu danych jednostki ADO.NET</span><span class="sxs-lookup"><span data-stu-id="8716f-151">Creating the ADO.NET Entity Data Model</span></span>

<span data-ttu-id="8716f-152">Aby można było używać programu Entity Framework, musisz utworzyć modelu danych jednostki.</span><span class="sxs-lookup"><span data-stu-id="8716f-152">In order to use the Entity Framework, you need to create an Entity Data Model.</span></span> <span data-ttu-id="8716f-153">Możesz korzystać z programu Visual Studio *kreatora modelu danych jednostki* automatycznie wygenerowany modelu Entity Data Model z bazy danych.</span><span class="sxs-lookup"><span data-stu-id="8716f-153">You can take advantage of the Visual Studio *Entity Data Model Wizard* to generate an Entity Data Model from a database automatically.</span></span>

<span data-ttu-id="8716f-154">Wykonaj następujące kroki:</span><span class="sxs-lookup"><span data-stu-id="8716f-154">Follow these steps:</span></span>

1. <span data-ttu-id="8716f-155">Kliknij prawym przyciskiem myszy folder modeli w oknie Eksploratora rozwiązań i wybierz opcję menu **Dodaj, nowy element**.</span><span class="sxs-lookup"><span data-stu-id="8716f-155">Right-click the Models folder in the Solution Explorer window and select the menu option **Add, New Item**.</span></span>
2. <span data-ttu-id="8716f-156">W **Dodaj nowy element** okno dialogowe, wybierz kategorię danych (zobacz rysunek 1).</span><span class="sxs-lookup"><span data-stu-id="8716f-156">In the **Add New Item** dialog, select the Data category (see Figure 1).</span></span>
3. <span data-ttu-id="8716f-157">Wybierz **modelu danych jednostki ADO.NET** szablonie, nazwę modelu Entity Data Model MoviesDBModel.edmx, a następnie kliknij przycisk **Dodaj** przycisku.</span><span class="sxs-lookup"><span data-stu-id="8716f-157">Select the **ADO.NET Entity Data Model** template, give the Entity Data Model the name MoviesDBModel.edmx, and click the **Add** button.</span></span> <span data-ttu-id="8716f-158">Kliknięcie przycisku **Dodaj** przycisk uruchamia Kreatora modelu danych.</span><span class="sxs-lookup"><span data-stu-id="8716f-158">Clicking the **Add** button launches the Data Model Wizard.</span></span>
4. <span data-ttu-id="8716f-159">W **wybierz zawartość modelu** kroku, wybierz **generowania z bazy danych** opcję i kliknij przycisk **dalej** przycisk (patrz rysunek 2).</span><span class="sxs-lookup"><span data-stu-id="8716f-159">In the **Choose Model Contents** step, choose the **Generate from a database** option and click the **Next** button (see Figure 2).</span></span>
5. <span data-ttu-id="8716f-160">W **wybierz połączenie danych** krok, wybierz połączenie z bazą danych MoviesDB.mdf, wprowadź jednostek ustawienia połączenia nazwę MoviesDBEntities, a następnie kliknij przycisk **dalej** przycisk (patrz rysunek 3).</span><span class="sxs-lookup"><span data-stu-id="8716f-160">In the **Choose Your Data Connection** step, select the MoviesDB.mdf database connection, enter the entities connection settings name MoviesDBEntities, and click the **Next** button (see Figure 3).</span></span>
6. <span data-ttu-id="8716f-161">W **wybierz obiekty bazy danych użytkownika** kroku, wybierz film tabeli bazy danych i kliknij przycisk **Zakończ** przycisk (patrz rysunek 4).</span><span class="sxs-lookup"><span data-stu-id="8716f-161">In the **Choose Your Database Objects** step, select the Movie database table and click the **Finish** button (see Figure 4).</span></span>

<span data-ttu-id="8716f-162">Po wykonaniu tych kroków otwiera Projektant modelu danych jednostki ADO.NET (Entity Designer).</span><span class="sxs-lookup"><span data-stu-id="8716f-162">After you complete these steps, the ADO.NET Entity Data Model Designer (Entity Designer) opens.</span></span>

<span data-ttu-id="8716f-163">**Rysunek 1 — Tworzenie nowego modelu danych jednostki**</span><span class="sxs-lookup"><span data-stu-id="8716f-163">**Figure 1 – Creating a new Entity Data Model**</span></span>

![clip_image002](creating-model-classes-with-the-entity-framework-vb/_static/image1.jpg)

<span data-ttu-id="8716f-165">**Rysunek 2 — Wybierz Model zawartości kroku**</span><span class="sxs-lookup"><span data-stu-id="8716f-165">**Figure 2 – Choose Model Contents Step**</span></span>

![clip_image004](creating-model-classes-with-the-entity-framework-vb/_static/image2.jpg)

<span data-ttu-id="8716f-167">**Rysunek 3 – Wybierz połączenie danych**</span><span class="sxs-lookup"><span data-stu-id="8716f-167">**Figure 3 – Choose Your Data Connection**</span></span>

![clip_image006](creating-model-classes-with-the-entity-framework-vb/_static/image3.jpg)

<span data-ttu-id="8716f-169">**Rysunek 4 — Wybierz obiekty bazy danych**</span><span class="sxs-lookup"><span data-stu-id="8716f-169">**Figure 4 – Choose Your Database Objects**</span></span>

![clip_image008](creating-model-classes-with-the-entity-framework-vb/_static/image4.jpg)

## <a name="modifying-the-adonet-entity-data-model"></a><span data-ttu-id="8716f-171">Modyfikowanie modelu danych jednostki ADO.NET</span><span class="sxs-lookup"><span data-stu-id="8716f-171">Modifying the ADO.NET Entity Data Model</span></span>

<span data-ttu-id="8716f-172">Po utworzeniu modelu danych jednostki, można zmodyfikować modelu dzięki wykorzystaniu Entity Designer (patrz rysunek 5).</span><span class="sxs-lookup"><span data-stu-id="8716f-172">After you create an Entity Data Model, you can modify the model by taking advantage of the Entity Designer (see Figure 5).</span></span> <span data-ttu-id="8716f-173">Program Entity Designer można otworzyć w dowolnym momencie, klikając dwukrotnie plik MoviesDBModel.edmx znajdujące się w folderze modeli w oknie Eksploratora rozwiązań.</span><span class="sxs-lookup"><span data-stu-id="8716f-173">You can open the Entity Designer at any time by double-clicking the MoviesDBModel.edmx file contained in the Models folder within the Solution Explorer window.</span></span>

<span data-ttu-id="8716f-174">**Rysunek 5 — Projektant modelu danych jednostki ADO.NET**</span><span class="sxs-lookup"><span data-stu-id="8716f-174">**Figure 5 – The ADO.NET Entity Data Model Designer**</span></span>

![clip_image010](creating-model-classes-with-the-entity-framework-vb/_static/image5.jpg)

<span data-ttu-id="8716f-176">Na przykład służy program Entity Designer zmiana nazw klas, generowane przez kreatora Entity Model danych.</span><span class="sxs-lookup"><span data-stu-id="8716f-176">For example, you can use the Entity Designer to change the names of the classes that the Entity Model Data Wizard generates.</span></span> <span data-ttu-id="8716f-177">Kreator utworzyć nową klasę dostępu do danych o nazwie filmów.</span><span class="sxs-lookup"><span data-stu-id="8716f-177">The Wizard created a new data access class named Movies.</span></span> <span data-ttu-id="8716f-178">Innymi słowy Kreator udzielił klasy bardzo samą nazwę jak tabeli bazy danych.</span><span class="sxs-lookup"><span data-stu-id="8716f-178">In other words, the Wizard gave the class the very same name as the database table.</span></span> <span data-ttu-id="8716f-179">Ponieważ klasa będzie używana do reprezentowania konkretnego wystąpienia film, możemy zmienić nazwy klasy filmy film.</span><span class="sxs-lookup"><span data-stu-id="8716f-179">Because we will use this class to represent a particular Movie instance, we should rename the class from Movies to Movie.</span></span>

<span data-ttu-id="8716f-180">Jeśli chcesz zmienić nazwę klasy jednostki można kliknij dwukrotnie nazwę klasy w programie Entity Designer i wprowadź nową nazwę (patrz rysunek 6).</span><span class="sxs-lookup"><span data-stu-id="8716f-180">If you want to rename an entity class, you can double-click on the class name in the Entity Designer and enter a new name (see Figure 6).</span></span> <span data-ttu-id="8716f-181">Alternatywnie można zmienić nazwę jednostki w oknie właściwości po wybraniu jednostki w programie Entity Designer.</span><span class="sxs-lookup"><span data-stu-id="8716f-181">Alternatively, you can change the name of an entity in the Properties window after selecting an entity in the Entity Designer.</span></span>

<span data-ttu-id="8716f-182">**Rysunek 6 — zmiana nazwy podmiotu**</span><span class="sxs-lookup"><span data-stu-id="8716f-182">**Figure 6 – Changing an entity name**</span></span>

![clip_image012](creating-model-classes-with-the-entity-framework-vb/_static/image6.jpg)

<span data-ttu-id="8716f-184">Pamiętaj, aby zapisać modelu Entity Data Model po wprowadzeniu zmiany przez kliknięcie przycisku Zapisz (ikona dyskietki).</span><span class="sxs-lookup"><span data-stu-id="8716f-184">Remember to save your Entity Data Model after making a modification by clicking the Save button (the icon of the floppy disk).</span></span> <span data-ttu-id="8716f-185">W tle przez program Entity Designer generuje zestaw klas Visual Basic .NET.</span><span class="sxs-lookup"><span data-stu-id="8716f-185">Behind the scenes, the Entity Designer generates a set of Visual Basic .NET classes.</span></span> <span data-ttu-id="8716f-186">Te klasy można wyświetlić, otwierając plik MoviesDBModel.Designer.vb z okna Eksploratora rozwiązań.</span><span class="sxs-lookup"><span data-stu-id="8716f-186">You can view these classes by opening the MoviesDBModel.Designer.vb file from the Solution Explorer window.</span></span>


<span data-ttu-id="8716f-187">Nie należy modyfikować kod w pliku Designer.vb, ponieważ zmiany zostaną zastąpione podczas następnego Użyj Projektanta obiektów.</span><span class="sxs-lookup"><span data-stu-id="8716f-187">Don't modify the code in the Designer.vb file since your changes will be overwritten the next time you use the Entity Designer.</span></span> <span data-ttu-id="8716f-188">Jeśli chcesz rozszerzyć funkcjonalność klas jednostek zdefiniowanych w pliku Designer.vb, można utworzyć *klasy częściowe* w oddzielnych plikach.</span><span class="sxs-lookup"><span data-stu-id="8716f-188">If you want to extend the functionality of the entity classes defined in the Designer.vb file then you can create *partial classes* in separate files.</span></span>


#### <a name="selecting-database-records-with-the-entity-framework"></a><span data-ttu-id="8716f-189">Wybieranie rekordów bazy danych z programu Entity Framework</span><span class="sxs-lookup"><span data-stu-id="8716f-189">Selecting Database Records with the Entity Framework</span></span>

<span data-ttu-id="8716f-190">Zacznijmy tworzenia aplikacji filmu bazy danych, tworząc strona, wyświetlająca listę rekordów filmu.</span><span class="sxs-lookup"><span data-stu-id="8716f-190">Let's start building our Movie Database application by creating a page that displays a list of movie records.</span></span> <span data-ttu-id="8716f-191">Kontroler głównej w 1 lista przedstawia akcji o nazwie indeks().</span><span class="sxs-lookup"><span data-stu-id="8716f-191">The Home controller in Listing 1 exposes an action named Index().</span></span> <span data-ttu-id="8716f-192">Akcja indeks() zwraca wszystkie rekordy film z tabeli bazy danych film korzystając z programu Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="8716f-192">The Index() action returns all of the movie records from the Movie database table by taking advantage of the Entity Framework.</span></span>

<span data-ttu-id="8716f-193">**Wyświetlanie listy 1 – Controllers\HomeController.vb**</span><span class="sxs-lookup"><span data-stu-id="8716f-193">**Listing 1 – Controllers\HomeController.vb**</span></span>

[!code-vb[Main](creating-model-classes-with-the-entity-framework-vb/samples/sample1.vb)]

<span data-ttu-id="8716f-194">Zwróć uwagę, że kontroler w 1 Lista zawiera konstruktora.</span><span class="sxs-lookup"><span data-stu-id="8716f-194">Notice that the controller in Listing 1 includes a constructor.</span></span> <span data-ttu-id="8716f-195">Konstruktor inicjuje pola poziomie klasy o nazwie \_bazy danych.</span><span class="sxs-lookup"><span data-stu-id="8716f-195">The constructor initializes a class-level field named \_db.</span></span> <span data-ttu-id="8716f-196">\_Reprezentuje pole db jednostki bazy danych wygenerowanych przez program Microsoft Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="8716f-196">The \_db field represents the database entities generated by the Microsoft Entity Framework.</span></span> <span data-ttu-id="8716f-197">\_Pole bazy danych jest wystąpienie klasy MoviesDBEntities, który został wygenerowany przez program Entity Designer.</span><span class="sxs-lookup"><span data-stu-id="8716f-197">The \_db field is an instance of the MoviesDBEntities class that was generated by the Entity Designer.</span></span>

<span data-ttu-id="8716f-198">\_Pole bazy danych jest używany w akcji indeks() pobrać rekordy z tabeli bazy danych filmów.</span><span class="sxs-lookup"><span data-stu-id="8716f-198">The \_db field is used within the Index() action to retrieve the records from the Movies database table.</span></span> <span data-ttu-id="8716f-199">Wyrażenie \_bazy danych. MovieSet reprezentuje wszystkie rekordy z tabeli filmy bazy danych.</span><span class="sxs-lookup"><span data-stu-id="8716f-199">The expression \_db.MovieSet represents all of the records from the Movies database table.</span></span> <span data-ttu-id="8716f-200">Metoda ToList() służy do konwertowania zbiór filmów w ogólnej kolekcji obiektów film: Lista (film z).</span><span class="sxs-lookup"><span data-stu-id="8716f-200">The ToList() method is used to convert the set of movies into a generic collection of Movie objects: List( Of Movie).</span></span>

<span data-ttu-id="8716f-201">Rejestruje filmu są pobierane za pomocą LINQ to Entities.</span><span class="sxs-lookup"><span data-stu-id="8716f-201">The movie records are retrieved with the help of LINQ to Entities.</span></span> <span data-ttu-id="8716f-202">Akcja indeks() wyświetlania 1 używa LINQ *składni metody* można pobrać zestaw rekordów bazy danych.</span><span class="sxs-lookup"><span data-stu-id="8716f-202">The Index() action in Listing 1 uses LINQ *method syntax* to retrieve the set of database records.</span></span> <span data-ttu-id="8716f-203">Jeśli wolisz, możesz użyć LINQ *Składnia kwerendy* zamiast tego.</span><span class="sxs-lookup"><span data-stu-id="8716f-203">If you prefer, you can use LINQ *query syntax* instead.</span></span> <span data-ttu-id="8716f-204">Poniższe instrukcje dwóch wykonaj bardzo samo:</span><span class="sxs-lookup"><span data-stu-id="8716f-204">The following two statements do the very same thing:</span></span>

[!code-vb[Main](creating-model-classes-with-the-entity-framework-vb/samples/sample2.vb)]

<span data-ttu-id="8716f-205">Użyj niezależnie od składni LINQ — składnia metody lub składnia zapytania —, który można znaleźć najbardziej intuicyjnego.</span><span class="sxs-lookup"><span data-stu-id="8716f-205">Use whichever LINQ syntax – method syntax or query syntax – that you find most intuitive.</span></span> <span data-ttu-id="8716f-206">Nie ma różnic w wydajności między dwa podejścia — jedyna różnica polega na styl.</span><span class="sxs-lookup"><span data-stu-id="8716f-206">There is no difference in performance between the two approaches – the only difference is style.</span></span>

<span data-ttu-id="8716f-207">Widok wyświetlania 2 służy do wyświetlania rekordów filmu.</span><span class="sxs-lookup"><span data-stu-id="8716f-207">The view in Listing 2 is used to display the movie records.</span></span>

<span data-ttu-id="8716f-208">**Wyświetlanie listy 2 — Views\Home\Index.aspx**</span><span class="sxs-lookup"><span data-stu-id="8716f-208">**Listing 2 – Views\Home\Index.aspx**</span></span>

[!code-aspx[Main](creating-model-classes-with-the-entity-framework-vb/samples/sample3.aspx)]

<span data-ttu-id="8716f-209">Widok wyświetlania 2 zawiera **dla każdego** pętli, który iteruje każdego rekordu filmu i wyświetla wartości właściwości Title i dyrektora rekordu filmu.</span><span class="sxs-lookup"><span data-stu-id="8716f-209">The view in Listing 2 contains a **For Each** loop that iterates through each movie record and displays the values of the movie record's Title and Director properties.</span></span> <span data-ttu-id="8716f-210">Należy zauważyć, że edytowanie i usuwanie link jest wyświetlany obok każdego rekordu.</span><span class="sxs-lookup"><span data-stu-id="8716f-210">Notice that an Edit and Delete link is displayed next to each record.</span></span> <span data-ttu-id="8716f-211">Ponadto łącze Dodaj film jest wyświetlane w dolnej części widoku (patrz rysunek 7).</span><span class="sxs-lookup"><span data-stu-id="8716f-211">Furthermore, an Add Movie link appears at the bottom of the view (see Figure 7).</span></span>

<span data-ttu-id="8716f-212">**Rysunek 7 — widok indeksu**</span><span class="sxs-lookup"><span data-stu-id="8716f-212">**Figure 7 – The Index view**</span></span>

![clip_image014](creating-model-classes-with-the-entity-framework-vb/_static/image7.jpg)

<span data-ttu-id="8716f-214">Widok indeksu jest *widoku wpisanych*.</span><span class="sxs-lookup"><span data-stu-id="8716f-214">The Index view is a *typed view*.</span></span> <span data-ttu-id="8716f-215">Widok indeksu ma &lt;% @ strony %&gt; dyrektywy, który zawiera atrybut Inherits.</span><span class="sxs-lookup"><span data-stu-id="8716f-215">The Index view has a &lt;%@ Page %&gt; directive that includes an Inherits attribute.</span></span> <span data-ttu-id="8716f-216">Atrybut Inherits rzutuje właściwość ViewData.Model jednoznacznie ogólnej listy kolekcji obiektów filmu — lista (film z).</span><span class="sxs-lookup"><span data-stu-id="8716f-216">The Inherits attribute casts the ViewData.Model property to a strongly typed generic List collection of Movie objects – a List(Of Movie).</span></span>

## <a name="inserting-database-records-with-the-entity-framework"></a><span data-ttu-id="8716f-217">Wstawianie rekordów bazy danych z programu Entity Framework</span><span class="sxs-lookup"><span data-stu-id="8716f-217">Inserting Database Records with the Entity Framework</span></span>

<span data-ttu-id="8716f-218">Aby ułatwić wstawianie nowych rekordów do tabeli bazy danych, można użyć programu Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="8716f-218">You can use the Entity Framework to make it easy to insert new records into a database table.</span></span> <span data-ttu-id="8716f-219">Wyświetlanie listy 3 zawiera dwa nowe akcje dodany do klasy kontrolera głównej, która umożliwia wstawianie nowych rekordów do filmu tabeli bazy danych.</span><span class="sxs-lookup"><span data-stu-id="8716f-219">Listing 3 contains two new actions added to the Home controller class that you can use to insert new records into the Movie database table.</span></span>

<span data-ttu-id="8716f-220">**Wyświetlanie listy 3 – Controllers\HomeController.vb (Dodaj metody)**</span><span class="sxs-lookup"><span data-stu-id="8716f-220">**Listing 3 – Controllers\HomeController.vb (Add methods)**</span></span>

[!code-vb[Main](creating-model-classes-with-the-entity-framework-vb/samples/sample4.vb)]

<span data-ttu-id="8716f-221">Pierwszą akcją Add() po prostu zwraca widok.</span><span class="sxs-lookup"><span data-stu-id="8716f-221">The first Add() action simply returns a view.</span></span> <span data-ttu-id="8716f-222">Widok zawiera formularz służący do dodawania nowej bazy danych filmu rekordów (patrz rysunek 8).</span><span class="sxs-lookup"><span data-stu-id="8716f-222">The view contains a form for adding a new movie database record (see Figure 8).</span></span> <span data-ttu-id="8716f-223">Po przesłaniu formularza jest wywoływany drugiej akcji Add().</span><span class="sxs-lookup"><span data-stu-id="8716f-223">When you submit the form, the second Add() action is invoked.</span></span>

<span data-ttu-id="8716f-224">Zwróć uwagę, że drugiej akcji Add() zostanie nadany atrybut AcceptVerbs.</span><span class="sxs-lookup"><span data-stu-id="8716f-224">Notice that the second Add() action is decorated with the AcceptVerbs attribute.</span></span> <span data-ttu-id="8716f-225">Ta akcja może być wywoływany tylko w przypadku wykonywania operacji POST protokołu HTTP.</span><span class="sxs-lookup"><span data-stu-id="8716f-225">This action can be invoked only when performing an HTTP POST operation.</span></span> <span data-ttu-id="8716f-226">Innymi słowy ta akcja może być wywoływany tylko zaksięgowania formularza HTML.</span><span class="sxs-lookup"><span data-stu-id="8716f-226">In other words, this action can only be invoked when posting an HTML form.</span></span>

<span data-ttu-id="8716f-227">Drugiej akcji Add() tworzy nowe wystąpienie klasy Entity Framework filmu przy pomocy metody ASP.NET MVC TryUpdateModel().</span><span class="sxs-lookup"><span data-stu-id="8716f-227">The second Add() action creates a new instance of the Entity Framework Movie class with the help of the ASP.NET MVC TryUpdateModel() method.</span></span> <span data-ttu-id="8716f-228">Metoda TryUpdateModel() pobiera pola FormCollection przekazany do metody Add() i przypisuje wartości tych pól formularza HTML do klasy filmu.</span><span class="sxs-lookup"><span data-stu-id="8716f-228">The TryUpdateModel() method takes the fields in the FormCollection passed to the Add() method and assigns the values of these HTML form fields to the Movie class.</span></span>


<span data-ttu-id="8716f-229">Podczas korzystania z programu Entity Framework, należy podać "białą listę" właściwości podczas przy użyciu metod TryUpdateModel lub UpdateModel, aby zaktualizować właściwości klasy jednostka.</span><span class="sxs-lookup"><span data-stu-id="8716f-229">When using the Entity Framework, you must supply a "white list" of properties when using the TryUpdateModel or UpdateModel methods to update the properties of an entity class.</span></span>


<span data-ttu-id="8716f-230">Następnie akcji Add() sprawdza poprawność niektórych prostych.</span><span class="sxs-lookup"><span data-stu-id="8716f-230">Next, the Add() action performs some simple form validation.</span></span> <span data-ttu-id="8716f-231">Akcja sprawdza, czy tytuł i dyrektora właściwości mają wartości.</span><span class="sxs-lookup"><span data-stu-id="8716f-231">The action verifies that both the Title and Director properties have values.</span></span> <span data-ttu-id="8716f-232">W przypadku błędu sprawdzania poprawności, komunikat o błędzie weryfikacji jest dodawany do ModelState.</span><span class="sxs-lookup"><span data-stu-id="8716f-232">If there is a validation error, then a validation error message is added to ModelState.</span></span>

<span data-ttu-id="8716f-233">Jeśli nie ma żadnych błędów sprawdzania poprawności nowego rekordu film jest dodawany do filmy tabeli bazy danych za pomocą programu Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="8716f-233">If there are no validation errors then a new movie record is added to the Movies database table with the help of the Entity Framework.</span></span> <span data-ttu-id="8716f-234">Nowy rekord został dodany do bazy danych z następujących dwóch wierszy kodu:</span><span class="sxs-lookup"><span data-stu-id="8716f-234">The new record is added to the database with the following two lines of code:</span></span>

[!code-vb[Main](creating-model-classes-with-the-entity-framework-vb/samples/sample5.vb)]

<span data-ttu-id="8716f-235">Pierwszy wiersz kodu dodaje nową jednostkę filmu do zestawu filmy śledzony przez program Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="8716f-235">The first line of code adds the new Movie entity to the set of movies being tracked by the Entity Framework.</span></span> <span data-ttu-id="8716f-236">Drugi wiersz kodu zapisuje, niezależnie od zmian wprowadzono filmy śledzone do podstawowej bazy danych.</span><span class="sxs-lookup"><span data-stu-id="8716f-236">The second line of code saves whatever changes have been made to the Movies being tracked back to the underlying database.</span></span>

<span data-ttu-id="8716f-237">**Rysunek 8 — Dodaj widok**</span><span class="sxs-lookup"><span data-stu-id="8716f-237">**Figure 8 – The Add view**</span></span>

![clip_image016](creating-model-classes-with-the-entity-framework-vb/_static/image8.jpg)

## <a name="updating-database-records-with-the-entity-framework"></a><span data-ttu-id="8716f-239">Aktualizowanie rekordów bazy danych z programu Entity Framework</span><span class="sxs-lookup"><span data-stu-id="8716f-239">Updating Database Records with the Entity Framework</span></span>

<span data-ttu-id="8716f-240">Można wykonać prawie te same podejście, aby edytować rekord bazy danych z programu Entity Framework jako podejście, która była tylko do wstawienia nowego rekordu bazy danych.</span><span class="sxs-lookup"><span data-stu-id="8716f-240">You can follow almost the same approach to edit a database record with the Entity Framework as the approach that we just followed to insert a new database record.</span></span> <span data-ttu-id="8716f-241">Wyświetlanie listy 4 zawiera dwa nowe akcje kontrolera o nazwie Edit().</span><span class="sxs-lookup"><span data-stu-id="8716f-241">Listing 4 contains two new controller actions named Edit().</span></span> <span data-ttu-id="8716f-242">Pierwszą akcją Edit() zwraca formularza HTML do edytowania rekordu filmu.</span><span class="sxs-lookup"><span data-stu-id="8716f-242">The first Edit() action returns an HTML form for editing a movie record.</span></span> <span data-ttu-id="8716f-243">Drugiej akcji Edit() próbuje zaktualizować bazę danych.</span><span class="sxs-lookup"><span data-stu-id="8716f-243">The second Edit() action attempts to update the database.</span></span>

<span data-ttu-id="8716f-244">**Wyświetlanie listy 4 — Controllers\HomeController.vb (Edycja metody)**</span><span class="sxs-lookup"><span data-stu-id="8716f-244">**Listing 4 – Controllers\HomeController.vb (Edit methods)**</span></span>

[!code-vb[Main](creating-model-classes-with-the-entity-framework-vb/samples/sample6.vb)]

<span data-ttu-id="8716f-245">Uruchamia drugiej akcji Edit() pobierając filmu rekordu z bazy danych, który jest zgodny z identyfikatorem filmu edytowany.</span><span class="sxs-lookup"><span data-stu-id="8716f-245">The second Edit() action starts by retrieving the Movie record from the database that matches the Id of the movie being edited.</span></span> <span data-ttu-id="8716f-246">Następujące składnika LINQ to Entities instrukcji grabs pierwszy rekord bazy danych, zgodny z określonym identyfikatorem:</span><span class="sxs-lookup"><span data-stu-id="8716f-246">The following LINQ to Entities statement grabs the first database record that matches a particular Id:</span></span>

[!code-vb[Main](creating-model-classes-with-the-entity-framework-vb/samples/sample7.vb)]

<span data-ttu-id="8716f-247">Następnie metoda TryUpdateModel() jest używana do przypisywania wartości pola formularza HTML do właściwości elementu entity filmu.</span><span class="sxs-lookup"><span data-stu-id="8716f-247">Next, the TryUpdateModel() method is used to assign the values of the HTML form fields to the properties of the movie entity.</span></span> <span data-ttu-id="8716f-248">Zwróć uwagę, czy białą listę jest dostarczany do określenia dokładnej właściwości do zaktualizowania.</span><span class="sxs-lookup"><span data-stu-id="8716f-248">Notice that a white list is supplied to specify the exact properties to update.</span></span>

<span data-ttu-id="8716f-249">Następnie niektóre proste weryfikacji można sprawdzić, czy tytuł filmu i dyrektora właściwości mają wartości.</span><span class="sxs-lookup"><span data-stu-id="8716f-249">Next, some simple validation is performed to verify that both the Movie Title and Director properties have values.</span></span> <span data-ttu-id="8716f-250">Jeśli właściwość albo brakuje wartości, komunikat o błędzie weryfikacji jest dodawany do ModelState i ModelState.IsValid zwraca wartość false.</span><span class="sxs-lookup"><span data-stu-id="8716f-250">If either property is missing a value, then a validation error message is added to ModelState and ModelState.IsValid returns the value false.</span></span>

<span data-ttu-id="8716f-251">Ponadto jeśli nie ma żadnych błędów sprawdzania poprawności, następnie tabeli podstawowej bazy danych filmy zostało zaktualizowane o zmianach, wywołując metodę SaveChanges().</span><span class="sxs-lookup"><span data-stu-id="8716f-251">Finally, if there are no validation errors, then the underlying Movies database table is updated with any changes by calling the SaveChanges() method.</span></span>

<span data-ttu-id="8716f-252">Podczas edytowania rekordów bazy danych, musisz przekazać właściwości Id rekordu edytowany do akcji kontrolera, który wykonuje aktualizacji bazy danych.</span><span class="sxs-lookup"><span data-stu-id="8716f-252">When editing database records, you need to pass the Id of the record being edited to the controller action that performs the database update.</span></span> <span data-ttu-id="8716f-253">W przeciwnym razie akcji kontrolera nie będzie wiedzieć, który rekordów do aktualizacji w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="8716f-253">Otherwise, the controller action will not know which record to update in the underlying database.</span></span> <span data-ttu-id="8716f-254">Widok edycji, zawiera listę 5 zawiera ukryte pole formularza reprezentujący identyfikator edytowanego rekordu bazy danych.</span><span class="sxs-lookup"><span data-stu-id="8716f-254">The Edit view, contained in Listing 5, includes a hidden form field that represents the Id of the database record being edited.</span></span>

<span data-ttu-id="8716f-255">**Wyświetlanie listy 5 — Views\Home\Edit.aspx**</span><span class="sxs-lookup"><span data-stu-id="8716f-255">**Listing 5 – Views\Home\Edit.aspx**</span></span>

[!code-aspx[Main](creating-model-classes-with-the-entity-framework-vb/samples/sample8.aspx)]

## <a name="deleting-database-records-with-the-entity-framework"></a><span data-ttu-id="8716f-256">Usuwanie rekordów bazy danych z programu Entity Framework</span><span class="sxs-lookup"><span data-stu-id="8716f-256">Deleting Database Records with the Entity Framework</span></span>

<span data-ttu-id="8716f-257">Operacja końcowego bazy danych, która potrzebne do rozwiązania problemu w tym samouczku, jest usunięcie rekordów bazy danych.</span><span class="sxs-lookup"><span data-stu-id="8716f-257">The final database operation, which we need to tackle in this tutorial, is deleting database records.</span></span> <span data-ttu-id="8716f-258">Akcji kontrolera wyświetlania 6 służy do usuwania rekordu określonej bazy danych.</span><span class="sxs-lookup"><span data-stu-id="8716f-258">You can use the controller action in Listing 6 to delete a particular database record.</span></span>

<span data-ttu-id="8716f-259">**Wyświetlanie listy 6 — \Controllers\HomeController.vb (Akcja usuwania)**</span><span class="sxs-lookup"><span data-stu-id="8716f-259">**Listing 6 -- \Controllers\HomeController.vb (Delete action)**</span></span>

[!code-vb[Main](creating-model-classes-with-the-entity-framework-vb/samples/sample9.vb)]

<span data-ttu-id="8716f-260">Akcja Delete() najpierw pobiera filmu jednostki, który jest zgodny z identyfikatorem przekazany do akcji.</span><span class="sxs-lookup"><span data-stu-id="8716f-260">The Delete() action first retrieves the Movie entity that matches the Id passed to the action.</span></span> <span data-ttu-id="8716f-261">Następnie filmu został usunięty z bazy danych przez wywołanie metody DeleteObject() następuje metody SaveChanges().</span><span class="sxs-lookup"><span data-stu-id="8716f-261">Next, the movie is deleted from the database by calling the DeleteObject() method followed by the SaveChanges() method.</span></span> <span data-ttu-id="8716f-262">Na koniec zostanie przekierowany użytkownik w powrót do widoku indeksu.</span><span class="sxs-lookup"><span data-stu-id="8716f-262">Finally, the user is redirected back to the Index view.</span></span>

## <a name="summary"></a><span data-ttu-id="8716f-263">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="8716f-263">Summary</span></span>

<span data-ttu-id="8716f-264">Celem tego samouczka było pokazują, jak można tworzyć aplikacje opartej na bazie danych w sieci web dzięki wykorzystaniu ASP.NET MVC i Microsoft Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="8716f-264">The purpose of this tutorial was to demonstrate how you can build database-driven web applications by taking advantage of ASP.NET MVC and the Microsoft Entity Framework.</span></span> <span data-ttu-id="8716f-265">Przedstawiono sposób tworzenia aplikacji, która umożliwia wybranie, wstawianie, aktualizowanie i usuwanie rekordów bazy danych.</span><span class="sxs-lookup"><span data-stu-id="8716f-265">You learned how to build an application that enables you to select, insert, update, and delete database records.</span></span>

<span data-ttu-id="8716f-266">Po pierwsze omówiono, jak można użyć Kreatora modelu danych jednostki do wygenerowania modelu Entity Data Model z poziomu programu Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="8716f-266">First, we discussed how you can use the Entity Data Model Wizard to generate an Entity Data Model from within Visual Studio.</span></span> <span data-ttu-id="8716f-267">Następnie zostanie przedstawiony sposób Pobierz zestaw rekordów bazy danych z tabeli bazy danych za pomocą LINQ to Entities.</span><span class="sxs-lookup"><span data-stu-id="8716f-267">Next, you learn how to use LINQ to Entities to retrieve a set of database records from a database table.</span></span> <span data-ttu-id="8716f-268">Na koniec użyliśmy programu Entity Framework do wstawiania, aktualizacji i usuwania rekordów bazy danych.</span><span class="sxs-lookup"><span data-stu-id="8716f-268">Finally, we used the Entity Framework to insert, update, and delete database records.</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="8716f-269">[Poprzednie](validation-with-the-data-annotation-validators-cs.md)
[dalej](creating-model-classes-with-linq-to-sql-vb.md)</span><span class="sxs-lookup"><span data-stu-id="8716f-269">[Previous](validation-with-the-data-annotation-validators-cs.md)
[Next](creating-model-classes-with-linq-to-sql-vb.md)</span></span>
