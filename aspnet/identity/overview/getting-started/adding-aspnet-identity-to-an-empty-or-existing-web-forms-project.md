---
uid: identity/overview/getting-started/adding-aspnet-identity-to-an-empty-or-existing-web-forms-project
title: Dodawanie produktu ASP.NET Identity do pustego lub istniejącego sieci Web Forms projektu | Dokumentacja firmy Microsoft
author: raquelsa
description: W tym samouczku przedstawiono sposób dodawania produktu ASP.NET Identity (nowy system członkostwa programu ASP.NET) do aplikacji ASP.NET. Podczas tworzenia nowych formularzy sieci Web lub MVC...
ms.author: riande
ms.date: 10/23/2013
ms.assetid: 1cbc0ed2-5bd6-4b62-8d34-4c193dcd8b25
msc.legacyurl: /identity/overview/getting-started/adding-aspnet-identity-to-an-empty-or-existing-web-forms-project
msc.type: authoredcontent
ms.openlocfilehash: 229d6fef5aa9c2384b6d92ec3e3ed7316b69afe0
ms.sourcegitcommit: 45ac74e400f9f2b7dbded66297730f6f14a4eb25
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 08/16/2018
ms.locfileid: "41755777"
---
<a name="adding-aspnet-identity-to-an-empty-or-existing-web-forms-project"></a><span data-ttu-id="daf99-104">Dodawanie produktu ASP.NET Identity do pustego lub istniejącego sieci Web Forms projektu</span><span class="sxs-lookup"><span data-stu-id="daf99-104">Adding ASP.NET Identity to an Empty or Existing Web Forms Project</span></span>
====================
<span data-ttu-id="daf99-105">przez [Raquel Soares De Almeida](https://github.com/raquelsa)</span><span class="sxs-lookup"><span data-stu-id="daf99-105">by [Raquel Soares De Almeida](https://github.com/raquelsa)</span></span>

> <span data-ttu-id="daf99-106">W tym samouczku przedstawiono sposób dodawania [produktu ASP.NET Identity](introduction-to-aspnet-identity.md) (nowy system członkostwa programu ASP.NET) do aplikacji ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="daf99-106">This tutorial shows you how to add [ASP.NET Identity](introduction-to-aspnet-identity.md) (the new membership system for ASP.NET) to an ASP.NET application.</span></span>
> 
> <span data-ttu-id="daf99-107">Po utworzeniu nowego projektu formularzy sieci Web lub MVC w programie Visual Studio 2013 RTM za pomocą indywidualnych kont programu Visual Studio zainstalujesz wymagane pakiety i Dodaj wszystkie klasy niezbędne dla Ciebie.</span><span class="sxs-lookup"><span data-stu-id="daf99-107">When you create a new Web Forms or MVC project in Visual Studio 2013 RTM with Individual Accounts, Visual Studio will install all the required packages and add all necessary classes for you.</span></span> <span data-ttu-id="daf99-108">Ten samouczek przedstawia kroki Aby dodać obsługę produktu ASP.NET Identity do istniejącego projektu formularzy sieci Web lub nowy pusty projekt.</span><span class="sxs-lookup"><span data-stu-id="daf99-108">This tutorial will illustrate the steps to add ASP.NET Identity support to your existing Web Forms project or a new empty project.</span></span> <span data-ttu-id="daf99-109">Czy mogę opisują wszystkich pakietów NuGet, które należy zainstalować i klas, które należy dodać.</span><span class="sxs-lookup"><span data-stu-id="daf99-109">I will outline all the NuGet packages you need to install, and classes you need to add.</span></span> <span data-ttu-id="daf99-110">Będzie go za pośrednictwem formularzy sieci Web przykładowej rejestrowania nowych użytkowników i logowania podczas wyróżniania wszystkie interfejsy API punkt wejścia głównego do zarządzania użytkownikami i uwierzytelniania.</span><span class="sxs-lookup"><span data-stu-id="daf99-110">I will go over sample Web Forms for registering new users and logging in while highlighting all main entry point APIs for user management and authentication.</span></span> <span data-ttu-id="daf99-111">W tym przykładzie będzie używać w implementacji domyślnej produktu ASP.NET Identity magazyn danych SQL, która jest oparta na platformie Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="daf99-111">This sample will use the ASP.NET Identity default implementation for SQL data storage which is built on Entity Framework.</span></span> <span data-ttu-id="daf99-112">Ten samouczek, firma Microsoft będzie używać LocalDB bazy danych SQL.</span><span class="sxs-lookup"><span data-stu-id="daf99-112">This tutorial, we will use LocalDB for the SQL database.</span></span>
> 
> <span data-ttu-id="daf99-113">Ten samouczek został napisany przez Raquel Soares De Almeida i Rick Anderson ( [ @RickAndMSFT ](https://twitter.com/#!/RickAndMSFT) ).</span><span class="sxs-lookup"><span data-stu-id="daf99-113">This tutorial was written by Raquel Soares De Almeida and Rick Anderson ( [@RickAndMSFT](https://twitter.com/#!/RickAndMSFT) ).</span></span>


## <a name="getting-started-aspnet-identity"></a><span data-ttu-id="daf99-114">Wprowadzenie do produktu ASP.NET Identity</span><span class="sxs-lookup"><span data-stu-id="daf99-114">Getting Started ASP.NET Identity</span></span>

1. <span data-ttu-id="daf99-115">Rozpocznij od instalowania i uruchamiania [Visual Studio Express 2013 for Web](https://go.microsoft.com/fwlink/?LinkId=299058) lub [programu Visual Studio 2013](https://go.microsoft.com/fwlink/?LinkId=306566).</span><span class="sxs-lookup"><span data-stu-id="daf99-115">Start by installing and running [Visual Studio Express 2013 for Web](https://go.microsoft.com/fwlink/?LinkId=299058) or [Visual Studio 2013](https://go.microsoft.com/fwlink/?LinkId=306566).</span></span>
2. <span data-ttu-id="daf99-116">Kliknij przycisk **nowy projekt** od samego początku strony, lub można użyć menu i wybrać **pliku**, a następnie **nowy projekt**.</span><span class="sxs-lookup"><span data-stu-id="daf99-116">Click **New Project** from the Start page, or you can use the menu and select **File**, and then **New Project**.</span></span>
3. <span data-ttu-id="daf99-117">Wybierz **Visual C# i** n okienka po lewej stronie, następnie **Web** , a następnie wybierz **aplikacji sieci Web ASP.NET**.</span><span class="sxs-lookup"><span data-stu-id="daf99-117">Select **Visual C# i** n the left pane, then **Web** and then select **ASP.NET Web Application**.</span></span> <span data-ttu-id="daf99-118">Nazwij swój projekt "WebFormsIdentity", a następnie kliknij przycisk **OK**.</span><span class="sxs-lookup"><span data-stu-id="daf99-118">Name your project "WebFormsIdentity" and then click **OK**.</span></span>   
  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image1.png)
4. <span data-ttu-id="daf99-119">W **nowy projekt ASP.NET** okno dialogowe, wybierz opcję **pusty** szablonu.</span><span class="sxs-lookup"><span data-stu-id="daf99-119">In the **New ASP.NET Project** dialog, select the **Empty** template.</span></span>  
  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image2.png)  
  
   <span data-ttu-id="daf99-120">Zwróć uwagę **Zmień uwierzytelnianie** przycisk jest wyłączony i nie obsługuje uwierzytelniania znajduje się w tym szablonie.</span><span class="sxs-lookup"><span data-stu-id="daf99-120">Notice the **Change Authentication** button is disabled and no authentication support is provided in this template.</span></span> <span data-ttu-id="daf99-121">Szablony formularzy sieci Web, MVC i interfejs API sieci Web umożliwiają wybranie podejścia do uwierzytelniania.</span><span class="sxs-lookup"><span data-stu-id="daf99-121">The Web Forms, MVC and Web API templates allow you to select the authentication approach.</span></span> <span data-ttu-id="daf99-122">Aby uzyskać więcej informacji, zobacz [omówienie uwierzytelniania](../../../visual-studio/overview/2013/creating-web-projects-in-visual-studio.md#auth) .</span><span class="sxs-lookup"><span data-stu-id="daf99-122">For more information, see [Overview of Authentication](../../../visual-studio/overview/2013/creating-web-projects-in-visual-studio.md#auth) .</span></span>

## <a name="adding-identity-packages-to-your-app"></a><span data-ttu-id="daf99-123">Trwa dodawanie pakietów tożsamości do aplikacji</span><span class="sxs-lookup"><span data-stu-id="daf99-123">Adding Identity Packages to your App</span></span>

<span data-ttu-id="daf99-124">W Eksploratorze rozwiązań kliknij prawym przyciskiem myszy projekt i wybierz **Zarządzaj pakietami NuGet**.</span><span class="sxs-lookup"><span data-stu-id="daf99-124">In Solution Explorer, right-click your project and select **Manage NuGet Packages**.</span></span> <span data-ttu-id="daf99-125">W oknie dialogowym pole tekstowe wyszukiwania wpisz "*Identity.E*".</span><span class="sxs-lookup"><span data-stu-id="daf99-125">In the search text box dialog, type "*Identity.E*".</span></span> <span data-ttu-id="daf99-126">Kliknij przycisk Instaluj, aby uzyskać tego pakietu.</span><span class="sxs-lookup"><span data-stu-id="daf99-126">Click install for this package.</span></span>   
  
![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image3.png)  
  
<span data-ttu-id="daf99-127">Należy pamiętać, że ten pakiet zainstaluje pakiety zależności: EntityFramework i tożsamość Microsoft ASP.NET w wersji podstawowej.</span><span class="sxs-lookup"><span data-stu-id="daf99-127">Note that this package will install the dependency packages: EntityFramework and Microsoft ASP.NET Identity Core.</span></span>

## <a name="adding-web-forms-to-register-users"></a><span data-ttu-id="daf99-128">Dodawanie formularzy sieci Web w celu zarejestrowania użytkowników</span><span class="sxs-lookup"><span data-stu-id="daf99-128">Adding Web Forms to Register Users</span></span>

1. <span data-ttu-id="daf99-129">W **Eksploratora rozwiązań**, kliknij prawym przyciskiem myszy projekt i kliknij przycisk **Dodaj**, a następnie **formularz sieci Web**.</span><span class="sxs-lookup"><span data-stu-id="daf99-129">In **Solution Explorer**, right-click your project and click **Add**, and then **Web Form**.</span></span>  
  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image4.png)
2. <span data-ttu-id="daf99-130">W **Określ nazwę dla elementu** okno dialogowe, Nazwa nowego formularza sieci web **zarejestrować**, a następnie kliknij przycisk **OK**</span><span class="sxs-lookup"><span data-stu-id="daf99-130">In the **Specify Name for Item** dialog box, name the new web form **Register**, and then click **OK**</span></span>
3. <span data-ttu-id="daf99-131">Zastąp kod znaczników w wygenerowanym *Register.aspx* plik zawierający poniższy kod.</span><span class="sxs-lookup"><span data-stu-id="daf99-131">Replace the markup in the generated *Register.aspx* file with the code below.</span></span> <span data-ttu-id="daf99-132">Zmiany kodu są wyróżnione.</span><span class="sxs-lookup"><span data-stu-id="daf99-132">The code changes are highlighted.</span></span>   

    [!code-aspx[Main](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/samples/sample1.aspx?highlight=9,12-40)]

    > [!NOTE]
    > <span data-ttu-id="daf99-133">Jest to po prostu uproszczoną wersję *Register.aspx* pliku, który jest tworzony podczas tworzenia nowego projektu formularzy sieci Web ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="daf99-133">This is just a simplified version of the *Register.aspx* file that is created when you create a new ASP.NET Web Forms project.</span></span> <span data-ttu-id="daf99-134">Kod znaczników powyżej umożliwia dodanie pola formularza i przycisk, aby zarejestrować nowego użytkownika.</span><span class="sxs-lookup"><span data-stu-id="daf99-134">The markup above adds form fields and a button to register a new user.</span></span>
4. <span data-ttu-id="daf99-135">Otwórz *Register.aspx.cs* i Zastąp zawartość pliku następującym kodem:</span><span class="sxs-lookup"><span data-stu-id="daf99-135">Open the *Register.aspx.cs* file and replace the contents of the file with the following code:</span></span>

    [!code-csharp[Main](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/samples/sample2.cs)]

    > [!NOTE] 
    > 
    > 1. <span data-ttu-id="daf99-136">Powyższy kod jest uproszczoną wersją *Register.aspx.cs* pliku, który jest tworzony podczas tworzenia nowego projektu formularzy sieci Web ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="daf99-136">The code above is a simplified version of the *Register.aspx.cs* file that is created when you create a new ASP.NET Web Forms project.</span></span>
    > 2. <span data-ttu-id="daf99-137">*IdentityUser* klasa jest domyślna implementacja EntityFramework *IUser* interfejsu.</span><span class="sxs-lookup"><span data-stu-id="daf99-137">The *IdentityUser* class is the default EntityFramework implementation of the *IUser* interface.</span></span> <span data-ttu-id="daf99-138">*IUser* interfejs jest minimalny interfejs użytkownika programu ASP.NET Identity Core.</span><span class="sxs-lookup"><span data-stu-id="daf99-138">*IUser* interface is the minimal interface for a user on ASP.NET Identity Core.</span></span>
    > 3. <span data-ttu-id="daf99-139">*Magazynie UserStore* klasa jest domyślna implementacja EntityFramework magazynu na użytkownika.</span><span class="sxs-lookup"><span data-stu-id="daf99-139">The *UserStore* class is the default EntityFramework implementation of a user store.</span></span> <span data-ttu-id="daf99-140">Ta klasa implementuje interfejsy minimalny platformy ASP.NET Core Identity: *elementy IUserStore*, *IUserLoginStore*, *IUserClaimStore* i *IUserRoleStore* .</span><span class="sxs-lookup"><span data-stu-id="daf99-140">This class implements the ASP.NET Identity Core's minimal interfaces: *IUserStore*, *IUserLoginStore*, *IUserClaimStore* and *IUserRoleStore*.</span></span>
    > 4. <span data-ttu-id="daf99-141">*Menedżera UserManager* klasa udostępnia związane z użytkownikami interfejsy API, który automatycznie zapisze zmiany *magazynie UserStore*.</span><span class="sxs-lookup"><span data-stu-id="daf99-141">The *UserManager* class exposes user related APIs which will automatically save changes to the *UserStore*.</span></span>
    > 5. <span data-ttu-id="daf99-142">*IdentityResult* klasa reprezentuje wynik operacji tożsamości.</span><span class="sxs-lookup"><span data-stu-id="daf99-142">The *IdentityResult* class represents the result of an identity operation.</span></span>
5. <span data-ttu-id="daf99-143">W **Eksploratora rozwiązań**, kliknij prawym przyciskiem myszy projekt i kliknij przycisk **Dodaj**, **Dodaj Folder ASP.NET** i następnie **aplikacji\_danych**.</span><span class="sxs-lookup"><span data-stu-id="daf99-143">In **Solution Explorer**, right-click your project and click **Add**, **Add ASP.NET Folder** and then **App\_Data**.</span></span>  
  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image5.png)
6. <span data-ttu-id="daf99-144">Otwórz *Web.config* pliku i Dodaj wpis ciągu połączenia dla bazy danych, firma Microsoft będzie używany do przechowywania informacji o użytkowniku.</span><span class="sxs-lookup"><span data-stu-id="daf99-144">Open the *Web.config* file and add a connection string entry for the database we will use to store user information.</span></span> <span data-ttu-id="daf99-145">Baza danych zostanie utworzona w czasie wykonywania przez EntityFramework jednostek tożsamości.</span><span class="sxs-lookup"><span data-stu-id="daf99-145">The database will be created at runtime by EntityFramework for the Identity entities.</span></span> <span data-ttu-id="daf99-146">Parametry połączenia są podobne do tworzony automatycznie podczas tworzenia nowego projektu formularzy sieci Web.</span><span class="sxs-lookup"><span data-stu-id="daf99-146">The connection string is similar to one created for you when you create a new Web Forms project.</span></span> <span data-ttu-id="daf99-147">Wyróżniony kod znaczników, należy dodać:</span><span class="sxs-lookup"><span data-stu-id="daf99-147">The highlighted code shows the markup you should add:</span></span>

    [!code-xml[Main](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/samples/sample3.xml?highlight=11-14)]
    
    > [!NOTE] 
    > <span data-ttu-id="daf99-148">Dla programu Visual Studio 2015 lub nowszego, Zastąp `(localdb)\v11.0` z `(localdb)\MSSQLLocalDB` w ciągu połączenia.</span><span class="sxs-lookup"><span data-stu-id="daf99-148">For Visual Studio 2015 or higher, replace `(localdb)\v11.0` with `(localdb)\MSSQLLocalDB` in your connection string.</span></span>
    
7. <span data-ttu-id="daf99-149">Kliknij prawym przyciskiem myszy plik *Register.aspx* w projekcie i wybierz **Ustaw jako strona startowa**.</span><span class="sxs-lookup"><span data-stu-id="daf99-149">Right click file *Register.aspx* in your project and select **Set as Start Page**.</span></span> <span data-ttu-id="daf99-150">Naciśnij klawisze Ctrl + F5, aby skompilować i uruchomić aplikację sieci web.</span><span class="sxs-lookup"><span data-stu-id="daf99-150">Press Ctrl + F5 to build and run the web application.</span></span> <span data-ttu-id="daf99-151">Wprowadź nową nazwę użytkownika i hasło, a następnie kliknij polecenie **zarejestrować**.</span><span class="sxs-lookup"><span data-stu-id="daf99-151">Enter a new user name and password and then click on **Register**.</span></span>  
  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image6.png)  

    > [!NOTE]
    > <span data-ttu-id="daf99-152">Tożsamości ASP.NET zapewnia obsługę sprawdzania poprawności i w tym przykładzie domyślne zachowanie na użytkownika i hasła można sprawdzić poprawności, które pochodzą z pakiet podstawowego tożsamości.</span><span class="sxs-lookup"><span data-stu-id="daf99-152">ASP.NET Identity has support for validation and in this sample you can verify the default behavior on User and Password validators that come from the Identity Core package.</span></span> <span data-ttu-id="daf99-153">Domyślny moduł weryfikacji dla użytkownika (`UserValidator`) ma właściwość `AllowOnlyAlphanumericUserNames` zawierający wartość domyślna równa `true`.</span><span class="sxs-lookup"><span data-stu-id="daf99-153">The default validator for User (`UserValidator`) has a property `AllowOnlyAlphanumericUserNames` that has default value set to `true`.</span></span> <span data-ttu-id="daf99-154">Domyślny moduł weryfikacji dla hasła (`MinimumLengthValidator`) zapewnia, że hasło zawiera co najmniej 6 znaków.</span><span class="sxs-lookup"><span data-stu-id="daf99-154">The default validator for Password (`MinimumLengthValidator`) ensures that password has at least 6 characters.</span></span> <span data-ttu-id="daf99-155">Te moduły są właściwościami na `UserManager` , może zostać zastąpiona, jeśli chcesz mieć niestandardowego sprawdzania poprawności,</span><span class="sxs-lookup"><span data-stu-id="daf99-155">These validators are properties on `UserManager` that can be overridden if you want to have custom validation,</span></span>

## <a name="verifying-the-localdb-identity-database-and-tables-generated-by-entity-framework"></a><span data-ttu-id="daf99-156">Weryfikowanie bazy danych LocalDb tożsamości i tabele generowane przez program Entity Framework</span><span class="sxs-lookup"><span data-stu-id="daf99-156">Verifying the LocalDb Identity Database and Tables Generated by Entity Framework</span></span>

1. <span data-ttu-id="daf99-157">W **widoku** menu, kliknij przycisk **Eksploratora serwera**.</span><span class="sxs-lookup"><span data-stu-id="daf99-157">In the **View** menu, click **Server Explorer**.</span></span>  
  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image7.png)
2. <span data-ttu-id="daf99-158">Rozwiń **DefaultConnection (WebFormsIdentity)**, rozwiń węzeł **tabel**, kliknij prawym przyciskiem myszy **AspNetUsers** i kliknij przycisk **Pokaż dane tabeli**.</span><span class="sxs-lookup"><span data-stu-id="daf99-158">Expand **DefaultConnection (WebFormsIdentity)**, expand **Tables**, right click **AspNetUsers** and click **Show Table Data**.</span></span>  
  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image8.png)  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image9.png)

## <a name="configuring-the-application-for-owin-authentication"></a><span data-ttu-id="daf99-159">Konfigurowanie aplikacji uwierzytelniania OWIN</span><span class="sxs-lookup"><span data-stu-id="daf99-159">Configuring the application for OWIN authentication</span></span>

<span data-ttu-id="daf99-160">W tym momencie tylko Dodaliśmy obsługę tworzenia użytkowników.</span><span class="sxs-lookup"><span data-stu-id="daf99-160">At this point we have only added support for creating users.</span></span> <span data-ttu-id="daf99-161">Teraz zamierzamy pokazują, jak możemy dodać uwierzytelnianie, aby zalogować użytkownika.</span><span class="sxs-lookup"><span data-stu-id="daf99-161">Now, we are going to demonstrate how we can add authentication to login a user.</span></span> <span data-ttu-id="daf99-162">Tożsamości ASP.NET używa oprogramowania pośredniczącego uwierzytelniania OWIN firmy Microsoft dla uwierzytelniania formularzy.</span><span class="sxs-lookup"><span data-stu-id="daf99-162">ASP.NET Identity uses Microsoft OWIN Authentication middleware for forms authentication.</span></span> <span data-ttu-id="daf99-163">Uwierzytelniania plików Cookie OWIN plik cookie i oświadczeń mechanizmu uwierzytelniania zależności, które mogą być używane przez dowolnej architektury w serwisie [OWIN](https://msdn.microsoft.com/magazine/dn451439.aspx) lub IIS.</span><span class="sxs-lookup"><span data-stu-id="daf99-163">The OWIN Cookie Authentication is a cookie and claims based authentication mechanism that can be used by any framework hosted on [OWIN](https://msdn.microsoft.com/magazine/dn451439.aspx) or IIS.</span></span> <span data-ttu-id="daf99-164">W tym modelu te same pakiety uwierzytelniania może służyć przez wielu struktur, w tym ASP.NET MVC i formularzy sieci Web.</span><span class="sxs-lookup"><span data-stu-id="daf99-164">With this model, the same authentication packages can be used across multiple frameworks including ASP.NET MVC and Web Forms.</span></span> <span data-ttu-id="daf99-165">Aby uzyskać więcej informacji na temat projektu Katana oraz sposobu uruchamiania oprogramowania pośredniczącego Zobacz niezależny od hosta [wprowadzenie do projektu Katana](https://msdn.microsoft.com/magazine/dn451439.aspx).</span><span class="sxs-lookup"><span data-stu-id="daf99-165">For more information on project Katana and how to run middleware in a host agnostic see [Getting Started with the Katana Project](https://msdn.microsoft.com/magazine/dn451439.aspx).</span></span>

## <a name="installing-authentication-packages-to-your-application"></a><span data-ttu-id="daf99-166">Instalowanie pakietów uwierzytelniania do aplikacji</span><span class="sxs-lookup"><span data-stu-id="daf99-166">Installing authentication packages to your application</span></span>

1. <span data-ttu-id="daf99-167">W Eksploratorze rozwiązań kliknij prawym przyciskiem myszy projekt i wybierz **Zarządzaj pakietami NuGet**.</span><span class="sxs-lookup"><span data-stu-id="daf99-167">In Solution Explorer, right-click your project and select **Manage NuGet Packages**.</span></span> <span data-ttu-id="daf99-168">W oknie dialogowym pole tekstowe wyszukiwania wpisz "*Identity.Owin*".</span><span class="sxs-lookup"><span data-stu-id="daf99-168">In the search text box dialog, type "*Identity.Owin*".</span></span> <span data-ttu-id="daf99-169">Kliknij przycisk Instaluj, aby uzyskać tego pakietu.</span><span class="sxs-lookup"><span data-stu-id="daf99-169">Click install for this package.</span></span>   
  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image10.png)
2. <span data-ttu-id="daf99-170">Wyszukaj pakiet ***Microsoft.Owin.Host.SystemWeb*** i zainstaluj go.</span><span class="sxs-lookup"><span data-stu-id="daf99-170">Search for package ***Microsoft.Owin.Host.SystemWeb*** and install it.</span></span>   

    > [!NOTE]
    > <span data-ttu-id="daf99-171">**Microsoft.Aspnet.Identity.Owin** pakiet zawiera zestaw klas rozszerzeń OWIN do zarządzania i konfigurowania oprogramowania pośredniczącego uwierzytelniania OWIN do użycia przez pakiety platformy ASP.NET Core Identity.</span><span class="sxs-lookup"><span data-stu-id="daf99-171">The **Microsoft.Aspnet.Identity.Owin** package contains a set of OWIN extension classes to manage and configure OWIN authentication middleware to be consumed by ASP.NET Identity Core packages.</span></span>  
    > <span data-ttu-id="daf99-172">**Microsoft.Owin.Host.SystemWeb** pakiet zawiera serwer OWIN, który umożliwia aplikacji OWIN do uruchamiania w usługach IIS przy użyciu potoku żądania programu ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="daf99-172">The **Microsoft.Owin.Host.SystemWeb** package contains an OWIN server that enables OWIN-based applications to run on IIS using the ASP.NET request pipeline.</span></span> <span data-ttu-id="daf99-173">Aby uzyskać więcej informacji, zobacz [oprogramowanie pośredniczące OWIN w usługach IIS zintegrowany potok](../../../aspnet/overview/owin-and-katana/owin-middleware-in-the-iis-integrated-pipeline.md).</span><span class="sxs-lookup"><span data-stu-id="daf99-173">For more information see [OWIN Middleware in the IIS integrated pipeline](../../../aspnet/overview/owin-and-katana/owin-middleware-in-the-iis-integrated-pipeline.md).</span></span>

## <a name="adding-owin-startup-and-authentication-configuration-classes"></a><span data-ttu-id="daf99-174">Dodawanie początkowa OWIN i klas konfiguracji uwierzytelniania</span><span class="sxs-lookup"><span data-stu-id="daf99-174">Adding OWIN Startup and Authentication Configuration Classes</span></span>

1. <span data-ttu-id="daf99-175">W **Eksploratora rozwiązań**, kliknij prawym przyciskiem myszy projekt, kliknij przycisk **Dodaj**, a następnie **Dodaj nowy element**.</span><span class="sxs-lookup"><span data-stu-id="daf99-175">In **Solution Explorer**, right-click your project, click **Add**, and then **Add New Item**.</span></span> <span data-ttu-id="daf99-176">W oknie dialogowym pole tekstowe wyszukiwania wpisz "*owin*".</span><span class="sxs-lookup"><span data-stu-id="daf99-176">In the search text box dialog, type "*owin*".</span></span> <span data-ttu-id="daf99-177">Nadaj nazwę klasy "*uruchamiania*" i kliknij przycisk **Dodaj**.</span><span class="sxs-lookup"><span data-stu-id="daf99-177">Name the class "*Startup*" and click **Add**.</span></span>   
  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image11.png)
2. <span data-ttu-id="daf99-178">W pliku Startup.cs Dodaj wyróżniony kod przedstawione poniżej, aby skonfigurować uwierzytelniania plików cookie OWIN.</span><span class="sxs-lookup"><span data-stu-id="daf99-178">In the Startup.cs file, add the highlighted code shown below to configure OWIN cookie authentication.</span></span>

    [!code-csharp[Main](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/samples/sample4.cs?highlight=1,3,15-19)]

    > [!NOTE]
    > <span data-ttu-id="daf99-179">Ta klasa zawiera `OwinStartup` atrybutu w celu określenia klasy początkowej OWIN.</span><span class="sxs-lookup"><span data-stu-id="daf99-179">This class contains the `OwinStartup` attribute for specifying the OWIN startup class.</span></span> <span data-ttu-id="daf99-180">Każda aplikacja OWIN ma klasę uruchamiania, w których określane są składniki do potoku aplikacji.</span><span class="sxs-lookup"><span data-stu-id="daf99-180">Every OWIN application has a startup class where you specify components for the application pipeline.</span></span> <span data-ttu-id="daf99-181">Zobacz [wykrywanie klasy początkowej OWIN](../../../aspnet/overview/owin-and-katana/owin-startup-class-detection.md) Aby uzyskać więcej informacji na ten model.</span><span class="sxs-lookup"><span data-stu-id="daf99-181">See [OWIN Startup Class Detection](../../../aspnet/overview/owin-and-katana/owin-startup-class-detection.md) for more info on this model.</span></span>

## <a name="adding-web-forms-for-registering-and-logging-in-users"></a><span data-ttu-id="daf99-182">Dodawanie formularzy sieci Web rejestracji i logowania użytkowników</span><span class="sxs-lookup"><span data-stu-id="daf99-182">Adding Web Forms for Registering and Logging in Users</span></span>

1. <span data-ttu-id="daf99-183">Otwórz *Register.cs* pliku i Dodaj następujący kod, który będzie zalogować użytkownika, po pomyślnym zakończeniu rejestracji.</span><span class="sxs-lookup"><span data-stu-id="daf99-183">Open the *Register.cs* file and add the following code which will log in the user when registration succeeds.</span></span> <span data-ttu-id="daf99-184">Zmiany są wyróżnione poniżej.</span><span class="sxs-lookup"><span data-stu-id="daf99-184">The changes are highlighted below.</span></span>

    [!code-csharp[Main](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/samples/sample5.cs)]

    > [!NOTE] 
    > 
    > - <span data-ttu-id="daf99-185">Ponieważ produktu ASP.NET Identity i uwierzytelniania plików Cookie OWIN są oświadczenia na podstawie systemu, struktura wymaga deweloperem aplikacji, aby wygenerować [ClaimsIdentity](https://msdn.microsoft.com/library/microsoft.identitymodel.claims.claimsidentity.aspx) dla użytkownika.</span><span class="sxs-lookup"><span data-stu-id="daf99-185">Since ASP.NET Identity and OWIN Cookie Authentication are claims based system, the framework requires the app developer to generate a [ClaimsIdentity](https://msdn.microsoft.com/library/microsoft.identitymodel.claims.claimsidentity.aspx) for the user.</span></span> <span data-ttu-id="daf99-186">Tożsamość ClaimsIdentity zawierają informacje dotyczące wszystkich oświadczeń dla użytkownika, takich jak role, jakie należy użytkownik.</span><span class="sxs-lookup"><span data-stu-id="daf99-186">ClaimsIdentity has information about all the claims for the user such as what Roles the user belongs to.</span></span> <span data-ttu-id="daf99-187">Można również dodać więcej oświadczenia dla użytkownika na tym etapie.</span><span class="sxs-lookup"><span data-stu-id="daf99-187">You can also add more claims for the user at this stage.</span></span>
    > - <span data-ttu-id="daf99-188">Użytkownik loguje użytkownika za pomocą słowniku z OWIN i wywoływania `SignIn` i przekazując ClaimsIdentity, jak pokazano powyżej.</span><span class="sxs-lookup"><span data-stu-id="daf99-188">You can sign in the user by using the AuthenticationManager from OWIN and calling `SignIn` and passing in the ClaimsIdentity as shown above.</span></span> <span data-ttu-id="daf99-189">Ten kod będzie zalogować użytkownika i generowanie pliku cookie, jak również.</span><span class="sxs-lookup"><span data-stu-id="daf99-189">This code will sign in the user and generate a cookie as well.</span></span> <span data-ttu-id="daf99-190">To wywołanie jest odpowiednikiem [FormAuthentication.SetAuthCookie](https://msdn.microsoft.com/library/system.web.security.formsauthentication.setauthcookie.aspx) posługują się [FormsAuthentication](https://msdn.microsoft.com/library/system.web.security.formsauthenticationmodule.aspx) modułu.</span><span class="sxs-lookup"><span data-stu-id="daf99-190">This call is analogous to [FormAuthentication.SetAuthCookie](https://msdn.microsoft.com/library/system.web.security.formsauthentication.setauthcookie.aspx) used by the [FormsAuthentication](https://msdn.microsoft.com/library/system.web.security.formsauthenticationmodule.aspx) module.</span></span>
2. <span data-ttu-id="daf99-191">W **Eksploratora rozwiązań**, kliknij prawym przyciskiem myszy kliknij Twojego projektu **Dodaj**, a następnie **formularz sieci Web**.</span><span class="sxs-lookup"><span data-stu-id="daf99-191">In **Solution Explorer**, right-click your project click **Add**, and then **Web Form**.</span></span> <span data-ttu-id="daf99-192">Nazwa formularza sieci web **logowania**.</span><span class="sxs-lookup"><span data-stu-id="daf99-192">Name the web form **Login**.</span></span>  
  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image12.png)
3. <span data-ttu-id="daf99-193">Zastąp zawartość *Login.aspx* pliku następującym kodem:</span><span class="sxs-lookup"><span data-stu-id="daf99-193">Replace the contents of the *Login.aspx* file with the following code:</span></span>  

    [!code-aspx[Main](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/samples/sample6.aspx)]
4. <span data-ttu-id="daf99-194">Zastąp zawartość *Login.aspx.cs* pliku następującym kodem:</span><span class="sxs-lookup"><span data-stu-id="daf99-194">Replace the contents of the *Login.aspx.cs* file with the following:</span></span>  

    [!code-csharp[Main](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/samples/sample7.cs)]

    > [!NOTE] 
    > 
    > - <span data-ttu-id="daf99-195">`Page_Load` Teraz sprawdza, czy stan bieżącego użytkownika i wykonuje akcję na podstawie jego `Context.User.Identity.IsAuthenticated` stanu.</span><span class="sxs-lookup"><span data-stu-id="daf99-195">The `Page_Load` now checks for the status of current user and takes action based on its `Context.User.Identity.IsAuthenticated` status.</span></span>  
    >     <span data-ttu-id="daf99-196">**Wyświetl zarejestrowane w imieniu użytkownika** : Microsoft ASP.NET Identity Framework został dodany metody rozszerzenia w [System.Security.Principal.IIdentity](https://msdn.microsoft.com/library/system.security.principal.iidentity.aspx) pozwala uzyskać `UserName` i `UserId` dla zalogowany użytkownik.</span><span class="sxs-lookup"><span data-stu-id="daf99-196">**Display Logged in User Name** : The Microsoft ASP.NET Identity Framework has added extension methods on [System.Security.Principal.IIdentity](https://msdn.microsoft.com/library/system.security.principal.iidentity.aspx) that allows you to get the `UserName` and `UserId`  for the logged in User.</span></span> <span data-ttu-id="daf99-197">Te metody rozszerzenia są zdefiniowane w `Microsoft.AspNet.Identity.Core` zestawu.</span><span class="sxs-lookup"><span data-stu-id="daf99-197">These extension methods are defined in the `Microsoft.AspNet.Identity.Core` assembly.</span></span> <span data-ttu-id="daf99-198">Te metody rozszerzenia są zastępuje [HttpContext.User.Identity.Name](https://msdn.microsoft.com/library/system.web.httpcontext.user.aspx) .</span><span class="sxs-lookup"><span data-stu-id="daf99-198">These extension methods are the replacement for [HttpContext.User.Identity.Name](https://msdn.microsoft.com/library/system.web.httpcontext.user.aspx) .</span></span>
    > - <span data-ttu-id="daf99-199">Logowanie za pomocą metody:</span><span class="sxs-lookup"><span data-stu-id="daf99-199">SignIn method:</span></span>   
    >     <span data-ttu-id="daf99-200">`This` metoda zastępuje poprzedni `CreateUser_Click` metody, w tym przykładowych i teraz loguje się użytkownik, po pomyślnym utworzeniu użytkownika.</span><span class="sxs-lookup"><span data-stu-id="daf99-200">`This` method replaces the previous `CreateUser_Click` method in this sample and now signs in the user after successfully creating the user.</span></span>   
    >  <span data-ttu-id="daf99-201">Microsoft OWIN Framework został dodany metody rozszerzenia w `System.Web.HttpContext` pozwala to uzyskać odwołanie do `IOwinContext`.</span><span class="sxs-lookup"><span data-stu-id="daf99-201">The Microsoft OWIN Framework has added extension methods on `System.Web.HttpContext` that allows you to get a reference to an `IOwinContext`.</span></span> <span data-ttu-id="daf99-202">Te metody rozszerzenia są zdefiniowane w `Microsoft.Owin.Host.SystemWeb` zestawu.</span><span class="sxs-lookup"><span data-stu-id="daf99-202">These extension methods are defined in `Microsoft.Owin.Host.SystemWeb` assembly.</span></span> <span data-ttu-id="daf99-203">`OwinContext` Klasy ujawnia `IAuthenticationManager` właściwość, która reprezentuje funkcje oprogramowania pośredniczącego uwierzytelniania dostępne dla bieżącego żądania.</span><span class="sxs-lookup"><span data-stu-id="daf99-203">The `OwinContext` class exposes an `IAuthenticationManager` property that represents the Authentication middleware functionality available on the current request.</span></span>  
    >  <span data-ttu-id="daf99-204">Użytkownik loguje użytkownika za pomocą `AuthenticationManager` z OWIN i wywoływania `SignIn` i przekazując `ClaimsIdentity` jak pokazano powyżej.</span><span class="sxs-lookup"><span data-stu-id="daf99-204">You can sign in the user by using the `AuthenticationManager` from OWIN and calling `SignIn`  and passing in the `ClaimsIdentity`  as shown above.</span></span>   
    >  <span data-ttu-id="daf99-205">Ponieważ produktu ASP.NET Identity i uwierzytelniania plików Cookie OWIN są systemu opartego na oświadczeniach, struktura wymaga aplikację, aby wygenerować `ClaimsIdentity` dla użytkownika.</span><span class="sxs-lookup"><span data-stu-id="daf99-205">Because ASP.NET Identity and OWIN Cookie Authentication are claims-based system, the framework requires the app to generate a `ClaimsIdentity` for the user.</span></span>   
    >  <span data-ttu-id="daf99-206">`ClaimsIdentity` Zawiera informacje o wszystkich oświadczeń użytkownika, takich jak role, jakie należy użytkownik.</span><span class="sxs-lookup"><span data-stu-id="daf99-206">The `ClaimsIdentity` has information about all the claims for the user, such as what roles the user belongs to.</span></span> <span data-ttu-id="daf99-207">Możesz również dodać więcej oświadczenia dla użytkownika na tym etapie</span><span class="sxs-lookup"><span data-stu-id="daf99-207">You can also add more claims for the user at this stage</span></span>  
    >  <span data-ttu-id="daf99-208">Ten kod będzie zalogować użytkownika i generowanie pliku cookie, jak również.</span><span class="sxs-lookup"><span data-stu-id="daf99-208">This code will sign in the user and generate a cookie as well.</span></span> <span data-ttu-id="daf99-209">To wywołanie jest odpowiednikiem [FormAuthentication.SetAuthCookie](https://msdn.microsoft.com/library/system.web.security.formsauthentication.setauthcookie.aspx) posługują się [FormsAuthentication](https://msdn.microsoft.com/library/system.web.security.formsauthenticationmodule.aspx) modułu.</span><span class="sxs-lookup"><span data-stu-id="daf99-209">This call is analogous to [FormAuthentication.SetAuthCookie](https://msdn.microsoft.com/library/system.web.security.formsauthentication.setauthcookie.aspx) used by the [FormsAuthentication](https://msdn.microsoft.com/library/system.web.security.formsauthenticationmodule.aspx) module.</span></span>
    > - <span data-ttu-id="daf99-210">`SignOut` Metoda:</span><span class="sxs-lookup"><span data-stu-id="daf99-210">`SignOut` method:</span></span>   
    >  <span data-ttu-id="daf99-211">Pobiera odwołanie do `AuthenticationManager` z OWIN i wywołania `SignOut`.</span><span class="sxs-lookup"><span data-stu-id="daf99-211">Gets a reference to the `AuthenticationManager` from OWIN and calls `SignOut`.</span></span> <span data-ttu-id="daf99-212">To jest odpowiednikiem [FormsAuthentication.SignOut](https://msdn.microsoft.com/library/system.web.security.formsauthentication.signout.aspx) metodę używaną przez [FormsAuthentication](https://msdn.microsoft.com/library/system.web.security.formsauthenticationmodule.aspx) modułu.</span><span class="sxs-lookup"><span data-stu-id="daf99-212">This is analogous to [FormsAuthentication.SignOut](https://msdn.microsoft.com/library/system.web.security.formsauthentication.signout.aspx) method used by the [FormsAuthentication](https://msdn.microsoft.com/library/system.web.security.formsauthenticationmodule.aspx) module.</span></span>
5. <span data-ttu-id="daf99-213">Naciśnij klawisz **klawiszy Ctrl + F5** do kompilowania i uruchamiania aplikacji sieci web.</span><span class="sxs-lookup"><span data-stu-id="daf99-213">Press **Ctrl + F5** to build and run the web application.</span></span> <span data-ttu-id="daf99-214">Wprowadź nową nazwę użytkownika i hasło, a następnie kliknij polecenie **zarejestrować**.</span><span class="sxs-lookup"><span data-stu-id="daf99-214">Enter a new user name and password and then click on **Register**.</span></span>  
  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image13.png)  
   <span data-ttu-id="daf99-215">Uwaga: W tym momencie nowy użytkownik jest utworzony i zalogowany.</span><span class="sxs-lookup"><span data-stu-id="daf99-215">Note: At this point, the new user is created and logged in.</span></span>
6. <span data-ttu-id="daf99-216">Kliknij pozycję **Wyloguj** przycisku. Nastąpi przekierowanie do strony logowania formularza.</span><span class="sxs-lookup"><span data-stu-id="daf99-216">Click on **Log out** button.You will be redirected to the Log in form.</span></span>
7. <span data-ttu-id="daf99-217">Wprowadź Nieprawidłowa nazwa użytkownika lub hasło i kliknij przycisk na **Zaloguj** przycisku.</span><span class="sxs-lookup"><span data-stu-id="daf99-217">Enter an invalid user name or password and Click on **Log in** button.</span></span>   
   <span data-ttu-id="daf99-218">`UserManager.Find` Metoda zwróci wartość null i komunikat o błędzie: " *Nieprawidłowa nazwa użytkownika lub hasło* " będą wyświetlane.</span><span class="sxs-lookup"><span data-stu-id="daf99-218">The `UserManager.Find`  method will return null and the error message: " *Invalid user name or password* " will be displayed.</span></span>  
  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image14.png)
