---
uid: web-forms/overview/data-access/basic-reporting/declarative-parameters-vb
title: Parametry deklaratywne (VB) | Dokumentacja firmy Microsoft
author: rick-anderson
description: W tym samouczku firma Microsoft będzie pokazano, jak użyć parametru ustawioną wartość wpisaną na stałe, aby wybrać dane do wyświetlenia w formancie widoku DetailsView.
ms.author: aspnetcontent
manager: wpickett
ms.date: 03/31/2010
ms.topic: article
ms.assetid: dc1234a3-114f-4c9a-8d25-50ca03cc8e8e
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/basic-reporting/declarative-parameters-vb
msc.type: authoredcontent
ms.openlocfilehash: 933b7276c6dac5cce0e278fd23ff010c5b4a6fdd
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/06/2018
ms.locfileid: "30877414"
---
<a name="declarative-parameters-vb"></a><span data-ttu-id="12635-103">Parametry deklaratywne (VB)</span><span class="sxs-lookup"><span data-stu-id="12635-103">Declarative Parameters (VB)</span></span>
====================
<span data-ttu-id="12635-104">przez [Bento Scott](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="12635-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="12635-105">[Pobierz przykładową aplikację](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_5_VB.exe) lub [pobierania plików PDF](declarative-parameters-vb/_static/datatutorial05vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="12635-105">[Download Sample App](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_5_VB.exe) or [Download PDF](declarative-parameters-vb/_static/datatutorial05vb1.pdf)</span></span>

> <span data-ttu-id="12635-106">W tym samouczku firma Microsoft będzie pokazano, jak użyć parametru ustawioną wartość wpisaną na stałe, aby wybrać dane do wyświetlenia w formancie widoku DetailsView.</span><span class="sxs-lookup"><span data-stu-id="12635-106">In this tutorial we'll illustrate how to use a parameter set to a hard-coded value to select the data to display in a DetailsView control.</span></span>


## <a name="introduction"></a><span data-ttu-id="12635-107">Wprowadzenie</span><span class="sxs-lookup"><span data-stu-id="12635-107">Introduction</span></span>

<span data-ttu-id="12635-108">W [ostatniego samouczek](displaying-data-with-the-objectdatasource-vb.md) analizujemy wyświetlanie danych z widoku GridView widoku DetailsView i FormView formantów związanych z kontrolki ObjectDataSource, który wywołał `GetProducts()` metody `ProductsBLL` klasy.</span><span class="sxs-lookup"><span data-stu-id="12635-108">In the [last tutorial](displaying-data-with-the-objectdatasource-vb.md) we looked at displaying data with the GridView, DetailsView, and FormView controls bound to an ObjectDataSource control that invoked the `GetProducts()` method from the `ProductsBLL` class.</span></span> <span data-ttu-id="12635-109">`GetProducts()` Metoda zwraca jednoznacznie DataTable wypełnioną wszystkie rekordy z bazy danych Northwind `Products` tabeli.</span><span class="sxs-lookup"><span data-stu-id="12635-109">The `GetProducts()` method returns a strongly-typed DataTable populated with all of the records from the Northwind database's `Products` table.</span></span> <span data-ttu-id="12635-110">`ProductsBLL` Klasa zawiera dodatkowe metody dla zwracanie tylko podzbiór produktów - `GetProductByProductID(productID)`, `GetProductsByCategoryID(categoryID)`, i `GetProductsBySupplierID(supplierID)`.</span><span class="sxs-lookup"><span data-stu-id="12635-110">The `ProductsBLL` class contains additional methods for returning just subsets of the products - `GetProductByProductID(productID)`, `GetProductsByCategoryID(categoryID)`, and `GetProductsBySupplierID(supplierID)`.</span></span> <span data-ttu-id="12635-111">Te trzy metody oczekiwać, że parametr wejściowy wskazujący sposób filtrowania informacji o produkcie zwrócony.</span><span class="sxs-lookup"><span data-stu-id="12635-111">These three methods expect an input parameter indicating how to filter the returned product information.</span></span>

<span data-ttu-id="12635-112">Element ObjectDataSource może służyć do wywoływania metod, które oczekują parametrów wejściowych, ale aby zrobić, należy określić, skąd pochodzą wartości tych parametrów.</span><span class="sxs-lookup"><span data-stu-id="12635-112">The ObjectDataSource can be used to invoke methods that expect input parameters, but in order to do so we must specify where the values for these parameters come from.</span></span> <span data-ttu-id="12635-113">Wartości parametrów, które mogą być ustalony lub mogą pochodzić z różnych źródeł dynamicznej łącznie: wartości querystring, zmienne sesji, wartość właściwości formantu sieci Web na stronie lub innym osobom.</span><span class="sxs-lookup"><span data-stu-id="12635-113">The parameter values can be hard-coded or can come from a variety of dynamic sources, including: querystring values, Session variables, the property value of a Web control on the page, or others.</span></span>

<span data-ttu-id="12635-114">W tym samouczku Zacznijmy od pokazujący sposób użycia parametru ustawioną wartość ustalony.</span><span class="sxs-lookup"><span data-stu-id="12635-114">For this tutorial let's start by illustrating how to use a parameter set to a hard-coded value.</span></span> <span data-ttu-id="12635-115">W szczególności przyjrzymy dodanie do strony, która wyświetla informacje dotyczące określonego produktu, a mianowicie Jacka Chef Gumbo mieszany, który ma element DetailsView `ProductID` 5.</span><span class="sxs-lookup"><span data-stu-id="12635-115">Specifically, we'll look at adding a DetailsView to the page that displays information about a specific product, namely Chef Anton's Gumbo Mix, which has a `ProductID` of 5.</span></span> <span data-ttu-id="12635-116">Następnie będzie przedstawiono sposób ustawiania wartości parametru na podstawie formantu sieci Web.</span><span class="sxs-lookup"><span data-stu-id="12635-116">Next, we'll see how to set the parameter value based on a Web control.</span></span> <span data-ttu-id="12635-117">W szczególności użyjemy pole tekstowe użytkownikowi należy wpisać w danym kraju, po upływie którego można kliknąć przycisk, aby wyświetlić listę dostawców, które znajdują się w tym kraju.</span><span class="sxs-lookup"><span data-stu-id="12635-117">In particular, we'll use a TextBox to let the user type in a country, after which they can click a Button to see the list of suppliers that reside in that country.</span></span>

## <a name="using-a-hard-coded-parameter-value"></a><span data-ttu-id="12635-118">Przy użyciu wartości parametru ustalony</span><span class="sxs-lookup"><span data-stu-id="12635-118">Using a Hard-Coded Parameter Value</span></span>

<span data-ttu-id="12635-119">Na przykład pierwszy, Rozpocznij od dodania formantu widoku DetailsView `DeclarativeParams.aspx` strony `BasicReporting` folderu.</span><span class="sxs-lookup"><span data-stu-id="12635-119">For the first example, start by adding a DetailsView control to the `DeclarativeParams.aspx` page in the `BasicReporting` folder.</span></span> <span data-ttu-id="12635-120">W widoku DetailsView tagów inteligentnych, wybierz &lt;nowe źródło danych&gt; z listy rozwijanej liście i wybierz opcję Dodaj element ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="12635-120">From the DetailsView's smart tag, select &lt;New data source&gt; from the drop-down list and choose to add an ObjectDataSource.</span></span>


<span data-ttu-id="12635-121">[![Na stronie Dodaj element ObjectDataSource](declarative-parameters-vb/_static/image2.png)](declarative-parameters-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="12635-121">[![Add an ObjectDataSource to the Page](declarative-parameters-vb/_static/image2.png)](declarative-parameters-vb/_static/image1.png)</span></span>

<span data-ttu-id="12635-122">**Rysunek 1**: na stronie Dodaj element ObjectDataSource ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](declarative-parameters-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="12635-122">**Figure 1**: Add an ObjectDataSource to the Page ([Click to view full-size image](declarative-parameters-vb/_static/image3.png))</span></span>


<span data-ttu-id="12635-123">Spowoduje to automatyczne uruchomienie kreatora wybierz źródło danych kontrolki ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="12635-123">This will automatically start the ObjectDataSource control's Choose Data Source wizard.</span></span> <span data-ttu-id="12635-124">Wybierz `ProductsBLL` klasy na pierwszym ekranie kreatora.</span><span class="sxs-lookup"><span data-stu-id="12635-124">Select the `ProductsBLL` class from the first screen of the wizard.</span></span>


<span data-ttu-id="12635-125">[![Wybierz klasę ProductsBLL](declarative-parameters-vb/_static/image5.png)](declarative-parameters-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="12635-125">[![Select the ProductsBLL Class](declarative-parameters-vb/_static/image5.png)](declarative-parameters-vb/_static/image4.png)</span></span>

<span data-ttu-id="12635-126">**Rysunek 2**: Wybierz `ProductsBLL` klasy ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](declarative-parameters-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="12635-126">**Figure 2**: Select the `ProductsBLL` Class ([Click to view full-size image](declarative-parameters-vb/_static/image6.png))</span></span>


<span data-ttu-id="12635-127">Ponieważ chcemy wyświetlić informacje dotyczące określonego produktu chcemy użyć `GetProductByProductID(productID)` metody.</span><span class="sxs-lookup"><span data-stu-id="12635-127">Since we want to display information about a particular product we want to use the `GetProductByProductID(productID)` method.</span></span>


<span data-ttu-id="12635-128">[![Wybierz metodę GetProductByProductID(productID)](declarative-parameters-vb/_static/image8.png)](declarative-parameters-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="12635-128">[![Choose the GetProductByProductID(productID) method](declarative-parameters-vb/_static/image8.png)](declarative-parameters-vb/_static/image7.png)</span></span>

<span data-ttu-id="12635-129">**Rysunek 3**: Wybierz `GetProductByProductID(productID)` — metoda ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](declarative-parameters-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="12635-129">**Figure 3**: Choose the `GetProductByProductID(productID)` method ([Click to view full-size image](declarative-parameters-vb/_static/image9.png))</span></span>


<span data-ttu-id="12635-130">Ponieważ metoda, którą wybrano zawiera parametr, jest jednym ekranie więcej kreatora, gdy system prosi o definiują wartości do użycia dla parametru.</span><span class="sxs-lookup"><span data-stu-id="12635-130">Since the method we selected includes a parameter, there's one more screen for the wizard, where we're asked to define the value to be used for the parameter.</span></span> <span data-ttu-id="12635-131">Na liście z lewej strony pokazano wszystkie parametry dla wybranej metody.</span><span class="sxs-lookup"><span data-stu-id="12635-131">The list on the left shows all of the parameters for the selected method.</span></span> <span data-ttu-id="12635-132">Aby uzyskać `GetProductByProductID(productID)` jest tylko jeden `productID`.</span><span class="sxs-lookup"><span data-stu-id="12635-132">For `GetProductByProductID(productID)` there's only one `productID`.</span></span> <span data-ttu-id="12635-133">Po prawej stronie można określić wartość parametru wybrane.</span><span class="sxs-lookup"><span data-stu-id="12635-133">On the right we can specify the value for the selected parameter.</span></span> <span data-ttu-id="12635-134">Listy rozwijanej Źródło parametru wylicza różnych źródeł możliwe wartości parametru.</span><span class="sxs-lookup"><span data-stu-id="12635-134">The parameter source drop-down list enumerates the various possible sources for the parameter value.</span></span> <span data-ttu-id="12635-135">Ponieważ chcemy określić wartość ustalony 5 dla `productID` parametru, pozostaw źródło parametru None, a następnie wprowadź 5 w polu tekstowym DefaultValue.</span><span class="sxs-lookup"><span data-stu-id="12635-135">Since we want to specify a hard-coded value of 5 for the `productID` parameter, leave the Parameter source as None and enter 5 into the DefaultValue textbox.</span></span>


<span data-ttu-id="12635-136">[![Hard-Coded parametru z 5 zostanie użyta wartość dla parametru productID](declarative-parameters-vb/_static/image11.png)](declarative-parameters-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="12635-136">[![A Hard-Coded Parameter Value of 5 Will Be Used for the productID Parameter](declarative-parameters-vb/_static/image11.png)](declarative-parameters-vb/_static/image10.png)</span></span>

<span data-ttu-id="12635-137">**Rysunek 4**: A Hard-Coded parametru z 5 zostanie użyta wartość dla `productID` parametr ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](declarative-parameters-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="12635-137">**Figure 4**: A Hard-Coded Parameter Value of 5 Will Be Used for the `productID` Parameter ([Click to view full-size image](declarative-parameters-vb/_static/image12.png))</span></span>


<span data-ttu-id="12635-138">Po zakończeniu pracy kreatora skonfiguruj źródło danych zawiera kod znaczników deklaratywne kontrolki ObjectDataSource `Parameter` obiektu w `SelectParameters` kolekcji dla wszystkich parametrów wejściowych oczekiwany przez metody zdefiniowanej w `SelectMethod` Właściwość.</span><span class="sxs-lookup"><span data-stu-id="12635-138">After completing the Configure Data Source wizard, the ObjectDataSource control's declarative markup includes a `Parameter` object in the `SelectParameters` collection for each of the input parameters expected by the method defined in the `SelectMethod` property.</span></span> <span data-ttu-id="12635-139">Ponieważ używamy w tym przykładzie metoda oczekuje tylko jednego parametru wejściowego, `parameterID`, jest tylko jeden wpis w tym miejscu.</span><span class="sxs-lookup"><span data-stu-id="12635-139">Since the method we're using in this example expects just a single input parameter, `parameterID`, there's only one entry here.</span></span> <span data-ttu-id="12635-140">`SelectParameters` Kolekcja może zawierać dowolną klasę, która pochodzi z `Parameter` klasy w `System.Web.UI.WebControls` przestrzeni nazw.</span><span class="sxs-lookup"><span data-stu-id="12635-140">The `SelectParameters` collection can contain any class that derives from the `Parameter` class in the `System.Web.UI.WebControls` namespace.</span></span> <span data-ttu-id="12635-141">Dla parametru ustalony wartości podstawowym `Parameter` klasa jest używana, ale w parametrze inne opcje pochodnego źródła `Parameter` klasa jest używana; można także tworzyć własne [typy parametrów niestandardowych](http://www.leftslipper.com/ShowFaq.aspx?FaqId=11), jeśli to konieczne.</span><span class="sxs-lookup"><span data-stu-id="12635-141">For hard-coded parameter values the base `Parameter` class is used, but for the other parameter source options a derived `Parameter` class is used; you can also create your own [custom parameter types](http://www.leftslipper.com/ShowFaq.aspx?FaqId=11), if needed.</span></span>

[!code-aspx[Main](declarative-parameters-vb/samples/sample1.aspx)]

> [!NOTE]
> <span data-ttu-id="12635-142">Jeśli postępujesz zgodnie z na własnym komputerze deklaratywne znaczników zostanie wyświetlony na tym etapie może zawierać wartości `InsertMethod`, `UpdateMethod`, i `DeleteMethod` właściwości, a także `DeleteParameters`.</span><span class="sxs-lookup"><span data-stu-id="12635-142">If you're following along on your own computer the declarative markup you see at this point may include values for the `InsertMethod`, `UpdateMethod`, and `DeleteMethod` properties, as well as `DeleteParameters`.</span></span> <span data-ttu-id="12635-143">Element ObjectDataSource kreatora wybierz źródło danych automatycznie określa metody z `ProductBLL` do użycia podczas wstawiania, aktualizowania i usuwania, chyba że jawnie wyczyszczone tych wychodzących, zostaną one uwzględnione w znaczniku powyżej.</span><span class="sxs-lookup"><span data-stu-id="12635-143">The ObjectDataSource's Choose Data Source wizard automatically specifies the methods from the `ProductBLL` to use for inserting, updating, and deleting, so unless you explicitly cleared those out, they'll be included in the markup above.</span></span>


<span data-ttu-id="12635-144">Podczas odwiedzania tej strony, danych formantu sieci Web zostaną wywołane przez element ObjectDataSource `Select` metodę, która wywoła `ProductsBLL` klasy `GetProductByProductID(productID)` metodę przy użyciu wartości stałe 5 `productID` parametru wejściowego.</span><span class="sxs-lookup"><span data-stu-id="12635-144">When visiting this page, the data Web control will invoke the ObjectDataSource's `Select` method, which will call the `ProductsBLL` class's `GetProductByProductID(productID)` method using the hard-coded value of 5 for the `productID` input parameter.</span></span> <span data-ttu-id="12635-145">Metoda zwróci silnie typizowanego `ProductDataTable` obiekt, który zawiera pojedynczy wiersz z informacjami o Jacka Chef Gumbo mieszanego (produkt o `ProductID` 5).</span><span class="sxs-lookup"><span data-stu-id="12635-145">The method will return a strongly-typed `ProductDataTable` object that contains a single row with information about Chef Anton's Gumbo Mix (the product with `ProductID` 5).</span></span>


<span data-ttu-id="12635-146">[![Wyświetlane są informacje o Chef Jacka Gumbo mieszany](declarative-parameters-vb/_static/image14.png)](declarative-parameters-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="12635-146">[![Information About Chef Anton's Gumbo Mix are Displayed](declarative-parameters-vb/_static/image14.png)](declarative-parameters-vb/_static/image13.png)</span></span>

<span data-ttu-id="12635-147">**Rysunek 5**: wyświetlane są informacje o Chef Jacka Gumbo mieszanego ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](declarative-parameters-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="12635-147">**Figure 5**: Information About Chef Anton's Gumbo Mix are Displayed ([Click to view full-size image](declarative-parameters-vb/_static/image15.png))</span></span>


## <a name="setting-the-parameter-value-to-the-property-value-of-a-web-control"></a><span data-ttu-id="12635-148">Ustawienie wartości parametru na wartość właściwości formantu sieci Web</span><span class="sxs-lookup"><span data-stu-id="12635-148">Setting the Parameter Value to the Property Value of a Web Control</span></span>

<span data-ttu-id="12635-149">Element ObjectDataSource parametr, który można ustawić wartości na podstawie wartości formantu na stronie sieci Web.</span><span class="sxs-lookup"><span data-stu-id="12635-149">The ObjectDataSource's parameter values can also be set based on the value of a Web control on the page.</span></span> <span data-ttu-id="12635-150">Na przykład załóżmy ma element GridView, który wyświetla listę wszystkich dostawców znajdujących się w danym kraju określone przez użytkownika.</span><span class="sxs-lookup"><span data-stu-id="12635-150">To illustrate this, let's have a GridView that lists all of the suppliers that are located in a country specified by the user.</span></span> <span data-ttu-id="12635-151">Do wykonania tego uruchomienia przez dodanie pola tekstowego do strony, do którego użytkownik może wprowadzić nazwę kraju.</span><span class="sxs-lookup"><span data-stu-id="12635-151">To accomplish this start by adding a TextBox to the page into which the user can enter a country name.</span></span> <span data-ttu-id="12635-152">Ustaw tego formantu TextBox `ID` właściwości `CountryName`.</span><span class="sxs-lookup"><span data-stu-id="12635-152">Set this TextBox control's `ID` property to `CountryName`.</span></span> <span data-ttu-id="12635-153">Również dodać kontrolkę przycisku w sieci Web.</span><span class="sxs-lookup"><span data-stu-id="12635-153">Also add a Button Web control.</span></span>


<span data-ttu-id="12635-154">[![Na stronie o identyfikatorze CountryName Dodaj pole tekstowe](declarative-parameters-vb/_static/image17.png)](declarative-parameters-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="12635-154">[![Add a TextBox to the Page with ID CountryName](declarative-parameters-vb/_static/image17.png)](declarative-parameters-vb/_static/image16.png)</span></span>

<span data-ttu-id="12635-155">**Rysunek 6**: Dodaj pole tekstowe do strony z `ID` `CountryName` ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](declarative-parameters-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="12635-155">**Figure 6**: Add a TextBox to the Page with `ID` `CountryName` ([Click to view full-size image](declarative-parameters-vb/_static/image18.png))</span></span>


<span data-ttu-id="12635-156">Następnie dodaj element GridView do strony i z tagów inteligentnych, wybierz można dodać nowego elementu ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="12635-156">Next, add a GridView to the page and, from the smart tag, choose to add a new ObjectDataSource.</span></span> <span data-ttu-id="12635-157">Ponieważ chcemy wyświetlić wybierz informacje o dostawcy `SuppliersBLL` klasy z pierwszym ekranie kreatora.</span><span class="sxs-lookup"><span data-stu-id="12635-157">Since we want to display supplier information select the `SuppliersBLL` class from the wizard's first screen.</span></span> <span data-ttu-id="12635-158">Na ekranie drugi wybierz `GetSuppliersByCountry(country)` metody.</span><span class="sxs-lookup"><span data-stu-id="12635-158">From the second screen, pick the `GetSuppliersByCountry(country)` method.</span></span>


<span data-ttu-id="12635-159">[![Wybierz metodę GetSuppliersByCountry(country)](declarative-parameters-vb/_static/image20.png)](declarative-parameters-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="12635-159">[![Choose the GetSuppliersByCountry(country) Method](declarative-parameters-vb/_static/image20.png)](declarative-parameters-vb/_static/image19.png)</span></span>

<span data-ttu-id="12635-160">**Rysunek 7**: Wybierz `GetSuppliersByCountry(country)` — metoda ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](declarative-parameters-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="12635-160">**Figure 7**: Choose the `GetSuppliersByCountry(country)` Method ([Click to view full-size image](declarative-parameters-vb/_static/image21.png))</span></span>


<span data-ttu-id="12635-161">Ponieważ `GetSuppliersByCountry(country)` metoda ma parametr wejściowy, Kreator ponownie zawiera ekranie końcowym dla wartości parametru.</span><span class="sxs-lookup"><span data-stu-id="12635-161">Since the `GetSuppliersByCountry(country)` method has an input parameter, the wizard once again includes a final screen for choosing the parameter value.</span></span> <span data-ttu-id="12635-162">Teraz, ustawioną kontroli źródła parametru.</span><span class="sxs-lookup"><span data-stu-id="12635-162">This time, set the Parameter source to Control.</span></span> <span data-ttu-id="12635-163">Spowoduje to wypełnienie listy rozwijanej ControlID z nazwami formantów na stronie; Wybierz `CountryName` kontroli z listy.</span><span class="sxs-lookup"><span data-stu-id="12635-163">This will populate the ControlID drop-down list with the names of the controls on the page; select the `CountryName` control from the list.</span></span> <span data-ttu-id="12635-164">Po pierwsze odwiedzenia strony `CountryName` pola tekstowego będzie puste, więc żadne wyniki nie są zwracane i nie będą wyświetlane żadne.</span><span class="sxs-lookup"><span data-stu-id="12635-164">When the page is first visited the `CountryName` TextBox will be blank, so no results are returned and nothing is displayed.</span></span> <span data-ttu-id="12635-165">Jeśli chcesz wyświetlić wyniki niektórych domyślnie ustawiony odpowiednio pole tekstowe DefaultValue.</span><span class="sxs-lookup"><span data-stu-id="12635-165">If you want to display some results by default, set the DefaultValue textbox accordingly.</span></span>


<span data-ttu-id="12635-166">[![Ustaw wartość parametru na wartość formantu CountryName](declarative-parameters-vb/_static/image23.png)](declarative-parameters-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="12635-166">[![Set the Parameter Value to the CountryName Control Value](declarative-parameters-vb/_static/image23.png)](declarative-parameters-vb/_static/image22.png)</span></span>

<span data-ttu-id="12635-167">**Rysunek 8**: Ustaw wartość parametru `CountryName` wartości formantu ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](declarative-parameters-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="12635-167">**Figure 8**: Set the Parameter Value to the `CountryName` Control Value ([Click to view full-size image](declarative-parameters-vb/_static/image24.png))</span></span>


<span data-ttu-id="12635-168">Znaczników deklaracyjne element ObjectDataSource różni się nieco z pierwszego przykładu, za pomocą [parametrze ControlParameter](https://msdn.microsoft.com/library/system.web.ui.webcontrols.controlparameter.aspx) zamiast standardowego `Parameter` obiektu.</span><span class="sxs-lookup"><span data-stu-id="12635-168">The ObjectDataSource's declarative markup differs slightly from our first example, using a [ControlParameter](https://msdn.microsoft.com/library/system.web.ui.webcontrols.controlparameter.aspx) instead of the standard `Parameter` object.</span></span> <span data-ttu-id="12635-169">A `ControlParameter` ma dodatkowe właściwości, aby określić `ID` kontrolka sieci Web i wartości właściwości do użycia dla parametru (`PropertyName`).</span><span class="sxs-lookup"><span data-stu-id="12635-169">A `ControlParameter` has additional properties to specify the `ID` of the Web control and the property value to use for the parameter (`PropertyName`).</span></span> <span data-ttu-id="12635-170">Kreator konfigurowania źródła danych nie inteligentne określić, że dla pola tekstowego, firma Microsoft będzie prawdopodobnie zechcesz użyć `Text` właściwości dla wartości parametru.</span><span class="sxs-lookup"><span data-stu-id="12635-170">The Configure Data Source wizard was smart enough to determine that, for a TextBox, we'll likely want to use the `Text` property for the parameter value.</span></span> <span data-ttu-id="12635-171">Jeśli jednak chcesz użyć wartości różnych właściwości z formantu sieci Web można zmienić `PropertyName` wartości w tym miejscu lub klikając łącze "Pokaż zaawansowane właściwości" w kreatorze.</span><span class="sxs-lookup"><span data-stu-id="12635-171">If, however, you want to use a different property value from the Web control you can change the `PropertyName` value here or by clicking the "Show advanced properties" link in the wizard.</span></span>

[!code-aspx[Main](declarative-parameters-vb/samples/sample2.aspx)]

<span data-ttu-id="12635-172">Podczas odwiedzania strony po raz pierwszy `CountryName` pole tekstowe jest pusta.</span><span class="sxs-lookup"><span data-stu-id="12635-172">When visiting the page for the first time the `CountryName` TextBox is empty.</span></span> <span data-ttu-id="12635-173">Element ObjectDataSource `Select` widoku GridView, ale wartość nadal jest wywoływana metoda `Nothing` została przekazana do `GetSuppliersByCountry(country)` metody.</span><span class="sxs-lookup"><span data-stu-id="12635-173">The ObjectDataSource's `Select` method is still invoked by the GridView, but a value of `Nothing` is passed into the `GetSuppliersByCountry(country)` method.</span></span> <span data-ttu-id="12635-174">Konwertuje TableAdapter `Nothing` w bazie danych `NULL` wartość (`DBNull.Value`), ale zapytania używanego przez `GetSuppliersByCountry(country)` metodę jest zapisywany w taki sposób, że nie zwraca żadnego wartości, gdy `NULL` określono wartość dla `@CategoryID`parametru.</span><span class="sxs-lookup"><span data-stu-id="12635-174">The TableAdapter converts the `Nothing` into a database `NULL` value (`DBNull.Value`), but the query used by the `GetSuppliersByCountry(country)` method is written such that it doesn't return any values when a `NULL` value is specified for the `@CategoryID` parameter.</span></span> <span data-ttu-id="12635-175">Krótko mówiąc są zwracane nie dostawców.</span><span class="sxs-lookup"><span data-stu-id="12635-175">In short, no suppliers are returned.</span></span>

<span data-ttu-id="12635-176">Po obiekt odwiedzający przechodzi w danym kraju, jednak i kliknie przycisk Pokaż dostawców powoduje odświeżenie strony, ObjectDataSource w `Select` ponowieniu metody, przekazując formantu TextBox `Text` wartość jako `country` parametru.</span><span class="sxs-lookup"><span data-stu-id="12635-176">Once the visitor enters in a country, however, and clicks the Show Suppliers button to cause a postback, the ObjectDataSource's `Select` method is requeried, passing in the TextBox control's `Text` value as the `country` parameter.</span></span>


<span data-ttu-id="12635-177">[![Tych dostawców z Kanady są wyświetlane.](declarative-parameters-vb/_static/image26.png)](declarative-parameters-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="12635-177">[![Those Suppliers from Canada are Shown](declarative-parameters-vb/_static/image26.png)](declarative-parameters-vb/_static/image25.png)</span></span>

<span data-ttu-id="12635-178">**Rysunek 9**: przedstawiono tych dostawców z Kanady ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](declarative-parameters-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="12635-178">**Figure 9**: Those Suppliers from Canada are Shown ([Click to view full-size image](declarative-parameters-vb/_static/image27.png))</span></span>


## <a name="showing-all-suppliers-by-default"></a><span data-ttu-id="12635-179">Wyświetlanie wszystkich dostawców domyślnie</span><span class="sxs-lookup"><span data-stu-id="12635-179">Showing All Suppliers By Default</span></span>

<span data-ttu-id="12635-180">Zamiast niż w przypadku najpierw wyświetlania strony nie wykazuje żadnych dostawców może chęć pokazania *wszystkie* dostawców na początku, umożliwiając użytkownikowi nawiasu listę w dół, wprowadzając w polu tekstowym Nazwa kraju.</span><span class="sxs-lookup"><span data-stu-id="12635-180">Rather than show none of the suppliers when first viewing the page we may want to show *all* suppliers at first, allowing the user to pare down the list by entering a country name in the TextBox.</span></span> <span data-ttu-id="12635-181">Gdy pole tekstowe jest pusta, `SuppliersBLL` klasy `GetSuppliersByCountry(country)` metody jest przekazywany w `Nothing` dla jego *`country`* parametru wejściowego.</span><span class="sxs-lookup"><span data-stu-id="12635-181">When the TextBox is empty, the `SuppliersBLL` class's `GetSuppliersByCountry(country)` method is passed in `Nothing` for its *`country`* input parameter.</span></span> <span data-ttu-id="12635-182">To `Nothing` wartości są następnie przekazywane w dół do warstwy DAL `GetSupplierByCountry(country)` metody, gdzie jest translacja do bazy danych `NULL` wartość `@Country` parametr w następującym zapytaniu:</span><span class="sxs-lookup"><span data-stu-id="12635-182">This `Nothing` value is then passed down into the DAL's `GetSupplierByCountry(country)` method, where it's translated to a database `NULL` value for the `@Country` parameter in the following query:</span></span>

[!code-sql[Main](declarative-parameters-vb/samples/sample3.sql)]

<span data-ttu-id="12635-183">Wyrażenie `Country = NULL` zawsze zwraca wartość False, nawet w przypadku rekordów którego `Country` kolumna ma `NULL` wartości; w związku z tym nie zwrócono żadnych rekordów.</span><span class="sxs-lookup"><span data-stu-id="12635-183">The expression `Country = NULL` always returns False, even for records whose `Country` column has a `NULL` value; therefore, no records are returned.</span></span>

<span data-ttu-id="12635-184">Aby powrócić *wszystkie* dostawców, gdy kraju pole tekstowe jest pusta, firma Microsoft może rozszerzyć `GetSuppliersByCountry(country)` w logiki warstwy Biznesowej do wywołania metody `GetSuppliers()` metody po jej parametr kraju `Nothing` oraz wywołanie DAL `GetSuppliersByCountry(country)` w przeciwnym razie — metoda</span><span class="sxs-lookup"><span data-stu-id="12635-184">To return *all* suppliers when the country TextBox is empty, we can augment the `GetSuppliersByCountry(country)` method in the BLL to invoke the `GetSuppliers()` method when its country parameter is `Nothing` and to call the DAL's `GetSuppliersByCountry(country)` method otherwise.</span></span> <span data-ttu-id="12635-185">Ma to wpływu zwracanie wszystkich dostawców, jeśli nie określono żadnych kraju i odpowiednie podzestaw dostawców, gdy parametr kraju jest dołączony.</span><span class="sxs-lookup"><span data-stu-id="12635-185">This will have the effect of returning all suppliers when no country is specified and the appropriate subset of suppliers when the country parameter is included.</span></span>

<span data-ttu-id="12635-186">Zmień `GetSuppliersByCountry(country)` metoda `SuppliersBLL` klasy do następującego:</span><span class="sxs-lookup"><span data-stu-id="12635-186">Change the `GetSuppliersByCountry(country)` method in the `SuppliersBLL` class to the following:</span></span>

[!code-vb[Main](declarative-parameters-vb/samples/sample4.vb)]

<span data-ttu-id="12635-187">Z tą zmianą `DeclarativeParams.aspx` są wyświetlane wszystkie dostawców po odwiedzeniu najpierw (lub po każdej zmianie `CountryName` pole tekstowe jest pusta).</span><span class="sxs-lookup"><span data-stu-id="12635-187">With this change the `DeclarativeParams.aspx` page shows all of the suppliers when first visited (or whenever the `CountryName` TextBox is empty).</span></span>


<span data-ttu-id="12635-188">[![Wszystkich dostawców są teraz wyświetlane domyślnie](declarative-parameters-vb/_static/image29.png)](declarative-parameters-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="12635-188">[![All Suppliers are Now Shown by Default](declarative-parameters-vb/_static/image29.png)](declarative-parameters-vb/_static/image28.png)</span></span>

<span data-ttu-id="12635-189">**Na rysunku nr 10**: wszystkich dostawców są teraz wyświetlane domyślnie ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](declarative-parameters-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="12635-189">**Figure 10**: All Suppliers are Now Shown by Default ([Click to view full-size image](declarative-parameters-vb/_static/image30.png))</span></span>


## <a name="summary"></a><span data-ttu-id="12635-190">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="12635-190">Summary</span></span>

<span data-ttu-id="12635-191">Aby można było używać metody z parametrami wejściowymi, należy określić wartości parametrów w elemencie ObjectDataSource `SelectParameters` kolekcji.</span><span class="sxs-lookup"><span data-stu-id="12635-191">In order to use methods with input parameters, we need to specify the values for the parameters in the ObjectDataSource's `SelectParameters` collection.</span></span> <span data-ttu-id="12635-192">Zezwalaj na różnych typów parametrów dla wartości parametru, które mają zostać uzyskane z różnych źródeł.</span><span class="sxs-lookup"><span data-stu-id="12635-192">Different types of parameters allow for the parameter value to be obtained from different sources.</span></span> <span data-ttu-id="12635-193">Domyślny typ parametru używa stałe wartości, ale równie łatwo (i bez linii kodu) można uzyskać wartości parametrów z querystring, zmienne sesji, plików cookie i wartości z formantów sieci Web na stronie nawet wprowadzonych przez użytkownika.</span><span class="sxs-lookup"><span data-stu-id="12635-193">The default parameter type uses a hard-coded value, but just as easily (and without a line of code) parameter values can be obtained from the querystring, Session variables, cookies, and even user-entered values from Web controls on the page.</span></span>

<span data-ttu-id="12635-194">Przykłady, które analizujemy w tym samouczku przedstawiono sposób użycia wartości deklaratywne parametrów.</span><span class="sxs-lookup"><span data-stu-id="12635-194">The examples we looked at in this tutorial illustrated how to use declarative parameter values.</span></span> <span data-ttu-id="12635-195">Jednak mogą wystąpić sytuacje, kiedy należy używać źródła parametr, który nie jest dostępny, takich jak bieżącą datę i godzinę lub, jeśli naszej witrynie korzystał z członkostwa, identyfikator użytkownika osoby odwiedzającej jest możliwe.</span><span class="sxs-lookup"><span data-stu-id="12635-195">However, there may be times when we need to use a parameter source that's not available, such as the current date and time, or, if our site was using Membership, the User ID of the visitor.</span></span> <span data-ttu-id="12635-196">W takich scenariuszach możemy ustawić wartości parametru programowo przed ObjectDataSource wywołania metody jego obiekt źródłowy.</span><span class="sxs-lookup"><span data-stu-id="12635-196">For such scenarios we can set the parameter values programmatically prior to the ObjectDataSource invoking its underlying object's method.</span></span> <span data-ttu-id="12635-197">Zajmiemy się tym, jak w tym w celu [następny samouczek](programmatically-setting-the-objectdatasource-s-parameter-values-vb.md).</span><span class="sxs-lookup"><span data-stu-id="12635-197">We'll see how to accomplish this in the [next tutorial](programmatically-setting-the-objectdatasource-s-parameter-values-vb.md).</span></span>

<span data-ttu-id="12635-198">Programowanie przyjemność!</span><span class="sxs-lookup"><span data-stu-id="12635-198">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="12635-199">Informacje o autorze</span><span class="sxs-lookup"><span data-stu-id="12635-199">About the Author</span></span>

<span data-ttu-id="12635-200">[Scott Bento](http://www.4guysfromrolla.com/ScottMitchell.shtml), autora siedmiu książek ASP/ASP.NET i twórcę z [4GuysFromRolla.com](http://www.4guysfromrolla.com), pracuje z technologii Microsoft Web od 1998.</span><span class="sxs-lookup"><span data-stu-id="12635-200">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="12635-201">Scott działa jako niezależnego konsultanta trainer i składnika zapisywania.</span><span class="sxs-lookup"><span data-stu-id="12635-201">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="12635-202">Jest jego najnowszej książki [ *Sams nauczyć się ASP.NET 2.0 w ciągu 24 godzin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="12635-202">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="12635-203">Piotr można uzyskać pod adresem [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) lub za pośrednictwem jego blog, który znajduje się w temacie [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="12635-203">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="12635-204">Specjalne podziękowania dla</span><span class="sxs-lookup"><span data-stu-id="12635-204">Special Thanks To</span></span>

<span data-ttu-id="12635-205">Ten samouczek serii zostało sprawdzone przez wiele recenzentów przydatne.</span><span class="sxs-lookup"><span data-stu-id="12635-205">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="12635-206">Recenzenta realizacji w tym samouczku został Hilton Giesenow.</span><span class="sxs-lookup"><span data-stu-id="12635-206">Lead reviewer for this tutorial was Hilton Giesenow.</span></span> <span data-ttu-id="12635-207">Zainteresowani recenzowania Moje nadchodzących artykuły MSDN?</span><span class="sxs-lookup"><span data-stu-id="12635-207">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="12635-208">Jeśli tak, Porzuć mnie linii w [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="12635-208">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="12635-209">[Poprzednie](displaying-data-with-the-objectdatasource-vb.md)
> [dalej](programmatically-setting-the-objectdatasource-s-parameter-values-vb.md)</span><span class="sxs-lookup"><span data-stu-id="12635-209">[Previous](displaying-data-with-the-objectdatasource-vb.md)
[Next](programmatically-setting-the-objectdatasource-s-parameter-values-vb.md)</span></span>
