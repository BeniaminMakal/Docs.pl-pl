---
uid: web-forms/overview/older-versions-getting-started/deploying-web-site-projects/processing-unhandled-exceptions-cs
title: Przetwarzania nieobsługiwanych wyjątków (C#) | Dokumentacja firmy Microsoft
author: rick-anderson
description: Gdy wystąpi błąd środowiska uruchomieniowego w aplikacji sieci web w środowisku produkcyjnym ważne jest, by powiadomić dewelopera i błąd logowania, dzięki czemu mogą być zdiagnozowany na a la...
ms.author: aspnetcontent
manager: wpickett
ms.date: 06/09/2009
ms.topic: article
ms.assetid: 5bc1afd5-2484-4528-b158-ab218ba150e8
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/older-versions-getting-started/deploying-web-site-projects/processing-unhandled-exceptions-cs
msc.type: authoredcontent
ms.openlocfilehash: fccd529f5c489ed28f3cb01f07ffdc4452ead36d
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/06/2018
ms.locfileid: "30889647"
---
<a name="processing-unhandled-exceptions-c"></a><span data-ttu-id="eaaf6-103">Przetwarzania nieobsługiwanych wyjątków (C#)</span><span class="sxs-lookup"><span data-stu-id="eaaf6-103">Processing Unhandled Exceptions (C#)</span></span>
====================
<span data-ttu-id="eaaf6-104">przez [Bento Scott](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="eaaf6-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="eaaf6-105">[Wyświetlić lub pobrać przykładowy kod](https://github.com/aspnet/Docs/tree/master/aspnet/web-forms/overview/older-versions-getting-started/deploying-web-site-projects/processing-unhandled-exceptions-cs/samples) ([sposobu pobierania](/aspnet/core/tutorials/index#how-to-download-a-sample))</span><span class="sxs-lookup"><span data-stu-id="eaaf6-105">[View or download sample code](https://github.com/aspnet/Docs/tree/master/aspnet/web-forms/overview/older-versions-getting-started/deploying-web-site-projects/processing-unhandled-exceptions-cs/samples) ([how to download](/aspnet/core/tutorials/index#how-to-download-a-sample))</span></span>

> <span data-ttu-id="eaaf6-106">Gdy wystąpi błąd środowiska uruchomieniowego w aplikacji sieci web w środowisku produkcyjnym należy powiadomić dewelopera i Dziennik ten błąd może być zdiagnozowany w późniejszym czasie w czasie.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-106">When a runtime error occurs on a web application in production it is important to notify a developer and to log the error so that it may be diagnosed at a later point in time.</span></span> <span data-ttu-id="eaaf6-107">Ten samouczek zawiera omówienie sposobu ASP.NET przetwarza błędy podczas wykonywania i analizuje jednym ze sposobów niestandardowy kod wykonania zawsze, gdy dymki nieobsługiwany wyjątek do środowiska wykonawczego programu ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-107">This tutorial provides an overview of how ASP.NET processes runtime errors and looks at one way to have custom code execute whenever an unhandled exception bubbles up to the ASP.NET runtime.</span></span>


## <a name="introduction"></a><span data-ttu-id="eaaf6-108">Wprowadzenie</span><span class="sxs-lookup"><span data-stu-id="eaaf6-108">Introduction</span></span>

<span data-ttu-id="eaaf6-109">Gdy wystąpi nieobsługiwany wyjątek w aplikacji ASP.NET, propaguje go do środowiska uruchomieniowego ASP.NET, który wywołuje `Error` zdarzeń i zostanie wyświetlona strona błędu odpowiednie.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-109">When an unhandled exception occurs in an ASP.NET application, it bubbles up to the ASP.NET runtime, which raises the `Error` event and displays the appropriate error page.</span></span> <span data-ttu-id="eaaf6-110">Istnieją trzy różne typy stron błędów: środowisko uruchomieniowe błąd żółty ekranu z śmierci (YSOD); Szczegóły wyjątku YSOD; i strony błędów niestandardowych.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-110">There are three different types of error pages: the Runtime Error Yellow Screen of Death (YSOD); the Exception Details YSOD; and custom error pages.</span></span> <span data-ttu-id="eaaf6-111">W [poprzedniego samouczek](displaying-a-custom-error-page-cs.md) został skonfigurowany aplikacji na używanie niestandardowej strony błędu dla użytkowników zdalnych i YSOD szczegóły wyjątku dla użytkowników odwiedzających lokalnie.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-111">In the [preceding tutorial](displaying-a-custom-error-page-cs.md) we configured the application to use a custom error page for remote users and the Exception Details YSOD for users visiting locally.</span></span>

<span data-ttu-id="eaaf6-112">Przy użyciu strony błędu niestandardowego przyjaznych dla człowieka odpowiadający wyglądu i działania witryny jest preferowana domyślne YSOD błąd środowiska uruchomieniowego, ale strona błędu niestandardowego jest tylko jedna część kompleksowe rozwiązanie do obsługi błędu.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-112">Using a human-friendly custom error page that matches the look and feel of the site is preferred to the default Runtime Error YSOD, but displaying a custom error page is only one part of a comprehensive error handling solution.</span></span> <span data-ttu-id="eaaf6-113">Po wystąpieniu błędu w aplikacji w środowisku produkcyjnym, jest ważne, że Deweloperzy są powiadamiani o błędu, aby mogli unearth przyczyną wyjątku i rozwiąż go.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-113">When an error occurs in an application in production, it is important that the developers are notified of the error so that they can unearth the cause of the exception and address it.</span></span> <span data-ttu-id="eaaf6-114">Ponadto szczegóły błędu powinny być rejestrowane, dzięki czemu błędu można zbadać i zdiagnozować w późniejszym czasie, w czasie.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-114">Furthermore, the error's details should be logged so that the error can be examined and diagnosed at a later point in time.</span></span>

<span data-ttu-id="eaaf6-115">Ten samouczek pokazuje, jak dostęp do szczegółów nieobsługiwany wyjątek, dzięki czemu mogą być rejestrowane i dewelopera powiadomienie.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-115">This tutorial shows how to access the details of an unhandled exception so that they can be logged and a developer notified.</span></span> <span data-ttu-id="eaaf6-116">Dwa samouczki, ta po Poznaj Błąd rejestrowania bibliotek, które, po nieco konfigurację, automatycznie powiadamiać deweloperzy błędy podczas wykonywania i zaloguj się ich szczegóły.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-116">The two tutorials following this one explore error logging libraries that, after a bit of configuration, will automatically notify developers of runtime errors and log their details.</span></span>

> [!NOTE]
> <span data-ttu-id="eaaf6-117">Informacje przedstawione w tym samouczku jest najbardziej przydatna do przetwarzania nieobsługiwanych wyjątków w sposób unikatowy lub dostosowane.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-117">The information examined in this tutorial is most useful if you need to process unhandled exceptions in some unique or customized manner.</span></span> <span data-ttu-id="eaaf6-118">W przypadkach, gdzie wystarczy zarejestruje wyjątek i powiadom dewelopera przy użyciu błąd podczas rejestrowania biblioteki jest sposób, aby przejść.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-118">In cases where you only need to log the exception and notify a developer, using an error logging library is the way to go.</span></span> <span data-ttu-id="eaaf6-119">Następne dwa samouczki zawierają omówienie dwóch takich bibliotek.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-119">The next two tutorials provide an overview of two such libraries.</span></span>


## <a name="executing-code-when-theerrorevent-is-raised"></a><span data-ttu-id="eaaf6-120">Wykonywanie kodu, gdy`Error`zdarzenia</span><span class="sxs-lookup"><span data-stu-id="eaaf6-120">Executing Code When The`Error`Event Is Raised</span></span>

<span data-ttu-id="eaaf6-121">Zdarzenia mechanizm obiektu sygnalizowania, że coś interesującego wystąpił, a innym obiektem, aby wykonać kod w odpowiedzi.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-121">Events provide an object a mechanism for signaling that something interesting has occurred, and for another object to execute code in response.</span></span> <span data-ttu-id="eaaf6-122">Deweloper ASP.NET użytkownik jest przyzwyczajony do planowania pod względem zdarzenia.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-122">As an ASP.NET developer you are accustomed to thinking in terms of events.</span></span> <span data-ttu-id="eaaf6-123">Jeśli chcesz uruchomić kod po kliknięciu określonego przycisku Utwórz program obsługi zdarzeń dla tego przycisku `Click` zdarzeń i umieszczono kodu.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-123">If you want to run some code when the visitor clicks a particular Button, you create an event handler for that Button's `Click` event and put your code there.</span></span> <span data-ttu-id="eaaf6-124">Biorąc pod uwagę, że moduł wykonawczy platformy ASP.NET zgłasza jego [ `Error` zdarzeń](https://msdn.microsoft.com/library/system.web.httpapplication.error.aspx) zawsze, gdy wystąpi nieobsługiwany wyjątek, wynika, że kod rejestrowania szczegóły błędu przejdzie w obsłudze zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-124">Given that the ASP.NET runtime raises its [`Error` event](https://msdn.microsoft.com/library/system.web.httpapplication.error.aspx) whenever an unhandled exception occurs, it follows that the code for logging the error's details would go in an event handler.</span></span> <span data-ttu-id="eaaf6-125">Jak utworzyć programu obsługi zdarzeń dla, ale `Error` zdarzenia?</span><span class="sxs-lookup"><span data-stu-id="eaaf6-125">But how do you create an event handler for the `Error` event?</span></span>

<span data-ttu-id="eaaf6-126">`Error` Zdarzeń jest jedną z wielu zdarzeń w [ `HttpApplication` klasy](https://msdn.microsoft.com/library/system.web.httpapplication.aspx) który pojawienia się na określonym etapie w potoku HTTP przez cały okres istnienia żądania.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-126">The `Error` event is one of many events in the [`HttpApplication` class](https://msdn.microsoft.com/library/system.web.httpapplication.aspx) that are raised at certain stages in the HTTP pipeline during the lifetime of a request.</span></span> <span data-ttu-id="eaaf6-127">Na przykład `HttpApplication` klasy [ `BeginRequest` zdarzeń](https://msdn.microsoft.com/library/system.web.httpapplication.beginrequest.aspx) jest wywoływane na początku każdego żądania; jego [ `AuthenticateRequest` zdarzeń](https://msdn.microsoft.com/library/system.web.httpapplication.authenticaterequest.aspx) jest wywoływane, gdy moduł zabezpieczeń zidentyfikował żądającego.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-127">For example, the `HttpApplication` class's [`BeginRequest` event](https://msdn.microsoft.com/library/system.web.httpapplication.beginrequest.aspx) is raised at the start of every request; its [`AuthenticateRequest` event](https://msdn.microsoft.com/library/system.web.httpapplication.authenticaterequest.aspx) is raised when a security module has identified the requestor.</span></span> <span data-ttu-id="eaaf6-128">Te `HttpApplication` zdarzenia zapewniają developer strony sposób wykonania niestandardowej logiki w różnych punktach w okresie istnienia żądanie.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-128">These `HttpApplication` events give the page developer a means to execute custom logic at the various points in the lifetime of a request.</span></span>

<span data-ttu-id="eaaf6-129">Programy obsługi zdarzeń dla `HttpApplication` zdarzeń można umieścić w specjalnym pliku o nazwie `Global.asax`.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-129">Event handlers for the `HttpApplication` events can be placed in a special file named `Global.asax`.</span></span> <span data-ttu-id="eaaf6-130">Aby utworzyć ten plik w witrynie sieci Web, Dodaj nowy element do katalogu głównego witryny sieci Web przy użyciu szablonu globalnej klasy aplikacji o nazwie `Global.asax`.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-130">To create this file in your website, add a new item to the root of your website using the Global Application Class template with the name `Global.asax`.</span></span>

[![](processing-unhandled-exceptions-cs/_static/image2.png)](processing-unhandled-exceptions-cs/_static/image1.png)

<span data-ttu-id="eaaf6-131">**Rysunek 1**: Dodaj `Global.asax` do aplikacji sieci Web</span><span class="sxs-lookup"><span data-stu-id="eaaf6-131">**Figure 1**: Add `Global.asax` To Your Web Application</span></span>  
<span data-ttu-id="eaaf6-132">([Kliknij, aby wyświetlić obraz w pełnym rozmiarze](processing-unhandled-exceptions-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="eaaf6-132">([Click to view full-size image](processing-unhandled-exceptions-cs/_static/image3.png))</span></span>

<span data-ttu-id="eaaf6-133">Zawartość i struktura `Global.asax` plik utworzony przez program Visual Studio różni się nieco zależności od tego, czy za pomocą projektu aplikacji sieci Web (WAP) lub projekt witryny sieci Web (WSP).</span><span class="sxs-lookup"><span data-stu-id="eaaf6-133">The contents and structure of the `Global.asax` file created by Visual Studio differ slightly based on whether you are using a Web Application Project (WAP) or Web Site Project (WSP).</span></span> <span data-ttu-id="eaaf6-134">Z WAP `Global.asax` jest zaimplementowany jako dwa osobne pliki - `Global.asax` i `Global.asax.cs`.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-134">With a WAP, the `Global.asax` is implemented as two separate files - `Global.asax` and `Global.asax.cs`.</span></span> <span data-ttu-id="eaaf6-135">`Global.asax` Zawiera plik, ale `@Application` dyrektywy, który odwołuje się do `.cs` plików; zdarzenia obsługi odsetek są zdefiniowane w `Global.asax.cs` pliku.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-135">The `Global.asax` file contains nothing but an `@Application` directive that references the `.cs` file; the event handlers of interest are defined in the `Global.asax.cs` file.</span></span> <span data-ttu-id="eaaf6-136">Dla WSPs, tworzony jest tylko jeden plik, `Global.asax`, i obsługi zdarzeń są definiowane w `<script runat="server">` bloku.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-136">For WSPs, only a single file is created, `Global.asax`, and the event handlers are defined in a `<script runat="server">` block.</span></span>

<span data-ttu-id="eaaf6-137">`Global.asax` Plików utworzonych w WAP przez szablon globalnej klasy aplikacji Visual Studio zawiera procedury obsługi zdarzeń o nazwie `Application_BeginRequest`, `Application_AuthenticateRequest`, i `Application_Error`, które są programy obsługi zdarzeń dla `HttpApplication` zdarzenia `BeginRequest`, `AuthenticateRequest`, i `Error`odpowiednio.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-137">The `Global.asax` file created in a WAP by Visual Studio's Global Application Class template includes event handlers named `Application_BeginRequest`, `Application_AuthenticateRequest`, and `Application_Error`, which are event handlers for the `HttpApplication` events `BeginRequest`, `AuthenticateRequest`, and `Error`, respectively.</span></span> <span data-ttu-id="eaaf6-138">Dostępne są także procedury obsługi zdarzeń o nazwie `Application_Start`, `Session_Start`, `Application_End`, i `Session_End`, które są programy obsługi zdarzeń, które uruchamiają się po aplikacji sieci web rozpoczyna się po uruchomieniu nowej sesji, podczas kończenia aplikacji, a podczas kończenia sesji odpowiednio.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-138">There are also event handlers named `Application_Start`, `Session_Start`, `Application_End`, and `Session_End`, which are event handlers that fire when the web application starts, when a new session starts, when the application ends, and when a session ends, respectively.</span></span> <span data-ttu-id="eaaf6-139">`Global.asax` Pliku utworzonego w WSP przez program Visual Studio zawiera po prostu `Application_Error`, `Application_Start`, `Session_Start`, `Application_End`, i `Session_End` procedury obsługi zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-139">The `Global.asax` file created in a WSP by Visual Studio contains just the `Application_Error`, `Application_Start`, `Session_Start`, `Application_End`, and `Session_End` event handlers.</span></span>

> [!NOTE]
> <span data-ttu-id="eaaf6-140">W przypadku wdrażania aplikacji ASP.NET należy skopiować `Global.asax` pliku do środowiska produkcyjnego.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-140">When deploying the ASP.NET application you need to copy the `Global.asax` file to the production environment.</span></span> <span data-ttu-id="eaaf6-141">`Global.asax.cs` Pliku, który jest tworzony w WAP, nie trzeba można skopiować do środowiska produkcyjnego, ponieważ ten kod jest kompilowany do zestawu projektu.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-141">The `Global.asax.cs` file, which is created in the WAP, does not need to be copied to production because this code is compiled into the project's assembly.</span></span>


<span data-ttu-id="eaaf6-142">Programy obsługi zdarzeń utworzony przez szablon globalnej klasy aplikacji Visual Studio nie są wyczerpujące.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-142">The event handlers created by Visual Studio's Global Application Class template are not exhaustive.</span></span> <span data-ttu-id="eaaf6-143">Można dodać obsługi zdarzeń dla każdego `HttpApplication` zdarzeń za pomocą nazw programu obsługi zdarzeń `Application_EventName`.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-143">You can add an event handler for any `HttpApplication` event by naming the event handler `Application_EventName`.</span></span> <span data-ttu-id="eaaf6-144">Można na przykład, Dodaj następujący kod, aby `Global.asax` pliku w celu utworzenia programu obsługi zdarzeń dla [ `AuthorizeRequest` zdarzeń](https://msdn.microsoft.com/library/system.web.httpapplication.authorizerequest.aspx):</span><span class="sxs-lookup"><span data-stu-id="eaaf6-144">For example, you could add the following code to the `Global.asax` file to create an event handler for the [`AuthorizeRequest` event](https://msdn.microsoft.com/library/system.web.httpapplication.authorizerequest.aspx):</span></span>

[!code-cs[Main](processing-unhandled-exceptions-cs/samples/sample1.cs)]

<span data-ttu-id="eaaf6-145">Podobnie należy usunąć wszystkie obsługi zdarzeń utworzony przez szablon globalnej klasy aplikacji, które nie są wymagane.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-145">Likewise, you can remove any event handlers created by the Global Application Class template that are not needed.</span></span> <span data-ttu-id="eaaf6-146">W tym samouczku wymagamy tylko program obsługi zdarzeń dla `Error` zdarzeń; działanie do usunięcia innych programów obsługi zdarzeń z `Global.asax` pliku.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-146">For this tutorial we only require an event handler for the `Error` event; feel free to remove the other event handlers from the `Global.asax` file.</span></span>

> [!NOTE]
> <span data-ttu-id="eaaf6-147">*Moduły HTTP* oferują inny sposób definiowania obsługi zdarzeń `HttpApplication` zdarzenia.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-147">*HTTP Modules* offer another way to define event handlers for `HttpApplication` events.</span></span> <span data-ttu-id="eaaf6-148">Moduły HTTP są tworzone jako plik klasy, które mogą być umieszczane bezpośrednio w ramach projektu aplikacji sieci web lub oddzielone do biblioteki osobnej klasy.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-148">HTTP Modules are created as a class file that can be placed directly within the web application project or separated out into a separate class library.</span></span> <span data-ttu-id="eaaf6-149">Ponieważ one być oddzielone w bibliotece klas, moduły HTTP oferować bardziej elastyczne i wielokrotnego użytku modelu do tworzenia `HttpApplication` procedury obsługi zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-149">Because they can be separated out into a class library, HTTP Modules offer a more flexible and reusable model for creating `HttpApplication` event handlers.</span></span> <span data-ttu-id="eaaf6-150">Podczas gdy `Global.asax` dotyczy pliku do aplikacji sieci web, w której znajduje się, moduły HTTP mogą być kompilowane do zestawów w takim przypadku Dodawanie moduł HTTP do witryny sieci Web jest tak proste, jak usunięcie zestawu `Bin` folderu i rejestrowanie Moduł w `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-150">Whereas the `Global.asax` file is specific to the web application where it resides, HTTP Modules can be compiled into assemblies, at which point adding the HTTP Module to a website is as simple as dropping the assembly in the `Bin` folder and registering the Module in `Web.config`.</span></span> <span data-ttu-id="eaaf6-151">W tym samouczku nie wygląda na tworzenie i używanie modułów HTTP, ale bibliotek dwóch rejestrowania błędów używane w następujących dwóch samouczki są zaimplementowane jako moduły HTTP.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-151">This tutorial does not look at creating and using HTTP Modules, but the two error logging libraries used in the following two tutorials are implemented as HTTP Modules.</span></span> <span data-ttu-id="eaaf6-152">Tło więcej o zaletach moduły HTTP można znaleźć w temacie [modułów przy użyciu protokołu HTTP i dojścia do tworzenia składników ASP.NET podłączany](https://msdn.microsoft.com/library/aa479332.aspx).</span><span class="sxs-lookup"><span data-stu-id="eaaf6-152">For more background on the benefits of HTTP Modules refer to [Using HTTP Modules and Handlers to Create Pluggable ASP.NET Components](https://msdn.microsoft.com/library/aa479332.aspx).</span></span>


## <a name="retrieving-information-about-the-unhandled-exception"></a><span data-ttu-id="eaaf6-153">Trwa pobieranie informacji na temat nieobsługiwany wyjątek</span><span class="sxs-lookup"><span data-stu-id="eaaf6-153">Retrieving Information About the Unhandled Exception</span></span>

<span data-ttu-id="eaaf6-154">W tym momencie mamy pliku Global.asax z `Application_Error` obsługi zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-154">At this point we have a Global.asax file with an `Application_Error` event handler.</span></span> <span data-ttu-id="eaaf6-155">Gdy wykonuje ten program obsługi zdarzeń musimy powiadomić dewelopera błędu i dziennika jego szczegóły.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-155">When this event handler executes we need to notify a developer of the error and log its details.</span></span> <span data-ttu-id="eaaf6-156">Aby wykonać te zadania, najpierw należy określić szczegóły wyjątku, który został zgłoszony.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-156">To accomplish these tasks we first need to determine the details of the exception that was raised.</span></span> <span data-ttu-id="eaaf6-157">Obiekt serwera [ `GetLastError` metody](https://msdn.microsoft.com/library/system.web.httpserverutility.getlasterror.aspx) można pobrać szczegółów nieobsługiwany wyjątek, który spowodował `Error` zdarzenia.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-157">Use the Server object's [`GetLastError` method](https://msdn.microsoft.com/library/system.web.httpserverutility.getlasterror.aspx) to retrieve details of the unhandled exception that caused the `Error` event to fire.</span></span>

[!code-csharp[Main](processing-unhandled-exceptions-cs/samples/sample2.cs)]

<span data-ttu-id="eaaf6-158">`GetLastError` Metoda zwraca wartość typu obiektu `Exception`, który jest typem podstawowym wszystkie wyjątki w programie .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-158">The `GetLastError` method returns an object of type `Exception`, which is the base type for all exceptions in the .NET Framework.</span></span> <span data-ttu-id="eaaf6-159">Jednak w powyższym kodzie I am rzutowanie obiektu wyjątku zwróconego przez `GetLastError` do `HttpException` obiektu.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-159">However, in the code above I am casting the Exception object returned by `GetLastError` into an `HttpException` object.</span></span> <span data-ttu-id="eaaf6-160">Jeśli `Error` zdarzenia jest uruchamiane, ponieważ wystąpił wyjątek podczas przetwarzania zasobu ASP.NET, a następnie został zgłoszony wyjątek jest ujęte w `HttpException`.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-160">If the `Error` event is being fired because an exception was thrown during the processing of an ASP.NET resource then the exception that was thrown is wrapped within an `HttpException`.</span></span> <span data-ttu-id="eaaf6-161">Uzyskanie faktyczny wyjątek, który wytrącane Użyj zdarzenie błędu `InnerException` właściwości.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-161">To get the actual exception that precipitated the Error event use the `InnerException` property.</span></span> <span data-ttu-id="eaaf6-162">Jeśli `Error` wywołano zdarzenie z powodu wyjątku oparte na protokole HTTP, np. żądań dotyczących stronę nieistniejącą `HttpException` jest zgłaszany, ale nie ma wyjątek wewnętrzny.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-162">If the `Error` event was raised because of an HTTP-based exception, such as a request for a non-existent page, an `HttpException` is thrown, but it does not have an inner exception.</span></span>

<span data-ttu-id="eaaf6-163">Poniższy kod używa `GetLastErrormessage` można pobrać informacji o wyjątku, który wywołał `Error` zdarzeń, przechowywanie `HttpException` w zmiennej o nazwie `lastErrorWrapper`.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-163">The following code uses the `GetLastErrormessage` to retrieve information about the exception that triggered the `Error` event, storing the `HttpException` in a variable named `lastErrorWrapper`.</span></span> <span data-ttu-id="eaaf6-164">Następnie przechowuje typu, wiadomości i ślad stosu wyjątku pochodzących w trzech zmiennych ciągu w celu sprawdzania, jeśli `lastErrorWrapper` jest faktyczny wyjątek, który wywołał `Error` zdarzenie (w przypadku oparte na protokole HTTP wyjątkami) lub czy jest jedynie Otoka dla wyjątek został zgłoszony podczas przetwarzania żądania.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-164">It then stores the type, message, and stack trace of the originating exception in three string variables, checking to see if the `lastErrorWrapper` is the actual exception that triggered the `Error` event (in the case of HTTP-based exceptions) or if it's merely a wrapper for an exception that was thrown while processing the request.</span></span>

[!code-csharp[Main](processing-unhandled-exceptions-cs/samples/sample3.cs)]

<span data-ttu-id="eaaf6-165">W tym momencie masz wszystkie informacje potrzebne do pisania kodu, który będzie rejestrować szczegóły wyjątku do tabeli bazy danych.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-165">At this point you have all the information you need to write code that will log the exception's details to a database table.</span></span> <span data-ttu-id="eaaf6-166">Dla każdej istotnej — typ, wiadomości, ślad stosu i tak dalej — wraz z innych części przydatne informacje, takie jak adres URL żądanej strony i nazwę aktualnie zalogowanego użytkownika, szczegóły błędu, można utworzyć tabeli bazy danych z kolumnami.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-166">You could create a database table with columns for each of the error details of interest - the type, the message, the stack trace, and so on - along with other useful pieces of information, such as the URL of the requested page and the name of the currently logged on user.</span></span> <span data-ttu-id="eaaf6-167">W `Application_Error` obsługi zdarzeń, czy połączenia z bazą danych i wstawienia rekordu do tabeli.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-167">In the `Application_Error` event handler you would then connect to the database and insert a record into the table.</span></span> <span data-ttu-id="eaaf6-168">Podobnie można dodać kod do alertów dewelopera błąd za pośrednictwem poczty e-mail.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-168">Likewise, you could add code to alert a developer of the error via email.</span></span>

<span data-ttu-id="eaaf6-169">Biblioteki rejestrowania błędów w dwóch następnych samouczki Podaj takich funkcji fabrycznej, więc nie ma konieczności tworzenia tego rejestrowania błędów i powiadomień.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-169">The error logging libraries examined in the next two tutorials provide such functionality out of the box, so there's no need to build this error logging and notification yourself.</span></span> <span data-ttu-id="eaaf6-170">Jednak aby zilustrować, który `Error` są zdarzenia, a `Application_Error` obsługi zdarzeń może służyć do logowania szczegóły błędu i powiadamiać dewelopera, możemy dodać kod, który powiadamia dewelopera, po wystąpieniu błędu.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-170">However, to illustrate that the `Error` event is being raised and that the `Application_Error` event handler can be used to log error details and notify a developer, let's add code that notifies a developer when an error occurs.</span></span>

## <a name="notifying-a-developer-when-an-unhandled-exception-occurs"></a><span data-ttu-id="eaaf6-171">Powiadamianie dewelopera, gdy wystąpi nieobsługiwany wyjątek</span><span class="sxs-lookup"><span data-stu-id="eaaf6-171">Notifying a Developer When an Unhandled Exception Occurs</span></span>

<span data-ttu-id="eaaf6-172">Gdy wystąpi nieobsługiwany wyjątek w środowisku produkcyjnym należy alertów zespół deweloperów, dzięki czemu mogą ocenić błąd i ustalić, jakie działania należy podjąć.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-172">When an unhandled exception occurs in the production environment it is important to alert the development team so that they can assess the error and determine what actions need to be taken.</span></span> <span data-ttu-id="eaaf6-173">Na przykład w przypadku wystąpił błąd podczas łączenia z bazą danych, konieczne będzie dwa razy, a następnie sprawdź ciąg połączenia i, prawdopodobnie, otwórz bilet pomocy technicznej z hostingu firmy w sieci web.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-173">For example, if there is an error in connecting to the database then you'll need to double check your connection string and, perhaps, open a support ticket with your web hosting company.</span></span> <span data-ttu-id="eaaf6-174">Jeśli wyjątek wystąpił z powodu błędu programowania, dodatkowy kod lub logikę weryfikacji może być konieczne można dodać, aby zapobiec takie błędy w przyszłości.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-174">If the exception occurred because of a programming error, additional code or validation logic may need to be added to prevent such errors in the future.</span></span>

<span data-ttu-id="eaaf6-175">Klasy programu .NET Framework w [ `System.Net.Mail` przestrzeni nazw](https://msdn.microsoft.com/library/system.net.mail.aspx) ułatwiają wysyłanie wiadomości e-mail.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-175">The .NET Framework classes in the [`System.Net.Mail` namespace](https://msdn.microsoft.com/library/system.net.mail.aspx) make it easy to send an email.</span></span> <span data-ttu-id="eaaf6-176">[ `MailMessage` Klasy](https://msdn.microsoft.com/library/system.net.mail.mailmessage.aspx) reprezentuje wiadomości e-mail i ma właściwości, takie jak `To`, `From`, `Subject`, `Body`, i `Attachments`.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-176">The [`MailMessage` class](https://msdn.microsoft.com/library/system.net.mail.mailmessage.aspx) represents an email message and has properties like `To`, `From`, `Subject`, `Body`, and `Attachments`.</span></span> <span data-ttu-id="eaaf6-177">`SmtpClass` Służy do wysyłania `MailMessage` przy użyciu określonego serwera SMTP; ustawienia serwera SMTP można określić programowo i deklaratywnie w [ `<system.net>` elementu](https://msdn.microsoft.com/library/6484zdc1.aspx) w `Web.config file`.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-177">The `SmtpClass` is used to send a `MailMessage` object using a specified SMTP server; the SMTP server settings can be specified programmatically or declaratively in the [`<system.net>` element](https://msdn.microsoft.com/library/6484zdc1.aspx) in the `Web.config file`.</span></span> <span data-ttu-id="eaaf6-178">Aby uzyskać więcej informacji na temat wysyłania wiadomości e-mail wiadomości w aplikacji ASP.NET, zapoznaj się z mojej artykułu [wysyłania poczty E-mail w programie ASP.NET](http://aspnet.4guysfromrolla.com/articles/072606-1.aspx)i [System.Net.Mail — często zadawane pytania](http://systemnetmail.com/).</span><span class="sxs-lookup"><span data-stu-id="eaaf6-178">For more information on sending email messages in an ASP.NET application check out my article, [Sending Email in ASP.NET](http://aspnet.4guysfromrolla.com/articles/072606-1.aspx), and the [System.Net.Mail FAQ](http://systemnetmail.com/).</span></span>

> [!NOTE]
> <span data-ttu-id="eaaf6-179">`<system.net>` Element zawiera ustawienia serwera SMTP używany przez `SmtpClient` klasy podczas wysyłania wiadomości e-mail.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-179">The `<system.net>` element contains the SMTP server settings used by the `SmtpClient` class when sending an email.</span></span> <span data-ttu-id="eaaf6-180">Firmy prawdopodobną hostingu w sieci web ma serwer SMTP, który służy do wysyłania wiadomości e-mail z aplikacji.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-180">Your web hosting company likely has an SMTP server that you can use to send email from your application.</span></span> <span data-ttu-id="eaaf6-181">Informacje na temat ustawień serwera SMTP, które powinny być używane w aplikacji sieci web na ten temat można znaleźć w sekcji Obsługa hosta sieci web.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-181">Consult your web host's support section for information on the SMTP server settings you should use in your web application.</span></span>


<span data-ttu-id="eaaf6-182">Dodaj następujący kod do `Application_Error` obsługi zdarzeń, aby wysłać wiadomość e-mail dewelopera, po wystąpieniu błędu:</span><span class="sxs-lookup"><span data-stu-id="eaaf6-182">Add the following code to the `Application_Error` event handler to send a developer an email when an error occurs:</span></span>

[!code-csharp[Main](processing-unhandled-exceptions-cs/samples/sample4.cs)]

<span data-ttu-id="eaaf6-183">Gdy powyższy kod jest bardzo długi, zbiorczego jego tworzy kod HTML, który pojawi się w wiadomości e-mail wysyłane do projektanta.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-183">While the above code is quite lengthy, the bulk of it creates the HTML that appears in the email sent to the developer.</span></span> <span data-ttu-id="eaaf6-184">Uruchamia kod za pomocą odwołań do `HttpException` zwrócony przez `GetLastError` — metoda (`lastErrorWrapper`).</span><span class="sxs-lookup"><span data-stu-id="eaaf6-184">The code starts by referencing the `HttpException` returned by the `GetLastError` method (`lastErrorWrapper`).</span></span> <span data-ttu-id="eaaf6-185">Faktyczny wyjątek, który został zgłoszony przez żądanie jest pobierana za pośrednictwem `lastErrorWrapper.InnerException` i jest przypisany do zmiennej `lastError`.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-185">The actual exception that was raised by the request is retrieved via `lastErrorWrapper.InnerException` and is assigned to the variable `lastError`.</span></span> <span data-ttu-id="eaaf6-186">Typ komunikatu i stosu informacje śledzenia są pobierane z `lastError` i przechowywane w trzech zmiennych ciągu.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-186">The type, message, and stack trace information is retrieved from `lastError` and stored in three string variables.</span></span>

<span data-ttu-id="eaaf6-187">Następnie `MailMessage` obiektu o nazwie `mm` jest tworzony.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-187">Next, a `MailMessage` object named `mm` is created.</span></span> <span data-ttu-id="eaaf6-188">Treść wiadomości e-mail jest w formacie HTML i wyświetla adres URL żądanej strony, nazwę aktualnie zalogowanego użytkownika oraz informacje o wyjątku (typ, wiadomości i ślad stosu).</span><span class="sxs-lookup"><span data-stu-id="eaaf6-188">The email body is HTML formatted and displays the URL of the requested page, the name of the currently logged on user, and information about the exception (the type, message, and stack trace).</span></span> <span data-ttu-id="eaaf6-189">Jednym z elementów chłodnych o `HttpException` jest klasa istnieje możliwość wygenerowania HTML używany do tworzenia wyjątek szczegóły żółty ekranu z śmierci (YSOD) przez wywołanie metody [GetHtmlErrorMessage — metoda](https://msdn.microsoft.com/library/system.web.httpexception.gethtmlerrormessage.aspx).</span><span class="sxs-lookup"><span data-stu-id="eaaf6-189">One of the cool things about the `HttpException` class is that you can generate the HTML used to create the Exception Details Yellow Screen of Death (YSOD) by calling the [GetHtmlErrorMessage method](https://msdn.microsoft.com/library/system.web.httpexception.gethtmlerrormessage.aspx).</span></span> <span data-ttu-id="eaaf6-190">Ta metoda służy tutaj, aby pobrać znaczników YSOD szczegóły wyjątku i dodaj go jako załącznik wiadomości e-mail.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-190">This method is used here to retrieve the Exception Details YSOD markup and add it to the email as an attachment.</span></span> <span data-ttu-id="eaaf6-191">Ostrzeżenie o jedno słowo: Jeśli wyjątek który wyzwolone `Error` zdarzeń wyjątek oparte na protokole HTTP (np. żądań dotyczących strony nieistniejącą), a następnie `GetHtmlErrorMessage` metoda zwróci `null`.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-191">One word of caution: if the exception that triggered the `Error` event was an HTTP-based exception (such as a request for a non-existent page) then the `GetHtmlErrorMessage` method will return `null`.</span></span>

<span data-ttu-id="eaaf6-192">Ostatnim krokiem jest wysłanie `MailMessage`.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-192">The final step is to send the `MailMessage`.</span></span> <span data-ttu-id="eaaf6-193">Odbywa się przez utworzenie nowej `SmtpClient` — metoda i wywoływanie jej `Send` metody.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-193">This is done by creating a new `SmtpClient` method and calling its `Send` method.</span></span>

> [!NOTE]
> <span data-ttu-id="eaaf6-194">Przed użyciem tego kodu w aplikacji sieci web można zmienić wartości w `ToAddress` i `FromAddress` stałe z support@example.com niezależnie od wiadomości e-mail adres błąd powiadomienia e-mail mają być wysyłane do i pochodzi z.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-194">Before using this code in your web application you'll want to change the values in the `ToAddress` and `FromAddress` constants from support@example.com to whatever email address the error notification email should be sent to and originate from.</span></span> <span data-ttu-id="eaaf6-195">Należy również określić ustawienia serwera SMTP w `<system.net>` sekcji `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-195">You'll also need to specify SMTP server settings in the `<system.net>` section in `Web.config`.</span></span> <span data-ttu-id="eaaf6-196">Zapoznaj się z dostawcą hosta sieci web, aby określić ustawienia serwera SMTP do użycia.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-196">Consult your web host provider to determine the SMTP server settings to use.</span></span>


<span data-ttu-id="eaaf6-197">Kod w miejscu przy każdym wystąpieniu błędu dewelopera są wysyłane wiadomości e-mail znajduje się podsumowanie błąd, który obejmuje YSOD.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-197">With this code in place anytime there's an error the developer is sent an email message that summarizes the error and includes the YSOD.</span></span> <span data-ttu-id="eaaf6-198">W poprzednim samouczka przedstawiono firma Microsoft błąd w czasie wykonywania odwiedzając Genre.aspx i przekazując nieprawidłowy `ID` wartości za pośrednictwem ciąg zapytania, takie jak `Genre.aspx?ID=foo`.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-198">In the preceding tutorial we demonstrated a runtime error by visiting Genre.aspx and passing in an invalid `ID` value through the querystring, like `Genre.aspx?ID=foo`.</span></span> <span data-ttu-id="eaaf6-199">Odwiedzania strony z `Global.asax` miejscowej pliku tworzy tego samego środowiska użytkownika, jak w poprzednim samouczek — w środowisku programistycznym nastąpi przejście do zobacz wyjątek szczegóły żółty ekranem śmierci, podczas gdy w środowisku produkcyjnym należy odwiedź stronę błędu niestandardowego.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-199">Visiting the page with the `Global.asax` file in place produces the same user experience as in the preceding tutorial - in the development environment you'll continue to see the Exception Details Yellow Screen of Death, while in the production environment you'll see the custom error page.</span></span> <span data-ttu-id="eaaf6-200">Oprócz tego zachowanie istniejącej dewelopera jest wysyłana wiadomość e-mail.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-200">In addition to this existing behavior, the developer is sent an email.</span></span>

<span data-ttu-id="eaaf6-201">**Rysunek 2** pokazuje wiadomości e-mail podczas odwiedzania `Genre.aspx?ID=foo`.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-201">**Figure 2** shows the email received when visiting `Genre.aspx?ID=foo`.</span></span> <span data-ttu-id="eaaf6-202">Treść wiadomości e-mail zawiera podsumowanie informacji o wyjątkach, podczas gdy `YSOD.htm` załącznika wyświetla zawartość, która jest wyświetlana w YSOD szczegóły wyjątku (zobacz **rysunek 3**).</span><span class="sxs-lookup"><span data-stu-id="eaaf6-202">The email body summarizes the exception information, while the `YSOD.htm` attachment displays the content that is shown in the Exception Details YSOD (see **Figure 3**).</span></span>

[![](processing-unhandled-exceptions-cs/_static/image5.png)](processing-unhandled-exceptions-cs/_static/image4.png)

<span data-ttu-id="eaaf6-203">**Rysunek 2**: dewelopera jest wysyłana wiadomość E-mail z powiadomieniem, zawsze, gdy jest nieobsługiwany wyjątek</span><span class="sxs-lookup"><span data-stu-id="eaaf6-203">**Figure 2**: The Developer Is Sent An Email Notification Whenever There's An Unhandled Exception</span></span>  
<span data-ttu-id="eaaf6-204">([Kliknij, aby wyświetlić obraz w pełnym rozmiarze](processing-unhandled-exceptions-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="eaaf6-204">([Click to view full-size image](processing-unhandled-exceptions-cs/_static/image6.png))</span></span>

[![](processing-unhandled-exceptions-cs/_static/image8.png)](processing-unhandled-exceptions-cs/_static/image7.png)

<span data-ttu-id="eaaf6-205">**Rysunek 3**: powiadomienie E-mail zawiera szczegóły wyjątku YSOD jako załącznik</span><span class="sxs-lookup"><span data-stu-id="eaaf6-205">**Figure 3**: The Email Notification Includes the Exception Details YSOD As An Attachment</span></span>  
<span data-ttu-id="eaaf6-206">([Kliknij, aby wyświetlić obraz w pełnym rozmiarze](processing-unhandled-exceptions-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="eaaf6-206">([Click to view full-size image](processing-unhandled-exceptions-cs/_static/image9.png))</span></span>

## <a name="what-about-using-the-custom-error-page"></a><span data-ttu-id="eaaf6-207">Co zrobić za pomocą strony błędu niestandardowego?</span><span class="sxs-lookup"><span data-stu-id="eaaf6-207">What About Using the Custom Error Page?</span></span>

<span data-ttu-id="eaaf6-208">W tym samouczku przedstawiono sposób użycia `Global.asax` i `Application_Error` obsługi zdarzeń do wykonywania kodu, gdy wystąpi nieobsługiwany wyjątek.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-208">This tutorial showed how to use `Global.asax` and the `Application_Error` event handler to execute code when an unhandled exception occurs.</span></span> <span data-ttu-id="eaaf6-209">W szczególności użyliśmy ten program obsługi zdarzeń do powiadamiania dewelopera błąd; Firma Microsoft może rozszerzyć również logowania szczegóły błędu w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-209">Specifically, we used this event handler to notify a developer of an error; we could extend it to also log the error details in a database.</span></span> <span data-ttu-id="eaaf6-210">Obecność `Application_Error` program obsługi zdarzeń nie ma wpływu na środowisko użytkownika końcowego.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-210">The presence of the `Application_Error` event handler does not affect the end user's experience.</span></span> <span data-ttu-id="eaaf6-211">Wciąż widzą strony błędów skonfigurowany, YSOD szczegóły błędu, YSOD błąd środowiska uruchomieniowego i stronę błędu niestandardowego.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-211">They still see the configured error page, be it the Error Details YSOD, the Runtime Error YSOD, or the custom error page.</span></span>

<span data-ttu-id="eaaf6-212">Naturalna staje się zastanawiasz się, czy `Global.asax` pliku i `Application_Error` zdarzenie jest niezbędne, używając strony błędu niestandardowego.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-212">It's natural to wonder whether the `Global.asax` file and `Application_Error` event is necessary when using a custom error page.</span></span> <span data-ttu-id="eaaf6-213">Jeśli wystąpi błąd, użytkownik jest wyświetlana strona błędu niestandardowego tak Dlaczego nie testujemy kod, aby powiadomić projektanta i dziennika szczegóły błędu w klasie związanej z kodem strony błędu niestandardowego?</span><span class="sxs-lookup"><span data-stu-id="eaaf6-213">When an error occurs the user is shown the custom error page so why can't we put the code to notify the developer and log the error details into the code-behind class of the custom error page?</span></span> <span data-ttu-id="eaaf6-214">Gdy na pewno można dodać kod do klasy związane z kodem strony błędu niestandardowego nie masz dostęp do szczegółów wyjątku, który wywołał `Error` zdarzenie, gdy przy użyciu techniki możemy przedstawione w poprzednich instrukcji.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-214">While you can certainly add code to the custom error page's code-behind class you do not have access to the details of the exception that triggered the `Error` event when using the technique we explored in the preceding tutorial.</span></span> <span data-ttu-id="eaaf6-215">Wywoływanie `GetLastError` metoda ze strony błędu niestandardowego zwraca `Nothing`.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-215">Calling the `GetLastError` method from the custom error page returns `Nothing`.</span></span>

<span data-ttu-id="eaaf6-216">Przyczyna to zachowanie jest ponieważ osiągnięto za pomocą przekierowania strony błędu niestandardowego.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-216">The reason for this behavior is because the custom error page is reached via a redirect.</span></span> <span data-ttu-id="eaaf6-217">Gdy wystąpił nieobsługiwany wyjątek osiągnie środowiska uruchomieniowego ASP.NET aparatu ASP.NET zgłasza jego `Error` zdarzenia (który wykonuje `Application_Error` obsługi zdarzeń), a następnie *przekierowuje* użytkownika do strony błędu niestandardowego, wysyłając `Response.Redirect(customErrorPageUrl)`.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-217">When an unhandled exception reaches the ASP.NET runtime the ASP.NET engine raises its `Error` event (which executes the `Application_Error` event handler) and then *redirects* the user to the custom error page by issuing a `Response.Redirect(customErrorPageUrl)`.</span></span> <span data-ttu-id="eaaf6-218">`Response.Redirect` Metoda wysyła odpowiedź do klienta z kodem stanu HTTP 302 poinstruowanie przeglądarkę, aby nowy adres URL, czyli strony błędu niestandardowego.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-218">The `Response.Redirect` method sends a response to the client with an HTTP 302 status code, instructing the browser to request a new URL, namely the custom error page.</span></span> <span data-ttu-id="eaaf6-219">Przeglądarka następnie automatycznie żąda nowej strony.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-219">The browser then automatically requests this new page.</span></span> <span data-ttu-id="eaaf6-220">Można określić, że strony błędu niestandardowego zażądano oddzielnie ze strony którego pochodzi błąd, ponieważ zmiany paska adresu w przeglądarce adres URL strony błędu niestandardowego (zobacz **4 rysunek**).</span><span class="sxs-lookup"><span data-stu-id="eaaf6-220">You can tell that the custom error page was requested separately from the page where the error originated because the browser's Address bar changes to the custom error page URL (see **Figure 4**).</span></span>

[![](processing-unhandled-exceptions-cs/_static/image11.png)](processing-unhandled-exceptions-cs/_static/image10.png)

<span data-ttu-id="eaaf6-221">**Rysunek 4**: Jeśli wystąpi błąd przeglądarki jest kierowany do adresu URL strony błędu niestandardowego</span><span class="sxs-lookup"><span data-stu-id="eaaf6-221">**Figure 4**: When an Error Occurs the Browser Gets Redirected to the Custom Error Page URL</span></span>  
<span data-ttu-id="eaaf6-222">([Kliknij, aby wyświetlić obraz w pełnym rozmiarze](processing-unhandled-exceptions-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="eaaf6-222">([Click to view full-size image](processing-unhandled-exceptions-cs/_static/image12.png))</span></span>

<span data-ttu-id="eaaf6-223">Net powoduje, że serwer odpowiadający przy użyciu przekierowania HTTP 302 kończy się żądanie, w którym wystąpił nieobsługiwany wyjątek.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-223">The net effect is that the request where the unhandled exception occurred ends when the server responds with the HTTP 302 redirect.</span></span> <span data-ttu-id="eaaf6-224">Kolejne żądania do strony błędu niestandardowego jest całkowicie nowe żądanie; w tym punkcie ASP.NET aparat odrzucił informacje o błędzie, a ponadto nie ma możliwości skojarzenia nieobsługiwany wyjątek w wcześniejsze żądanie z nowego żądania strony błędu niestandardowego.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-224">The subsequent request to the custom error page is a brand new request; by this point the ASP.NET engine has discarded the error information and, moreover, has no way to associate the unhandled exception in the previous request with the new request for the custom error page.</span></span> <span data-ttu-id="eaaf6-225">Jest to dlaczego `GetLastError` zwraca `null` wywołanego ze strony błędu niestandardowego.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-225">This is why `GetLastError` returns `null` when called from the custom error page.</span></span>

<span data-ttu-id="eaaf6-226">Jednak jest możliwe wykonywanego w jednym żądaniu powodujący błąd strony błędu niestandardowego.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-226">However, it is possible to have the custom error page executed during the same request that caused the error.</span></span> <span data-ttu-id="eaaf6-227">[ `Server.Transfer(url)` ](https://msdn.microsoft.com/library/system.web.httpserverutility.transfer.aspx) Metody przenosi wykonanie do określonego adresu URL i przetwarza je w jednym żądaniu.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-227">The [`Server.Transfer(url)`](https://msdn.microsoft.com/library/system.web.httpserverutility.transfer.aspx) method transfers execution to the specified URL and processes it within the same request.</span></span> <span data-ttu-id="eaaf6-228">Można przenieść kod w `Application_Error` obsługi zdarzeń do klasy związane z kodem strony błędu niestandardowego, zastępując je w `Global.asax` następującym kodem:</span><span class="sxs-lookup"><span data-stu-id="eaaf6-228">You could move the code in the `Application_Error` event handler to the custom error page's code-behind class, replacing it in `Global.asax` with the following code:</span></span>

[!code-csharp[Main](processing-unhandled-exceptions-cs/samples/sample5.cs)]

<span data-ttu-id="eaaf6-229">Teraz, gdy wystąpił nieobsługiwany wyjątek wystąpi `Application_Error` obsługi zdarzeń przekazuje sterowanie do odpowiednich niestandardowej strony błędu na podstawie kodu stanu HTTP.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-229">Now when an unhandled exception occurs the `Application_Error` event handler transfers control to the appropriate custom error page based on the HTTP status code.</span></span> <span data-ttu-id="eaaf6-230">Ponieważ sterowania zostało przeniesione, stronę błędu niestandardowego ma dostęp do informacji nieobsługiwany wyjątek za pośrednictwem `Server.GetLastError` i powiadomić dewelopera błędu i dziennika można jego szczegóły.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-230">Because control was transferred, the custom error page has access to the unhandled exception information via `Server.GetLastError` and can notify a developer of the error and log its details.</span></span> <span data-ttu-id="eaaf6-231">`Server.Transfer` Przestanie aparatu ASP.NET z przekierowanie użytkownika do strony błędu niestandardowego.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-231">The `Server.Transfer` call stops the ASP.NET engine from redirecting the user to the custom error page.</span></span> <span data-ttu-id="eaaf6-232">Zamiast tego zawartość strony błędu niestandardowego jest zwracana jako odpowiedzi do strony, który wygenerował błąd.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-232">Instead, the custom error page's content is returned as the response to the page that generated the error.</span></span>

## <a name="summary"></a><span data-ttu-id="eaaf6-233">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="eaaf6-233">Summary</span></span>

<span data-ttu-id="eaaf6-234">Gdy wystąpi nieobsługiwany wyjątek w aplikacji sieci web ASP.NET środowiska uruchomieniowego ASP.NET zgłasza `Error` zdarzeń i zostanie wyświetlona strona błędu skonfigurowany.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-234">When an unhandled exception occurs in an ASP.NET web application the ASP.NET runtime raises the `Error` event and displays the configured error page.</span></span> <span data-ttu-id="eaaf6-235">Mamy powiadamiać developer błędu, jego szczegóły logowania lub przetwarzać dane w dowolny sposób, tworząc program obsługi zdarzeń dla zdarzenia błędu.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-235">We can notify the developer of the error, log its details, or process it in some other fashion, by creating an event handler for the Error event.</span></span> <span data-ttu-id="eaaf6-236">Istnieją dwa sposoby tworzenia programu obsługi zdarzeń dla `HttpApplication` zdarzeń, takich jak `Error`: w `Global.asax` pliku lub modułu HTTP.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-236">There are two ways to create an event handler for `HttpApplication` events like `Error`: in the `Global.asax` file or from an HTTP Module.</span></span> <span data-ttu-id="eaaf6-237">W tym samouczku przedstawiono sposób tworzenia `Error` obsługi zdarzeń w `Global.asax` pliku, który powiadamia deweloperzy błąd za pomocą wiadomości e-mail.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-237">This tutorial showed how to create an `Error` event handler in the `Global.asax` file that notifies developers of an error by means of an email message.</span></span>

<span data-ttu-id="eaaf6-238">Tworzenie `Error` procedura obsługi zdarzeń jest przydatna do przetwarzania nieobsługiwanych wyjątków w sposób unikatowy lub dostosowane.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-238">Creating an `Error` event handler is useful if you need to process unhandled exceptions in some unique or customized manner.</span></span> <span data-ttu-id="eaaf6-239">Jednak tworzenia własnego `Error` obsługi zdarzeń, który zarejestruje wyjątek lub powiadamiania Projektant nie jest najbardziej efektywne wykorzystanie czasu, ponieważ istnieją już bezpłatny i łatwy w użyciu Błąd rejestrowania bibliotek, które można skonfigurować w ciągu kilku minut.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-239">However, creating your own `Error` event handler to log the exception or to notify a developer is not the most efficient use of your time as there already exist free and easy to use error logging libraries that can be setup in a matter of minutes.</span></span> <span data-ttu-id="eaaf6-240">Następne dwa samouczki Sprawdź, czy dwie takie biblioteki.</span><span class="sxs-lookup"><span data-stu-id="eaaf6-240">The next two tutorials examine two such libraries.</span></span>

<span data-ttu-id="eaaf6-241">Programowanie przyjemność!</span><span class="sxs-lookup"><span data-stu-id="eaaf6-241">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="eaaf6-242">Dalsze informacje</span><span class="sxs-lookup"><span data-stu-id="eaaf6-242">Further Reading</span></span>

<span data-ttu-id="eaaf6-243">Więcej informacji dotyczących tematów omówionych w tym samouczku można znaleźć w następujących zasobach:</span><span class="sxs-lookup"><span data-stu-id="eaaf6-243">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="eaaf6-244">Omówienie obsługi HTTP i moduły HTTP platformy ASP.NET</span><span class="sxs-lookup"><span data-stu-id="eaaf6-244">ASP.NET HTTP Modules and HTTP Handlers Overview</span></span>](https://support.microsoft.com/kb/307985)
- [<span data-ttu-id="eaaf6-245">Bezpiecznie odpowiada na żądania nieobsługiwanych wyjątków - przetwarzania nieobsługiwanych wyjątków</span><span class="sxs-lookup"><span data-stu-id="eaaf6-245">Gracefully Responding to Unhandled Exceptions - Processing Unhandled Exceptions</span></span>](http://aspnet.4guysfromrolla.com/articles/091306-1.aspx)
- [<span data-ttu-id="eaaf6-246">`HttpApplication` Klasa i obiekt aplikacji ASP.NET</span><span class="sxs-lookup"><span data-stu-id="eaaf6-246">`HttpApplication` Class and the ASP.NET Application Object</span></span>](http://www.eggheadcafe.com/articles/20030211.asp)
- [<span data-ttu-id="eaaf6-247">Programy obsługi HTTP i modułów HTTP w programie ASP.NET</span><span class="sxs-lookup"><span data-stu-id="eaaf6-247">HTTP Handlers and HTTP Modules in ASP.NET</span></span>](http://www.15seconds.com/Issue/020417.htm)
- [<span data-ttu-id="eaaf6-248">Wysyłanie wiadomości E-mail w programie ASP.NET</span><span class="sxs-lookup"><span data-stu-id="eaaf6-248">Sending Email in ASP.NET</span></span>](http://aspnet.4guysfromrolla.com/articles/072606-1.aspx)
- [<span data-ttu-id="eaaf6-249">Opis `Global.asax` pliku</span><span class="sxs-lookup"><span data-stu-id="eaaf6-249">Understanding the `Global.asax` File</span></span>](http://aspalliance.com/1114_Understanding_the_Globalasax_file.all)
- [<span data-ttu-id="eaaf6-250">Tworzenie składników ASP.NET podłączany przy użyciu moduły HTTP i obsługi</span><span class="sxs-lookup"><span data-stu-id="eaaf6-250">Using HTTP Modules and Handlers to Create Pluggable ASP.NET Components</span></span>](https://msdn.microsoft.com/library/aa479332.aspx)
- [<span data-ttu-id="eaaf6-251">Praca z platformy ASP.NET `Global.asax` pliku</span><span class="sxs-lookup"><span data-stu-id="eaaf6-251">Working with the ASP.NET `Global.asax` File</span></span>](http://articles.techrepublic.com.com/5100-10878_11-5771721.html)
- [<span data-ttu-id="eaaf6-252">Praca z `HttpApplication` wystąpień</span><span class="sxs-lookup"><span data-stu-id="eaaf6-252">Working with `HttpApplication` Instances</span></span>](https://msdn.microsoft.com/library/a0xez8f2.aspx)

> [!div class="step-by-step"]
> <span data-ttu-id="eaaf6-253">[Poprzednie](displaying-a-custom-error-page-cs.md)
> [dalej](logging-error-details-with-asp-net-health-monitoring-cs.md)</span><span class="sxs-lookup"><span data-stu-id="eaaf6-253">[Previous](displaying-a-custom-error-page-cs.md)
[Next](logging-error-details-with-asp-net-health-monitoring-cs.md)</span></span>
