---
uid: web-forms/overview/data-access/filtering-scenarios-with-the-datalist-and-repeater/master-detail-filtering-acess-two-pages-datalist-vb
title: Wzorzec/szczegół filtrowania przez dwie strony (VB) | Dokumentacja firmy Microsoft
author: rick-anderson
description: W ramach tego samouczka przyjrzymy się oddzielającego raportu wzorzec/szczegół między dwoma stronami. Na stronie "master" używamy kontrolce elementu powtarzanego do renderowania listę categ...
ms.author: aspnetcontent
manager: wpickett
ms.date: 10/30/2010
ms.topic: article
ms.assetid: f1a1be2c-6fd9-4a09-916e-aa1b98d5cf17
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/filtering-scenarios-with-the-datalist-and-repeater/master-detail-filtering-acess-two-pages-datalist-vb
msc.type: authoredcontent
ms.openlocfilehash: 2afc216de3b6894cfdd112787ab92d7483198ecc
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/06/2018
ms.locfileid: "30886235"
---
<a name="masterdetail-filtering-across-two-pages-vb"></a><span data-ttu-id="f2c13-104">Wzorzec/szczegół filtrowania przez dwie strony (VB)</span><span class="sxs-lookup"><span data-stu-id="f2c13-104">Master/Detail Filtering Across Two Pages (VB)</span></span>
====================
<span data-ttu-id="f2c13-105">przez [Bento Scott](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="f2c13-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="f2c13-106">[Pobierz przykładową aplikację](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_34_VB.exe) lub [pobierania plików PDF](master-detail-filtering-acess-two-pages-datalist-vb/_static/datatutorial34vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="f2c13-106">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_34_VB.exe) or [Download PDF](master-detail-filtering-acess-two-pages-datalist-vb/_static/datatutorial34vb1.pdf)</span></span>

> <span data-ttu-id="f2c13-107">W ramach tego samouczka przyjrzymy się oddzielającego raportu wzorzec/szczegół między dwoma stronami.</span><span class="sxs-lookup"><span data-stu-id="f2c13-107">In this tutorial we look at how to separate a master/detail report across two pages.</span></span> <span data-ttu-id="f2c13-108">Na stronie "główny" używamy kontrolce elementu powtarzanego do renderowania listy kategorii, gdy kliknięto, potrwa użytkownika na stronie "szczegóły", gdzie DataList dwie kolumny zawiera tych produktów należących do wybranej kategorii.</span><span class="sxs-lookup"><span data-stu-id="f2c13-108">In the "master" page we use a Repeater control to render a list of categories that, when clicked, will take the user to the "details" page where a two-column DataList shows those products belonging to the selected category.</span></span>


## <a name="introduction"></a><span data-ttu-id="f2c13-109">Wprowadzenie</span><span class="sxs-lookup"><span data-stu-id="f2c13-109">Introduction</span></span>

<span data-ttu-id="f2c13-110">W [wzorzec/szczegół filtrowania między dwoma stronami](../masterdetail/master-detail-filtering-across-two-pages-vb.md) samouczek, możemy zbadać tego wzorca przy użyciu Element GridView w celu wyświetlenia wszystkich dostawców w systemie.</span><span class="sxs-lookup"><span data-stu-id="f2c13-110">In the [Master/Detail Filtering Across Two Pages](../masterdetail/master-detail-filtering-across-two-pages-vb.md) tutorial, we examined this pattern using a GridView to display all of the suppliers in the system.</span></span> <span data-ttu-id="f2c13-111">Ten element GridView uwzględnione pole hiperłącza HyperLinkField, który odwzorowany jako łącze do drugiej strony, przekazywanie wzdłuż `SupplierID` w zmiennej querystring.</span><span class="sxs-lookup"><span data-stu-id="f2c13-111">This GridView included a HyperLinkField, which rendered as a link to a second page, passing along the `SupplierID` in the querystring.</span></span> <span data-ttu-id="f2c13-112">Druga strona używany element GridView do tworzenia listy produktów dostarczone przez wybranego dostawcę.</span><span class="sxs-lookup"><span data-stu-id="f2c13-112">The second page used a GridView to list those products provided by the selected supplier.</span></span>

<span data-ttu-id="f2c13-113">Raporty takie dwustronicowy wzorzec/szczegół można osiągnąć za pomocą formantów DataList i elementu powtarzanego.</span><span class="sxs-lookup"><span data-stu-id="f2c13-113">Such two-page master/detail reports can be accomplished using DataList and Repeater controls as well.</span></span> <span data-ttu-id="f2c13-114">Jedyna różnica polega na tym, że elementu DataList ani powtarzanego zapewnia obsługę dla formantu pole hiperłącza HyperLinkField.</span><span class="sxs-lookup"><span data-stu-id="f2c13-114">The only difference is that neither the DataList nor the Repeater provides support for the HyperLinkField control.</span></span> <span data-ttu-id="f2c13-115">Zamiast tego, firma Microsoft lub należy dodać formant sieci Web hiperłącza element kotwicy HTML (`<a>`) w formancie `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="f2c13-115">Instead, we must add a HyperLink Web control or an anchor HTML element (`<a>`) within the control's `ItemTemplate`.</span></span> <span data-ttu-id="f2c13-116">HyperLink `NavigateUrl` właściwości lub zakotwiczenia `href` atrybut można następnie dostosować przy użyciu podejścia deklaratywne lub programowe.</span><span class="sxs-lookup"><span data-stu-id="f2c13-116">The HyperLink's `NavigateUrl` property or the anchor's `href` attribute can then be customized using declarative or programmatic approaches.</span></span>

<span data-ttu-id="f2c13-117">W tym samouczku firma Microsoft będzie zapoznać się przykładem, który zawiera listę kategorii na liście punktowanej na jednej stronie przy użyciu kontrolce elementu powtarzanego.</span><span class="sxs-lookup"><span data-stu-id="f2c13-117">In this tutorial we'll explore an example that lists the categories in a bulleted list on one page using a Repeater control.</span></span> <span data-ttu-id="f2c13-118">Każdy element tej listy będzie zawierać nazwę i opis, kategoria o nazwie kategorii wyświetlany jako łącze do drugiej strony.</span><span class="sxs-lookup"><span data-stu-id="f2c13-118">Each list item will include the category's name and description, with the category name displayed as a link to a second page.</span></span> <span data-ttu-id="f2c13-119">Kliknięcie tego łącza spowoduje whisk użytkownika do drugiej strony, gdzie DataList wyświetli te produkty, które należą do wybranej kategorii.</span><span class="sxs-lookup"><span data-stu-id="f2c13-119">Clicking on this link will whisk the user to the second page, where a DataList will show those products that belong to the selected category.</span></span>

## <a name="step-1-displaying-the-categories-in-a-bulleted-list"></a><span data-ttu-id="f2c13-120">Krok 1: Wyświetlanie kategorii na liście punktowanej</span><span class="sxs-lookup"><span data-stu-id="f2c13-120">Step 1: Displaying the Categories in a Bulleted List</span></span>

<span data-ttu-id="f2c13-121">Pierwszym krokiem tworzenia żadnych raportów wzorzec/szczegół jest można uruchomić za pomocą wyświetlania rekordów "master".</span><span class="sxs-lookup"><span data-stu-id="f2c13-121">The first step in creating any master/detail report is to start by displaying the "master" records.</span></span> <span data-ttu-id="f2c13-122">W związku z tym naszym pierwszym zadaniem jest wyświetlone kategorii na stronie "master".</span><span class="sxs-lookup"><span data-stu-id="f2c13-122">Therefore, our first task is to display the categories in the "master" page.</span></span> <span data-ttu-id="f2c13-123">Otwórz `CategoryListMaster.aspx` strony `DataListRepeaterFiltering` , Dodaj kontrolce elementu powtarzanego i, z tagu inteligentnego, należy wybrać opcję Dodaj nowy element ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="f2c13-123">Open the `CategoryListMaster.aspx` page in the `DataListRepeaterFiltering` folder, add a Repeater control, and, from the smart tag, opt to add a new ObjectDataSource.</span></span> <span data-ttu-id="f2c13-124">Skonfiguruj nowy element ObjectDataSource, dzięki czemu uzyskuje dostęp do danych z `CategoriesBLL` klasy `GetCategories` — metoda (zobacz rysunek 1).</span><span class="sxs-lookup"><span data-stu-id="f2c13-124">Configure the new ObjectDataSource so that it accesses its data from the `CategoriesBLL` class's `GetCategories` method (see Figure 1).</span></span>


<span data-ttu-id="f2c13-125">[![Skonfiguruj element ObjectDataSource przy użyciu metody GetCategories klasy CategoriesBLL](master-detail-filtering-acess-two-pages-datalist-vb/_static/image2.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="f2c13-125">[![Configure the ObjectDataSource to Use the CategoriesBLL Class's GetCategories Method](master-detail-filtering-acess-two-pages-datalist-vb/_static/image2.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image1.png)</span></span>

<span data-ttu-id="f2c13-126">**Rysunek 1**: Konfigurowanie ObjectDataSource użyć `CategoriesBLL` klasy `GetCategories` — metoda ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](master-detail-filtering-acess-two-pages-datalist-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="f2c13-126">**Figure 1**: Configure the ObjectDataSource to Use the `CategoriesBLL` Class's `GetCategories` Method ([Click to view full-size image](master-detail-filtering-acess-two-pages-datalist-vb/_static/image3.png))</span></span>


<span data-ttu-id="f2c13-127">Następnie określ elemencie powtarzanym szablony w taki sposób, że wyświetlane jako element na liście punktowanej każdej kategorii, nazwę i opis.</span><span class="sxs-lookup"><span data-stu-id="f2c13-127">Next, define the Repeater's templates such that it displays each category name and description as an item in a bulleted list.</span></span> <span data-ttu-id="f2c13-128">Teraz nie została jeszcze martwić o każdej kategorii łącze do strony szczegółów.</span><span class="sxs-lookup"><span data-stu-id="f2c13-128">Let's not yet worry about having each category link to the details page.</span></span> <span data-ttu-id="f2c13-129">Poniżej przedstawiono znaczników deklaratywne dla elementu powtarzanego i ObjectDataSource:</span><span class="sxs-lookup"><span data-stu-id="f2c13-129">The following shows the declarative markup for the Repeater and ObjectDataSource:</span></span>

[!code-aspx[Main](master-detail-filtering-acess-two-pages-datalist-vb/samples/sample1.aspx)]

<span data-ttu-id="f2c13-130">Z tego znacznika pełną Poświęć chwilę, aby wyświetlić postęp naszych za pośrednictwem przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="f2c13-130">With this markup complete, take a moment to view our progress through a browser.</span></span> <span data-ttu-id="f2c13-131">Jak pokazano na rysunku 2, powtarzanego renderuje jako listy punktowane przedstawiający nazwę i opis każdej kategorii.</span><span class="sxs-lookup"><span data-stu-id="f2c13-131">As Figure 2 shows, the Repeater renders as a bulleted list showing each category's name and description.</span></span>


<span data-ttu-id="f2c13-132">[![Każda kategoria jest wyświetlany jako element listy punktowanej](master-detail-filtering-acess-two-pages-datalist-vb/_static/image5.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="f2c13-132">[![Each Category is Displayed as a Bulleted List Item](master-detail-filtering-acess-two-pages-datalist-vb/_static/image5.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image4.png)</span></span>

<span data-ttu-id="f2c13-133">**Rysunek 2**: każdej kategorii jest wyświetlany jako element listy punktowanej ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](master-detail-filtering-acess-two-pages-datalist-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="f2c13-133">**Figure 2**: Each Category is Displayed as a Bulleted List Item ([Click to view full-size image](master-detail-filtering-acess-two-pages-datalist-vb/_static/image6.png))</span></span>


## <a name="step-2-turning-the-category-name-into-a-link-to-the-details-page"></a><span data-ttu-id="f2c13-134">Krok 2: Włączanie nazwę kategorii w łącze do strony szczegółów</span><span class="sxs-lookup"><span data-stu-id="f2c13-134">Step 2: Turning the Category Name into a Link to the Details Page</span></span>

<span data-ttu-id="f2c13-135">Aby zezwolić użytkownikowi na wyświetlanie informacji "szczegóły" dla danej kategorii, należy dodać do każdej listy punktowanej elementu, gdy kliknięty, potrwa użytkownikowi na drugiej stronie łącza (`ProductsForCategoryDetails.aspx`).</span><span class="sxs-lookup"><span data-stu-id="f2c13-135">To allow a user to display the "details" information for a given category, we need to add a link to each bulleted list item that, when clicked, will take the user to the second page (`ProductsForCategoryDetails.aspx`).</span></span> <span data-ttu-id="f2c13-136">Ta druga strona będzie wyświetlana produktów dla wybranej kategorii przy użyciu elementu DataList.</span><span class="sxs-lookup"><span data-stu-id="f2c13-136">This second page will then display the products for the selected category using a DataList.</span></span> <span data-ttu-id="f2c13-137">W celu określenia kategorii, którego łącze został kliknięty, należy przekazać klikniętej kategorii `CategoryID` do drugiej strony za pomocą mechanizmu.</span><span class="sxs-lookup"><span data-stu-id="f2c13-137">In order to determine the category whose link was clicked, we need to pass the clicked category's `CategoryID` to the second page through some mechanism.</span></span> <span data-ttu-id="f2c13-138">Najprostszy, najbardziej oczywistym sposobem transferu danych skalarnych z jednej strony do innego jest za pośrednictwem querystring, czyli opcji, które będą używane w tym samouczku.</span><span class="sxs-lookup"><span data-stu-id="f2c13-138">The simplest, most straightforward way to transfer scalar data from one page to another is through the querystring, which is the option we'll use in this tutorial.</span></span> <span data-ttu-id="f2c13-139">W szczególności `ProductsForCategoryDetails.aspx` strony będą oczekiwać wybranego *`categoryID`* wartości przekazywane querystring pole o nazwie `CategoryID`.</span><span class="sxs-lookup"><span data-stu-id="f2c13-139">In particular, the `ProductsForCategoryDetails.aspx` page will expect the selected *`categoryID`* value to be passed through a querystring field named `CategoryID`.</span></span> <span data-ttu-id="f2c13-140">Na przykład, aby wyświetlić produkty należące do tej kategorii, który ma `CategoryID` 1, użytkownik może odwiedzić `ProductsForCategoryDetails.aspx?CategoryID=1`.</span><span class="sxs-lookup"><span data-stu-id="f2c13-140">For example, to view the products for the Beverages category, which has a `CategoryID` of 1, a user would visit `ProductsForCategoryDetails.aspx?CategoryID=1`.</span></span>

<span data-ttu-id="f2c13-141">Aby utworzyć hiperłącze dla każdego elementu listy punktowanej w elemencie powtarzanym musimy albo Dodaj formant sieci HyperLink Web lub element kotwicy HTML (`<a>`) do `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="f2c13-141">To create a hyperlink for each bulleted list item in the Repeater we need to either add a HyperLink Web control or an HTML anchor element (`<a>`) to the `ItemTemplate`.</span></span> <span data-ttu-id="f2c13-142">W zastosowaniach hiperłącze wyświetlane takie same dla każdego wiersza, wystarczy albo podejście.</span><span class="sxs-lookup"><span data-stu-id="f2c13-142">In scenarios where the hyperlink is displayed the same for each row, either approach will suffice.</span></span> <span data-ttu-id="f2c13-143">Dla wzmacniaki wolę za pomocą elementu zakotwiczenia.</span><span class="sxs-lookup"><span data-stu-id="f2c13-143">For Repeaters, I prefer using the anchor element.</span></span> <span data-ttu-id="f2c13-144">Aby użyć elementu zakotwiczenia, zaktualizuj ItemTemplate elemencie powtarzanym do:</span><span class="sxs-lookup"><span data-stu-id="f2c13-144">To use the anchor element, update the Repeater's ItemTemplate to:</span></span>

[!code-aspx[Main](master-detail-filtering-acess-two-pages-datalist-vb/samples/sample2.aspx)]

<span data-ttu-id="f2c13-145">Należy pamiętać, że `CategoryID` mogą zostać dodane bezpośrednio z poziomu elementu zakotwiczenia `href` atrybutu; jednak, aby tak Zadbaj ograniczyć `href` wartość atrybutu z apostrofów (i Uwaga cudzysłów), ponieważ `Eval` — metoda w ramach `href` atrybutu rozgranicza parametrach (`"CategoryID"`) w znaki cudzysłowu.</span><span class="sxs-lookup"><span data-stu-id="f2c13-145">Note that the `CategoryID` can be injected directly within the anchor element's `href` attribute; however, to do so be certain to delimit the `href` attribute's value with apostrophes (and note quotation marks) since the `Eval` method within the `href` attribute delimits its string (`"CategoryID"`) with quotation marks.</span></span> <span data-ttu-id="f2c13-146">Alternatywnie formant sieci Web hiperłącze można zamiast tego:</span><span class="sxs-lookup"><span data-stu-id="f2c13-146">Alternatively, a HyperLink Web control can be used instead:</span></span>

[!code-aspx[Main](master-detail-filtering-acess-two-pages-datalist-vb/samples/sample3.aspx)]

<span data-ttu-id="f2c13-147">Uwaga jak statyczny część adresu URL — `ProductsForCategoryDetails.aspx?CategoryID` — jest dołączany do wyniku `Eval("CategoryID")` bezpośrednio z poziomu składnia wiązania z danymi przy użyciu ciągów.</span><span class="sxs-lookup"><span data-stu-id="f2c13-147">Note how the static portion of the URL — `ProductsForCategoryDetails.aspx?CategoryID` — is appended to the result of `Eval("CategoryID")` directly within the databinding syntax using string concatenation.</span></span>

<span data-ttu-id="f2c13-148">Stosując kontrolki Hiperlinku jest, że można programowo dostęp do niej w elemencie powtarzanym `ItemDataBound` program obsługi zdarzeń, jeśli to konieczne.</span><span class="sxs-lookup"><span data-stu-id="f2c13-148">One benefit of using the HyperLink control is that it can be programmatically accessed from the Repeater's `ItemDataBound` event handler, if needed.</span></span> <span data-ttu-id="f2c13-149">Na przykład można wyświetlić nazwę kategorii jako tekst, a nie jako łącze dla kategorii z ma skojarzone produktów.</span><span class="sxs-lookup"><span data-stu-id="f2c13-149">For example, you might want to display the category name as text rather than as a link for categories with no associated products.</span></span> <span data-ttu-id="f2c13-150">Tę operację można było wykonać programowo w `ItemDataBound` obsługi zdarzeń; dla kategorii bez skojarzone produktów, hiperłącze w `NavigateUrl` na pusty ciąg, powodując tę nazwę konkretnej kategorii można ustawić właściwości Renderowanie jako zwykły tekst (a nie jako łącze).</span><span class="sxs-lookup"><span data-stu-id="f2c13-150">Such a check could be programmatically performed in the `ItemDataBound` event handler; for categories with no associated products, the HyperLink's `NavigateUrl` property could be set to a blank string, thereby resulting in that particular category name rendering as plain text (rather than as a link).</span></span> <span data-ttu-id="f2c13-151">Odwołaj się do [formatowania DataList i powtarzanego oparte na danych](../displaying-data-with-the-datalist-and-repeater/formatting-the-datalist-and-repeater-based-upon-data-vb.md) samouczek, aby uzyskać więcej informacji na formatowanie zawartości DataList i jego elementu powtarzanego oparte na logiki za pośrednictwem `ItemDataBound` programu obsługi zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="f2c13-151">Refer back to the [Formatting the DataList and Repeater Based Upon Data](../displaying-data-with-the-datalist-and-repeater/formatting-the-datalist-and-repeater-based-upon-data-vb.md) tutorial for more information on formatting the DataList and Repeater's contents based on programmatic logic through the `ItemDataBound` event handler.</span></span>

<span data-ttu-id="f2c13-152">Jeśli wykonujesz, możesz zająć się za pomocą elementu zakotwiczenia lub sposobów kontroli hiperłącze na stronie.</span><span class="sxs-lookup"><span data-stu-id="f2c13-152">If you are following along, feel free to use either the anchor element or HyperLink control approach in your page.</span></span> <span data-ttu-id="f2c13-153">Niezależnie od tego podejścia, podczas wyświetlania strony przy użyciu nazwy kategorii ma być renderowany jako łącze do przeglądarki `ProductsForCategoryDetails.aspx`, przekazując odpowiednie `CategoryID` wartość (patrz rysunek 3).</span><span class="sxs-lookup"><span data-stu-id="f2c13-153">Regardless of the approach, when viewing the page through a browser each category name should be rendered as a link to `ProductsForCategoryDetails.aspx`, passing in the applicable `CategoryID` value (see Figure 3).</span></span>


<span data-ttu-id="f2c13-154">[![Nazwy kategorii teraz łącze do ProductsForCategoryDetails.aspx](master-detail-filtering-acess-two-pages-datalist-vb/_static/image8.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="f2c13-154">[![The Category Names Now Link to ProductsForCategoryDetails.aspx](master-detail-filtering-acess-two-pages-datalist-vb/_static/image8.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image7.png)</span></span>

<span data-ttu-id="f2c13-155">**Rysunek 3**: Kategoria nazwy teraz łącze do `ProductsForCategoryDetails.aspx` ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](master-detail-filtering-acess-two-pages-datalist-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="f2c13-155">**Figure 3**: The Category Names Now Link to `ProductsForCategoryDetails.aspx` ([Click to view full-size image](master-detail-filtering-acess-two-pages-datalist-vb/_static/image9.png))</span></span>


## <a name="step-3-listing-the-products-that-belong-to-the-selected-category"></a><span data-ttu-id="f2c13-156">Krok 3: Listę produktów, które należą do wybranej kategorii</span><span class="sxs-lookup"><span data-stu-id="f2c13-156">Step 3: Listing the Products that Belong to the Selected Category</span></span>

<span data-ttu-id="f2c13-157">Z `CategoryListMaster.aspx` strona kompletna, zdecydowaliśmy włączyć wymagające uwagi do wykonania na stronie "szczegóły" `ProductsForCategoryDetails.aspx`.</span><span class="sxs-lookup"><span data-stu-id="f2c13-157">With the `CategoryListMaster.aspx` page complete, we're ready to turn our attention to implementing the "details" page, `ProductsForCategoryDetails.aspx`.</span></span> <span data-ttu-id="f2c13-158">Otwórz tę stronę, przeciągnij z przybornika do projektanta DataList i ustawić jej `ID` właściwości `ProductsInCategory`.</span><span class="sxs-lookup"><span data-stu-id="f2c13-158">Open this page, drag a DataList from the Toolbox onto the Designer, and set its `ID` property to `ProductsInCategory`.</span></span> <span data-ttu-id="f2c13-159">Następnie wybierz z DataList tagów inteligentnych można dodać nowego elementu ObjectDataSource do strony, nadając mu nazwę `ProductsInCategoryDataSource`.</span><span class="sxs-lookup"><span data-stu-id="f2c13-159">Next, from the DataList's smart tag choose to add a new ObjectDataSource to the page, naming it `ProductsInCategoryDataSource`.</span></span> <span data-ttu-id="f2c13-160">Skonfiguruj ją tak, aby wywoływał `ProductsBLL` klasy `GetProductsByCategoryID(categoryID)` metod; Ustaw listy rozwijanej listy w kartach INSERT, UPDATE i DELETE na (Brak).</span><span class="sxs-lookup"><span data-stu-id="f2c13-160">Configure it such that it calls the `ProductsBLL` class's `GetProductsByCategoryID(categoryID)` method; set the drop-down lists in the INSERT, UPDATE, and DELETE tabs to (None).</span></span>


<span data-ttu-id="f2c13-161">[![Skonfiguruj element ObjectDataSource przy użyciu metody GetProductsByCategoryID(categoryID) klasy ProductsBLL](master-detail-filtering-acess-two-pages-datalist-vb/_static/image11.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="f2c13-161">[![Configure the ObjectDataSource to Use the ProductsBLL Class's GetProductsByCategoryID(categoryID) Method](master-detail-filtering-acess-two-pages-datalist-vb/_static/image11.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image10.png)</span></span>

<span data-ttu-id="f2c13-162">**Rysunek 4**: Konfigurowanie ObjectDataSource użyć `ProductsBLL` klasy `GetProductsByCategoryID(categoryID)` — metoda ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](master-detail-filtering-acess-two-pages-datalist-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="f2c13-162">**Figure 4**: Configure the ObjectDataSource to Use the `ProductsBLL` Class's `GetProductsByCategoryID(categoryID)` Method ([Click to view full-size image](master-detail-filtering-acess-two-pages-datalist-vb/_static/image12.png))</span></span>


<span data-ttu-id="f2c13-163">Ponieważ `GetProductsByCategoryID(categoryID)` metoda przyjmuje parametr wejściowy (*`categoryID`*), Kreator wybierz źródło danych umożliwia nam określone źródło wartości parametru.</span><span class="sxs-lookup"><span data-stu-id="f2c13-163">Since the `GetProductsByCategoryID(categoryID)` method accepts an input parameter (*`categoryID`*), the Choose Data Source wizard offers us an opportunity to specify the parameter's source.</span></span> <span data-ttu-id="f2c13-164">Ustaw źródło parametru QueryString za pomocą pole QueryStringField `CategoryID`.</span><span class="sxs-lookup"><span data-stu-id="f2c13-164">Set the parameter source to QueryString using the QueryStringField `CategoryID`.</span></span>


<span data-ttu-id="f2c13-165">[![Użyj pola Querystring CategoryID jako źródło wartości parametru](master-detail-filtering-acess-two-pages-datalist-vb/_static/image14.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="f2c13-165">[![Use the Querystring Field CategoryID as the Parameter's Source](master-detail-filtering-acess-two-pages-datalist-vb/_static/image14.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image13.png)</span></span>

<span data-ttu-id="f2c13-166">**Rysunek 5**: pole Querystring służy `CategoryID` jako źródło wartości parametru ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](master-detail-filtering-acess-two-pages-datalist-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="f2c13-166">**Figure 5**: Use the Querystring Field `CategoryID` as the Parameter's Source ([Click to view full-size image](master-detail-filtering-acess-two-pages-datalist-vb/_static/image15.png))</span></span>


<span data-ttu-id="f2c13-167">Jak możemy opisane w poprzedniej samouczki, po zakończeniu pracy kreatora wybierz źródło danych programu Visual Studio automatycznie tworzy `ItemTemplate` dla elementu DataList listę poszczególnych nazwę pola danych i wartości.</span><span class="sxs-lookup"><span data-stu-id="f2c13-167">As we've seen in previous tutorials, after completing the Choose Data Source wizard, Visual Studio automatically creates an `ItemTemplate` for the DataList that lists each data field name and value.</span></span> <span data-ttu-id="f2c13-168">Zamień ten szablon, który wyświetla tylko produktu nazwy, dostawcy i cenę.</span><span class="sxs-lookup"><span data-stu-id="f2c13-168">Replace this template with one that lists only the product's name, supplier, and price.</span></span> <span data-ttu-id="f2c13-169">Ponadto należy ustawić DataList `RepeatColumns` właściwości do 2.</span><span class="sxs-lookup"><span data-stu-id="f2c13-169">Also, set the DataList's `RepeatColumns` property to 2.</span></span> <span data-ttu-id="f2c13-170">Po wprowadzeniu tych zmian DataList, a w elemencie ObjectDataSource znaczników deklaratywne powinien wyglądać podobnie do poniższej:</span><span class="sxs-lookup"><span data-stu-id="f2c13-170">After these changes, your DataList and ObjectDataSource's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](master-detail-filtering-acess-two-pages-datalist-vb/samples/sample4.aspx)]

<span data-ttu-id="f2c13-171">Aby wyświetlić tą stronę w akcji, Rozpocznij od `CategoryListMaster.aspx` strony; obok, kliknij łącze na liście kategorii.</span><span class="sxs-lookup"><span data-stu-id="f2c13-171">To view this page in action, start from the `CategoryListMaster.aspx` page; next, click on a link in the categories bulleted list.</span></span> <span data-ttu-id="f2c13-172">W ten sposób spowoduje przejście do `ProductsForCategoryDetails.aspx`, przechodzącą wzdłuż `CategoryID` przez ciąg zapytania.</span><span class="sxs-lookup"><span data-stu-id="f2c13-172">Doing so will take you to `ProductsForCategoryDetails.aspx`, passing along the `CategoryID` through the querystring.</span></span> <span data-ttu-id="f2c13-173">`ProductsInCategoryDataSource` ObjectDataSource w `ProductsForCategoryDetails.aspx` będą pobrania tylko tych produktów dla określonej kategorii i wyświetlić je w DataList, która renderuje dwóch produktów dla każdego wiersza.</span><span class="sxs-lookup"><span data-stu-id="f2c13-173">The `ProductsInCategoryDataSource` ObjectDataSource in `ProductsForCategoryDetails.aspx` will then get just those products for the specified category and display them in the DataList, which renders two products per row.</span></span> <span data-ttu-id="f2c13-174">Rysunek 6 przedstawia zrzut ekranu przedstawiający `ProductsForCategoryDetails.aspx` podczas wyświetlania napoje.</span><span class="sxs-lookup"><span data-stu-id="f2c13-174">Figure 6 shows a screenshot of `ProductsForCategoryDetails.aspx` when viewing the Beverages.</span></span>


<span data-ttu-id="f2c13-175">[![Napoje są wyświetlane dwa na jeden wiersz](master-detail-filtering-acess-two-pages-datalist-vb/_static/image17.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="f2c13-175">[![The Beverages are Displayed, Two per Row](master-detail-filtering-acess-two-pages-datalist-vb/_static/image17.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image16.png)</span></span>

<span data-ttu-id="f2c13-176">**Rysunek 6**: napoje są wyświetlane dwa na jeden wiersz ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](master-detail-filtering-acess-two-pages-datalist-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="f2c13-176">**Figure 6**: The Beverages are Displayed, Two per Row ([Click to view full-size image](master-detail-filtering-acess-two-pages-datalist-vb/_static/image18.png))</span></span>


## <a name="step-4-displaying-category-information-on-productsforcategorydetailsaspx"></a><span data-ttu-id="f2c13-177">Krok 4: Wyświetlane informacje o kategorii na ProductsForCategoryDetails.aspx</span><span class="sxs-lookup"><span data-stu-id="f2c13-177">Step 4: Displaying Category Information on ProductsForCategoryDetails.aspx</span></span>

<span data-ttu-id="f2c13-178">Gdy użytkownik kliknie ikonę kategorii w `CategoryListMaster.aspx`, podjęte w celu `ProductsForCategoryDetails.aspx` i wyświetlane produkty, które należą do wybranej kategorii.</span><span class="sxs-lookup"><span data-stu-id="f2c13-178">When a user clicks on a category in `CategoryListMaster.aspx`, they are taken to `ProductsForCategoryDetails.aspx` and shown the products that belong to the selected category.</span></span> <span data-ttu-id="f2c13-179">Jednak w `ProductsForCategoryDetails.aspx` nie ma żadnych wizualnych określające, jakie kategorii został wybrany.</span><span class="sxs-lookup"><span data-stu-id="f2c13-179">However, in `ProductsForCategoryDetails.aspx` there are no visual cues as to what category was selected.</span></span> <span data-ttu-id="f2c13-180">Użytkownik, który ma kliknij napoje, ale przypadkowo klikniętej przyprawy, nie ma możliwości programu realizująca ich błąd, po upływie `ProductsForCategoryDetails.aspx`.</span><span class="sxs-lookup"><span data-stu-id="f2c13-180">A user that meant to click Beverages, but accidentally clicked Condiments, has no way of realizing their mistake once they reach `ProductsForCategoryDetails.aspx`.</span></span> <span data-ttu-id="f2c13-181">Celu rozwiązanie tego problemu, można wyświetlić informacji na temat wybranej kategorii — nazwy i opisu — w górnej części `ProductsForCategoryDetails.aspx` strony.</span><span class="sxs-lookup"><span data-stu-id="f2c13-181">To alleviate this potential problem, we can display information about the selected category — its name and description — at the top of the `ProductsForCategoryDetails.aspx` page.</span></span>

<span data-ttu-id="f2c13-182">W tym celu Dodaj FormView powyżej w kontrolce elementu powtarzanego `ProductsForCategoryDetails.aspx`.</span><span class="sxs-lookup"><span data-stu-id="f2c13-182">To accomplish this, add a FormView above the Repeater control in `ProductsForCategoryDetails.aspx`.</span></span> <span data-ttu-id="f2c13-183">Następnie dodaj nowy element ObjectDataSource do strony z FormView tagów inteligentnych o nazwie `CategoryDataSource` i skonfigurować go do używania `CategoriesBLL` klasy `GetCategoryByCategoryID(categoryID)` metody.</span><span class="sxs-lookup"><span data-stu-id="f2c13-183">Next, add a new ObjectDataSource to the page from the FormView's smart tag named `CategoryDataSource` and configure it to use the `CategoriesBLL` class's `GetCategoryByCategoryID(categoryID)` method.</span></span>


<span data-ttu-id="f2c13-184">[![Dostęp do informacji o kategorii za pomocą metody GetCategoryByCategoryID(categoryID) klasy CategoriesBLL](master-detail-filtering-acess-two-pages-datalist-vb/_static/image20.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="f2c13-184">[![Access Information about the Category through the CategoriesBLL Class's GetCategoryByCategoryID(categoryID) Method](master-detail-filtering-acess-two-pages-datalist-vb/_static/image20.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image19.png)</span></span>

<span data-ttu-id="f2c13-185">**Rysunek 7**: dostęp do informacji o kategorii za pośrednictwem `CategoriesBLL` klasy `GetCategoryByCategoryID(categoryID)` — metoda ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](master-detail-filtering-acess-two-pages-datalist-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="f2c13-185">**Figure 7**: Access Information about the Category through the `CategoriesBLL` Class's `GetCategoryByCategoryID(categoryID)` Method ([Click to view full-size image](master-detail-filtering-acess-two-pages-datalist-vb/_static/image21.png))</span></span>


<span data-ttu-id="f2c13-186">Za pomocą `ProductsInCategoryDataSource` ObjectDataSource dodanej w kroku 3 `CategoryDataSource`przez konfigurowanie źródła danych, Kreator wyświetli monit nam źródła dla `GetCategoryByCategoryID(categoryID)` wejściowych parametru metody.</span><span class="sxs-lookup"><span data-stu-id="f2c13-186">As with the `ProductsInCategoryDataSource` ObjectDataSource added in Step 3, the `CategoryDataSource`'s Configure Data Source wizard prompts us for a source for the `GetCategoryByCategoryID(categoryID)` method's input parameter.</span></span> <span data-ttu-id="f2c13-187">Użyj takich samych ustawień jak wcześniej, ustawienie źródło parametru na ciąg zapytania i wartość pole QueryStringField `CategoryID` (odwołują się do rysunek 5).</span><span class="sxs-lookup"><span data-stu-id="f2c13-187">Use the exact same settings as before, setting the parameter source to QueryString and the QueryStringField value to `CategoryID` (refer back to Figure 5).</span></span>

<span data-ttu-id="f2c13-188">Po zakończeniu działania kreatora, program Visual Studio automatycznie tworzy `ItemTemplate`, `EditItemTemplate`, i `InsertItemTemplate` dla widoku FormView.</span><span class="sxs-lookup"><span data-stu-id="f2c13-188">After completing the wizard, Visual Studio automatically creates an `ItemTemplate`, `EditItemTemplate`, and `InsertItemTemplate` for the FormView.</span></span> <span data-ttu-id="f2c13-189">Ponieważ udostępniamy interfejsu tylko do odczytu, możesz usunąć `EditItemTemplate` i `InsertItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="f2c13-189">Since we're providing a read-only interface, feel free to remove the `EditItemTemplate` and `InsertItemTemplate`.</span></span> <span data-ttu-id="f2c13-190">Ponadto możesz dostosowywać FormView `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="f2c13-190">Also, feel free to customize the FormView's `ItemTemplate`.</span></span> <span data-ttu-id="f2c13-191">Po usunięciu zbędny szablony i dostosowywanie właściwości ItemTemplate, FormView, a w elemencie ObjectDataSource znaczników deklaratywne powinien wyglądać podobny do następującego:</span><span class="sxs-lookup"><span data-stu-id="f2c13-191">After removing the superfluous templates and customizing the ItemTemplate, your FormView and ObjectDataSource's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](master-detail-filtering-acess-two-pages-datalist-vb/samples/sample5.aspx)]

<span data-ttu-id="f2c13-192">Rysunek nr 8 przedstawia zrzut podczas wyświetlania tej strony za pośrednictwem przeglądarki ekranu.</span><span class="sxs-lookup"><span data-stu-id="f2c13-192">Figure 8 shows a screen shot when viewing this page through a browser.</span></span>

> [!NOTE]
> <span data-ttu-id="f2c13-193">Oprócz FormView, zostały dodane również kontrolki Hiperlinku powyżej FormView prowadzące użytkownika do listy kategorii (`CategoryListMaster.aspx`).</span><span class="sxs-lookup"><span data-stu-id="f2c13-193">In addition to the FormView, I've also added a HyperLink control above the FormView that will take the user back to the list of categories (`CategoryListMaster.aspx`).</span></span> <span data-ttu-id="f2c13-194">Możesz umieścić w innym miejscu tego łącza lub pominąć go całkowicie.</span><span class="sxs-lookup"><span data-stu-id="f2c13-194">Feel free to place this link elsewhere or to omit it altogether.</span></span>


<span data-ttu-id="f2c13-195">[![Informacje o kategorii jest teraz wyświetlany w górnej części strony](master-detail-filtering-acess-two-pages-datalist-vb/_static/image23.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="f2c13-195">[![Category Information is Now Displayed at the Top of the Page](master-detail-filtering-acess-two-pages-datalist-vb/_static/image23.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image22.png)</span></span>

<span data-ttu-id="f2c13-196">**Rysunek 8**: informacje o kategorii jest teraz wyświetlany w górnej części strony ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](master-detail-filtering-acess-two-pages-datalist-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="f2c13-196">**Figure 8**: Category Information is Now Displayed at the Top of the Page ([Click to view full-size image](master-detail-filtering-acess-two-pages-datalist-vb/_static/image24.png))</span></span>


## <a name="step-5-displaying-a-message-if-no-products-belong-to-the-selected-category"></a><span data-ttu-id="f2c13-197">Krok 5: Wyświetlenie komunikatu, jeśli produkty nie należą do wybranej kategorii</span><span class="sxs-lookup"><span data-stu-id="f2c13-197">Step 5: Displaying a Message if No Products Belong to the Selected Category</span></span>

<span data-ttu-id="f2c13-198">`CategoryListMaster.aspx` Strona zawiera listę wszystkich kategorii w systemie, bez względu na to czy istnieją skojarzone produktów.</span><span class="sxs-lookup"><span data-stu-id="f2c13-198">The `CategoryListMaster.aspx` page lists all categories in the system, regardless of whether there are any associated products.</span></span> <span data-ttu-id="f2c13-199">Jeśli użytkownik kliknie kategorię ma skojarzone produktów DataList w `ProductsForCategoryDetails.aspx` nie będą renderowane, jako źródła danych nie ma żadnych elementów.</span><span class="sxs-lookup"><span data-stu-id="f2c13-199">If a user clicks on a category with no associated products, the DataList in `ProductsForCategoryDetails.aspx` will not be rendered, as its data source will not have any items.</span></span> <span data-ttu-id="f2c13-200">Jak możemy przedstawiono w ciągu ostatnich samouczkach, zapewnia widoku GridView `EmptyDataText` właściwość, która może służyć do określenia wiadomość SMS, aby wyświetlić, jeśli nie ma żadnych rekordów w jego źródle danych.</span><span class="sxs-lookup"><span data-stu-id="f2c13-200">As we've seen in past tutorials, the GridView provides an `EmptyDataText` property that can be used to specify a text message to display if there are no records in its data source.</span></span> <span data-ttu-id="f2c13-201">Niestety DataList ani elementu powtarzanego nie posiada tych właściwości.</span><span class="sxs-lookup"><span data-stu-id="f2c13-201">Unfortunately, neither the DataList nor Repeater has such a property.</span></span>

<span data-ttu-id="f2c13-202">Aby wyświetlić komunikat informujący użytkownika, że brak pasujących produktów dla wybranej kategorii, należy dodać etykietę kontroli do strony którego `Text` właściwości przypisano komunikat wyświetlany w przypadku, gdy brak pasującego produktów.</span><span class="sxs-lookup"><span data-stu-id="f2c13-202">In order to display a message informing the user that there are no matching products for the selected category, we need to add a Label control to the page whose `Text` property is assigned the message to display in the event that there are no matching products.</span></span> <span data-ttu-id="f2c13-203">Następnie należy ustawić programowo jego `Visible` na czy elementu DataList zawiera wszystkie elementy na podstawie właściwości.</span><span class="sxs-lookup"><span data-stu-id="f2c13-203">We then need to programmatically set its `Visible` property based on whether or not the DataList contains any items.</span></span>

<span data-ttu-id="f2c13-204">Aby to zrobić, Rozpocznij od dodania etykiety poniżej elementu DataList.</span><span class="sxs-lookup"><span data-stu-id="f2c13-204">To accomplish this, start by adding a Label beneath the DataList.</span></span> <span data-ttu-id="f2c13-205">Ustaw jego `ID` właściwości `NoProductsMessage` i jego `Text` dla właściwości "Brak produktów dla wybranej kategorii..."</span><span class="sxs-lookup"><span data-stu-id="f2c13-205">Set its `ID` property to `NoProductsMessage` and its `Text` property to "There are no products for the selected category…"</span></span> <span data-ttu-id="f2c13-206">Następnie należy programowo ustawić tę etykietę `Visible` na podstawie właściwości na czy żadnych danych została powiązana z `ProductsInCategory` DataList.</span><span class="sxs-lookup"><span data-stu-id="f2c13-206">Next, we need to programmatically set this Label's `Visible` property based on whether or not any data was bound to the `ProductsInCategory` DataList.</span></span> <span data-ttu-id="f2c13-207">Musi być przydziału po danych została powiązana z elementu DataList.</span><span class="sxs-lookup"><span data-stu-id="f2c13-207">This assignment must be made after the data has been bound to the DataList.</span></span> <span data-ttu-id="f2c13-208">Dla widoku GridView, widoku DetailsView i FormView, można utworzyć programu obsługi zdarzeń dla formantu `DataBound` zdarzenie, które są generowane po zakończeniu wiązania z danymi.</span><span class="sxs-lookup"><span data-stu-id="f2c13-208">For the GridView, DetailsView, and FormView, we could create an event handler for the control's `DataBound` event, which fires after databinding has completed.</span></span> <span data-ttu-id="f2c13-209">Jednak elementu DataList ani powtarzanego nie posiada `DataBound` zdarzeń dostępne.</span><span class="sxs-lookup"><span data-stu-id="f2c13-209">However, neither the DataList nor the Repeater has a `DataBound` event available.</span></span>

<span data-ttu-id="f2c13-210">W tym przykładzie firma Microsoft może przypisać etykietę `Visible` właściwości w `Page_Load` program obsługi zdarzeń, ponieważ dane zostanie przypisana do elementu DataList przed strony `Load` zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="f2c13-210">For this particular example we can assign the Label's `Visible` property in the `Page_Load` event handler, since the data will have been assigned to the DataList prior to the page's `Load` event.</span></span> <span data-ttu-id="f2c13-211">Jednak ta metoda nie będzie działało w przypadku ogólnych, jak dane z ObjectDataSource może być powiązane z DataList później w cyklu życia strony.</span><span class="sxs-lookup"><span data-stu-id="f2c13-211">However, this approach would not work in the general case, as the data from the ObjectDataSource might be bound to the DataList later in the page's lifecycle.</span></span> <span data-ttu-id="f2c13-212">Na przykład, jeśli dane wyświetlane opiera się na wartość innego formantu, takie jak jest podczas wyświetlania raportu wzorzec/szczegół za pomocą DropDownList do przechowywania rekordów "główny", dane mogą nie odbitych do formantu danych sieci Web do `PreRender` etapie cykl życia strony.</span><span class="sxs-lookup"><span data-stu-id="f2c13-212">For example, if the displayed data is based upon the value in another control, such as it is when displaying a master/detail report using a DropDownList to hold the "master" records, the data may not rebound to the data Web control until the `PreRender` stage in the page's life cycle.</span></span>

<span data-ttu-id="f2c13-213">Jedno rozwiązanie, które będzie działać we wszystkich przypadkach jest przypisanie `Visible` właściwości `False` w DataList `ItemDataBound` (lub `ItemCreated`) program obsługi zdarzeń podczas wiązania z typem elementu `Item` lub `AlternatingItem`.</span><span class="sxs-lookup"><span data-stu-id="f2c13-213">One solution which will work for all cases is to assign the `Visible` property to `False` in the DataList's `ItemDataBound` (or `ItemCreated`) event handler when binding an item type of `Item` or `AlternatingItem`.</span></span> <span data-ttu-id="f2c13-214">W takim przypadku wiemy, że nie ma danych co najmniej jeden element w źródle danych i w związku z tym można ukryć `NoProductsMessage` etykiety.</span><span class="sxs-lookup"><span data-stu-id="f2c13-214">In such a case we know that there is at least one data item in the data source and therefore can hide the `NoProductsMessage` Label.</span></span> <span data-ttu-id="f2c13-215">Oprócz tej obsługi zdarzeń dla DataList potrzebujemy jest także program obsługi zdarzeń `DataBinding` zdarzeń, w którym możemy zainicjować etykiety `Visible` właściwości `True`.</span><span class="sxs-lookup"><span data-stu-id="f2c13-215">In addition to this event handler, we also need an event handler for the DataList's `DataBinding` event, where we initialize the Label's `Visible` property to `True`.</span></span> <span data-ttu-id="f2c13-216">Ponieważ `DataBinding` zdarzenia generowane przed `ItemDataBound` zdarzenia, etykiety w `Visible` właściwości początkowo zostanie ustawiona do `True`; Jeśli istnieją wszystkie elementy danych, jednak zostanie ustawiona `False`.</span><span class="sxs-lookup"><span data-stu-id="f2c13-216">Since the `DataBinding` event fires before the `ItemDataBound` events, the Label's `Visible` property will initially be set to `True`; if there are any data items, however, it will be set to `False`.</span></span> <span data-ttu-id="f2c13-217">Poniższy kod implementuje tę logikę:</span><span class="sxs-lookup"><span data-stu-id="f2c13-217">The following code implements this logic:</span></span>

[!code-vb[Main](master-detail-filtering-acess-two-pages-datalist-vb/samples/sample6.vb)]

<span data-ttu-id="f2c13-218">Wszystkie kategorie w bazie danych Northwind są skojarzone z jednego lub więcej produktów.</span><span class="sxs-lookup"><span data-stu-id="f2c13-218">All of the categories in the Northwind database are associated with one or more products.</span></span> <span data-ttu-id="f2c13-219">Do testowania tej funkcji, można ręcznie dostosowaniu bazy danych Northwind w tym samouczku, ponowne przypisywanie wszystkich produktów skojarzonych z kategorii produktu (`CategoryID` = 7) do kategorii ryby (`CategoryID` = 8).</span><span class="sxs-lookup"><span data-stu-id="f2c13-219">To test this feature, I've manually adjusted the Northwind database for this tutorial, reassigning all products associated with the Produce category (`CategoryID` = 7) to the Seafood category (`CategoryID` = 8).</span></span> <span data-ttu-id="f2c13-220">Można to zrobić z Eksploratora serwera przez wybranie nowego zapytania i użycie następujących `UPDATE` instrukcji:</span><span class="sxs-lookup"><span data-stu-id="f2c13-220">This can be accomplished from the Server Explorer by choosing New Query and using the following `UPDATE` statement:</span></span>

[!code-sql[Main](master-detail-filtering-acess-two-pages-datalist-vb/samples/sample7.sql)]

<span data-ttu-id="f2c13-221">Po zaktualizowaniu odpowiednio bazy danych, wróć do `CategoryListMaster.aspx` strony i kliknij łącze produktu.</span><span class="sxs-lookup"><span data-stu-id="f2c13-221">After updating the database accordingly, return to the `CategoryListMaster.aspx` page and click on the Produce link.</span></span> <span data-ttu-id="f2c13-222">Ponieważ nie ma już żadnych produktów należących do tej kategorii produktów, powinna zostać wyświetlona "Brak produktów dla wybranej kategorii..."</span><span class="sxs-lookup"><span data-stu-id="f2c13-222">Since there are no longer any products belonging to the Produce category, you should see the "There are no products for the selected category…"</span></span> <span data-ttu-id="f2c13-223">komunikat, jak pokazano na rysunku 9.</span><span class="sxs-lookup"><span data-stu-id="f2c13-223">message, as shown in Figure 9.</span></span>


<span data-ttu-id="f2c13-224">[![Zostanie wyświetlony komunikat, jeśli istnieją nr produktów należących do wybranej kategorii](master-detail-filtering-acess-two-pages-datalist-vb/_static/image26.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="f2c13-224">[![A Message is Displayed if there are No Products Belonging to the Selected Category](master-detail-filtering-acess-two-pages-datalist-vb/_static/image26.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image25.png)</span></span>

<span data-ttu-id="f2c13-225">**Rysunek 9**: komunikat jest wyświetlany w przypadku nr produktów należących do wybranej kategorii ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](master-detail-filtering-acess-two-pages-datalist-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="f2c13-225">**Figure 9**: A Message is Displayed if there are No Products Belonging to the Selected Category ([Click to view full-size image](master-detail-filtering-acess-two-pages-datalist-vb/_static/image27.png))</span></span>


## <a name="summary"></a><span data-ttu-id="f2c13-226">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="f2c13-226">Summary</span></span>

<span data-ttu-id="f2c13-227">Gdy wzorzec/szczegół raporty można wyświetlić głównego i szczegółów rekordy na jednej stronie, w wiele witryn sieci Web one są rozdzielone przez dwie strony sieci web.</span><span class="sxs-lookup"><span data-stu-id="f2c13-227">While master/detail reports can display both the master and detail records on a single page, in many websites they are separated out across two web pages.</span></span> <span data-ttu-id="f2c13-228">W tym samouczku analizujemy sposobu wdrażania raportu wzorzec/szczegół za kategorii wymienionych na liście punktowanej przy użyciu elementu powtarzanego "główny" strony sieci web i skojarzone wymienionego na stronie "szczegóły".</span><span class="sxs-lookup"><span data-stu-id="f2c13-228">In this tutorial we looked at how to implement such a master/detail report by having the categories listed in a bulleted list using a Repeater in the "master" web page and the associated products listed in the "details" page.</span></span> <span data-ttu-id="f2c13-229">Każdy element tej listy na stronie głównej sieci web zawiera łącze do strony szczegółów, który przekazał wzdłuż wiersza `CategoryID` wartość.</span><span class="sxs-lookup"><span data-stu-id="f2c13-229">Each list item in the master web page contained a link to the details page that passed along the row's `CategoryID` value.</span></span>

<span data-ttu-id="f2c13-230">Na stronie szczegółów pobierania tych produktów dla określonego dostawcy zostało wykonane za pomocą `ProductsBLL` klasy `GetProductsByCategoryID(categoryID)` metody.</span><span class="sxs-lookup"><span data-stu-id="f2c13-230">In the details page retrieving those products for the specified supplier was accomplished through the `ProductsBLL` class's `GetProductsByCategoryID(categoryID)` method.</span></span> <span data-ttu-id="f2c13-231">*`categoryID`* Określono wartość parametru deklaratywnie przy użyciu `CategoryID` wartości querystring jako źródło parametru.</span><span class="sxs-lookup"><span data-stu-id="f2c13-231">The *`categoryID`* parameter value was specified declaratively using the `CategoryID` querystring value as the parameter source.</span></span> <span data-ttu-id="f2c13-232">Również Analizujemy sposób wyświetlania szczegółów kategorii na stronie szczegółów za pomocą FormView i wyświetli komunikat, jeśli nie było żadnych produktów należących do wybranej kategorii.</span><span class="sxs-lookup"><span data-stu-id="f2c13-232">We also looked at how to display category details in the details page using a FormView and how to display a message if there were no products belonging to the selected category.</span></span>

<span data-ttu-id="f2c13-233">Programowanie przyjemność!</span><span class="sxs-lookup"><span data-stu-id="f2c13-233">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="f2c13-234">Informacje o autorze</span><span class="sxs-lookup"><span data-stu-id="f2c13-234">About the Author</span></span>

<span data-ttu-id="f2c13-235">[Scott Bento](http://www.4guysfromrolla.com/ScottMitchell.shtml), autora siedmiu książek ASP/ASP.NET i twórcę z [4GuysFromRolla.com](http://www.4guysfromrolla.com), pracuje z technologii Microsoft Web od 1998.</span><span class="sxs-lookup"><span data-stu-id="f2c13-235">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="f2c13-236">Scott działa jako niezależnego konsultanta trainer i składnika zapisywania.</span><span class="sxs-lookup"><span data-stu-id="f2c13-236">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="f2c13-237">Jest jego najnowszej książki [ *Sams nauczyć się ASP.NET 2.0 w ciągu 24 godzin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="f2c13-237">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="f2c13-238">Piotr można uzyskać pod adresem [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) lub za pośrednictwem jego blog, który znajduje się w temacie [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="f2c13-238">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="f2c13-239">Specjalne podziękowania dla...</span><span class="sxs-lookup"><span data-stu-id="f2c13-239">Special Thanks To…</span></span>

<span data-ttu-id="f2c13-240">Ten samouczek serii zostało sprawdzone przez wiele recenzentów przydatne.</span><span class="sxs-lookup"><span data-stu-id="f2c13-240">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="f2c13-241">Prowadzić osób dokonujących przeglądu, w tym samouczku zostały Kowalski Zack i Liz Shulok.</span><span class="sxs-lookup"><span data-stu-id="f2c13-241">Lead reviewers for this tutorial were Zack Jones and Liz Shulok.</span></span> <span data-ttu-id="f2c13-242">Zainteresowani recenzowania Moje nadchodzących artykuły MSDN?</span><span class="sxs-lookup"><span data-stu-id="f2c13-242">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="f2c13-243">Jeśli tak, Porzuć mnie linii w [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="f2c13-243">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="f2c13-244">[Poprzednie](master-detail-filtering-with-a-dropdownlist-datalist-vb.md)
> [dalej](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md)</span><span class="sxs-lookup"><span data-stu-id="f2c13-244">[Previous](master-detail-filtering-with-a-dropdownlist-datalist-vb.md)
[Next](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md)</span></span>
