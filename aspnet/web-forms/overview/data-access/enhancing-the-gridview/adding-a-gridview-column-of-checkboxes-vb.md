---
uid: web-forms/overview/data-access/enhancing-the-gridview/adding-a-gridview-column-of-checkboxes-vb
title: Dodawanie kolumny widoku GridView pola wyboru (VB) | Dokumentacja firmy Microsoft
author: rick-anderson
description: "W tym samouczku analizuje jak dodać kolumnę pola wyboru do kontrolki widoku siatki, aby przyznać użytkownikowi intuicyjny sposób wybierania wielu wierszy G..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 03/06/2007
ms.topic: article
ms.assetid: 39253d05-75c0-41c7-b9d4-a6c58ecf69ce
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/enhancing-the-gridview/adding-a-gridview-column-of-checkboxes-vb
msc.type: authoredcontent
ms.openlocfilehash: 4468f7e0c142fa432e58d4c686dd79d3b38612ad
ms.sourcegitcommit: 060879fcf3f73d2366b5c811986f8695fff65db8
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 01/24/2018
---
<a name="adding-a-gridview-column-of-checkboxes-vb"></a><span data-ttu-id="a99e3-103">Dodawanie kolumny widoku GridView pola wyboru (VB)</span><span class="sxs-lookup"><span data-stu-id="a99e3-103">Adding a GridView Column of Checkboxes (VB)</span></span>
====================
<span data-ttu-id="a99e3-104">przez [Bento Scott](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="a99e3-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="a99e3-105">[Pobierz przykładową aplikację](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_52_VB.exe) lub [pobierania plików PDF](adding-a-gridview-column-of-checkboxes-vb/_static/datatutorial52vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="a99e3-105">[Download Sample App](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_52_VB.exe) or [Download PDF](adding-a-gridview-column-of-checkboxes-vb/_static/datatutorial52vb1.pdf)</span></span>

> <span data-ttu-id="a99e3-106">W tym samouczku analizuje jak dodać kolumnę pola wyboru do kontrolki widoku siatki, aby przyznać użytkownikowi intuicyjny sposób wybierania wielu wierszy w widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="a99e3-106">This tutorial looks at how to add a column of check boxes to a GridView control to provide the user with an intuitive way of selecting multiple rows of the GridView.</span></span>


## <a name="introduction"></a><span data-ttu-id="a99e3-107">Wprowadzenie</span><span class="sxs-lookup"><span data-stu-id="a99e3-107">Introduction</span></span>

<span data-ttu-id="a99e3-108">W poprzednim samouczek możemy zbadać jak dodać kolumnę przycisków radiowych do na potrzeby wybranie określonego rekordu w widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="a99e3-108">In the preceding tutorial we examined how to add a column of radio buttons to the GridView for the purpose of selecting a particular record.</span></span> <span data-ttu-id="a99e3-109">Kolumnę przycisków radiowych jest interfejsem odpowiedniego użytkownika, gdy użytkownik jest ograniczona do wybierania co najwyżej jeden element z siatki.</span><span class="sxs-lookup"><span data-stu-id="a99e3-109">A column of radio buttons is a suitable user interface when the user is limited to choosing at most one item from the grid.</span></span> <span data-ttu-id="a99e3-110">Czasami jednak może chcemy umożliwia użytkownikowi pobranie dowolnej liczby elementów siatki.</span><span class="sxs-lookup"><span data-stu-id="a99e3-110">At times, however, we may want to allow the user to pick an arbitrary number of items from the grid.</span></span> <span data-ttu-id="a99e3-111">Klienci sieci Web poczty e-mail, na przykład wyświetlić zwykle listę komunikatów z kolumną pola wyboru.</span><span class="sxs-lookup"><span data-stu-id="a99e3-111">Web-based email clients, for example, typically display the list of messages with a column of checkboxes.</span></span> <span data-ttu-id="a99e3-112">Użytkownik może wybrać dowolną liczbę wiadomości i następnie wykonanie akcji, takich jak przenoszenia wiadomości e-mail do innego folderu lub usuwając je.</span><span class="sxs-lookup"><span data-stu-id="a99e3-112">The user can select an arbitrary number of messages and then perform some action, such as moving the emails to another folder or deleting them.</span></span>

<span data-ttu-id="a99e3-113">W tym samouczku zostanie wyświetlone jak dodać kolumnę pola wyboru oraz sposobu określania, jakie pola wyboru zostały zaznaczone na ogłaszania zwrotnego.</span><span class="sxs-lookup"><span data-stu-id="a99e3-113">In this tutorial we will see how to add a column of checkboxes and how to determine what checkboxes were checked on postback.</span></span> <span data-ttu-id="a99e3-114">W szczególności firma Microsoft będzie kompilacji przykładem ściśle naśladuje interfejsu użytkownika klienta opartego na sieci web.</span><span class="sxs-lookup"><span data-stu-id="a99e3-114">In particular, we'll build an example that closely mimics the web-based email client user interface.</span></span> <span data-ttu-id="a99e3-115">Zawiera element GridView stronicowanych listę produktów w naszym przykładzie `Products` tabeli bazy danych z wyboru w każdym wierszu (zobacz rysunek 1).</span><span class="sxs-lookup"><span data-stu-id="a99e3-115">Our example will include a paged GridView listing the products in the `Products` database table with a checkbox in each row (see Figure 1).</span></span> <span data-ttu-id="a99e3-116">Usuń wybrane produkty po kliknięciu przycisku, spowoduje usunięcie tych produktów wybranych.</span><span class="sxs-lookup"><span data-stu-id="a99e3-116">A Delete Selected Products button, when clicked, will delete those products selected.</span></span>


<span data-ttu-id="a99e3-117">[![Każdy wiersz produktu zawiera pole wyboru](adding-a-gridview-column-of-checkboxes-vb/_static/image1.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="a99e3-117">[![Each Product Row Includes a Checkbox](adding-a-gridview-column-of-checkboxes-vb/_static/image1.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image1.png)</span></span>

<span data-ttu-id="a99e3-118">**Rysunek 1**: każdy wiersz produktu zawiera pole wyboru ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](adding-a-gridview-column-of-checkboxes-vb/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="a99e3-118">**Figure 1**: Each Product Row Includes a Checkbox ([Click to view full-size image](adding-a-gridview-column-of-checkboxes-vb/_static/image2.png))</span></span>


## <a name="step-1-adding-a-paged-gridview-that-lists-product-information"></a><span data-ttu-id="a99e3-119">Krok 1: Dodawanie stronicowanych widoku GridView, która zawiera informacje o produkcie</span><span class="sxs-lookup"><span data-stu-id="a99e3-119">Step 1: Adding a Paged GridView that Lists Product Information</span></span>

<span data-ttu-id="a99e3-120">Zanim firma Microsoft martwić się o dodanie kolumny pola wyboru, umożliwiają s pierwszy fokus na wyświetlanie listy produktów w widoku GridView, który obsługuje stronicowania.</span><span class="sxs-lookup"><span data-stu-id="a99e3-120">Before we worry about adding a column of checkboxes, let s first focus on listing the products in a GridView that supports paging.</span></span> <span data-ttu-id="a99e3-121">Uruchamianie przez otwarcie `CheckBoxField.aspx` strony `EnhancedGridView` folder i przeciągnij element GridView z przybornika do projektanta, ustawienie jej `ID` do `Products`.</span><span class="sxs-lookup"><span data-stu-id="a99e3-121">Start by opening the `CheckBoxField.aspx` page in the `EnhancedGridView` folder and drag a GridView from the Toolbox onto the Designer, setting its `ID` to `Products`.</span></span> <span data-ttu-id="a99e3-122">Następnie wybierz powiązać widoku GridView nowy element ObjectDataSource o nazwie `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="a99e3-122">Next, choose to bind the GridView to a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="a99e3-123">Element ObjectDataSource umożliwia konfigurowanie `ProductsBLL` klasy wywoływania `GetProducts()` metody, aby zwrócić dane.</span><span class="sxs-lookup"><span data-stu-id="a99e3-123">Configure the ObjectDataSource to use the `ProductsBLL` class, calling the `GetProducts()` method to return the data.</span></span> <span data-ttu-id="a99e3-124">Ponieważ tego widoku GridView będzie tylko do odczytu, ustaw listy rozwijane w UPDATE, INSERT i usuwanie kart na (Brak).</span><span class="sxs-lookup"><span data-stu-id="a99e3-124">Since this GridView will be read-only, set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) .</span></span>


<span data-ttu-id="a99e3-125">[![Utwórz nowy element ObjectDataSource o nazwie ProductsDataSource](adding-a-gridview-column-of-checkboxes-vb/_static/image2.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="a99e3-125">[![Create a New ObjectDataSource Named ProductsDataSource](adding-a-gridview-column-of-checkboxes-vb/_static/image2.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image3.png)</span></span>

<span data-ttu-id="a99e3-126">**Rysunek 2**: Utwórz nowy składnik o nazwie ObjectDataSource `ProductsDataSource` ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](adding-a-gridview-column-of-checkboxes-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="a99e3-126">**Figure 2**: Create a New ObjectDataSource Named `ProductsDataSource` ([Click to view full-size image](adding-a-gridview-column-of-checkboxes-vb/_static/image4.png))</span></span>


<span data-ttu-id="a99e3-127">[![Skonfiguruj ObjectDataSource do pobierania danych przy użyciu metody GetProducts()](adding-a-gridview-column-of-checkboxes-vb/_static/image3.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="a99e3-127">[![Configure the ObjectDataSource to Retrieve Data Using the GetProducts() Method](adding-a-gridview-column-of-checkboxes-vb/_static/image3.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image5.png)</span></span>

<span data-ttu-id="a99e3-128">**Rysunek 3**: Konfigurowanie ObjectDataSource do pobierania danych przy użyciu `GetProducts()` — metoda ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](adding-a-gridview-column-of-checkboxes-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="a99e3-128">**Figure 3**: Configure the ObjectDataSource to Retrieve Data Using the `GetProducts()` Method ([Click to view full-size image](adding-a-gridview-column-of-checkboxes-vb/_static/image6.png))</span></span>


<span data-ttu-id="a99e3-129">[![Ustawianie list rozwijanych w UPDATE, INSERT i usuwanie kart na (Brak)](adding-a-gridview-column-of-checkboxes-vb/_static/image4.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="a99e3-129">[![Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None)](adding-a-gridview-column-of-checkboxes-vb/_static/image4.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image7.png)</span></span>

<span data-ttu-id="a99e3-130">**Rysunek 4**: wartość listy rozwijane w AKTUALIZOWANIA, WSTAWIANIA i usuwanie kart (None) ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](adding-a-gridview-column-of-checkboxes-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="a99e3-130">**Figure 4**: Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None) ([Click to view full-size image](adding-a-gridview-column-of-checkboxes-vb/_static/image8.png))</span></span>


<span data-ttu-id="a99e3-131">Po zakończeniu pracy Kreatora konfigurowania źródła danych programu Visual Studio automatycznie utworzy BoundColumns i CheckBoxColumn dla pól danych dotyczących produktu.</span><span class="sxs-lookup"><span data-stu-id="a99e3-131">After completing the Configure Data Source wizard, Visual Studio will automatically create BoundColumns and a CheckBoxColumn for the product-related data fields.</span></span> <span data-ttu-id="a99e3-132">Jak opisano w poprzedniej samouczek, Usuń wszystkie elementy oprócz `ProductName`, `CategoryName`, i `UnitPrice` BoundFields i zmień `HeaderText` właściwości do produktu, kategorii i cenę.</span><span class="sxs-lookup"><span data-stu-id="a99e3-132">Like we did in the previous tutorial, remove all but the `ProductName`, `CategoryName`, and `UnitPrice` BoundFields, and change the `HeaderText` properties to Product, Category, and Price.</span></span> <span data-ttu-id="a99e3-133">Skonfiguruj `UnitPrice` elementu BoundField tak, aby jego wartość jest w formacie waluty.</span><span class="sxs-lookup"><span data-stu-id="a99e3-133">Configure the `UnitPrice` BoundField so that its value is formatted as a currency.</span></span> <span data-ttu-id="a99e3-134">Również skonfigurować do obsługi stronicowania, zaznaczając pole wyboru Włącz stronicowania z tagów inteligentnych widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="a99e3-134">Also configure the GridView to support paging by checking the Enable Paging checkbox from the smart tag.</span></span>

<span data-ttu-id="a99e3-135">Umożliwiają również dodawanie interfejsu użytkownika dla usuwania zaznaczonych produktów s.</span><span class="sxs-lookup"><span data-stu-id="a99e3-135">Let s also add the user interface for deleting the selected products.</span></span> <span data-ttu-id="a99e3-136">Dodawanie formantu przycisku Web poniżej widoku GridView ustawienie jej `ID` do `DeleteSelectedProducts` i jego `Text` właściwość, aby usunąć wybrane produkty.</span><span class="sxs-lookup"><span data-stu-id="a99e3-136">Add a Button Web control beneath the GridView, setting its `ID` to `DeleteSelectedProducts` and its `Text` property to Delete Selected Products.</span></span> <span data-ttu-id="a99e3-137">Zamiast faktycznie ich nie usuwać produkty z bazy danych, w tym przykładzie firma Microsoft będzie po prostu Wyświetl komunikat z informacją o produktów, które będą usunięte.</span><span class="sxs-lookup"><span data-stu-id="a99e3-137">Rather than actually deleting products from the database, for this example we'll just display a message stating the products that would have been deleted.</span></span> <span data-ttu-id="a99e3-138">Aby to umożliwić, Dodaj formant etykiety w sieci Web, poniżej przycisku.</span><span class="sxs-lookup"><span data-stu-id="a99e3-138">To accommodate this, add a Label Web control beneath the Button.</span></span> <span data-ttu-id="a99e3-139">Ustawić jej identyfikator na `DeleteResults`, wyczyść się jego `Text` właściwości i ustaw jego `Visible` i `EnableViewState` właściwości `False`.</span><span class="sxs-lookup"><span data-stu-id="a99e3-139">Set its ID to `DeleteResults`, clear out its `Text` property, and set its `Visible` and `EnableViewState` properties to `False`.</span></span>

<span data-ttu-id="a99e3-140">Po wprowadzeniu tych zmian, znaczników deklaratywne s GridView, ObjectDataSource przycisk i etykiety powinna podobny do następującego:</span><span class="sxs-lookup"><span data-stu-id="a99e3-140">After making these changes, the GridView, ObjectDataSource, Button, and Label s declarative markup should similar to the following:</span></span>


[!code-aspx[Main](adding-a-gridview-column-of-checkboxes-vb/samples/sample1.aspx)]

<span data-ttu-id="a99e3-141">Poświęć chwilę, aby wyświetlić stronę w przeglądarce (patrz rysunek 5).</span><span class="sxs-lookup"><span data-stu-id="a99e3-141">Take a moment to view the page in a browser (see Figure 5).</span></span> <span data-ttu-id="a99e3-142">W tym momencie powinny pojawić się nazwa, kategoria i ceny produktów pierwszych dziesięciu.</span><span class="sxs-lookup"><span data-stu-id="a99e3-142">At this point you should see the name, category, and price of the first ten products.</span></span>


<span data-ttu-id="a99e3-143">[![Wyświetlane są nazwa, kategoria i cen pierwszy 10 produktów](adding-a-gridview-column-of-checkboxes-vb/_static/image5.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="a99e3-143">[![The Name, Category, and Price of the First Ten Products are Listed](adding-a-gridview-column-of-checkboxes-vb/_static/image5.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image9.png)</span></span>

<span data-ttu-id="a99e3-144">**Rysunek 5**: Name, kategorii i cen pierwszy 10 produktów są wyświetlane ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](adding-a-gridview-column-of-checkboxes-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="a99e3-144">**Figure 5**: The Name, Category, and Price of the First Ten Products are Listed ([Click to view full-size image](adding-a-gridview-column-of-checkboxes-vb/_static/image10.png))</span></span>


## <a name="step-2-adding-a-column-of-checkboxes"></a><span data-ttu-id="a99e3-145">Krok 2: Dodawanie kolumny pola wyboru</span><span class="sxs-lookup"><span data-stu-id="a99e3-145">Step 2: Adding a Column of Checkboxes</span></span>

<span data-ttu-id="a99e3-146">Ponieważ ASP.NET 2.0 obejmuje CheckBoxField, jeden może wziąć pod uwagę że może służyć do dodać kolumnę pola wyboru do widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="a99e3-146">Since ASP.NET 2.0 includes a CheckBoxField, one might think that it could be used to add a column of checkboxes to a GridView.</span></span> <span data-ttu-id="a99e3-147">Niestety, który nie jest to, jak w polu CheckBoxField jest przeznaczona do pracy z polem danych logicznych.</span><span class="sxs-lookup"><span data-stu-id="a99e3-147">Unfortunately, that is not the case, as the CheckBoxField is designed to work with a Boolean data field.</span></span> <span data-ttu-id="a99e3-148">Oznacza to aby użyć polu CheckBoxField możemy określić podstawowej pola danych, którego wartość jest konsultacji ustalenie, czy zaznaczono pole wyboru renderowany.</span><span class="sxs-lookup"><span data-stu-id="a99e3-148">That is, in order to use the CheckBoxField we must specify the underlying data field whose value is consulted to determine whether the rendered checkbox is checked.</span></span> <span data-ttu-id="a99e3-149">Nie można użyć polu CheckBoxField uwzględnienie tylko kolumnę usunięciu zaznaczenia pola wyboru.</span><span class="sxs-lookup"><span data-stu-id="a99e3-149">We cannot use the CheckBoxField to just include a column of unchecked checkboxes.</span></span>

<span data-ttu-id="a99e3-150">Zamiast tego, możemy dodać pole TemplateField i dodać kontrolkę pola wyboru sieci Web do jego `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="a99e3-150">Instead, we must add a TemplateField and add a CheckBox Web control to its `ItemTemplate`.</span></span> <span data-ttu-id="a99e3-151">Przejdź dalej i Dodaj pole TemplateField do `Products` GridView i przekształcenie go w pierwszym polu (daleko od lewej).</span><span class="sxs-lookup"><span data-stu-id="a99e3-151">Go ahead and add a TemplateField to the `Products` GridView and make it the first (far-left) field.</span></span> <span data-ttu-id="a99e3-152">Z widoku GridView s tagu, kliknij łącze Edytuj szablony, a następnie przeciągnij formant wyboru sieci Web z przybornika do `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="a99e3-152">From the GridView s smart tag, click on the Edit Templates link and then drag a CheckBox Web control from the Toolbox into the `ItemTemplate`.</span></span> <span data-ttu-id="a99e3-153">Ustaw to pole wyboru s `ID` właściwości `ProductSelector`.</span><span class="sxs-lookup"><span data-stu-id="a99e3-153">Set this CheckBox s `ID` property to `ProductSelector`.</span></span>


<span data-ttu-id="a99e3-154">[![Dodaj formant wyboru sieci Web o nazwie ProductSelector do TemplateField s ItemTemplate](adding-a-gridview-column-of-checkboxes-vb/_static/image6.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="a99e3-154">[![Add a CheckBox Web Control Named ProductSelector to the TemplateField s ItemTemplate](adding-a-gridview-column-of-checkboxes-vb/_static/image6.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image11.png)</span></span>

<span data-ttu-id="a99e3-155">**Rysunek 6**: Dodaj pola wyboru sieci Web formantu o nazwie `ProductSelector` s TemplateField `ItemTemplate` ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](adding-a-gridview-column-of-checkboxes-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="a99e3-155">**Figure 6**: Add a CheckBox Web Control Named `ProductSelector` to the TemplateField s `ItemTemplate` ([Click to view full-size image](adding-a-gridview-column-of-checkboxes-vb/_static/image12.png))</span></span>


<span data-ttu-id="a99e3-156">Z formantem TemplateField i pole wyboru w sieci Web dodany każdy wiersz zawiera pole wyboru.</span><span class="sxs-lookup"><span data-stu-id="a99e3-156">With the TemplateField and CheckBox Web control added, each row now includes a checkbox.</span></span> <span data-ttu-id="a99e3-157">Rysunek nr 7 przedstawia tę stronę, podczas wyświetlania za pośrednictwem przeglądarki, po dodaniu TemplateField i pól wyboru.</span><span class="sxs-lookup"><span data-stu-id="a99e3-157">Figure 7 shows this page, when viewed through a browser, after the TemplateField and CheckBox have been added.</span></span>


<span data-ttu-id="a99e3-158">[![Każdy wiersz produktu zawiera teraz Checkbox](adding-a-gridview-column-of-checkboxes-vb/_static/image7.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="a99e3-158">[![Each Product Row Now Includes a Checkbox](adding-a-gridview-column-of-checkboxes-vb/_static/image7.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image13.png)</span></span>

<span data-ttu-id="a99e3-159">**Rysunek 7**: każdy wiersz produktu zawiera teraz Checkbox ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](adding-a-gridview-column-of-checkboxes-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="a99e3-159">**Figure 7**: Each Product Row Now Includes a Checkbox ([Click to view full-size image](adding-a-gridview-column-of-checkboxes-vb/_static/image14.png))</span></span>


## <a name="step-3-determining-what-checkboxes-were-checked-on-postback"></a><span data-ttu-id="a99e3-160">Krok 3: Określanie, jakie pola wyboru zostały sprawdzone odświeżania strony</span><span class="sxs-lookup"><span data-stu-id="a99e3-160">Step 3: Determining What Checkboxes Were Checked On Postback</span></span>

<span data-ttu-id="a99e3-161">W tym momencie mamy kolumny pola wyboru, ale nie można określić, jakie pola wyboru zostały zaznaczone na ogłaszania zwrotnego.</span><span class="sxs-lookup"><span data-stu-id="a99e3-161">At this point we have a column of checkboxes but no way to determine what checkboxes were checked on postback.</span></span> <span data-ttu-id="a99e3-162">Po kliknięciu przycisku Usuń wybrane produkty, musimy wiedzieć, jakie pola wyboru zostały zaznaczone w celu usunięcia tych produktów.</span><span class="sxs-lookup"><span data-stu-id="a99e3-162">When the Delete Selected Products button is clicked, though, we need to know what checkboxes were checked in order to delete those products.</span></span>

<span data-ttu-id="a99e3-163">GridView s [ `Rows` właściwość](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.rows.aspx) zapewnia dostęp do wierszy danych w widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="a99e3-163">The GridView s [`Rows` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.rows.aspx) provides access to the data rows in the GridView.</span></span> <span data-ttu-id="a99e3-164">Firma Microsoft iterację te wiersze uzyskania programowego dostępu do formantu wyboru, a następnie zapoznaj się jego `Checked` właściwości w celu określenia, czy pole wyboru zostało zaznaczone.</span><span class="sxs-lookup"><span data-stu-id="a99e3-164">We can iterate through these rows, programmatically access the CheckBox control, and then consult its `Checked` property to determine whether the CheckBox has been selected.</span></span>

<span data-ttu-id="a99e3-165">Tworzenie procedury obsługi zdarzeń dla `DeleteSelectedProducts` kontrolki przycisku w sieci Web s `Click` zdarzeń i Dodaj następujący kod:</span><span class="sxs-lookup"><span data-stu-id="a99e3-165">Create an event handler for the `DeleteSelectedProducts` Button Web control s `Click` event and add the following code:</span></span>


[!code-vb[Main](adding-a-gridview-column-of-checkboxes-vb/samples/sample2.vb)]

<span data-ttu-id="a99e3-166">`Rows` Właściwość zwraca kolekcję `GridViewRow` wystąpień w skład tego wiersze danych widoku GridView s.</span><span class="sxs-lookup"><span data-stu-id="a99e3-166">The `Rows` property returns a collection of `GridViewRow` instances that makeup the GridView s data rows.</span></span> <span data-ttu-id="a99e3-167">`For Each` Pętli tutaj wylicza tej kolekcji.</span><span class="sxs-lookup"><span data-stu-id="a99e3-167">The `For Each` loop here enumerates this collection.</span></span> <span data-ttu-id="a99e3-168">Dla każdego `GridViewRow` obiekt wiersza s wyboru programowo jest dostępny przy użyciu `row.FindControl("controlID")`.</span><span class="sxs-lookup"><span data-stu-id="a99e3-168">For each `GridViewRow` object, the row s CheckBox is programmatically accessed using `row.FindControl("controlID")`.</span></span> <span data-ttu-id="a99e3-169">Jeśli pole wyboru jest zaznaczone, odpowiedni wiersz s `ProductID` wartość jest pobierana z `DataKeys` kolekcji.</span><span class="sxs-lookup"><span data-stu-id="a99e3-169">If the CheckBox is checked, the row s corresponding `ProductID` value is retrieved from the `DataKeys` collection.</span></span> <span data-ttu-id="a99e3-170">W tym ćwiczeniu, po prostu wyświetli komunikat informacyjny w `DeleteResults` etykietę, mimo że w działającą aplikację możemy d zamiast wywoływania `ProductsBLL` klasy s `DeleteProduct(productID)` metody.</span><span class="sxs-lookup"><span data-stu-id="a99e3-170">In this exercise, we simply display an informative message in the `DeleteResults` Label, although in a working application we d instead make a call to the `ProductsBLL` class s `DeleteProduct(productID)` method.</span></span>

<span data-ttu-id="a99e3-171">Dodając ten program obsługi zdarzeń, kliknięcie przycisku Usuń wybrane produkty teraz wyświetla `ProductID` s zaznaczonych produktów.</span><span class="sxs-lookup"><span data-stu-id="a99e3-171">With the addition of this event handler, clicking the Delete Selected Products button now displays the `ProductID` s of the selected products.</span></span>


<span data-ttu-id="a99e3-172">[![Po kliknięciu przycisku produktów usunąć wybrane ProductIDs wybrane produkty są wyświetlane](adding-a-gridview-column-of-checkboxes-vb/_static/image8.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="a99e3-172">[![When the Delete Selected Products Button is Clicked the Selected Products ProductIDs are Listed](adding-a-gridview-column-of-checkboxes-vb/_static/image8.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image15.png)</span></span>

<span data-ttu-id="a99e3-173">**Rysunek 8**: gdy usunąć wybrane produkty przycisku wybrane produkty `ProductID` s są wyświetlane ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](adding-a-gridview-column-of-checkboxes-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="a99e3-173">**Figure 8**: When the Delete Selected Products Button is Clicked the Selected Products `ProductID` s are Listed ([Click to view full-size image](adding-a-gridview-column-of-checkboxes-vb/_static/image16.png))</span></span>


## <a name="step-4-adding-check-all-and-uncheck-all-buttons"></a><span data-ttu-id="a99e3-174">Krok 4: Dodawanie zaznacz wszystkie i usuń zaznaczenie wszystkich przycisków</span><span class="sxs-lookup"><span data-stu-id="a99e3-174">Step 4: Adding Check All and Uncheck All Buttons</span></span>

<span data-ttu-id="a99e3-175">Jeśli użytkownik chce, aby usunąć wszystkie produkty na bieżącej stronie, musi sprawdzić każdy dziesięć pól wyboru.</span><span class="sxs-lookup"><span data-stu-id="a99e3-175">If a user wants to delete all products on the current page, they must check each of the ten checkboxes.</span></span> <span data-ttu-id="a99e3-176">Możemy pomóc przyspieszyć ten proces przez dodanie wszystkich Sprawdź przycisku, po kliknięciu zaznaczenie wszystkich pól wyboru w siatce.</span><span class="sxs-lookup"><span data-stu-id="a99e3-176">We can help expedite this process by adding a Check All button that, when clicked, selects all of the checkboxes in the grid.</span></span> <span data-ttu-id="a99e3-177">Przycisk Usuń zaznaczenie wszystkich będą pomocne w równym stopniu.</span><span class="sxs-lookup"><span data-stu-id="a99e3-177">An Uncheck All button would be equally helpful.</span></span>

<span data-ttu-id="a99e3-178">Dodaj dwa kontrolki przycisku w sieci Web ze stroną, umieszczenia ich powyżej widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="a99e3-178">Add two Button Web controls to the page, placing them above the GridView.</span></span> <span data-ttu-id="a99e3-179">Ustaw najpierw jeden s `ID` do `CheckAll` i jego `Text` właściwość, aby sprawdzić wszystkie; Ustaw drugi jeden s `ID` do `UncheckAll` i jego `Text` Usuń zaznaczenie wszystkich właściwości.</span><span class="sxs-lookup"><span data-stu-id="a99e3-179">Set the first one s `ID` to `CheckAll` and its `Text` property to Check All ; set the second one s `ID` to `UncheckAll` and its `Text` property to Uncheck All .</span></span>


[!code-aspx[Main](adding-a-gridview-column-of-checkboxes-vb/samples/sample3.aspx)]

<span data-ttu-id="a99e3-180">Następnie należy utworzyć metody w klasie związanej z kodem o nazwie `ToggleCheckState(checkState)` , gdy została wywołana, wylicza `Products` s widoku GridView `Rows` kolekcji i ustawia s każdego wyboru `Checked` właściwości do wartości przekazanych w *checkState*  parametru.</span><span class="sxs-lookup"><span data-stu-id="a99e3-180">Next, create a method in the code-behind class named `ToggleCheckState(checkState)` that, when invoked, enumerates the `Products` GridView s `Rows` collection and sets each CheckBox s `Checked` property to the value of the passed in *checkState* parameter.</span></span>


[!code-vb[Main](adding-a-gridview-column-of-checkboxes-vb/samples/sample4.vb)]

<span data-ttu-id="a99e3-181">Następnie należy utworzyć `Click` obsługi zdarzeń `CheckAll` i `UncheckAll` przycisków.</span><span class="sxs-lookup"><span data-stu-id="a99e3-181">Next, create `Click` event handlers for the `CheckAll` and `UncheckAll` buttons.</span></span> <span data-ttu-id="a99e3-182">W `CheckAll` s obsługi zdarzeń, po prostu wywołanie `ToggleCheckState(True)`; na liście `UncheckAll`, wywołaj `ToggleCheckState(False)`.</span><span class="sxs-lookup"><span data-stu-id="a99e3-182">In `CheckAll` s event handler, simply call `ToggleCheckState(True)`; in `UncheckAll`, call `ToggleCheckState(False)`.</span></span>


[!code-vb[Main](adding-a-gridview-column-of-checkboxes-vb/samples/sample5.vb)]

<span data-ttu-id="a99e3-183">Z tego kodu kliknięcie przycisku Sprawdź wszystkie powoduje odświeżenie strony i sprawdza wszystkie pola wyboru w widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="a99e3-183">With this code, clicking the Check All button causes a postback and checks all of the checkboxes in the GridView.</span></span> <span data-ttu-id="a99e3-184">Podobnie klikając polecenie Usuń zaznaczenie wszystkich usuwa wszystkie pola wyboru.</span><span class="sxs-lookup"><span data-stu-id="a99e3-184">Likewise, clicking Uncheck All unselects all checkboxes.</span></span> <span data-ttu-id="a99e3-185">Po sprawdzeniu przycisk Sprawdź wszystkie rysunku nr 9 przedstawiono ekranu.</span><span class="sxs-lookup"><span data-stu-id="a99e3-185">Figure 9 shows the screen after the Check All button has been checked.</span></span>


<span data-ttu-id="a99e3-186">[![Kliknij przycisk wszystkie sprawdzenia zaznaczyć wszystkie pola wyboru](adding-a-gridview-column-of-checkboxes-vb/_static/image9.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="a99e3-186">[![Clicking the Check All Button Selects All Checkboxes](adding-a-gridview-column-of-checkboxes-vb/_static/image9.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image17.png)</span></span>

<span data-ttu-id="a99e3-187">**Rysunek 9**: kliknięcie przycisku Sprawdź wszystkie przycisk wybiera wszystkie pola wyboru ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](adding-a-gridview-column-of-checkboxes-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="a99e3-187">**Figure 9**: Clicking the Check All Button Selects All Checkboxes ([Click to view full-size image](adding-a-gridview-column-of-checkboxes-vb/_static/image18.png))</span></span>


> [!NOTE]
> <span data-ttu-id="a99e3-188">Podczas wyświetlania kolumny pola wyboru, jednym z podejść zaznaczania lub unselecting wszystkie pola wyboru jest pole wyboru w wierszu nagłówka.</span><span class="sxs-lookup"><span data-stu-id="a99e3-188">When displaying a column of checkboxes, one approach for selecting or unselecting all of the checkboxes is through a checkbox in the header row.</span></span> <span data-ttu-id="a99e3-189">Ponadto bieżącego zaznacz wszystkie / Usuń zaznaczenie wszystkich wdrożenie wymaga odświeżania strony.</span><span class="sxs-lookup"><span data-stu-id="a99e3-189">Moreover, the current Check All / Uncheck All implementation requires a postback.</span></span> <span data-ttu-id="a99e3-190">Pola wyboru można zaznaczać lub usuwać zaznaczenia, jednak całkowicie za pomocą skryptu po stronie klienta, zapewniając snappier środowisko użytkownika.</span><span class="sxs-lookup"><span data-stu-id="a99e3-190">The checkboxes can be checked or unchecked, however, entirely through client-side script, thereby providing a snappier user experience.</span></span> <span data-ttu-id="a99e3-191">Aby zapoznać się z za pomocą wyboru wiersz nagłówka dla Zaznacz wszystko i usuń zaznaczenie wszystkich szczegółowo, wraz z dyskusji przy użyciu technik po stronie klienta, zapoznaj się [sprawdzanie wszystkie pola wyboru w widoku GridView skryptu po stronie klienta przy użyciu i wszystkie pola wyboru Sprawdź](http://aspnet.4guysfromrolla.com/articles/053106-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="a99e3-191">To explore using a header row checkbox for Check All and Uncheck All in detail, along with a discussion on using client-side techniques, check out [Checking All CheckBoxes in a GridView Using Client-Side Script and a Check All CheckBox](http://aspnet.4guysfromrolla.com/articles/053106-1.aspx).</span></span>


## <a name="summary"></a><span data-ttu-id="a99e3-192">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="a99e3-192">Summary</span></span>

<span data-ttu-id="a99e3-193">W przypadkach, w których należy powiadomić użytkowników, wybierz dowolną liczbę wierszy w widoku GridView przed kontynuowaniem Dodawanie kolumny pola wyboru jest jedną z opcji.</span><span class="sxs-lookup"><span data-stu-id="a99e3-193">In cases where you need to let users choose an arbitrary number of rows from a GridView before proceeding, adding a column of checkboxes is one option.</span></span> <span data-ttu-id="a99e3-194">Jak widzieliśmy w tym samouczku, włącznie z kolumną zawierającą pola wyboru w widoku GridView pociąga za sobą Dodawanie TemplateField za pomocą formantu CheckBox w sieci Web.</span><span class="sxs-lookup"><span data-stu-id="a99e3-194">As we saw in this tutorial, including a column of checkboxes in the GridView entails adding a TemplateField with a CheckBox Web control.</span></span> <span data-ttu-id="a99e3-195">Za pomocą formantu sieci Web (w przeciwieństwie wstrzyknięcie znaczników bezpośrednio do szablonu, jak robiliśmy w poprzednich instrukcji) ASP.NET pamięta automatycznie co pola wyboru zostały i nie zostały zaznaczone w ogłaszania zwrotnego.</span><span class="sxs-lookup"><span data-stu-id="a99e3-195">By using a Web control (versus injecting markup directly into the template, as we did in the previous tutorial) ASP.NET automatically remembers what CheckBoxes were and were not checked across postback.</span></span> <span data-ttu-id="a99e3-196">Firma Microsoft może również uzyskania programowego dostępu do pola wyboru w kodzie Aby ustalić, czy zaznaczono pole wyboru danego lub zmienić stan zaznaczenia.</span><span class="sxs-lookup"><span data-stu-id="a99e3-196">We can also programmatically access the CheckBoxes in code to determine whether a given CheckBox is checked, or to chnage the checked state.</span></span>

<span data-ttu-id="a99e3-197">W tym samouczku i ostatnią przeglądał dodanie selektora kolumnę do widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="a99e3-197">This tutorial and the last one looked at adding a row selector column to the GridView.</span></span> <span data-ttu-id="a99e3-198">W naszym samouczku dalej zajmiemy się, jak to zrobić, z bitowego pracy, można dodać możliwości wstawianie do widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="a99e3-198">In our next tutorial we'll examine how, with a bit of work, we can add inserting capabilities to the GridView.</span></span>

<span data-ttu-id="a99e3-199">Programowanie przyjemność!</span><span class="sxs-lookup"><span data-stu-id="a99e3-199">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="a99e3-200">Informacje o autorze</span><span class="sxs-lookup"><span data-stu-id="a99e3-200">About the Author</span></span>

<span data-ttu-id="a99e3-201">[Scott Bento](http://www.4guysfromrolla.com/ScottMitchell.shtml), autora siedmiu książek ASP/ASP.NET i twórcę z [4GuysFromRolla.com](http://www.4guysfromrolla.com), pracuje z technologii Microsoft Web od 1998.</span><span class="sxs-lookup"><span data-stu-id="a99e3-201">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="a99e3-202">Scott działa jako niezależnego konsultanta trainer i składnika zapisywania.</span><span class="sxs-lookup"><span data-stu-id="a99e3-202">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="a99e3-203">Jest jego najnowszej książki [ *Sams nauczyć się ASP.NET 2.0 w ciągu 24 godzin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="a99e3-203">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="a99e3-204">Piotr można uzyskać pod adresem [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) lub za pośrednictwem jego blog, który znajduje się w temacie [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="a99e3-204">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="a99e3-205">[Poprzednie](adding-a-gridview-column-of-radio-buttons-vb.md)
[dalej](inserting-a-new-record-from-the-gridview-s-footer-vb.md)</span><span class="sxs-lookup"><span data-stu-id="a99e3-205">[Previous](adding-a-gridview-column-of-radio-buttons-vb.md)
[Next](inserting-a-new-record-from-the-gridview-s-footer-vb.md)</span></span>
