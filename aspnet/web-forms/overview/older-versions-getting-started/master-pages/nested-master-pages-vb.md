---
uid: web-forms/overview/older-versions-getting-started/master-pages/nested-master-pages-vb
title: Zagnieżdżone strony wzorcowe (VB) | Dokumentacja firmy Microsoft
author: rick-anderson
description: Pokazuje, jak można zagnieżdżać jednej strony wzorcowej w innym.
ms.author: aspnetcontent
manager: wpickett
ms.date: 07/28/2008
ms.topic: article
ms.assetid: 14d9aa1b-4dca-43a0-aa9d-a6e891fee019
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/older-versions-getting-started/master-pages/nested-master-pages-vb
msc.type: authoredcontent
ms.openlocfilehash: 8c0123c12bb653a7f680154e2155eae0eb129428
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/06/2018
ms.locfileid: "30891822"
---
<a name="nested-master-pages-vb"></a><span data-ttu-id="29371-103">Zagnieżdżone strony wzorcowe (VB)</span><span class="sxs-lookup"><span data-stu-id="29371-103">Nested Master Pages (VB)</span></span>
====================
<span data-ttu-id="29371-104">przez [Bento Scott](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="29371-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="29371-105">[Pobierz kod](http://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_10_VB.zip) lub [pobierania plików PDF](http://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_10_VB.pdf)</span><span class="sxs-lookup"><span data-stu-id="29371-105">[Download Code](http://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_10_VB.zip) or [Download PDF](http://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_10_VB.pdf)</span></span>

> <span data-ttu-id="29371-106">Pokazuje, jak można zagnieżdżać jednej strony wzorcowej w innym.</span><span class="sxs-lookup"><span data-stu-id="29371-106">Shows how to nest one master page within another.</span></span>


## <a name="introduction"></a><span data-ttu-id="29371-107">Wprowadzenie</span><span class="sxs-lookup"><span data-stu-id="29371-107">Introduction</span></span>

<span data-ttu-id="29371-108">W ciągu ostatnich samouczki dziewięć zaobserwowano implementowania układ całej lokacji przy użyciu stron wzorcowych.</span><span class="sxs-lookup"><span data-stu-id="29371-108">Over the course of the past nine tutorials we have seen how to implement a site-wide layout with master pages.</span></span> <span data-ttu-id="29371-109">Mówiąc stron wzorcowych możemy, developer strony, aby zdefiniować markup wspólnego na stronie głównej wraz z określonych regionów, które mogą być dostosowywane na podstawie zawartości strony zawartości strony.</span><span class="sxs-lookup"><span data-stu-id="29371-109">In a nutshell, master pages allow us, the page developer, to define common markup in the master page along with specific regions that can be customized on a content page-by-content page basis.</span></span> <span data-ttu-id="29371-110">Formanty elementu ContentPlaceHolder na stronie głównej wskazać dostosowania regionów; dostosowane znaczników dla formantów elementu ContentPlaceHolder są definiowane na stronie zawartości za pomocą formantów zawartości.</span><span class="sxs-lookup"><span data-stu-id="29371-110">The ContentPlaceHolder controls in a master page indicate the customizable regions; the customized markup for the ContentPlaceHolder controls are defined in the content page via Content controls.</span></span>

<span data-ttu-id="29371-111">Techniki strony wzorcowej, które firma Microsoft zostały przedstawione dotychczasowych jest wspaniała, jeśli mieć pojedynczy układ używane w całej lokacji.</span><span class="sxs-lookup"><span data-stu-id="29371-111">The master page techniques we've explored thus far are great if you have a single layout used across the entire site.</span></span> <span data-ttu-id="29371-112">Jednak wielu dużych witryn sieci Web ma układu witryny, dostosowane w poszczególnych sekcjach.</span><span class="sxs-lookup"><span data-stu-id="29371-112">However, many large websites have a site layout that is customized across various sections.</span></span> <span data-ttu-id="29371-113">Rozważmy na przykład aplikacji opieki zdrowotnej, używane przez pracowników szpital Twoich do zarządzania informacji pacjenta, działań i rozliczeń.</span><span class="sxs-lookup"><span data-stu-id="29371-113">For example, consider a health care application used by hospital staff to manage patient information, activities, and billing.</span></span> <span data-ttu-id="29371-114">Może to być trzy typy stron sieci web w tej aplikacji:</span><span class="sxs-lookup"><span data-stu-id="29371-114">There may be three types of web pages in this application:</span></span>

- <span data-ttu-id="29371-115">Personel specyficzne dla elementu członkowskiego stron, którym pracownicy mogą aktualizować dostępności, wyświetlać harmonogramy, lub zwróć urlop.</span><span class="sxs-lookup"><span data-stu-id="29371-115">Staff member-specific pages where staff members can update availability, view schedules, or request vacation time.</span></span>
- <span data-ttu-id="29371-116">Strony pacjenta specyficzne, gdzie pracownicy Wyświetl lub Edytuj informacje dotyczące określonego pacjenta.</span><span class="sxs-lookup"><span data-stu-id="29371-116">Patient-specific pages where staff members view or edit information for a specific patient.</span></span>
- <span data-ttu-id="29371-117">Gdzie księgowym Przejrzyj bieżącej strony dotyczące rozliczeń oświadczeń stanów i raporty finansowe.</span><span class="sxs-lookup"><span data-stu-id="29371-117">Billing-specific pages where accountants review current claim statuses and financial reports.</span></span>

<span data-ttu-id="29371-118">Każdej strony może udostępnić układ wspólne, takie jak menu na górze i serii często używanych łączy wzdłuż dolnej.</span><span class="sxs-lookup"><span data-stu-id="29371-118">Every page might share a common layout, such as a menu across the top and a series of frequently used links along the bottom.</span></span> <span data-ttu-id="29371-119">Ale pracowników, pacjenta i stron związanych z rozliczeniami może być konieczne dostosowanie ten Układ ogólny.</span><span class="sxs-lookup"><span data-stu-id="29371-119">But the staff-, patient-, and billing-specific pages may need to customize this generic layout.</span></span> <span data-ttu-id="29371-120">Na przykład możliwe, że wszystkie strony specyficzne dla personelu powinna zawierać kalendarz i zadania listę zawierającą informacje o dostępności i harmonogramu dziennego aktualnie zalogowanego użytkownika.</span><span class="sxs-lookup"><span data-stu-id="29371-120">For example, perhaps all staff-specific pages should include a calendar and task list showing the currently logged on user's availability and daily schedule.</span></span> <span data-ttu-id="29371-121">Możliwe, że wszystkie strony pacjenta specyficzne chcesz pokazać nazwisko, adres i informacji dotyczących pacjenta, którego informacje jest edytowany ubezpieczenia.</span><span class="sxs-lookup"><span data-stu-id="29371-121">Perhaps all patient-specific pages need to show the name, address, and insurance information for the patient whose information is being edited.</span></span>

<span data-ttu-id="29371-122">Istnieje możliwość utworzenia takich układów niestandardowych za pomocą *zagnieżdżone strony wzorcowe*.</span><span class="sxs-lookup"><span data-stu-id="29371-122">It's possible to create such customized layouts by using *nested master pages*.</span></span> <span data-ttu-id="29371-123">Do zaimplementowania scenariusza powyżej, firma Microsoft będzie Rozpocznij od utworzenia zdefiniowana zawartości układ, menu i stopki całej lokacji, z Definiowanie regionów dostosowywalne Elementy ContentPlaceHolders strony wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="29371-123">To implement the above scenario, we would start by creating a master page that defined the site-wide layout, the menu and footer content, with ContentPlaceHolders defining the customizable regions.</span></span> <span data-ttu-id="29371-124">Następnie możemy utworzyć trzy zagnieżdżone strony wzorcowe, po jednej dla każdego typu strony sieci web.</span><span class="sxs-lookup"><span data-stu-id="29371-124">We would then create three nested master pages, one for each type of web page.</span></span> <span data-ttu-id="29371-125">Każdy osadzonej stronie głównej zdefiniowane zawartości między typem zawartości stron, które używają strony wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="29371-125">Each nested master page would define the content among the type of content pages that use the master page.</span></span> <span data-ttu-id="29371-126">Innymi słowy zagnieżdżone strony wzorcowej dla stron zawartości określonego pacjenta obejmuje znaczników i logiki do wyświetlania informacji na temat pacjenta edytowany.</span><span class="sxs-lookup"><span data-stu-id="29371-126">In other words, the nested master page for patient-specific content pages would include markup and programmatic logic for displaying information about the patient being edited.</span></span> <span data-ttu-id="29371-127">Podczas tworzenia nowej strony specyficzne dla pacjenta firma Microsoft może powiązać go z tego osadzonej stronie głównej.</span><span class="sxs-lookup"><span data-stu-id="29371-127">When creating a new patient-specific page we would bind it to this nested master page.</span></span>

<span data-ttu-id="29371-128">W tym samouczku rozpoczyna się od wyróżnianie zalet zagnieżdżone strony wzorcowe.</span><span class="sxs-lookup"><span data-stu-id="29371-128">This tutorial starts by highlighting the benefits of nested master pages.</span></span> <span data-ttu-id="29371-129">Następnie widoczny jest sposób tworzenia i używania zagnieżdżone strony wzorcowe.</span><span class="sxs-lookup"><span data-stu-id="29371-129">It then shows how to create and use nested master pages.</span></span>

> [!NOTE]
> <span data-ttu-id="29371-130">Zagnieżdżone strony wzorcowe zostały możliwe od programu .NET Framework w wersji 2.0.</span><span class="sxs-lookup"><span data-stu-id="29371-130">Nested master pages have been possible since version 2.0 of the .NET Framework.</span></span> <span data-ttu-id="29371-131">Visual Studio 2005 nie zawiera jednak obsługi zagnieżdżone strony wzorcowe w czasie projektowania.</span><span class="sxs-lookup"><span data-stu-id="29371-131">However, Visual Studio 2005 did not include design-time support for nested master pages.</span></span> <span data-ttu-id="29371-132">Dobre wieści jest, że program Visual Studio 2008 oferuje zaawansowane środowisko czasu projektowania dla zagnieżdżone strony wzorcowe.</span><span class="sxs-lookup"><span data-stu-id="29371-132">The good news is that Visual Studio 2008 offers a rich design-time experience for nested master pages.</span></span> <span data-ttu-id="29371-133">Jeśli chcesz użyć zagnieżdżone strony wzorcowe, ale nadal przy użyciu programu Visual Studio 2005, zapoznaj się [Scott Guthrie](https://weblogs.asp.net/scottgu/)jego wpis w blogu [porady dotyczące zagnieżdżone strony wzorcowe w czasie projektowania 2005 VS](https://weblogs.asp.net/scottgu/archive/2005/11/11/430382.aspx).</span><span class="sxs-lookup"><span data-stu-id="29371-133">If you are interested in using nested master pages but are still using Visual Studio 2005, check out [Scott Guthrie](https://weblogs.asp.net/scottgu/)'s blog entry, [Tips for Nested Master Pages in VS 2005 Design-Time](https://weblogs.asp.net/scottgu/archive/2005/11/11/430382.aspx).</span></span>


## <a name="the-benefits-of-nested-master-pages"></a><span data-ttu-id="29371-134">Zalety zagnieżdżone strony wzorcowe</span><span class="sxs-lookup"><span data-stu-id="29371-134">The Benefits of Nested Master Pages</span></span>

<span data-ttu-id="29371-135">Wiele witryn sieci Web ma lokacja nadrzędna, a także bardziej dostosowanego projektów specyficzne dla określonych rodzajów stron.</span><span class="sxs-lookup"><span data-stu-id="29371-135">Many websites have an overarching site design as well as more customized designs specific to certain types of pages.</span></span> <span data-ttu-id="29371-136">Na przykład w naszej aplikacji sieci web pokaz utworzono podstawowe sekcji Administracja (strony `~/Admin` folderu).</span><span class="sxs-lookup"><span data-stu-id="29371-136">For instance, in our demo web application we have created a rudimentary Administration section (the pages in the `~/Admin` folder).</span></span> <span data-ttu-id="29371-137">Obecnie stron sieci web w `~/Admin` folderu używać tej samej strony wzorcowej na tych stronach nie w sekcji Administracja (to znaczy, `Site.master` lub `Alternate.master`, w zależności od wybranej przez użytkownika).</span><span class="sxs-lookup"><span data-stu-id="29371-137">Currently the web pages in the `~/Admin` folder use the same master page as those pages not in the administration section (namely, `Site.master` or `Alternate.master`, depending on the user's selection).</span></span>

> [!NOTE]
> <span data-ttu-id="29371-138">Na razie podawać czy naszej witrynie ma tylko jedną stronę wzorcową `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="29371-138">For now, pretend that our site has just one master page, `Site.master`.</span></span> <span data-ttu-id="29371-139">Będzie można rozwiązać przy użyciu zagnieżdżone strony wzorcowe z dwóch (lub więcej) strony wzorcowe, począwszy od "Przy użyciu wzorca strony dla administracji sekcji zagnieżdżonych" w dalszej części tego samouczka.</span><span class="sxs-lookup"><span data-stu-id="29371-139">We'll address using nested master pages with two (or more) master pages starting with "Using a Nested Master Page for the Administration Section" later in this tutorial.</span></span>


<span data-ttu-id="29371-140">Załóżmy, że firma Microsoft zostały monit dostosować układ strony administracji do zawierają dodatkowe informacje i linki, które nie w przeciwnym razie jest obecny w innych stron w witrynie.</span><span class="sxs-lookup"><span data-stu-id="29371-140">Imagine that we were asked to customize the layout of the Administration pages to include additional information or links that would not otherwise be present in other pages in the site.</span></span> <span data-ttu-id="29371-141">Istnieją cztery technik w celu wykonania tego wymagania:</span><span class="sxs-lookup"><span data-stu-id="29371-141">There are four techniques to implement this requirement:</span></span>

1. <span data-ttu-id="29371-142">Ręcznie Dodaj informacje specyficzne dla Administracja i łącza do każdej strony zawartości `~/Admin` folderu.</span><span class="sxs-lookup"><span data-stu-id="29371-142">Manually add the Administration-specific information and links to every content page in the `~/Admin` folder.</span></span>
2. <span data-ttu-id="29371-143">Aktualizacja `Site.master` strony wzorcowej do uwzględnienia informacje specyficzne dla sekcji Administracja i łącza, a następnie dodaj kod do strony głównej, aby pokazać lub ukryć następujące sekcje w oparciu czy jednej strony Administracja jest odwiedzana.</span><span class="sxs-lookup"><span data-stu-id="29371-143">Update the `Site.master` master page to include the Administration section-specific information and links, and then add code to the master page to show or hide these sections based on whether one of the Administration pages is being visited.</span></span>
3. <span data-ttu-id="29371-144">Tworzenie nowej strony wzorcowej specjalnie z myślą o sekcji Administracja kopiowane znaczników z `Site.master`, Dodaj informacje specyficzne dla sekcji Administracja i łącza, a następnie zaktualizuj strony zawartości w `~/Admin` folderu, aby użyć tej nowej wzorca Strona.</span><span class="sxs-lookup"><span data-stu-id="29371-144">Create a new master page specifically for the Administration section, copy over the markup from `Site.master`, add the Administration section-specific information and links, and then update the content pages in the `~/Admin` folder to use this new master page.</span></span>
4. <span data-ttu-id="29371-145">Tworzenie osadzonej stronie głównej, która jest powiązana z `Site.master` i zawartości stron `~/Admin` użycie folderu nowy zagnieżdżone strony wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="29371-145">Create a nested master page that binds to `Site.master` and have the content pages in the `~/Admin` folder use this new nested master page.</span></span> <span data-ttu-id="29371-146">Ta osadzonej stronie głównej to po prostu dodatkowe informacje i linki specyficzne dla stron administracyjnych i nie jest wymagane Powtórz znacznika już zdefiniowana w `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="29371-146">This nested master page would include just the additional information and links specific to the Administration pages and would not need to repeat the markup already defined in `Site.master`.</span></span>

<span data-ttu-id="29371-147">Pierwsza opcja jest najmniej palatable.</span><span class="sxs-lookup"><span data-stu-id="29371-147">The first option is the least palatable.</span></span> <span data-ttu-id="29371-148">Całego miejsca przy użyciu stron wzorcowych jest przenieść poza konieczności ręcznie skopiuj i Wklej markup wspólnego do nowych stron ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="29371-148">The whole point of using master pages is to move away from having to manually copy and paste common markup to new ASP.NET pages.</span></span> <span data-ttu-id="29371-149">Drugą opcją jest dopuszczalna, ale sprawia, że aplikacja jest mniej łatwy w obsłudze, zgodnie z jego bulks się stron wzorcowych z kod znaczników, który jest wyświetlany tylko od czasu do czasu i wymaga deweloperzy edycji strony głównej w celu obejścia tego znacznika i do zapamiętania, kiedy dokładnie i jest wyświetlany niektórych znaczników, gdy jest on ukryty.</span><span class="sxs-lookup"><span data-stu-id="29371-149">The second option is acceptable, but makes the application less maintainable as it bulks up the master pages with markup that is only occasionally displayed and requires developers editing the master page to work around this markup and to have to remember when, exactly, certain markup is displayed versus when it is hidden.</span></span> <span data-ttu-id="29371-150">Ta metoda jest mniej firmy tenable jako dostosowania z coraz więcej typów stron sieci web, konieczne są spełnione przez ten pojedynczej strony wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="29371-150">This approach would be less tenable as customizations from more and more types of web pages needed to be accommodated by this single master page.</span></span>

<span data-ttu-id="29371-151">Trzecia opcja powoduje usunięcie niepotrzebnych i złożoność wystawia surfaced z drugą opcją.</span><span class="sxs-lookup"><span data-stu-id="29371-151">The third option removes the clutter and complexity issues the surfaced with the second option.</span></span> <span data-ttu-id="29371-152">Jednak opcja trzy przez główną wadą jest wymaganie firmie Microsoft w celu kopiowania i wklejania wspólnej układu z `Site.master` do nowej strony wzorcowej specyficzne dla sekcji administracji.</span><span class="sxs-lookup"><span data-stu-id="29371-152">However, option three's main drawback is that it requires us to copy and paste the common layout from `Site.master` to the new Administration section-specific master page.</span></span> <span data-ttu-id="29371-153">Jeśli zdecydujesz się firma Microsoft później zmienić układ całej lokacji, musimy Pamiętaj, aby go zmienić w dwóch miejscach.</span><span class="sxs-lookup"><span data-stu-id="29371-153">If we later decide to change the site-wide layout we have to remember to change it in two places.</span></span>

<span data-ttu-id="29371-154">Opcji czwarty zagnieżdżone strony wzorcowe, Przekaż nam najlepsze opcje drugiego i trzeciego.</span><span class="sxs-lookup"><span data-stu-id="29371-154">The fourth option, nested master pages, give us the best of the second and third options.</span></span> <span data-ttu-id="29371-155">Informacje o układzie całej lokacji jest obsługiwany w jednym pliku - najwyższego poziomu strony wzorcowej — podczas specyficzne dla poszczególnych regionów zawartości jest dzielony różne pliki.</span><span class="sxs-lookup"><span data-stu-id="29371-155">The site-wide layout information is maintained in one file - the top-level master page - while the content specific to particular regions is separated out into different files.</span></span>

<span data-ttu-id="29371-156">W tym samouczku rozpoczyna się od spojrzeć na tworzenie i korzystanie z prostych osadzonej stronie głównej.</span><span class="sxs-lookup"><span data-stu-id="29371-156">This tutorial starts with a look at creating and using a simple nested master page.</span></span> <span data-ttu-id="29371-157">Utworzymy całkowicie nowe strony wzorcowej najwyższego poziomu, dwa zagnieżdżone strony wzorcowe i dwie strony z zawartością.</span><span class="sxs-lookup"><span data-stu-id="29371-157">We create a brand new top-level master page, two nested master pages, and two content pages.</span></span> <span data-ttu-id="29371-158">Począwszy od przy użyciu zagnieżdżone wzorca strony dla administracji, zobacz sekcję"przyjrzymy się aktualizowanie obejmują użycie zagnieżdżone strony wzorcowe naszych istniejącej architektury strony wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="29371-158">Starting with "Using a Nested Master Page for the Administration Section," we look at updating our existing master page architecture to include the use of nested master pages.</span></span> <span data-ttu-id="29371-159">W szczególności, możemy utworzyć osadzonej stronie głównej i przy jego użyciu obejmować dodatkową zawartość niestandardowe dla stron zawartości w `~/Admin` folderu.</span><span class="sxs-lookup"><span data-stu-id="29371-159">Specifically, we create a nested master page and use it to include additional custom content for the content pages in the `~/Admin` folder.</span></span>

## <a name="step-1-creating-a-simple-top-level-master-page"></a><span data-ttu-id="29371-160">Krok 1: Tworzenie prostego najwyższego poziomu strony wzorcowej</span><span class="sxs-lookup"><span data-stu-id="29371-160">Step 1: Creating a Simple Top-Level Master Page</span></span>

<span data-ttu-id="29371-161">Tworzenie master zagnieżdżone na podstawie jednej z istniejącego wzorca stron i następnie aktualizacja istniejącej zawartości strony, aby używać tej nowej strony wzorcowej zagnieżdżonych zamiast najwyższego poziomu strony wzorcowej pociąga za sobą niektórych złożoności, ponieważ niektóre oczekuje już istniejących stron zawartości Formanty ContentPlaceHolder zdefiniowane na stronie głównej najwyższego poziomu.</span><span class="sxs-lookup"><span data-stu-id="29371-161">Creating a nested master based on one of the existing master pages and then updating an existing content page to use this new nested master page instead of the top-level master page entails some complexity because the existing content pages already expect certain ContentPlaceHolder controls defined in the top-level master page.</span></span> <span data-ttu-id="29371-162">W związku z tym osadzonej stronie głównej muszą także tych samych kontroli ContentPlaceHolder pod tą samą nazwą.</span><span class="sxs-lookup"><span data-stu-id="29371-162">Therefore, the nested master page must also include the same ContentPlaceHolder controls with the same names.</span></span> <span data-ttu-id="29371-163">Ponadto naszej aplikacji demonstracyjnej określonego ma dwie strony wzorcowej (`Site.master` i `Alternate.master`) dynamicznie przypisane do strony zawartości zgodnie z preferencjami użytkownika, którego dalsze dodaje do tego stopnia złożoności.</span><span class="sxs-lookup"><span data-stu-id="29371-163">Furthermore, our particular demo application has two master pages (`Site.master` and `Alternate.master`) that are dynamically assigned to a content page based on a user's preferences, which further adds to this complexity.</span></span> <span data-ttu-id="29371-164">Zajmiemy aktualizowania istniejących aplikacji do użycia w dalszej części tego samouczka zagnieżdżone strony wzorcowe, ale umożliwia pierwszy fokus na prostej zagnieżdżone strony wzorcowe przykład.</span><span class="sxs-lookup"><span data-stu-id="29371-164">We will look at updating the existing application to use nested master pages later in this tutorial, but let's first focus on a simple nested master pages example.</span></span>

<span data-ttu-id="29371-165">Utwórz nowy folder o nazwie `NestedMasterPages` , a następnie dodaj nowy plik strony głównej do tego folderu o nazwie `Simple.master`.</span><span class="sxs-lookup"><span data-stu-id="29371-165">Create a new folder named `NestedMasterPages` and then add a new master page file to that folder named `Simple.master`.</span></span> <span data-ttu-id="29371-166">(Zobacz rysunek 1 dla zrzut ekranu Eksploratora rozwiązań po dodaniu tego folderu i pliku). Przeciągnij `AlternateStyles.css` pliku arkusza stylów z Eksploratora rozwiązań do projektanta.</span><span class="sxs-lookup"><span data-stu-id="29371-166">(See Figure 1 for a screen shot of the Solution Explorer after this folder and file have been added.) Drag the `AlternateStyles.css` style sheet file from the Solution Explorer onto the Designer.</span></span> <span data-ttu-id="29371-167">Spowoduje to dodanie `<link>` elementu do pliku arkusza stylów w `<head>` elementu, po upływie którego strony wzorcowej `<head>` znacznika elementu powinien wyglądać następująco:</span><span class="sxs-lookup"><span data-stu-id="29371-167">This adds a `<link>` element to the style sheet file in the `<head>` element, after which the master page's `<head>` element's markup should look like:</span></span>


[!code-aspx[Main](nested-master-pages-vb/samples/sample1.aspx)]

<span data-ttu-id="29371-168">Następnie dodaj następujący kod w formularzu sieci Web `Simple.master`:</span><span class="sxs-lookup"><span data-stu-id="29371-168">Next, add the following markup within the Web Form of `Simple.master`:</span></span>


[!code-aspx[Main](nested-master-pages-vb/samples/sample2.aspx)]

<span data-ttu-id="29371-169">Ten kod znaczników zawiera łącze zatytułowany "Zagnieżdżone strony wzorcowe (proste)" w górnej części strony z użyciem dużej czcionki białe granatowym tła.</span><span class="sxs-lookup"><span data-stu-id="29371-169">This markup displays a link titled "Nested Master Pages (Simple)" at the top of the page in a large white font on a navy background.</span></span> <span data-ttu-id="29371-170">Pod który jest `MainContent` ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="29371-170">Beneath that is the `MainContent` ContentPlaceHolder.</span></span> <span data-ttu-id="29371-171">Rysunek 1 pokazuje `Simple.master` strony głównej po załadowaniu w projektancie programu Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="29371-171">Figure 1 shows the `Simple.master` master page when loaded in the Visual Studio Designer.</span></span>


<span data-ttu-id="29371-172">[![Zagnieżdżone strony wzorcowej definiuje określonej zawartości do stron w sekcji Administracja](nested-master-pages-vb/_static/image2.png)](nested-master-pages-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="29371-172">[![The Nested Master Page Defines Content Specific to the Pages in the Administration Section](nested-master-pages-vb/_static/image2.png)](nested-master-pages-vb/_static/image1.png)</span></span>

<span data-ttu-id="29371-173">**Rysunek 01**: zagnieżdżone wzorca strony definiuje zawartości specyficzne dla stron w sekcji Administracja ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](nested-master-pages-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="29371-173">**Figure 01**: The Nested Master Page Defines Content Specific to the Pages in the Administration Section ([Click to view full-size image](nested-master-pages-vb/_static/image3.png))</span></span>


## <a name="step-2-creating-a-simple-nested-master-page"></a><span data-ttu-id="29371-174">Krok 2: Tworzenie prostego zagnieżdżone strony wzorcowej</span><span class="sxs-lookup"><span data-stu-id="29371-174">Step 2: Creating a Simple Nested Master Page</span></span>

<span data-ttu-id="29371-175">`Simple.master` zawiera dwa formanty ContentPlaceHolder: `MainContent` ContentPlaceHolder dodaliśmy w formularzu sieci Web, wraz z `head` elementu ContentPlaceHolder na `<head>` elementu.</span><span class="sxs-lookup"><span data-stu-id="29371-175">`Simple.master` contains two ContentPlaceHolder controls: the `MainContent` ContentPlaceHolder we added within the Web Form along with the `head` ContentPlaceHolder in the `<head>` element.</span></span> <span data-ttu-id="29371-176">Czy możemy do tworzenia strony zawartości, który należy powiązać `Simple.master` musi dwóch formantów zawartości odwołujące się do dwóch Elementy ContentPlaceHolders strony zawartość.</span><span class="sxs-lookup"><span data-stu-id="29371-176">If we were to create a content page and bind it to `Simple.master` the content page would have two Content controls referencing the two ContentPlaceHolders.</span></span> <span data-ttu-id="29371-177">Podobnie możemy utworzyć osadzonej stronie głównej i powiązać `Simple.master` osadzonej stronie głównej będzie mieć dwa formanty zawartości.</span><span class="sxs-lookup"><span data-stu-id="29371-177">Similarly, if we create a nested master page and bind it to `Simple.master` then the nested master page will have two Content controls.</span></span>

<span data-ttu-id="29371-178">Możemy dodać do nowej strony wzorcowej zagnieżdżonych `NestedMasterPages` folder o nazwie `SimpleNested.master`.</span><span class="sxs-lookup"><span data-stu-id="29371-178">Let's add a new nested master page to the `NestedMasterPages` folder named `SimpleNested.master`.</span></span> <span data-ttu-id="29371-179">Kliknij prawym przyciskiem myszy `NestedMasterPages` folder i wybierz polecenie Dodaj nowy element.</span><span class="sxs-lookup"><span data-stu-id="29371-179">Right-click on the `NestedMasterPages` folder and choose Add New Item.</span></span> <span data-ttu-id="29371-180">Spowoduje to wyświetlenie okna dialogowego Dodaj nowy element pokazany na rysunku 2.</span><span class="sxs-lookup"><span data-stu-id="29371-180">This brings up the Add New Item dialog box shown in Figure 2.</span></span> <span data-ttu-id="29371-181">Wybierz typ szablonu strony wzorcowej i wpisz nazwę nowej strony wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="29371-181">Select the Master Page template type and type in the name of the new master page.</span></span> <span data-ttu-id="29371-182">Aby wskazać, że nowe strony wzorcowej powinny być osadzonej stronie głównej, zaznacz pole wyboru "Wybierz strony głównej".</span><span class="sxs-lookup"><span data-stu-id="29371-182">To indicate that the new master page should be a nested master page, check the "Select master page" checkbox.</span></span>

<span data-ttu-id="29371-183">Następnie kliknij przycisk Dodaj.</span><span class="sxs-lookup"><span data-stu-id="29371-183">Next, click the Add button.</span></span> <span data-ttu-id="29371-184">Spowoduje to wyświetlenie tego samego wybierz okno dialogowe strony wzorcowej, zostanie wyświetlony podczas wiązania strony zawartości strony wzorcowej (patrz rysunek 3).</span><span class="sxs-lookup"><span data-stu-id="29371-184">This will display the same Select a Master Page dialog box you see when binding a content page to a master page (see Figure 3).</span></span> <span data-ttu-id="29371-185">Wybierz `Simple.master` strony wzorcowej `NestedMasterPages` folder i kliknij przycisk OK.</span><span class="sxs-lookup"><span data-stu-id="29371-185">Choose the `Simple.master` master page in the `NestedMasterPages` folder and click OK.</span></span>

> [!NOTE]
> <span data-ttu-id="29371-186">Jeśli utworzono witryny sieci Web ASP.NET przy użyciu modelu projektu aplikacji sieci Web zamiast modelu projekt witryny sieci Web nie będą widzieć pole wyboru "Wybierz strony wzorcowej" w oknie dialogowym Dodawanie nowego elementu pokazany na rysunku 2.</span><span class="sxs-lookup"><span data-stu-id="29371-186">If you created your ASP.NET website using the Web Application Project model instead of the Web Site Project model you will not see the "Select master page" checkbox in the Add New Item dialog box shown in Figure 2.</span></span> <span data-ttu-id="29371-187">Można utworzyć osadzonej stronie głównej przy użyciu modelu projektu aplikacji sieci Web, musisz wybrać szablon zagnieżdżony strony wzorcowej (zamiast szablonu strony wzorcowej).</span><span class="sxs-lookup"><span data-stu-id="29371-187">To create a nested master page when using the Web Application Project model you must choose the Nested Master Page template (instead of the Master Page template).</span></span> <span data-ttu-id="29371-188">Po wybór szablonu zagnieżdżone strony wzorcowej i klikając przycisk Dodaj, wybierz taki sam strony wzorcowej, zostanie wyświetlone okno dialogowe pokazany na rysunku 3.</span><span class="sxs-lookup"><span data-stu-id="29371-188">After selecting the Nested Master Page template and clicking Add, the same Select a Master Page dialog box shown in Figure 3 will appear.</span></span>


<span data-ttu-id="29371-189">[![Sprawdź &quot;wybierz strony wzorcowej&quot; pole wyboru, aby dodać zagnieżdżone strony wzorcowej](nested-master-pages-vb/_static/image5.png)](nested-master-pages-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="29371-189">[![Check the &quot;Select master page&quot; Checkbox to Add a Nested Master Page](nested-master-pages-vb/_static/image5.png)](nested-master-pages-vb/_static/image4.png)</span></span>

<span data-ttu-id="29371-190">**Rysunek 02**: zaznacz pole wyboru "Wybierz strony wzorcowej", aby dodać zagnieżdżone strony wzorcowej ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](nested-master-pages-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="29371-190">**Figure 02**: Check the "Select master page" Checkbox to Add a Nested Master Page ([Click to view full-size image](nested-master-pages-vb/_static/image6.png))</span></span>


<span data-ttu-id="29371-191">[![Strona wzorcowa Simple.master powiązać zagnieżdżone strony wzorcowej](nested-master-pages-vb/_static/image8.png)](nested-master-pages-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="29371-191">[![Bind the Nested Master Page to the Simple.master Master Page](nested-master-pages-vb/_static/image8.png)](nested-master-pages-vb/_static/image7.png)</span></span>

<span data-ttu-id="29371-192">**Rysunek 03**: strona wzorcowa zagnieżdżone, aby powiązać `Simple.master` strony wzorcowej ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](nested-master-pages-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="29371-192">**Figure 03**: Bind the Nested Master Page to the `Simple.master` Master Page ([Click to view full-size image](nested-master-pages-vb/_static/image9.png))</span></span>


<span data-ttu-id="29371-193">Osadzonej stronie głównej deklaratywne znaczników, pokazano poniżej, zawiera dwa formanty zawartości odwołujące się do dwóch formantów elementu ContentPlaceHolder najwyższego poziomu strony wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="29371-193">The nested master page's declarative markup, shown below, contains two Content controls referencing the top-level master page's two ContentPlaceHolder controls.</span></span>


[!code-aspx[Main](nested-master-pages-vb/samples/sample3.aspx)]

<span data-ttu-id="29371-194">Z wyjątkiem `<%@ Master %>` dyrektywy, osadzonej stronie głównej początkowej deklaratywne znaczników jest identyczna jak znaczników, generowany podczas wiązania strony zawartości z tej samej strony wzorcowej najwyższego poziomu.</span><span class="sxs-lookup"><span data-stu-id="29371-194">Except for the `<%@ Master %>` directive, the nested master page's initial declarative markup is identical to the markup that is initially generated when binding a content page to the same top-level master page.</span></span> <span data-ttu-id="29371-195">Strony zawartości, takich jak `<%@ Page %>` dyrektywy `<%@ Master %>` tutaj dyrektywa zawiera `MasterPageFile` atrybut określający, strony głównej nadrzędnej osadzonej stronie głównej.</span><span class="sxs-lookup"><span data-stu-id="29371-195">Like a content page's `<%@ Page %>` directive, the `<%@ Master %>` directive here includes a `MasterPageFile` attribute that specifies the nested master page's parent master page.</span></span> <span data-ttu-id="29371-196">Podstawowa różnica między osadzonej stronie głównej i strony zawartości, która jest powiązana z tej samej strony wzorcowej najwyższego poziomu jest, że osadzonej stronie głównej może zawierać elementu ContentPlaceHolder kontrolki.</span><span class="sxs-lookup"><span data-stu-id="29371-196">The main difference between the nested master page and a content page bound to the same top-level master page is that the nested master page can include ContentPlaceHolder controls.</span></span> <span data-ttu-id="29371-197">Formanty ContentPlaceHolder osadzonej stronie głównej zdefiniuj regionach, gdzie strony zawartości można dostosować znaczników.</span><span class="sxs-lookup"><span data-stu-id="29371-197">The nested master page's ContentPlaceHolder controls define the regions where the content pages can customize the markup.</span></span>

<span data-ttu-id="29371-198">Zaktualizowanie tego osadzonej stronie głównej, tak aby zawiera tekst "Hello, z SimpleNested!"</span><span class="sxs-lookup"><span data-stu-id="29371-198">Update this nested master page so that it displays the text "Hello, from SimpleNested!"</span></span> <span data-ttu-id="29371-199">w formancie zawartości, która odpowiada `MainContent` ContentPlaceHolder formantu.</span><span class="sxs-lookup"><span data-stu-id="29371-199">in the Content control that corresponds to the `MainContent` ContentPlaceHolder control.</span></span>


[!code-aspx[Main](nested-master-pages-vb/samples/sample4.aspx)]

<span data-ttu-id="29371-200">Po wprowadzeniu to dodawanie, zapisać osadzonej stronie głównej, a następnie dodaj nową stronę zawartości do `NestedMasterPages` folder o nazwie `Default.aspx`oraz powiązać `SimpleNested.master` strony wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="29371-200">After making this addition, save the nested master page and then add a new content page to the `NestedMasterPages` folder named `Default.aspx`, and bind it to the `SimpleNested.master` master page.</span></span> <span data-ttu-id="29371-201">Podczas dodawania tej strony może być zaskoczeniem zobaczyć, czy zawiera on żadnych formantów zawartości (patrz rysunek 4)!</span><span class="sxs-lookup"><span data-stu-id="29371-201">Upon adding this page you may be surprised to see that it contains no Content controls (see Figure 4)!</span></span> <span data-ttu-id="29371-202">Zawartość strony ma dostęp tylko do jego *nadrzędnej* Elementy ContentPlaceHolders strony wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="29371-202">A content page can only access its *parent* master page's ContentPlaceHolders.</span></span> <span data-ttu-id="29371-203">`SimpleNested.master` nie zawiera żadnych formantów elementu ContentPlaceHolder; w związku z tym wszystkie strony zawartości, powiązane z tej strony wzorcowej nie może zawierać wszystkie formanty zawartości.</span><span class="sxs-lookup"><span data-stu-id="29371-203">`SimpleNested.master` does not contain any ContentPlaceHolder controls; therefore, any content page bound to this master page cannot contain any Content controls.</span></span>


<span data-ttu-id="29371-204">[![Nowa strona zawartości zawiera nie formanty zawartości](nested-master-pages-vb/_static/image11.png)](nested-master-pages-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="29371-204">[![The New Content Page Contains No Content Controls](nested-master-pages-vb/_static/image11.png)](nested-master-pages-vb/_static/image10.png)</span></span>

<span data-ttu-id="29371-205">**Rysunek 04**: nowej zawartości strony zawiera nr formantów zawartości ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](nested-master-pages-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="29371-205">**Figure 04**: The New Content Page Contains No Content Controls ([Click to view full-size image](nested-master-pages-vb/_static/image12.png))</span></span>


<span data-ttu-id="29371-206">Co należy zrobić to Aktualizuj osadzonej stronie głównej (`SimpleNested.master`) do uwzględnienia ContentPlaceHolder formantów.</span><span class="sxs-lookup"><span data-stu-id="29371-206">What we need to do is update the nested master page (`SimpleNested.master`) to include ContentPlaceHolder controls.</span></span> <span data-ttu-id="29371-207">Zazwyczaj należy zagnieżdżone strony wzorcowe uwzględnienie ContentPlaceHolder dla każdego elementu ContentPlaceHolder wynika z jego nadrzędny strony wzorcowej, umożliwiając jego podrzędnych strony wzorcowej lub zawartości strony do pracy z dowolnego elementu ContentPlaceHolder najwyższego poziomu strony wzorcowej formanty.</span><span class="sxs-lookup"><span data-stu-id="29371-207">Typically you'll want your nested master pages to include a ContentPlaceHolder for each ContentPlaceHolder defined by its parent master page, thereby allowing its child master page or content page to work with any of the top-level master page's ContentPlaceHolder controls.</span></span>

<span data-ttu-id="29371-208">Aktualizacja `SimpleNested.master` strony wzorcowej do dołączenia elementu ContentPlaceHolder jego dwóch formantów zawartości.</span><span class="sxs-lookup"><span data-stu-id="29371-208">Update the `SimpleNested.master` master page to include a ContentPlaceHolder in its two Content controls.</span></span> <span data-ttu-id="29371-209">Nadaj kontrolki elementu ContentPlaceHolder taką samą nazwę jak ich formantu zawartości odwołuje się do formantu elementu ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="29371-209">Give the ContentPlaceHolder controls the same name as the ContentPlaceHolder control their Content control refers to.</span></span> <span data-ttu-id="29371-210">Oznacza to, Dodaj formant ContentPlaceHolder o nazwie `MainContent` zawartości formantu w `SimpleNested.master` , która odwołuje się `MainContent` elementu ContentPlaceHolder na `Simple.master`.</span><span class="sxs-lookup"><span data-stu-id="29371-210">That is, add a ContentPlaceHolder control named `MainContent` to the Content control in `SimpleNested.master` that references the `MainContent` ContentPlaceHolder in `Simple.master`.</span></span> <span data-ttu-id="29371-211">Tak samo postąpić w formancie zawartości, który odwołuje się do `head` ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="29371-211">Do the same thing in the Content control that references the `head` ContentPlaceHolder.</span></span>

> [!NOTE]
> <span data-ttu-id="29371-212">Gdy najlepiej nazewnictwa kontrolki elementu ContentPlaceHolder na stronie głównej zagnieżdżonych taka sama jak elementy ContentPlaceHolders na stronie głównej najwyższego poziomu, to nazewnictwa symetrycznego nie jest wymagane.</span><span class="sxs-lookup"><span data-stu-id="29371-212">While I recommend naming the ContentPlaceHolder controls in the nested master page the same as the ContentPlaceHolders in the top-level master page, this naming symmetry is not required.</span></span> <span data-ttu-id="29371-213">Możesz zapewnić kontrolki elementu ContentPlaceHolder na stronie głównej zagnieżdżonych dowolną nazwę, którą chcesz.</span><span class="sxs-lookup"><span data-stu-id="29371-213">You can give the ContentPlaceHolder controls in your nested master page any name you like.</span></span> <span data-ttu-id="29371-214">Jednak I łatwiejsze do zapamiętania Elementy ContentPlaceHolders odpowiada z jakich regionach strony, jeśli mojego najwyższego poziomu strony wzorcowej i zagnieżdżone strony wzorcowe używają tych samych nazw.</span><span class="sxs-lookup"><span data-stu-id="29371-214">However, I find it easier to remember what ContentPlaceHolders correspond with what regions of the page if my top-level master page and nested master pages use the same names.</span></span>


<span data-ttu-id="29371-215">Po wprowadzeniu tych dodatków programu `SimpleNested.master` deklaratywne znaczników strony wzorcowej powinien wyglądać podobnie do następującego:</span><span class="sxs-lookup"><span data-stu-id="29371-215">After making these additions your `SimpleNested.master` master page's declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](nested-master-pages-vb/samples/sample5.aspx)]

<span data-ttu-id="29371-216">Usuń `Default.aspx` strona właśnie utworzyliśmy zawartości i następnie dodaj go ponownie, powiązanie go do `SimpleNested.master` strony wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="29371-216">Delete the `Default.aspx` content page we just created and then re-add it, binding it to the `SimpleNested.master` master page.</span></span> <span data-ttu-id="29371-217">Teraz program Visual Studio dodaje dwa formanty zawartości `Default.aspx`, odwołuje się do Elementy ContentPlaceHolders teraz zdefiniowany w `SimpleNested.master` (patrz rysunek 6).</span><span class="sxs-lookup"><span data-stu-id="29371-217">This time Visual Studio adds two Content controls to the `Default.aspx`, referencing the ContentPlaceHolders now defined in `SimpleNested.master` (see Figure 6).</span></span> <span data-ttu-id="29371-218">Dodaj tekst "Hello, z Default.aspx!"</span><span class="sxs-lookup"><span data-stu-id="29371-218">Add the text, "Hello, from Default.aspx!"</span></span> <span data-ttu-id="29371-219">w zawartości sterować tym, do którego odwołanie `MainContent`.</span><span class="sxs-lookup"><span data-stu-id="29371-219">in the Content control that referenced `MainContent`.</span></span>

<span data-ttu-id="29371-220">Rysunek 5. pokazuje trzy jednostki zaangażowane w tym miejscu - `Simple.master`, `SimpleNested.master`, i `Default.aspx` — i w jaki sposób są powiązane ze sobą.</span><span class="sxs-lookup"><span data-stu-id="29371-220">Figure 5 shows the three entities involved here - `Simple.master`, `SimpleNested.master`, and `Default.aspx` - and how they relate to one another.</span></span> <span data-ttu-id="29371-221">Jak pokazano na diagramie, osadzonej stronie głównej implementuje formantów zawartości dla elementu ContentPlaceHolder jego elementu nadrzędnego.</span><span class="sxs-lookup"><span data-stu-id="29371-221">As the diagram shows, the nested master page implements Content controls for its parent's ContentPlaceHolder.</span></span> <span data-ttu-id="29371-222">Jeśli tych regionów muszą być dostępne na stronie zawartości, osadzonej stronie głównej należy dodać własne elementy ContentPlaceHolders z formantami zawartości.</span><span class="sxs-lookup"><span data-stu-id="29371-222">If these regions need to be accessible to the content page, the nested master page must add its own ContentPlaceHolders to the Content controls.</span></span>


<span data-ttu-id="29371-223">[![Strony wzorcowe najwyższego poziomu i zagnieżdżonych dyktowania układ zawartości strony](nested-master-pages-vb/_static/image14.png)](nested-master-pages-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="29371-223">[![The Top-Level and Nested Master Pages Dictate the Content Page's Layout](nested-master-pages-vb/_static/image14.png)](nested-master-pages-vb/_static/image13.png)</span></span>

<span data-ttu-id="29371-224">**Rysunek 05**: układ strony zawartości jest wymagane przez najwyższego poziomu i zagnieżdżone strony wzorcowe ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](nested-master-pages-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="29371-224">**Figure 05**: The Top-Level and Nested Master Pages Dictate the Content Page's Layout ([Click to view full-size image](nested-master-pages-vb/_static/image15.png))</span></span>


<span data-ttu-id="29371-225">To zachowanie przedstawiono, jak strony zawartości lub strony wzorcowej jest tylko świadome jego nadrzędny strony wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="29371-225">This behavior illustrates how a content page or master page is only cognizant of its parent master page.</span></span> <span data-ttu-id="29371-226">To zachowanie jest także określane przez projektanta programu Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="29371-226">This behavior is also indicated by the Visual Studio Designer.</span></span> <span data-ttu-id="29371-227">Rysunek 6 przedstawia Projektant `Default.aspx`.</span><span class="sxs-lookup"><span data-stu-id="29371-227">Figure 6 shows the Designer for `Default.aspx`.</span></span> <span data-ttu-id="29371-228">Gdy Projektant jasno wskazuje, które regiony są edytowalne ze strony zawartość i nie są fragmenty, nie usunąć niejednoznaczność, nie można edytować regiony są z osadzonej stronie głównej i regiony są na stronie głównej najwyższego poziomu.</span><span class="sxs-lookup"><span data-stu-id="29371-228">While the Designer clearly shows what regions are editable from the content page and what portions aren't, it doesn't disambiguate what non-editable regions are from the nested master page and what regions are from the top-level master page.</span></span>


<span data-ttu-id="29371-229">[![Obecnie strony zawartości zawiera formanty zawartości dla strony wzorcowej zagnieżdżone elementy ContentPlaceHolders](nested-master-pages-vb/_static/image17.png)](nested-master-pages-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="29371-229">[![The Content Page Now Includes Content Controls for the Nested Master Page's ContentPlaceHolders](nested-master-pages-vb/_static/image17.png)](nested-master-pages-vb/_static/image16.png)</span></span>

<span data-ttu-id="29371-230">**Rysunek 06**: zawartości strony teraz zawiera formanty zawartości dla Elementy ContentPlaceHolders zagnieżdżone wzorca strony ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](nested-master-pages-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="29371-230">**Figure 06**: The Content Page Now Includes Content Controls for the Nested Master Page's ContentPlaceHolders ([Click to view full-size image](nested-master-pages-vb/_static/image18.png))</span></span>


## <a name="step-3-adding-a-second-simple-nested-master-page"></a><span data-ttu-id="29371-231">Krok 3: Dodawanie drugiego proste zagnieżdżone strony wzorcowej</span><span class="sxs-lookup"><span data-stu-id="29371-231">Step 3: Adding a Second Simple Nested Master Page</span></span>

<span data-ttu-id="29371-232">Zaletą zagnieżdżone strony wzorcowe jest bardziej widoczny, gdy istnieje wiele zagnieżdżone strony wzorcowe.</span><span class="sxs-lookup"><span data-stu-id="29371-232">The benefit of nested master pages is more evident when there are multiple nested master pages.</span></span> <span data-ttu-id="29371-233">Aby zilustrować ten korzyści, należy utworzyć inny osadzonej stronie głównej w `NestedMasterPages` folderu; nazwa nowy zagnieżdżone strony wzorcowej `SimpleNestedAlternate.master` , który należy powiązać `Simple.master` strony wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="29371-233">To illustrate this benefit, create another nested master page in the `NestedMasterPages` folder; name this new nested master page `SimpleNestedAlternate.master` and bind it to the `Simple.master` master page.</span></span> <span data-ttu-id="29371-234">Dodaj formanty ContentPlaceHolder w dwóch formantów zawartości osadzonej stronie głównej jak robiliśmy w kroku 2.</span><span class="sxs-lookup"><span data-stu-id="29371-234">Add ContentPlaceHolder controls in the nested master page's two Content controls like we did in Step 2.</span></span> <span data-ttu-id="29371-235">Ponadto Dodaj tekst "Hello, z SimpleNestedAlternate!"</span><span class="sxs-lookup"><span data-stu-id="29371-235">Also add the text, "Hello, from SimpleNestedAlternate!"</span></span> <span data-ttu-id="29371-236">w zawartości formantu, który odpowiada najwyższego poziomu strony wzorcowej `MainContent` ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="29371-236">in the Content control that corresponds to the top-level master page's `MainContent` ContentPlaceHolder.</span></span> <span data-ttu-id="29371-237">Po wprowadzeniu tych zmian nowej zagnieżdżone strony wzorcowej dla znaczników deklaratywne powinien wyglądać podobny do następującego:</span><span class="sxs-lookup"><span data-stu-id="29371-237">After making these changes your new nested master page's declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](nested-master-pages-vb/samples/sample6.aspx)]

<span data-ttu-id="29371-238">Utwórz stronę zawartości o nazwie `Alternate.aspx` w `NestedMasterPages` folderu, który należy powiązać `SimpleNestedAlternate.master` osadzonej stronie głównej.</span><span class="sxs-lookup"><span data-stu-id="29371-238">Create a content page named `Alternate.aspx` in the `NestedMasterPages` folder and bind it to the `SimpleNestedAlternate.master` nested master page.</span></span> <span data-ttu-id="29371-239">Dodaj tekst "Hello, z alternatywnym!"</span><span class="sxs-lookup"><span data-stu-id="29371-239">Add the text, "Hello, from Alternate!"</span></span> <span data-ttu-id="29371-240">w formancie zawartości, która odpowiada `MainContent`.</span><span class="sxs-lookup"><span data-stu-id="29371-240">in the Content control that corresponds to `MainContent`.</span></span> <span data-ttu-id="29371-241">Rysunek nr 7 przedstawia `Alternate.aspx` oglądany przez projektanta programu Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="29371-241">Figure 7 shows `Alternate.aspx` when viewed through the Visual Studio Designer.</span></span>


<span data-ttu-id="29371-242">[![Alternate.aspx jest powiązany z strony wzorcowej SimpleNestedAlternate.master](nested-master-pages-vb/_static/image20.png)](nested-master-pages-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="29371-242">[![Alternate.aspx is Bound to the SimpleNestedAlternate.master Master Page](nested-master-pages-vb/_static/image20.png)](nested-master-pages-vb/_static/image19.png)</span></span>

<span data-ttu-id="29371-243">**Rysunek 07**: `Alternate.aspx` jest powiązany z `SimpleNestedAlternate.master` strony wzorcowej ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](nested-master-pages-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="29371-243">**Figure 07**: `Alternate.aspx` is Bound to the `SimpleNestedAlternate.master` Master Page ([Click to view full-size image](nested-master-pages-vb/_static/image21.png))</span></span>


<span data-ttu-id="29371-244">Porównaj projektanta na rysunku 7 do projektanta na rysunku 6.</span><span class="sxs-lookup"><span data-stu-id="29371-244">Compare the Designer in Figure 7 to the Designer in Figure 6.</span></span> <span data-ttu-id="29371-245">Obie strony z zawartością udziału ten sam układ zdefiniowane na stronie głównej najwyższego poziomu (`Simple.master`), czyli tytuł "Zagnieżdżone wzorca stron samouczek (proste)".</span><span class="sxs-lookup"><span data-stu-id="29371-245">Both content pages share the same layout defined in the top-level master page (`Simple.master`), namely the "Nested Master Pages Tutorial (Simple)" title.</span></span> <span data-ttu-id="29371-246">Jeszcze mają różne zawartości zdefiniowanej w ich nadrzędnej strony wzorcowe - tekst "Hello, z SimpleNested!"</span><span class="sxs-lookup"><span data-stu-id="29371-246">Yet both have distinct content defined in their parent master pages - the text "Hello, from SimpleNested!"</span></span> <span data-ttu-id="29371-247">Rysunek 6 i "Hello, z SimpleNestedAlternate!"</span><span class="sxs-lookup"><span data-stu-id="29371-247">in Figure 6 and "Hello, from SimpleNestedAlternate!"</span></span> <span data-ttu-id="29371-248">na rysunku 7.</span><span class="sxs-lookup"><span data-stu-id="29371-248">in Figure 7.</span></span> <span data-ttu-id="29371-249">Udzieleniu tych różnic w tym miejscu są trivial, ale można rozszerzyć w tym przykładzie, aby uwzględnić bardziej znaczące różnice.</span><span class="sxs-lookup"><span data-stu-id="29371-249">Granted, these differences here are trivial, but you could extend this example to include more meaningful differences.</span></span> <span data-ttu-id="29371-250">Na przykład `SimpleNested.master` strony może obejmować menu z opcjami określone na stronach zawartości, podczas gdy `SimpleNestedAlternate.master` może być informacje dotyczące strony zawartości, które wiążą się do niego.</span><span class="sxs-lookup"><span data-stu-id="29371-250">For instance, the `SimpleNested.master` page might include a menu with options specific to its content pages, whereas `SimpleNestedAlternate.master` might have information pertinent to the content pages that bind to it.</span></span>

<span data-ttu-id="29371-251">Teraz załóżmy, że niezbędna do zmiany nadrzędna układu witryny.</span><span class="sxs-lookup"><span data-stu-id="29371-251">Now, imagine that we needed to make a change to the overarching site layout.</span></span> <span data-ttu-id="29371-252">Załóżmy, że trzeba dodać listę typowych łączy do wszystkich stron zawartości.</span><span class="sxs-lookup"><span data-stu-id="29371-252">For example, imagine that we wanted to add a list of common links to all content pages.</span></span> <span data-ttu-id="29371-253">W tym modyfikacjom najwyższego poziomu strony wzorcowej `Simple.master`.</span><span class="sxs-lookup"><span data-stu-id="29371-253">To accomplish this we update the top-level master page, `Simple.master`.</span></span> <span data-ttu-id="29371-254">Zmiany są natychmiast odzwierciedlane w jego zagnieżdżone strony wzorcowe i przez rozszerzenie, ich strony z zawartością.</span><span class="sxs-lookup"><span data-stu-id="29371-254">Any changes there are immediately reflected in its nested master pages and, by extension, their content pages.</span></span>

<span data-ttu-id="29371-255">Aby zademonstrować łatwość, z którym możemy zmienić układ lokacja nadrzędna, otwórz `Simple.master` strony wzorcowej i Dodaj następujący kod między `topContent` i `mainContent` `<div>` elementy:</span><span class="sxs-lookup"><span data-stu-id="29371-255">To demonstrate the ease with which we can change the overarching site layout, open the `Simple.master` master page and add the following markup between the `topContent` and `mainContent` `<div>` elements:</span></span>


[!code-aspx[Main](nested-master-pages-vb/samples/sample7.aspx)]

<span data-ttu-id="29371-256">To dodaje dwa łącza na początku każdej strony, która jest powiązana z `Simple.master`, `SimpleNested.master`, lub `SimpleNestedAlternate.master`; te zmiany dotyczą wszystkich zagnieżdżonych stron wzorcowych i stron zawartości natychmiast.</span><span class="sxs-lookup"><span data-stu-id="29371-256">This adds two links to the top of every page that binds to `Simple.master`, `SimpleNested.master`, or `SimpleNestedAlternate.master`; these changes apply to all nested master pages and their content pages immediately.</span></span> <span data-ttu-id="29371-257">Rysunek nr 8 przedstawia `Alternate.aspx` podczas wyświetlania za pośrednictwem przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="29371-257">Figure 8 shows `Alternate.aspx` when viewed through a browser.</span></span> <span data-ttu-id="29371-258">Należy pamiętać, dodawania łączy w górnej części strony (w porównaniu z rysunku 7).</span><span class="sxs-lookup"><span data-stu-id="29371-258">Note the addition of the links at the top of the page (compared to Figure 7).</span></span>


<span data-ttu-id="29371-259">[![Zmieniony na najwyższym poziomie strony wzorcowej są natychmiast odzwierciedlone w jego zagnieżdżone strony wzorcowe i ich zawartości strony](nested-master-pages-vb/_static/image23.png)](nested-master-pages-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="29371-259">[![Changed to the Top-Level Master Page are Immediately Reflected in its Nested Master Pages and Their Content Pages](nested-master-pages-vb/_static/image23.png)](nested-master-pages-vb/_static/image22.png)</span></span>

<span data-ttu-id="29371-260">**Rysunek 08**: zmieniony na najwyższym poziomie strony wzorcowej są natychmiast odzwierciedlone w jego zagnieżdżone strony wzorcowe i ich strony z zawartością ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](nested-master-pages-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="29371-260">**Figure 08**: Changed to the Top-Level Master Page are Immediately Reflected in its Nested Master Pages and Their Content Pages ([Click to view full-size image](nested-master-pages-vb/_static/image24.png))</span></span>


## <a name="using-a-nested-master-page-for-the-administration-section"></a><span data-ttu-id="29371-261">Za pomocą zagnieżdżone strony wzorcowej dla sekcji Administracja</span><span class="sxs-lookup"><span data-stu-id="29371-261">Using a Nested Master Page for the Administration Section</span></span>

<span data-ttu-id="29371-262">Na tym etapie nasz sprawdzono zalet master zagnieżdżone strony i ma przedstawiono sposób tworzenia i używania ich w aplikacji ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="29371-262">At this point we have looked at the advantages of nested master pages and have seen how to create and use them in an ASP.NET application.</span></span> <span data-ttu-id="29371-263">Przykłady w krokach 1, 2 i 3, jednak obejmuje tworzenie nowej strony wzorcowej najwyższego poziomu, nowe zagnieżdżone strony wzorcowe i nowych stron zawartości.</span><span class="sxs-lookup"><span data-stu-id="29371-263">The examples in Steps 1, 2, and 3, however, involved creating a new top-level master page, new nested master pages, and new content pages.</span></span> <span data-ttu-id="29371-264">Jak dodawanie nowego osadzonej stronie głównej witryny sieci Web z istniejącej najwyższego poziomu strony wzorcowej oraz strony z zawartością?</span><span class="sxs-lookup"><span data-stu-id="29371-264">What about adding a new nested master page to a website with an existing top-level master page and content pages?</span></span>

<span data-ttu-id="29371-265">Integrowanie osadzonej stronie głównej istniejącej witryny sieci Web i kojarzenie go z istniejących stron zawartości wymaga nieco więcej wysiłku niż od podstaw.</span><span class="sxs-lookup"><span data-stu-id="29371-265">Integrating a nested master page into an existing website and associating it with existing content pages requires a bit more effort than starting from scratch.</span></span> <span data-ttu-id="29371-266">Kroki 4, 5, 6 i 7 Eksploruj te problemy, jak firma Microsoft rozszerzyć naszej aplikacji demonstracyjnej, aby uwzględnić nowe osadzonej stronie głównej o nazwie `AdminNested.master` który zawiera instrukcje dla administratora i jest używany przez strony ASP.NET `~/Admin` folderu.</span><span class="sxs-lookup"><span data-stu-id="29371-266">Steps 4, 5, 6, and 7 explore these challenges as we augment our demo application to include a new nested master page named `AdminNested.master` that contains instructions for the administrator and is used by the ASP.NET pages in the `~/Admin` folder.</span></span>

<span data-ttu-id="29371-267">Integrowanie osadzonej stronie głównej aplikacji demonstracyjnej wprowadza następujące przeszkód:</span><span class="sxs-lookup"><span data-stu-id="29371-267">Integrating a nested master page into our demo application introduces the following hurdles:</span></span>

- <span data-ttu-id="29371-268">Istniejąca zawartość strony w `~/Admin` folder ma niektórych oczekiwań ze strony wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="29371-268">The existing content pages in the `~/Admin` folder have certain expectations from their master page.</span></span> <span data-ttu-id="29371-269">Po pierwsze oczekiwane niektórych formantów elementu ContentPlaceHolder obecności.</span><span class="sxs-lookup"><span data-stu-id="29371-269">For starters, they expect certain ContentPlaceHolder controls to be present.</span></span> <span data-ttu-id="29371-270">Ponadto `~/Admin/AddProduct.aspx` i `~/Admin/Products.aspx` strony wywoływać publicznego strony wzorcowej `RefreshRecentProductsGrid` metody, ustaw jej `GridMessageText` właściwości, lub program obsługi zdarzeń dla jego `PricesDoubled` zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="29371-270">Furthermore, the `~/Admin/AddProduct.aspx` and `~/Admin/Products.aspx` pages call the master page's public `RefreshRecentProductsGrid` method, set its `GridMessageText` property, or have an event handler for its `PricesDoubled` event.</span></span> <span data-ttu-id="29371-271">W rezultacie naszych osadzonej stronie głównej podać tego samego Elementy ContentPlaceHolders i publiczne elementy członkowskie.</span><span class="sxs-lookup"><span data-stu-id="29371-271">Consequently, our nested master page must provide the same ContentPlaceHolders and public members.</span></span>
- <span data-ttu-id="29371-272">W poprzednim samouczek firma Microsoft enhanced `BasePage` klasę, aby ustawić dynamicznie `Page` obiektu `MasterPageFile` na podstawie właściwości w zmiennej sesji.</span><span class="sxs-lookup"><span data-stu-id="29371-272">In the preceding tutorial we enhanced the `BasePage` class to dynamically set the `Page` object's `MasterPageFile` property based on a Session variable.</span></span> <span data-ttu-id="29371-273">Jak do obsługujemy dynamiczne strony głównej przy użyciu zagnieżdżone strony wzorcowe?</span><span class="sxs-lookup"><span data-stu-id="29371-273">How to we support dynamic master pages when using nested master pages?</span></span>

<span data-ttu-id="29371-274">Te dwa problemy będą powierzchni jak możemy utworzyć osadzonej stronie głównej i używać go z istniejących stron zawartości.</span><span class="sxs-lookup"><span data-stu-id="29371-274">These two challenges will surface as we build the nested master page and use it from our existing content pages.</span></span> <span data-ttu-id="29371-275">Firma Microsoft będzie badanie i rozwiązanie tych problemów, zanim jeszcze wystąpią.</span><span class="sxs-lookup"><span data-stu-id="29371-275">We'll investigate and surmount these issues as they arise.</span></span>

## <a name="step-4-creating-the-nested-master-page"></a><span data-ttu-id="29371-276">Krok 4: Tworzenie zagnieżdżone strony wzorcowej</span><span class="sxs-lookup"><span data-stu-id="29371-276">Step 4: Creating the Nested Master Page</span></span>

<span data-ttu-id="29371-277">Naszym pierwszym zadaniem jest można utworzyć osadzonej stronie głównej używanego przez stron w sekcji administracji.</span><span class="sxs-lookup"><span data-stu-id="29371-277">Our first task is to create the nested master page to be used by the pages in the Administration section.</span></span> <span data-ttu-id="29371-278">Jako widzieliśmy w kroku 2, podczas dodawania nowego zagnieżdżone strony wzorcowej należy określić strony wzorcowej nadrzędnego osadzonej stronie głównej.</span><span class="sxs-lookup"><span data-stu-id="29371-278">As we saw in Step 2, when adding a new nested master page we need to specify the nested master page's parent master page.</span></span> <span data-ttu-id="29371-279">Ale mamy dwie strony wzorcowej najwyższego poziomu: `Site.master` i `Alternate.master`.</span><span class="sxs-lookup"><span data-stu-id="29371-279">But we have two top-level master pages: `Site.master` and `Alternate.master`.</span></span> <span data-ttu-id="29371-280">Odwołania, który utworzyliśmy `Alternate.master` w poprzednim samouczek i zapisane w kodzie `BasePage` klasy zestawu `Page` obiektu `MasterPageFile` właściwości w czasie wykonywania jednej `Site.master` lub `Alternate.master` w zależności od wartości `MyMasterPage` Zmienna sesji.</span><span class="sxs-lookup"><span data-stu-id="29371-280">Recall that we created `Alternate.master` in the preceding tutorial and wrote code in the `BasePage` class that set the `Page` object's `MasterPageFile` property at runtime to either `Site.master` or `Alternate.master` depending on the value of the `MyMasterPage` Session variable.</span></span>

<span data-ttu-id="29371-281">W jaki sposób możemy skonfigurować naszych osadzonej stronie głównej, tak aby były używane odpowiednie najwyższego poziomu strony wzorcowej?</span><span class="sxs-lookup"><span data-stu-id="29371-281">How do we configure our nested master page so that it uses the appropriate top-level master page?</span></span> <span data-ttu-id="29371-282">Firma Microsoft są dostępne dwie opcje:</span><span class="sxs-lookup"><span data-stu-id="29371-282">We have two options:</span></span>

- <span data-ttu-id="29371-283">Utwórz dwa zagnieżdżone strony wzorcowe, `AdminNestedSite.master` i `AdminNestedAlternate.master`oraz powiązać najwyższego poziomu strony wzorcowe `Site.master` i `Alternate.master`odpowiednio.</span><span class="sxs-lookup"><span data-stu-id="29371-283">Create two nested master pages, `AdminNestedSite.master` and `AdminNestedAlternate.master`, and bind them to the top-level master pages `Site.master` and `Alternate.master`, respectively.</span></span> <span data-ttu-id="29371-284">W `BasePage`, następnie ustawimy usługę· `Page` obiektu `MasterPageFile` odpowiednie zagnieżdżone strony wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="29371-284">In `BasePage`, then, we'd set the `Page` object's `MasterPageFile` to the appropriate nested master page.</span></span>
- <span data-ttu-id="29371-285">Utwórz pojedynczy osadzonej stronie głównej i mieć strony zawartości, użyj tej konkretnej strony wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="29371-285">Create a single nested master page and have the content pages use this particular master page.</span></span> <span data-ttu-id="29371-286">Następnie, w czasie wykonywania, czy musimy ustawić osadzonej stronie głównej `MasterPageFile` właściwości do odpowiedniej strony wzorcowej najwyższego poziomu w czasie wykonywania.</span><span class="sxs-lookup"><span data-stu-id="29371-286">Then, at runtime, we'd need to set the nested master page's `MasterPageFile` property to the appropriate top-level master page at runtime.</span></span> <span data-ttu-id="29371-287">(Użytkownik może znalezienia przez teraz, stron wzorcowych również mają `MasterPageFile` właściwości.)</span><span class="sxs-lookup"><span data-stu-id="29371-287">(As you might have figured out by now, master pages also have a `MasterPageFile` property.)</span></span>

<span data-ttu-id="29371-288">Użyjmy drugiej opcji.</span><span class="sxs-lookup"><span data-stu-id="29371-288">Let's use the second option.</span></span> <span data-ttu-id="29371-289">Utwórz pojedynczy zagnieżdżonych pliku strony głównej w `~/Admin` folder o nazwie `AdminNested.master`.</span><span class="sxs-lookup"><span data-stu-id="29371-289">Create a single nested master page file in the `~/Admin` folder named `AdminNested.master`.</span></span> <span data-ttu-id="29371-290">Ponieważ oba `Site.master` i `Alternate.master` mają ten sam zestaw kontrolek elementu ContentPlaceHolder, nie ma znaczenia, jakie strony wzorcowej możesz powiązać ją, chociaż I zachęca do powiązać `Site.master` dla sake dla spójności.</span><span class="sxs-lookup"><span data-stu-id="29371-290">Because both `Site.master` and `Alternate.master` have the same set of ContentPlaceHolder controls, it doesn't matter what master page you bind it to, although I encourage you to bind it to `Site.master` for consistency's sake.</span></span>


<span data-ttu-id="29371-291">[![Dodaj stronę wzorcową zagnieżdżonych do folderu ~/Admin.](nested-master-pages-vb/_static/image26.png)](nested-master-pages-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="29371-291">[![Add a Nested Master Page to the ~/Admin Folder.](nested-master-pages-vb/_static/image26.png)](nested-master-pages-vb/_static/image25.png)</span></span>

<span data-ttu-id="29371-292">**Rysunek 09**: Dodaj stronę wzorcową zagnieżdżonych do `~/Admin` folderu.</span><span class="sxs-lookup"><span data-stu-id="29371-292">**Figure 09**: Add a Nested Master Page to the `~/Admin` Folder.</span></span> <span data-ttu-id="29371-293">([Kliknij, aby wyświetlić obraz w pełnym rozmiarze](nested-master-pages-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="29371-293">([Click to view full-size image](nested-master-pages-vb/_static/image27.png))</span></span>


<span data-ttu-id="29371-294">Ponieważ osadzonej stronie głównej jest powiązany z strony wzorcowej z cztery kontrolki elementu ContentPlaceHolder, Visual Studio dodaje cztery formanty do nowego pliku osadzonej stronie głównej znacznika początkowego zawartości.</span><span class="sxs-lookup"><span data-stu-id="29371-294">Because the nested master page is bound to a master page with four ContentPlaceHolder controls, Visual Studio adds four Content controls to the new nested master page file's initial markup.</span></span> <span data-ttu-id="29371-295">Jak robiliśmy kroki 2 i 3, Dodaj formant ContentPlaceHolder w każdej zawartości kontrolki nadanie mu taką samą nazwę jak kontrolki elementu ContentPlaceHolder najwyższego poziomu strony wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="29371-295">Like we did in Steps 2 and 3, add a ContentPlaceHolder control in each Content control, giving it the same name as the top-level master page's ContentPlaceHolder control.</span></span> <span data-ttu-id="29371-296">Również Dodaj następujący kod do zawartości formantu, który odpowiada `MainContent` ContentPlaceHolder:</span><span class="sxs-lookup"><span data-stu-id="29371-296">Also add the following markup to the Content control that corresponds to the `MainContent` ContentPlaceHolder:</span></span>


[!code-html[Main](nested-master-pages-vb/samples/sample8.html)]

<span data-ttu-id="29371-297">Następnie określ `instructions` klasy CSS w `Styles.css` i `AlternateStyles.css` pliki CSS.</span><span class="sxs-lookup"><span data-stu-id="29371-297">Next, define the `instructions` CSS class in the `Styles.css` and `AlternateStyles.css` CSS files.</span></span> <span data-ttu-id="29371-298">Następujące reguły CSS spowodować elementów HTML stylem `instructions` klasy, które mają być wyświetlane z jasny żółty kolor tła i obramowania czarny, stałe:</span><span class="sxs-lookup"><span data-stu-id="29371-298">The following CSS rules cause HTML elements styled with the `instructions` class to be displayed with a light yellow background color and a black, solid border:</span></span>


[!code-css[Main](nested-master-pages-vb/samples/sample9.css)]

<span data-ttu-id="29371-299">Ponieważ tego znacznika został dodany do osadzonej stronie głównej, zostanie wyświetlony tylko na tych stron, które używają osadzonej stronie głównej (to znaczy, strony w sekcji Administracja).</span><span class="sxs-lookup"><span data-stu-id="29371-299">Because this markup has been added to the nested master page, it will only appear in those pages that use this nested master page (namely, the pages in the Administration section).</span></span>

<span data-ttu-id="29371-300">Po wprowadzeniu tych dodatków do strony głównej zagnieżdżonych, jego deklaratywne znaczników powinien wyglądać podobny do następującego:</span><span class="sxs-lookup"><span data-stu-id="29371-300">After making these additions to your nested master page, its declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](nested-master-pages-vb/samples/sample10.aspx)]

<span data-ttu-id="29371-301">Należy zauważyć, że każdy formant zawartości ma formantu elementu ContentPlaceHolder oraz że formantów elementu ContentPlaceHolder `ID` właściwości są przypisane takie same wartości jak odpowiednie kontrolki elementu ContentPlaceHolder na stronie głównej najwyższego poziomu.</span><span class="sxs-lookup"><span data-stu-id="29371-301">Note that each Content control has a ContentPlaceHolder control and that the ContentPlaceHolder controls' `ID` properties are assigned the same values as the corresponding ContentPlaceHolder controls in the top-level master page.</span></span> <span data-ttu-id="29371-302">Ponadto znaczników specyficzne dla sekcji Administracja zostanie wyświetlona w `MainContent` ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="29371-302">Moreover, the Administration section-specific markup appears in the `MainContent` ContentPlaceHolder.</span></span>

<span data-ttu-id="29371-303">Rysunek nr 10 przedstawia `AdminNested.master` osadzonej stronie głównej oglądany przez projektanta programu Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="29371-303">Figure 10 shows the `AdminNested.master` nested master page when viewed through Visual Studio's Designer.</span></span> <span data-ttu-id="29371-304">Można zapoznaj się z instrukcjami w polu żółty w górnej części `MainContent` zawartości formantu.</span><span class="sxs-lookup"><span data-stu-id="29371-304">You can see the instructions in the yellow box at the top of the `MainContent` Content control.</span></span>


<span data-ttu-id="29371-305">[![Zagnieżdżone strony wzorcowej rozszerza strony wzorcowej najwyższego poziomu, aby dołączyć instrukcje dla administratora.](nested-master-pages-vb/_static/image29.png)](nested-master-pages-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="29371-305">[![The Nested Master Page Extends the Top-Level Master Page to Include Instructions for the Administrator.](nested-master-pages-vb/_static/image29.png)](nested-master-pages-vb/_static/image28.png)</span></span>

<span data-ttu-id="29371-306">**Na rysunku nr 10**: zagnieżdżone strony wzorcowej rozszerza strony wzorcowej najwyższego poziomu, aby dołączyć instrukcje dla administratora.</span><span class="sxs-lookup"><span data-stu-id="29371-306">**Figure 10**: The Nested Master Page Extends the Top-Level Master Page to Include Instructions for the Administrator.</span></span> <span data-ttu-id="29371-307">([Kliknij, aby wyświetlić obraz w pełnym rozmiarze](nested-master-pages-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="29371-307">([Click to view full-size image](nested-master-pages-vb/_static/image30.png))</span></span>


## <a name="step-5-updating-the-existing-content-pages-to-use-the-new-nested-master-page"></a><span data-ttu-id="29371-308">Krok 5: Aktualizowanie istniejących stron zawartości do użycia nowego zagnieżdżone strony wzorcowej</span><span class="sxs-lookup"><span data-stu-id="29371-308">Step 5: Updating the Existing Content Pages to Use the New Nested Master Page</span></span>

<span data-ttu-id="29371-309">W dowolnym momencie dodania nowej strony zawartości do sekcji Administracja należy powiązać `AdminNested.master` właśnie utworzyliśmy strony wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="29371-309">Anytime we add a new content page to the Administration section we need to bind it to the `AdminNested.master` master page we just created.</span></span> <span data-ttu-id="29371-310">Ale co istniejącej zawartości strony?</span><span class="sxs-lookup"><span data-stu-id="29371-310">But what about the existing content pages?</span></span> <span data-ttu-id="29371-311">Obecnie wszystkie zawartości strony w witrynie pochodzi od `BasePage` klasy, która programowo ustawia strony wzorcowej zawartości strony w czasie wykonywania.</span><span class="sxs-lookup"><span data-stu-id="29371-311">Currently, all content pages in the site derive from the `BasePage` class, which programmatically sets the content page's master page at runtime.</span></span> <span data-ttu-id="29371-312">To nie jest zachowanie interesujące dla stron zawartości w sekcji administracji.</span><span class="sxs-lookup"><span data-stu-id="29371-312">This is not the behavior we want for the content pages in the Administration section.</span></span> <span data-ttu-id="29371-313">Zamiast tego chcemy te strony zawartości, aby zawsze była używana `AdminNested.master` strony.</span><span class="sxs-lookup"><span data-stu-id="29371-313">Instead, we want these content pages to always use the `AdminNested.master` page.</span></span> <span data-ttu-id="29371-314">Będzie ona odpowiedzialność osadzonej stronie głównej wybierz prawo najwyższego poziomu strony zawartości w czasie wykonywania.</span><span class="sxs-lookup"><span data-stu-id="29371-314">It will be the responsibility of the nested master page to choose the right top-level content page at runtime.</span></span>

<span data-ttu-id="29371-315">Aby najlepszy sposób, aby osiągnąć to konieczne, zachowanie jest utworzenie nowej klasy niestandardowej strony podstawowej o nazwie `AdminBasePage` który rozszerza `BasePage` klasy.</span><span class="sxs-lookup"><span data-stu-id="29371-315">To best way to achieve this desired behavior is to create a new custom base page class named `AdminBasePage` that extends the `BasePage` class.</span></span> <span data-ttu-id="29371-316">`AdminBasePage` następnie można zastąpić `SetMasterPageFile` i ustaw `Page` obiektu `MasterPageFile` wartość ustalony "~ / Admin/AdminNested.master".</span><span class="sxs-lookup"><span data-stu-id="29371-316">`AdminBasePage` can then override the `SetMasterPageFile` and set the `Page` object's `MasterPageFile` to the hard-coded value "~/Admin/AdminNested.master".</span></span> <span data-ttu-id="29371-317">W ten sposób dowolną stronę która pochodzi z `AdminBasePage` użyje `AdminNested.master`, podczas gdy dowolną stronę, która pochodzi z `BasePage` będzie jego `MasterPageFile` właściwość ustawić dynamicznie "~ / Site.master" lub "~ / Alternate.master" na podstawie wartości z `MyMasterPage` Zmiennej sesji.</span><span class="sxs-lookup"><span data-stu-id="29371-317">In this way, any page that derives from `AdminBasePage` will use `AdminNested.master`, whereas any page that derives from `BasePage` will have its `MasterPageFile` property set dynamically to either "~/Site.master" or "~/Alternate.master" based on the value of the `MyMasterPage` Session variable.</span></span>

<span data-ttu-id="29371-318">Rozpocznij od dodania nowego pliku klasy `App_Code` folder o nazwie `AdminBasePage.vb`.</span><span class="sxs-lookup"><span data-stu-id="29371-318">Start by adding a new class file to the `App_Code` folder named `AdminBasePage.vb`.</span></span> <span data-ttu-id="29371-319">Ma `AdminBasePage` rozszerzyć `BasePage` , a następnie zastąpić `SetMasterPageFile` metody.</span><span class="sxs-lookup"><span data-stu-id="29371-319">Have `AdminBasePage` extend `BasePage` and then override the `SetMasterPageFile` method.</span></span> <span data-ttu-id="29371-320">W tej metodzie przypisać `MasterPageFile` wartość "~ / Admin/AdminNested.master".</span><span class="sxs-lookup"><span data-stu-id="29371-320">In that method assign the `MasterPageFile` the value "~/Admin/AdminNested.master".</span></span> <span data-ttu-id="29371-321">Po wprowadzeniu tych zmian na klasę pliku powinien wyglądać podobnie do poniższej:</span><span class="sxs-lookup"><span data-stu-id="29371-321">After making these changes your class file should look similar to the following:</span></span>


[!code-vb[Main](nested-master-pages-vb/samples/sample11.vb)]

<span data-ttu-id="29371-322">Teraz musisz mieć istniejących stron zawartości w administracji sekcji pochodzi od `AdminBasePage` zamiast `BasePage`.</span><span class="sxs-lookup"><span data-stu-id="29371-322">We now need to have the existing content pages in the Administration section derive from `AdminBasePage` instead of `BasePage`.</span></span> <span data-ttu-id="29371-323">Przejdź do pliku CodeBehind klasy dla każdej strony zawartości `~/Admin` folderu i wprowadzić tę zmianę.</span><span class="sxs-lookup"><span data-stu-id="29371-323">Go to the code-behind class file for each content page in the `~/Admin` folder and make this change.</span></span> <span data-ttu-id="29371-324">Na przykład w `~/Admin/Default.aspx` zmienia się z deklaracji klasy związane z kodem:</span><span class="sxs-lookup"><span data-stu-id="29371-324">For example, in `~/Admin/Default.aspx` you'd change the code-behind class declaration from:</span></span>


[!code-vb[Main](nested-master-pages-vb/samples/sample12.vb)]

<span data-ttu-id="29371-325">Do:</span><span class="sxs-lookup"><span data-stu-id="29371-325">To:</span></span>


[!code-vb[Main](nested-master-pages-vb/samples/sample13.vb)]

<span data-ttu-id="29371-326">Rysunek 11 przedstawia sposób najwyższego poziomu strony wzorcowej (`Site.master` lub `Alternate.master`), osadzonej stronie głównej (`AdminNested.master`), i stron zawartości sekcji Administracja odnoszą się do siebie.</span><span class="sxs-lookup"><span data-stu-id="29371-326">Figure 11 depicts how the top-level master page (`Site.master` or `Alternate.master`), the nested master page (`AdminNested.master`), and the Administration section content pages relate to one another.</span></span>


<span data-ttu-id="29371-327">[![Zagnieżdżone strony wzorcowej definiuje określonej zawartości do stron w sekcji Administracja](nested-master-pages-vb/_static/image32.png)](nested-master-pages-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="29371-327">[![The Nested Master Page Defines Content Specific to the Pages in the Administration Section](nested-master-pages-vb/_static/image32.png)](nested-master-pages-vb/_static/image31.png)</span></span>

<span data-ttu-id="29371-328">**Rysunek 11**: zagnieżdżone wzorca strony definiuje zawartości specyficzne dla stron w sekcji Administracja ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](nested-master-pages-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="29371-328">**Figure 11**: The Nested Master Page Defines Content Specific to the Pages in the Administration Section ([Click to view full-size image](nested-master-pages-vb/_static/image33.png))</span></span>


## <a name="step-6-mirroring-the-master-pages-public-methods-and-properties"></a><span data-ttu-id="29371-329">Krok 6: Dublowania publicznej metody i właściwości strony wzorcowej</span><span class="sxs-lookup"><span data-stu-id="29371-329">Step 6: Mirroring the Master Page's Public Methods and Properties</span></span>

<span data-ttu-id="29371-330">Odwołania, który `~/Admin/AddProduct.aspx` i `~/Admin/Products.aspx` stron interakcji programowej z strony wzorcowej: `~/Admin/AddProduct.aspx` wywołań strony wzorcowej do publicznego `RefreshRecentProductsGrid` — metoda i ustawia jej `GridMessageText` właściwości; `~/Admin/Products.aspx` ma obsługi zdarzeń dla `PricesDoubled` zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="29371-330">Recall that the `~/Admin/AddProduct.aspx` and `~/Admin/Products.aspx` pages interact programmatically with the master page: `~/Admin/AddProduct.aspx` calls the master page's public `RefreshRecentProductsGrid` method and sets its `GridMessageText` property; `~/Admin/Products.aspx` has an event handler for the `PricesDoubled` event.</span></span> <span data-ttu-id="29371-331">W poprzednim samouczek utworzyliśmy `MustInherit` `BaseMasterPage` klasy, która zdefiniowana te publiczne elementy członkowskie.</span><span class="sxs-lookup"><span data-stu-id="29371-331">In the preceding tutorial we created a `MustInherit` `BaseMasterPage` class that defined these public members.</span></span>

<span data-ttu-id="29371-332">`~/Admin/AddProduct.aspx` i `~/Admin/Products.aspx` stron założono, że ich strony wzorcowej pochodną `BaseMasterPage` klasy.</span><span class="sxs-lookup"><span data-stu-id="29371-332">The `~/Admin/AddProduct.aspx` and `~/Admin/Products.aspx` pages assume that their master page derives from the `BaseMasterPage` class.</span></span> <span data-ttu-id="29371-333">`AdminNested.master` Strony, jednak obecnie rozszerza `System.Web.UI.MasterPage` klasy.</span><span class="sxs-lookup"><span data-stu-id="29371-333">The `AdminNested.master` page, however, currently extends the `System.Web.UI.MasterPage` class.</span></span> <span data-ttu-id="29371-334">Dzięki temu podczas odwiedzania `~/Admin/Products.aspx` `InvalidCastException` jest generowany komunikat o: "nie można rzutować obiektu typu" ASP.admin\_adminnested\_wzorca "na typ"BaseMasterPage"."</span><span class="sxs-lookup"><span data-stu-id="29371-334">As a result, when visiting `~/Admin/Products.aspx` an `InvalidCastException` is thrown with the message: "Unable to cast object of type 'ASP.admin\_adminnested\_master' to type 'BaseMasterPage'."</span></span>

<span data-ttu-id="29371-335">Aby naprawić to musimy mieć `AdminNested.master` rozszerzyć klasę kodu `BaseMasterPage`.</span><span class="sxs-lookup"><span data-stu-id="29371-335">To fix this we need to have the `AdminNested.master` code-behind class extend `BaseMasterPage`.</span></span> <span data-ttu-id="29371-336">Aktualizacja deklarację klasy związane z kodem osadzonej stronie głównej:</span><span class="sxs-lookup"><span data-stu-id="29371-336">Update the nested master page's code-behind class declaration from:</span></span>


[!code-vb[Main](nested-master-pages-vb/samples/sample14.vb)]

<span data-ttu-id="29371-337">Do:</span><span class="sxs-lookup"><span data-stu-id="29371-337">To:</span></span>


[!code-vb[Main](nested-master-pages-vb/samples/sample15.vb)]

<span data-ttu-id="29371-338">Nie skończymy jeszcze.</span><span class="sxs-lookup"><span data-stu-id="29371-338">We're not done yet.</span></span> <span data-ttu-id="29371-339">Należy zastąpić elementy członkowskie oznaczone jako `MustOverride`, to znaczy `RefreshRecentProductsGrid` i `GridMessageText`.</span><span class="sxs-lookup"><span data-stu-id="29371-339">We need to override the members marked as `MustOverride`, namely `RefreshRecentProductsGrid` and `GridMessageText`.</span></span> <span data-ttu-id="29371-340">Elementy te są używane przez strony wzorcowe najwyższego poziomu można zaktualizować swoje interfejsy użytkownika.</span><span class="sxs-lookup"><span data-stu-id="29371-340">These members are used by the top-level master pages to update their user interfaces.</span></span> <span data-ttu-id="29371-341">(W rzeczywistości tylko `Site.master` strony wzorcowej używa tych metod, mimo że obu stron wzorcowych najwyższego poziomu wdrożenia tych metod, ponieważ zarówno rozszerzyć `BaseMasterPage`.)</span><span class="sxs-lookup"><span data-stu-id="29371-341">(Actually, only the `Site.master` master page uses these methods, although both top-level master pages implement these methods, since both extend `BaseMasterPage`.)</span></span>

<span data-ttu-id="29371-342">Gdy musimy zaimplementować te elementy członkowskie w `AdminNested.master`, wszystkie te implementacji konieczne jest po prostu wywołać elementu członkowskiego na stronie głównej najwyższego poziomu używane przez osadzonej stronie głównej.</span><span class="sxs-lookup"><span data-stu-id="29371-342">While we need to implement these members in `AdminNested.master`, all these implementations need to do is simply call the same member in the top-level master page used by the nested master page.</span></span> <span data-ttu-id="29371-343">Na przykład gdy zawartości strony w sekcji Administracja wywołuje osadzonej stronie głównej `RefreshRecentProductsGrid` metody, wszystkie zagnieżdżone strony wzorcowej musi wykonać, z kolei, wywołaj `Site.master` lub `Alternate.master`w `RefreshRecentProductsGrid` metody.</span><span class="sxs-lookup"><span data-stu-id="29371-343">For instance, when a content page in the Administration section calls the nested master page's `RefreshRecentProductsGrid` method, all the nested master page needs to do is, in turn, call `Site.master` or `Alternate.master`'s `RefreshRecentProductsGrid` method.</span></span>

<span data-ttu-id="29371-344">Aby to osiągnąć, Rozpocznij od dodania następujących `@MasterType` dyrektywy na początku `AdminNested.master`:</span><span class="sxs-lookup"><span data-stu-id="29371-344">To achieve this, start by adding the following `@MasterType` directive to the top of `AdminNested.master`:</span></span>


[!code-aspx[Main](nested-master-pages-vb/samples/sample16.aspx)]

<span data-ttu-id="29371-345">Odwołania, który `@MasterType` dyrektywy dodaje właściwość silnie typizowaną do klasy związane z kodem o nazwie `Master`.</span><span class="sxs-lookup"><span data-stu-id="29371-345">Recall that the `@MasterType` directive adds a strongly-typed property to the code-behind class named `Master`.</span></span> <span data-ttu-id="29371-346">Następnie zastąp `RefreshRecentProductsGrid` i `GridMessageText` elementy członkowskie i po prostu delegowanie wywołanie `Master`i odpowiadający jej metodę:</span><span class="sxs-lookup"><span data-stu-id="29371-346">Then override the `RefreshRecentProductsGrid` and `GridMessageText` members and simply delegate the call to the `Master`'s corresponding method:</span></span>


[!code-vb[Main](nested-master-pages-vb/samples/sample17.vb)]

<span data-ttu-id="29371-347">Z tego kodu w miejscu należy odwiedzić i używać zawartości strony w sekcji Administracja.</span><span class="sxs-lookup"><span data-stu-id="29371-347">With this code in place, you should be able to visit and use the content pages in the Administration section.</span></span> <span data-ttu-id="29371-348">Przedstawia rysunek 12 `~/Admin/Products.aspx` strony podczas wyświetlania za pośrednictwem przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="29371-348">Figure 12 shows the `~/Admin/Products.aspx` page when viewed through a browser.</span></span> <span data-ttu-id="29371-349">Jak widać, strona zawiera pole instrukcje administracji, które jest zdefiniowany w osadzonej stronie głównej.</span><span class="sxs-lookup"><span data-stu-id="29371-349">As you can see, the page includes the Administration Instructions box, which is defined in the nested master page.</span></span>


<span data-ttu-id="29371-350">[![Strony zawartości, w sekcji Administracja instrukcje na początku każdej strony](nested-master-pages-vb/_static/image35.png)](nested-master-pages-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="29371-350">[![The Content Pages in the Administration Section Include Instructions at the Top of Each Page](nested-master-pages-vb/_static/image35.png)](nested-master-pages-vb/_static/image34.png)</span></span>

<span data-ttu-id="29371-351">**Rysunek 12**: strony z zawartością w administracji sekcji zawierają instrukcje na początku każdej stronie ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](nested-master-pages-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="29371-351">**Figure 12**: The Content Pages in the Administration Section Include Instructions at the Top of Each Page ([Click to view full-size image](nested-master-pages-vb/_static/image36.png))</span></span>


## <a name="step-7-using-the-appropriate-top-level-master-page-at-runtime"></a><span data-ttu-id="29371-352">Krok 7: Przy użyciu odpowiedniej strony wzorcowej najwyższego poziomu w czasie wykonywania</span><span class="sxs-lookup"><span data-stu-id="29371-352">Step 7: Using the Appropriate Top-Level Master Page at Runtime</span></span>

<span data-ttu-id="29371-353">Gdy wszystkie zawartości strony w sekcji Administracja są w pełni funkcjonalne, używają tej samej strony wzorcowej najwyższego poziomu i Ignoruj strony wzorcowej wybrane przez użytkownika w `ChooseMasterPage.aspx`.</span><span class="sxs-lookup"><span data-stu-id="29371-353">While all the content pages in the Administration section are fully functional, they all use the same top-level master page and ignore the master page selected by the user at `ChooseMasterPage.aspx`.</span></span> <span data-ttu-id="29371-354">To zachowanie to z faktu, że ma osadzonej stronie głównej jego `MasterPageFile` statycznie ustawioną właściwość `Site.master` w jego `<%@ Master %>` dyrektywy.</span><span class="sxs-lookup"><span data-stu-id="29371-354">This behavior is due to the fact that the nested master page has its `MasterPageFile` property statically set to `Site.master` in its `<%@ Master %>` directive.</span></span>

<span data-ttu-id="29371-355">Aby użyć najwyższego poziomu strony wzorcowej wybrane przez użytkownika końcowego, należy ustawić `AdminNested.master`w `MasterPageFile` właściwości do wartości w `MyMasterPage` zmiennej sesji.</span><span class="sxs-lookup"><span data-stu-id="29371-355">To use the top-level master page selected by the end user we need to set the `AdminNested.master`'s `MasterPageFile` property to the value in the `MyMasterPage` Session variable.</span></span> <span data-ttu-id="29371-356">Ponieważ firma Microsoft strony zawartości `MasterPageFile` właściwości w `BasePage`, może uważasz, że ustawimy usługę· osadzonej stronie głównej `MasterPageFile` właściwości w `BaseMasterPage` lub `AdminNested.master`w klasie związanej z kodem.</span><span class="sxs-lookup"><span data-stu-id="29371-356">Because we set the content pages' `MasterPageFile` properties in `BasePage`, you may think that we would set the nested master page's `MasterPageFile` property in `BaseMasterPage` or in the `AdminNested.master`'s code-behind class.</span></span> <span data-ttu-id="29371-357">To nie będzie działać, jednak ponieważ musimy ustawiono `MasterPageFile` właściwości do końca etap PreInit.</span><span class="sxs-lookup"><span data-stu-id="29371-357">This won't work, however, because we need to have set the `MasterPageFile` property by the end of the PreInit stage.</span></span> <span data-ttu-id="29371-358">Najwcześniejsza czas, który firma Microsoft może programowo nacisnąć w cyklu życia strony ze strony wzorcowej jest na etapie Init, (realizowany po fazie PreInit).</span><span class="sxs-lookup"><span data-stu-id="29371-358">The earliest time that we can programmatically tap into the page lifecycle from a master page is the Init stage (which occurs after the PreInit stage).</span></span>

<span data-ttu-id="29371-359">W związku z tym należy ustawić osadzonej stronie głównej `MasterPageFile` właściwość ze strony z zawartością.</span><span class="sxs-lookup"><span data-stu-id="29371-359">Therefore, we need to set the nested master page's `MasterPageFile` property from the content pages.</span></span> <span data-ttu-id="29371-360">Tylko zawartość strony używające `AdminNested.master` strony wzorcowej pochodzi od `AdminBasePage`.</span><span class="sxs-lookup"><span data-stu-id="29371-360">The only content pages that use the `AdminNested.master` master page derive from `AdminBasePage`.</span></span> <span data-ttu-id="29371-361">Firma Microsoft w związku z tym umieścić tę logikę.</span><span class="sxs-lookup"><span data-stu-id="29371-361">Therefore, we can put this logic there.</span></span> <span data-ttu-id="29371-362">W kroku 5 możemy overrode `SetMasterPageFile` metody ustawienie obiekt strony `MasterPageFile` dla właściwości "~ / Admin/AdminNested.master".</span><span class="sxs-lookup"><span data-stu-id="29371-362">In Step 5 we overrode the `SetMasterPageFile` method, setting the Page object's `MasterPageFile` property to "~/Admin/AdminNested.master".</span></span> <span data-ttu-id="29371-363">Aktualizacja `SetMasterPageFile` można również ustawić strony wzorcowej `MasterPageFile` właściwości do wyniku przechowywanego w sesji:</span><span class="sxs-lookup"><span data-stu-id="29371-363">Update `SetMasterPageFile` to also set the master page's `MasterPageFile` property to the result stored in Session:</span></span>


[!code-vb[Main](nested-master-pages-vb/samples/sample18.vb)]

<span data-ttu-id="29371-364">`GetMasterPageFileFromSession` Metody, które dodano do `BasePage` klasy w poprzednim samouczek, zwraca ścieżkę pliku strony głównej odpowiednie oparta na wartości zmiennej sesji.</span><span class="sxs-lookup"><span data-stu-id="29371-364">The `GetMasterPageFileFromSession` method, which we added to the `BasePage` class in the preceding tutorial, returns the appropriate master page file path based on the Session variable value.</span></span>

<span data-ttu-id="29371-365">Dzięki tej zmianie w miejscu wybranej strony wzorcowej przez użytkownika są przenoszone do sekcji Administracja.</span><span class="sxs-lookup"><span data-stu-id="29371-365">With this change in place, the user's master page selection carries over to the Administration section.</span></span> <span data-ttu-id="29371-366">Rysunek 13 przedstawiono tej samej stronie co rysunek 12, ale po zmianie ich zaznaczenie strony wzorcowej do użytkownika `Alternate.master`.</span><span class="sxs-lookup"><span data-stu-id="29371-366">Figure 13 shows the same page as Figure 12, but after the user has changed their master page selection to `Alternate.master`.</span></span>


<span data-ttu-id="29371-367">[![Strony Administracja zagnieżdżonych używa najwyższego poziomu strony wzorcowej wybrane przez użytkownika](nested-master-pages-vb/_static/image38.png)](nested-master-pages-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="29371-367">[![The Nested Administration Page Uses the Top-Level Master Page Selected by the User](nested-master-pages-vb/_static/image38.png)](nested-master-pages-vb/_static/image37.png)</span></span>

<span data-ttu-id="29371-368">**Rysunek 13**: zagnieżdżone strony Administracja używa najwyższego poziomu głównego strony wybranego przez użytkownika ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](nested-master-pages-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="29371-368">**Figure 13**: The Nested Administration Page Uses the Top-Level Master Page Selected by the User ([Click to view full-size image](nested-master-pages-vb/_static/image39.png))</span></span>


## <a name="summary"></a><span data-ttu-id="29371-369">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="29371-369">Summary</span></span>

<span data-ttu-id="29371-370">Wiele podobnych jak zawartości strony można powiązać z strony wzorcowej, jest możliwość utworzenia zagnieżdżone strony wzorcowe przez posiadanie strony wzorcowej podrzędnych powiązać nadrzędny strony wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="29371-370">Much like how content pages can bind to a master page, it is possible to create nested master pages by having a child master page bind to a parent master page.</span></span> <span data-ttu-id="29371-371">Strony wzorcowej podrzędnych może zdefiniować formantów zawartości dla każdego z jego elementu nadrzędnego Elementy ContentPlaceHolders; go można następnie dodać własne kontrolki elementu ContentPlaceHolder (a także innych znaczników) do tych kontrolek zawartości.</span><span class="sxs-lookup"><span data-stu-id="29371-371">The child master page may define Content controls for each of its parent's ContentPlaceHolders; it can then add its own ContentPlaceHolder controls (as well as other markup) to these Content controls.</span></span> <span data-ttu-id="29371-372">Zagnieżdżone strony wzorcowe są bardzo przydatne w aplikacji sieci web dużych, gdzie wszystkie strony Udostępnianie nadrzędna wyglądu i działania, ale określone sekcje lokacji wymagają unikatowych dostosowania.</span><span class="sxs-lookup"><span data-stu-id="29371-372">Nested master pages are quite useful in large web applications where all pages share an overarching look and feel, yet certain sections of the site require unique customizations.</span></span>

<span data-ttu-id="29371-373">Programowanie przyjemność!</span><span class="sxs-lookup"><span data-stu-id="29371-373">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="29371-374">Dalsze informacje</span><span class="sxs-lookup"><span data-stu-id="29371-374">Further Reading</span></span>

<span data-ttu-id="29371-375">Więcej informacji dotyczących tematów omówionych w tym samouczku można znaleźć w następujących zasobach:</span><span class="sxs-lookup"><span data-stu-id="29371-375">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="29371-376">Zagnieżdżone strony wzorcowe ASP.NET</span><span class="sxs-lookup"><span data-stu-id="29371-376">Nested ASP.NET Master Pages</span></span>](https://msdn.microsoft.com/library/x2b3ktt7.aspx)
- [<span data-ttu-id="29371-377">Porady dotyczące zagnieżdżone strony wzorcowe i czasu projektowania 2005 VS</span><span class="sxs-lookup"><span data-stu-id="29371-377">Tips for Nested Master Pages and VS 2005 Design-Time</span></span>](https://weblogs.asp.net/scottgu/archive/2005/11/11/430382.aspx)
- [<span data-ttu-id="29371-378">Obsługa strony wzorca zagnieżdżone VS 2008</span><span class="sxs-lookup"><span data-stu-id="29371-378">VS 2008 Nested Master Page Support</span></span>](https://weblogs.asp.net/scottgu/archive/2007/07/09/vs-2008-nested-master-page-support.aspx)

### <a name="about-the-author"></a><span data-ttu-id="29371-379">Informacje o autorze</span><span class="sxs-lookup"><span data-stu-id="29371-379">About the Author</span></span>

<span data-ttu-id="29371-380">[Scott Bento](http://www.4guysfromrolla.com/ScottMitchell.shtml), autora wielu książek ASP/ASP.NET i twórcę 4GuysFromRolla.com pracuje z technologii Microsoft Web od 1998.</span><span class="sxs-lookup"><span data-stu-id="29371-380">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="29371-381">Scott działa jako niezależnego konsultanta trainer i składnika zapisywania.</span><span class="sxs-lookup"><span data-stu-id="29371-381">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="29371-382">Jest jego najnowszej książki [ *Sams nauczyć się ASP.NET 3.5 w ciągu 24 godzin*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="29371-382">His latest book is [*Sams Teach Yourself ASP.NET 3.5 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco).</span></span> <span data-ttu-id="29371-383">Scott jest osiągalny w [ mitchell@4GuysFromRolla.com ](mailto:mitchell@4GuysFromRolla.com) lub za pośrednictwem jego blogu w [ http://ScottOnWriting.NET ](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="29371-383">Scott can be reached at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="29371-384">Specjalne podziękowania dla</span><span class="sxs-lookup"><span data-stu-id="29371-384">Special Thanks To</span></span>

<span data-ttu-id="29371-385">Ten samouczek serii zostało sprawdzone przez wiele recenzentów przydatne.</span><span class="sxs-lookup"><span data-stu-id="29371-385">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="29371-386">Zainteresowani recenzowania Moje nadchodzących artykuły MSDN?</span><span class="sxs-lookup"><span data-stu-id="29371-386">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="29371-387">Jeśli tak, Porzuć mnie linii w [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="29371-387">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="29371-388">Poprzednie</span><span class="sxs-lookup"><span data-stu-id="29371-388">Previous</span></span>](specifying-the-master-page-programmatically-vb.md)
