---
uid: web-forms/overview/older-versions-security/membership/storing-additional-user-information-vb
title: Przechowywanie dodatkowe informacje dotyczące użytkownika (VB) | Dokumentacja firmy Microsoft
author: rick-anderson
description: W tym samouczku odpowiemy na to pytanie przez tworzenie aplikacji bardzo proste księgi gości. W ten sposób zajmiemy różnych opcji dla modeli...
ms.author: aspnetcontent
manager: wpickett
ms.date: 01/18/2008
ms.topic: article
ms.assetid: ee4b924e-8002-4dc3-819f-695fca1ff867
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/older-versions-security/membership/storing-additional-user-information-vb
msc.type: authoredcontent
ms.openlocfilehash: 9a8673e764ae94b12fbc01f81ef12ea4c133b7d5
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/10/2018
---
<a name="storing-additional-user-information-vb"></a><span data-ttu-id="0e079-104">Przechowywanie dodatkowe informacje dotyczące użytkownika (VB)</span><span class="sxs-lookup"><span data-stu-id="0e079-104">Storing Additional User Information (VB)</span></span>
====================
<span data-ttu-id="0e079-105">przez [Bento Scott](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="0e079-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="0e079-106">[Pobierz kod](http://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/ASPNET_Security_Tutorial_08_VB.zip) lub [pobierania plików PDF](http://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/aspnet_tutorial08_ExtraUserInfo_vb.pdf)</span><span class="sxs-lookup"><span data-stu-id="0e079-106">[Download Code](http://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/ASPNET_Security_Tutorial_08_VB.zip) or [Download PDF](http://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/aspnet_tutorial08_ExtraUserInfo_vb.pdf)</span></span>

> <span data-ttu-id="0e079-107">W tym samouczku odpowiemy na to pytanie przez tworzenie aplikacji bardzo proste księgi gości.</span><span class="sxs-lookup"><span data-stu-id="0e079-107">In this tutorial we will answer this question by building a very rudimentary guestbook application.</span></span> <span data-ttu-id="0e079-108">W ten sposób firma Microsoft będzie przyjrzeć się różne opcje modelowania informacje o użytkowniku w bazie danych, a następnie zobacz jak skojarzyć te dane z kontami użytkownika utworzone przez platformę członkostwa.</span><span class="sxs-lookup"><span data-stu-id="0e079-108">In doing so, we will look at different options for modeling user information in a database, and then see how to associate this data with the user accounts created by the Membership framework.</span></span>


## <a name="introduction"></a><span data-ttu-id="0e079-109">Wprowadzenie</span><span class="sxs-lookup"><span data-stu-id="0e079-109">Introduction</span></span>

<span data-ttu-id="0e079-110">ŚRODOWISKO ASP. W NET framework członkostwa oferuje elastyczne interfejsu do zarządzania użytkownikami.</span><span class="sxs-lookup"><span data-stu-id="0e079-110">ASP.NET's Membership framework offers a flexible interface for managing users.</span></span> <span data-ttu-id="0e079-111">Interfejs API członkostwa zawiera metody sprawdzanie poprawności poświadczeń, trwa pobieranie informacji na temat aktualnie zalogowanego użytkownika, tworzenie nowego konta użytkownika i usunięcie konta użytkownika, między innymi.</span><span class="sxs-lookup"><span data-stu-id="0e079-111">The Membership API includes methods for validating credentials, retrieving information about the currently logged on user, creating a new user account, and deleting a user account, among others.</span></span> <span data-ttu-id="0e079-112">Każde konto użytkownika w ramach członkostwa zawiera tylko właściwości potrzebne sprawdzanie poprawności poświadczeń i wykonywanie zadań związanych z kontem użytkownika podstawowych.</span><span class="sxs-lookup"><span data-stu-id="0e079-112">Each user account in the Membership framework contains only the properties needed for validating credentials and performing essential user account-related tasks.</span></span> <span data-ttu-id="0e079-113">To jest dowodem metody i właściwości [ `MembershipUser` klasy](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx), które modele konta użytkownika w ramach członkostwa.</span><span class="sxs-lookup"><span data-stu-id="0e079-113">This is evidenced by the methods and properties of the [`MembershipUser` class](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx), which models a user account in the Membership framework.</span></span> <span data-ttu-id="0e079-114">Ta klasa ma właściwości, takie jak [ `UserName` ](https://msdn.microsoft.com/library/system.web.security.membershipuser.username.aspx), [ `Email` ](https://msdn.microsoft.com/library/system.web.security.membershipuser.email.aspx), i [ `IsLockedOut` ](https://msdn.microsoft.com/library/system.web.security.membershipuser.islockedout.aspx), i metod, takich jak [ `GetPassword` ](https://msdn.microsoft.com/library/system.web.security.membershipuser.getpassword.aspx) i [ `UnlockUser` ](https://msdn.microsoft.com/library/system.web.security.membershipuser.unlockuser.aspx).</span><span class="sxs-lookup"><span data-stu-id="0e079-114">This class has properties like [`UserName`](https://msdn.microsoft.com/library/system.web.security.membershipuser.username.aspx), [`Email`](https://msdn.microsoft.com/library/system.web.security.membershipuser.email.aspx), and [`IsLockedOut`](https://msdn.microsoft.com/library/system.web.security.membershipuser.islockedout.aspx), and methods like [`GetPassword`](https://msdn.microsoft.com/library/system.web.security.membershipuser.getpassword.aspx) and [`UnlockUser`](https://msdn.microsoft.com/library/system.web.security.membershipuser.unlockuser.aspx).</span></span>

<span data-ttu-id="0e079-115">Często należy zachować dodatkowe informacje dotyczące użytkownika nie jest uwzględniony w ramach członkostwa aplikacji.</span><span class="sxs-lookup"><span data-stu-id="0e079-115">Oftentimes, applications need to store additional user information not included in the Membership framework.</span></span> <span data-ttu-id="0e079-116">Na przykład detalicznej online może być konieczne let każdego użytkownika, przechowywać swoje adresy wysyłki i rozliczeń, informacje dotyczące płatności, a preferencje dostarczania i numer telefonu.</span><span class="sxs-lookup"><span data-stu-id="0e079-116">For example, an online retailer might need to let each user store her shipping and billing addresses, payment information, delivery preferences, and contact phone number.</span></span> <span data-ttu-id="0e079-117">Ponadto każdy kolejności w systemie jest skojarzony z określonego konta użytkownika.</span><span class="sxs-lookup"><span data-stu-id="0e079-117">Furthermore, each order in the system is associated with a particular user account.</span></span>

<span data-ttu-id="0e079-118">`MembershipUser` Klasa nie ma właściwości, takie jak `PhoneNumber` lub `DeliveryPreferences` lub `PastOrders`.</span><span class="sxs-lookup"><span data-stu-id="0e079-118">The `MembershipUser` class does not include properties like `PhoneNumber` or `DeliveryPreferences` or `PastOrders`.</span></span> <span data-ttu-id="0e079-119">W jaki sposób firma Microsoft śledzenia informacji użytkownika wymagane przez aplikację i ich integracji z architekturą członkostwa?</span><span class="sxs-lookup"><span data-stu-id="0e079-119">So how do we track the user information needed by the application and have it integrate with the Membership framework?</span></span> <span data-ttu-id="0e079-120">W tym samouczku odpowiemy na to pytanie przez tworzenie aplikacji bardzo proste księgi gości.</span><span class="sxs-lookup"><span data-stu-id="0e079-120">In this tutorial we will answer this question by building a very rudimentary guestbook application.</span></span> <span data-ttu-id="0e079-121">W ten sposób firma Microsoft będzie przyjrzeć się różne opcje modelowania informacje o użytkowniku w bazie danych, a następnie zobacz jak skojarzyć te dane z kontami użytkownika utworzone przez platformę członkostwa.</span><span class="sxs-lookup"><span data-stu-id="0e079-121">In doing so, we will look at different options for modeling user information in a database, and then see how to associate this data with the user accounts created by the Membership framework.</span></span> <span data-ttu-id="0e079-122">Dzieła!</span><span class="sxs-lookup"><span data-stu-id="0e079-122">Let's get started!</span></span>

## <a name="step-1-creating-the-guestbook-applications-data-model"></a><span data-ttu-id="0e079-123">Krok 1: Tworzenie modelu danych aplikacji księgi gości</span><span class="sxs-lookup"><span data-stu-id="0e079-123">Step 1: Creating the Guestbook Application's Data Model</span></span>

<span data-ttu-id="0e079-124">Istnieją różne techniki, które można zastosować do przechwycenia informacji użytkownika w bazie danych i powiązać ją z kontami użytkownika utworzone przez platformę członkostwa.</span><span class="sxs-lookup"><span data-stu-id="0e079-124">There are a variety of techniques that can be employed to capture user information in a database and associate it with the user accounts created by the Membership framework.</span></span> <span data-ttu-id="0e079-125">Aby zilustrować te techniki, potrzebujemy rozszerzyć aplikacji sieci web samouczka, dzięki czemu znajdują się jakieś dane dotyczące użytkowników.</span><span class="sxs-lookup"><span data-stu-id="0e079-125">In order to illustrate these techniques, we will need to augment the tutorial web application so that it captures some sort of user-related data.</span></span> <span data-ttu-id="0e079-126">(Aktualnie modelu danych aplikacji zawiera tylko aplikację usługi tabel wymaganych przez `SqlMembershipProvider`.)</span><span class="sxs-lookup"><span data-stu-id="0e079-126">(Currently, the application's data model contains only the application services tables needed by the `SqlMembershipProvider`.)</span></span>

<span data-ttu-id="0e079-127">Umożliwia tworzenie aplikacji bardzo proste księgi gości, gdzie uwierzytelniony użytkownik może narazić komentarz.</span><span class="sxs-lookup"><span data-stu-id="0e079-127">Let's create a very simple guestbook application where an authenticated user can leave a comment.</span></span> <span data-ttu-id="0e079-128">Oprócz przechowywania komentarzy księgi gości, umożliwia pozwolić każdemu użytkownikowi na przechowywanie jego miejscowość macierzystego, strony głównej i podpis.</span><span class="sxs-lookup"><span data-stu-id="0e079-128">In addition to storing guestbook comments, let's allow each user to store his home town, homepage, and signature.</span></span> <span data-ttu-id="0e079-129">Jeśli zostanie podana, miasta macierzysty użytkownika, strony głównej i podpis będą wyświetlane na każdy komunikat, który opuścił on w księdze gości.</span><span class="sxs-lookup"><span data-stu-id="0e079-129">If provided, the user's home town, homepage, and signature will appear on each message he has left in the guestbook.</span></span>

### <a name="adding-theguestbookcommentstable"></a><span data-ttu-id="0e079-130">Dodawanie`GuestbookComments`tabeli</span><span class="sxs-lookup"><span data-stu-id="0e079-130">Adding the`GuestbookComments`Table</span></span>

<span data-ttu-id="0e079-131">Aby przechwycić komentarze księgi gości, należy utworzyć tabeli bazy danych o nazwie `GuestbookComments` mający kolumny, tak jak `CommentId`, `Subject`, `Body`, i `CommentDate`.</span><span class="sxs-lookup"><span data-stu-id="0e079-131">In order to capture the guestbook comments, we need to create a database table named `GuestbookComments` that has columns like `CommentId`, `Subject`, `Body`, and `CommentDate`.</span></span> <span data-ttu-id="0e079-132">Możemy również musi mieć każdy rekord w `GuestbookComments` odwołania do tabeli użytkownika, który pozostanie komentarz.</span><span class="sxs-lookup"><span data-stu-id="0e079-132">We also need to have each record in the `GuestbookComments` table reference the user who left the comment.</span></span>

<span data-ttu-id="0e079-133">Aby dodać tej tabeli do naszej bazie danych, przejdź do Eksploratora bazy danych w programie Visual Studio i przejdź do szczegółów `SecurityTutorials` bazy danych.</span><span class="sxs-lookup"><span data-stu-id="0e079-133">To add this table to our database, go to the Database Explorer in Visual Studio and drill down into the `SecurityTutorials` database.</span></span> <span data-ttu-id="0e079-134">Kliknij prawym przyciskiem folder Tabele i wybierz polecenie Dodaj nową tabelę.</span><span class="sxs-lookup"><span data-stu-id="0e079-134">Right-click on the Tables folder and choose Add New Table.</span></span> <span data-ttu-id="0e079-135">Spowoduje to wyświetlenie interfejs, który pozwala zdefiniować kolumny w nowej tabeli.</span><span class="sxs-lookup"><span data-stu-id="0e079-135">This brings up an interface that allows us to define the columns for the new table.</span></span>


<span data-ttu-id="0e079-136">[![Dodaj nową tabelę w bazie danych SecurityTutorials](storing-additional-user-information-vb/_static/image2.png)](storing-additional-user-information-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="0e079-136">[![Add a New Table to the SecurityTutorials Database](storing-additional-user-information-vb/_static/image2.png)](storing-additional-user-information-vb/_static/image1.png)</span></span>

<span data-ttu-id="0e079-137">**Rysunek 1**: Dodaj nową tabelę do `SecurityTutorials` bazy danych ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](storing-additional-user-information-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="0e079-137">**Figure 1**: Add a New Table to the `SecurityTutorials` Database  ([Click to view full-size image](storing-additional-user-information-vb/_static/image3.png))</span></span>


<span data-ttu-id="0e079-138">Następnie określ `GuestbookComments`dla kolumn.</span><span class="sxs-lookup"><span data-stu-id="0e079-138">Next, define the `GuestbookComments`'s columns.</span></span> <span data-ttu-id="0e079-139">Rozpocznij od dodania kolumny o nazwie `CommentId` typu `uniqueidentifier`.</span><span class="sxs-lookup"><span data-stu-id="0e079-139">Start by adding a column named `CommentId` of type `uniqueidentifier`.</span></span> <span data-ttu-id="0e079-140">Ta kolumna zostanie jednoznacznie zidentyfikować każdy komentarz w księdze gości, więc nie zezwalaj na `NULL` s i oznacz ją jako klucz podstawowy tabeli.</span><span class="sxs-lookup"><span data-stu-id="0e079-140">This column will uniquely identify each comment in the guestbook, so disallow `NULL` s and mark it as the table's primary key.</span></span> <span data-ttu-id="0e079-141">Zamiast podawania wartości dla `CommentId` pole na każdym `INSERT`, firma Microsoft może oznaczać, że nowy `uniqueidentifier` wartości powinny być generowane automatycznie dla tego pola na `INSERT` się przez ustawienie wartości domyślnej kolumny `NEWID()`.</span><span class="sxs-lookup"><span data-stu-id="0e079-141">Rather than providing a value for the `CommentId` field on each `INSERT`, we can indicate that a new `uniqueidentifier` value should be automatically generated for this field on `INSERT` by setting the column's default value to `NEWID()`.</span></span> <span data-ttu-id="0e079-142">Po dodaniu tego pierwsze pole, oznaczając je jako klucz podstawowy, a ustawienia wartość domyślną ekranie powinien wyglądać podobnie do ekranu zrzut pokazano na rysunku 2.</span><span class="sxs-lookup"><span data-stu-id="0e079-142">After adding this first field, marking it as the primary key, and settings its default value, your screen should look similar to the screen shot shown in Figure 2.</span></span>


<span data-ttu-id="0e079-143">[![Dodaj kolumnę podstawowego o nazwie CommentId](storing-additional-user-information-vb/_static/image5.png)](storing-additional-user-information-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="0e079-143">[![Add a Primary Column Named CommentId](storing-additional-user-information-vb/_static/image5.png)](storing-additional-user-information-vb/_static/image4.png)</span></span>

<span data-ttu-id="0e079-144">**Rysunek 2**: Dodawanie podstawowego o nazwie kolumny `CommentId` ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](storing-additional-user-information-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="0e079-144">**Figure 2**: Add a Primary Column Named `CommentId` ([Click to view full-size image](storing-additional-user-information-vb/_static/image6.png))</span></span>


<span data-ttu-id="0e079-145">Następnie dodaj kolumnę o nazwie `Subject` typu `nvarchar(50)` i kolumna o nazwie `Body` typu `nvarchar(MAX)`, niezezwalające `NULL` s w kolumnach.</span><span class="sxs-lookup"><span data-stu-id="0e079-145">Next, add a column named `Subject` of type `nvarchar(50)` and a column named `Body` of type `nvarchar(MAX)`, disallowing `NULL` s in both columns.</span></span> <span data-ttu-id="0e079-146">Następujące, Dodaj kolumnę o nazwie `CommentDate` typu `datetime`.</span><span class="sxs-lookup"><span data-stu-id="0e079-146">Following that, add a column named `CommentDate` of type `datetime`.</span></span> <span data-ttu-id="0e079-147">Nie zezwalaj na `NULL` s i zestaw `CommentDate` wartości domyślnej kolumny do `getdate()`.</span><span class="sxs-lookup"><span data-stu-id="0e079-147">Disallow `NULL` s and set the `CommentDate` column's default value to `getdate()`.</span></span>

<span data-ttu-id="0e079-148">Wszystkie opcje, które pozostaje jest dodanie kolumny, która kojarzy konto użytkownika z każdego komentarza księgi gości.</span><span class="sxs-lookup"><span data-stu-id="0e079-148">All that remains is to add a column that associates a user account with each guestbook comment.</span></span> <span data-ttu-id="0e079-149">Jedną z opcji byłoby dodać kolumnę o nazwie `UserName` typu `nvarchar(256)`.</span><span class="sxs-lookup"><span data-stu-id="0e079-149">One option would be to add a column named `UserName` of type `nvarchar(256)`.</span></span> <span data-ttu-id="0e079-150">Jest to odpowiedni wybór w przypadku innych niż przy użyciu dostawcy członkostwa `SqlMembershipProvider`.</span><span class="sxs-lookup"><span data-stu-id="0e079-150">This is a suitable choice when using a Membership provider other than the `SqlMembershipProvider`.</span></span> <span data-ttu-id="0e079-151">Jednak przy użyciu `SqlMembershipProvider`, ponieważ nie jesteśmy w tym samouczku, `UserName` kolumny w `aspnet_Users` tabeli nie musi być unikatowy.</span><span class="sxs-lookup"><span data-stu-id="0e079-151">But when using the `SqlMembershipProvider`, as we are in this tutorial series, the `UserName` column in the `aspnet_Users` table is not guaranteed to be unique.</span></span> <span data-ttu-id="0e079-152">`aspnet_Users` Jest klucz podstawowy tabeli `UserId` i jest typu `uniqueidentifier`.</span><span class="sxs-lookup"><span data-stu-id="0e079-152">The `aspnet_Users` table's primary key is `UserId` and is of type `uniqueidentifier`.</span></span> <span data-ttu-id="0e079-153">W związku z tym `GuestbookComments` tabela musi kolumny o nazwie `UserId` typu `uniqueidentifier` (Brak zezwolenia `NULL` wartości).</span><span class="sxs-lookup"><span data-stu-id="0e079-153">Therefore, the `GuestbookComments` table needs a column named `UserId` of type `uniqueidentifier` (disallowing `NULL` values).</span></span> <span data-ttu-id="0e079-154">Przejdź dalej i dodać tę kolumnę.</span><span class="sxs-lookup"><span data-stu-id="0e079-154">Go ahead and add this column.</span></span>

> [!NOTE]
> <span data-ttu-id="0e079-155">Jak wspomniano w [ *tworzenie schematu członkostwa w programie SQL Server* ](creating-the-membership-schema-in-sql-server-vb.md) samouczek, w ramach członkostwa zaprojektowana w celu umożliwienia wiele aplikacji sieci web z różnych kont użytkowników w identyczny Magazyn użytkowników.</span><span class="sxs-lookup"><span data-stu-id="0e079-155">As we discussed in the [*Creating the Membership Schema in SQL Server*](creating-the-membership-schema-in-sql-server-vb.md) tutorial, the Membership framework is designed to enable multiple web applications with different user accounts to share the same user store.</span></span> <span data-ttu-id="0e079-156">Jest to możliwe dzięki partycjonowanie konta użytkowników do różnych aplikacji.</span><span class="sxs-lookup"><span data-stu-id="0e079-156">It does this by partitioning user accounts into different applications.</span></span> <span data-ttu-id="0e079-157">I gdy nazwy użytkownika jest musi być unikatowy w obrębie aplikacji, tej samej nazwy użytkownika mogą być używane w różnych aplikacji przy użyciu tego samego magazynu użytkownika.</span><span class="sxs-lookup"><span data-stu-id="0e079-157">And while each username is guaranteed to be unique within an application, the same username may be used in different applications using the same user store.</span></span> <span data-ttu-id="0e079-158">Brak złożonym `UNIQUE` ograniczeniem `aspnet_Users` tabeli na `UserName` i `ApplicationId` pól, ale nie jest elementem na tylko `UserName` pola.</span><span class="sxs-lookup"><span data-stu-id="0e079-158">There is a composite `UNIQUE` constraint in the `aspnet_Users` table on the `UserName` and `ApplicationId` fields, but not one on just the `UserName` field.</span></span> <span data-ttu-id="0e079-159">W związku z tym, istnieje możliwość aspnet\_tabeli użytkowników (co najmniej dwa) rekordy z takimi samymi `UserName` wartość.</span><span class="sxs-lookup"><span data-stu-id="0e079-159">Consequently, it is possible for the aspnet\_Users table to have two (or more) records with the same `UserName` value.</span></span> <span data-ttu-id="0e079-160">Jest jednak `UNIQUE` ograniczenie `aspnet_Users` tabeli `UserId` pola (ponieważ jest to klucz podstawowy).</span><span class="sxs-lookup"><span data-stu-id="0e079-160">There is, however, a `UNIQUE` constraint on the `aspnet_Users` table's `UserId` field (since it is the primary key).</span></span> <span data-ttu-id="0e079-161">A `UNIQUE` ograniczenie jest ważne, ponieważ bez niego firma Microsoft nie może ustanowić ograniczenie klucza obcego między `GuestbookComments` i `aspnet_Users` tabel.</span><span class="sxs-lookup"><span data-stu-id="0e079-161">A `UNIQUE` constraint is important because without it we cannot establish a foreign key constraint between the `GuestbookComments` and `aspnet_Users` tables.</span></span>


<span data-ttu-id="0e079-162">Po dodaniu `UserId` kolumny, Zapisz tabeli, klikając ikonę Zapisz na pasku narzędzi.</span><span class="sxs-lookup"><span data-stu-id="0e079-162">After adding the `UserId` column, save the table by clicking on the Save icon in the Toolbar.</span></span> <span data-ttu-id="0e079-163">Nazwa nowej tabeli `GuestbookComments`.</span><span class="sxs-lookup"><span data-stu-id="0e079-163">Name the new table `GuestbookComments`.</span></span>

<span data-ttu-id="0e079-164">Mamy jednego ostatniego problemu, aby zająć się z `GuestbookComments` tabeli: należy utworzyć [ograniczenie klucza obcego](https://msdn.microsoft.com/library/ms175464.aspx) między `GuestbookComments.UserId` kolumny i `aspnet_Users.UserId` kolumny.</span><span class="sxs-lookup"><span data-stu-id="0e079-164">We have one last issue to attend to with the `GuestbookComments` table: we need to create a [foreign key constraint](https://msdn.microsoft.com/library/ms175464.aspx) between the `GuestbookComments.UserId` column and the `aspnet_Users.UserId` column.</span></span> <span data-ttu-id="0e079-165">Aby to osiągnąć, kliknij ikonę relacji w pasku narzędzi, aby uruchomić okno dialogowe relacje klucza obcego.</span><span class="sxs-lookup"><span data-stu-id="0e079-165">To achieve this, click the Relationship icon in the Toolbar to launch the Foreign Key Relationships dialog box.</span></span> <span data-ttu-id="0e079-166">(Można również będzie można uruchomić tego okna dialogowego, przechodząc do menu projektanta tabel i wybierając relacje.)</span><span class="sxs-lookup"><span data-stu-id="0e079-166">(Alternatively, you can launch this dialog box by going to the Table Designer menu and choosing Relationships.)</span></span>

<span data-ttu-id="0e079-167">Kliknij przycisk Dodaj w lewym dolnym rogu okna dialogowego relacje klucza obcego.</span><span class="sxs-lookup"><span data-stu-id="0e079-167">Click the Add button in the lower left corner of the Foreign Key Relationships dialog box.</span></span> <span data-ttu-id="0e079-168">Spowoduje to dodanie nowego ograniczenie klucza obcego, mimo że nadal trzeba zdefiniować tabel uczestniczących w relacji.</span><span class="sxs-lookup"><span data-stu-id="0e079-168">This will add a new foreign key constraint, although we still need to define the tables that participate in the relationship.</span></span>


<span data-ttu-id="0e079-169">[![Użyj okna dialogowego relacje klucza obcego do zarządzania ograniczeń klucza obcego w tabeli](storing-additional-user-information-vb/_static/image8.png)](storing-additional-user-information-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="0e079-169">[![Use the Foreign Key Relationships Dialog Box to Manage a Table's Foreign Key Constraints](storing-additional-user-information-vb/_static/image8.png)](storing-additional-user-information-vb/_static/image7.png)</span></span>

<span data-ttu-id="0e079-170">**Rysunek 3**: umożliwia zarządzanie ograniczeń klucza obcego w tabeli w oknie dialogowym relacji klucza obcego ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](storing-additional-user-information-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="0e079-170">**Figure 3**: Use the Foreign Key Relationships Dialog Box to Manage a Table's Foreign Key Constraints  ([Click to view full-size image](storing-additional-user-information-vb/_static/image9.png))</span></span>


<span data-ttu-id="0e079-171">Następnie kliknij ikonę elipsy w wierszu "I kolumny specyfikacje tabeli" po prawej stronie.</span><span class="sxs-lookup"><span data-stu-id="0e079-171">Next, click the ellipses icon in the "Table and Columns Specifications" row on the right.</span></span> <span data-ttu-id="0e079-172">Spowoduje to uruchomienie tabele i kolumny, okno dialogowe, w którym można określić tabeli klucza podstawowego i kolumny i kolumny klucza obcego z `GuestbookComments` tabeli.</span><span class="sxs-lookup"><span data-stu-id="0e079-172">This will launch the Tables and Columns dialog box, from which we can specify the primary key table and column and the foreign key column from the `GuestbookComments` table.</span></span> <span data-ttu-id="0e079-173">W szczególności należy wybrać `aspnet_Users` i `UserId` jako tabeli klucza podstawowego i kolumny, a `UserId` z `GuestbookComments` tabeli co kolumna klucza obcego (patrz rysunek 4).</span><span class="sxs-lookup"><span data-stu-id="0e079-173">In particular, select `aspnet_Users` and `UserId` as the primary key table and column, and `UserId` from the `GuestbookComments` table as the foreign key column (see Figure 4).</span></span> <span data-ttu-id="0e079-174">Po zdefiniowaniu podstawowe i obce klucza tabel i kolumn, kliknij przycisk OK, aby powrócić do okna dialogowego relacje klucza obcego.</span><span class="sxs-lookup"><span data-stu-id="0e079-174">After defining the primary and foreign key tables and columns, click OK to return to the Foreign Key Relationships dialog box.</span></span>


<span data-ttu-id="0e079-175">[![Tworzą i obcego klucza ograniczenia między aspnet_Users GuesbookComments tabel](storing-additional-user-information-vb/_static/image11.png)](storing-additional-user-information-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="0e079-175">[![Establish a Foreign Key Constraint Between the aspnet_Users and GuesbookComments Tables](storing-additional-user-information-vb/_static/image11.png)](storing-additional-user-information-vb/_static/image10.png)</span></span>

<span data-ttu-id="0e079-176">**Rysunek 4**: ustanowić obcego klucza ograniczenia między `aspnet_Users` i `GuesbookComments` tabele ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](storing-additional-user-information-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="0e079-176">**Figure 4**: Establish a Foreign Key Constraint Between the `aspnet_Users` and `GuesbookComments` Tables  ([Click to view full-size image](storing-additional-user-information-vb/_static/image12.png))</span></span>


<span data-ttu-id="0e079-177">W tym momencie została ustanowiona ograniczenie klucza obcego.</span><span class="sxs-lookup"><span data-stu-id="0e079-177">At this point the foreign key constraint has been established.</span></span> <span data-ttu-id="0e079-178">Zapewnia obecności tego ograniczenia [relacyjna integralność](http://en.wikipedia.org/wiki/Referential_integrity) między dwiema tabelami, gwarantując, że nigdy nie będzie wpisu księgi gości, odwołujący się do konta użytkownika nie istnieje.</span><span class="sxs-lookup"><span data-stu-id="0e079-178">The presence of this constraint ensures [relational integrity](http://en.wikipedia.org/wiki/Referential_integrity) between the two tables by guaranteeing that there will never be a guestbook entry referring to a non-existent user account.</span></span> <span data-ttu-id="0e079-179">Domyślnie ograniczenie klucza obcego uniemożliwi rekord nadrzędny ma zostać usunięty, jeśli istnieją odpowiadające im rekordów podrzędnych.</span><span class="sxs-lookup"><span data-stu-id="0e079-179">By default, a foreign key constraint will disallow a parent record to be deleted if there are corresponding child records.</span></span> <span data-ttu-id="0e079-180">Oznacza to, że użytkownik tworzy co najmniej jeden komentarz księgi gości, a następnie spróbuj możemy można usunąć tego konta użytkownika, Usuń zakończy się niepowodzeniem, chyba że najpierw zostaną usunięte jego komentarze księgi gości.</span><span class="sxs-lookup"><span data-stu-id="0e079-180">That is, if a user makes one or more guestbook comments, and then we attempt to delete that user account, the delete will fail unless his guestbook comments are deleted first.</span></span>

<span data-ttu-id="0e079-181">Ograniczenia klucza obcego można skonfigurować do automatycznego usuwania rekordów podrzędnych usunięcie rekordu nadrzędnego.</span><span class="sxs-lookup"><span data-stu-id="0e079-181">Foreign key constraints can be configured to automatically delete the associated child records when a parent record is deleted.</span></span> <span data-ttu-id="0e079-182">Innymi słowy będziemy konfigurować to ograniczenie klucza obcego, dzięki czemu wpisów księgi gości są automatycznie usuwane, gdy konto użytkownika zostanie usunięta.</span><span class="sxs-lookup"><span data-stu-id="0e079-182">In other words, we can setup this foreign key constraint so that a user's guestbook entries are automatically deleted when her user account is deleted.</span></span> <span data-ttu-id="0e079-183">Aby to zrobić, rozwiń sekcję "INSERT i UPDATE specyfikacji" i ustaw dla właściwości "Usuń regułę" Cascade.</span><span class="sxs-lookup"><span data-stu-id="0e079-183">To accomplish this, expand the "INSERT And UPDATE Specification" section and set the "Delete Rule" property to Cascade.</span></span>


<span data-ttu-id="0e079-184">[![Konfiguruj ograniczenie klucza obcego do kaskadowo](storing-additional-user-information-vb/_static/image14.png)](storing-additional-user-information-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="0e079-184">[![Configure the Foreign Key Constraint to Cascade Deletes](storing-additional-user-information-vb/_static/image14.png)](storing-additional-user-information-vb/_static/image13.png)</span></span>

<span data-ttu-id="0e079-185">**Rysunek 5**: skonfigurować ograniczenie klucza obcego do kaskadowe ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](storing-additional-user-information-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="0e079-185">**Figure 5**: Configure the Foreign Key Constraint to Cascade Deletes  ([Click to view full-size image](storing-additional-user-information-vb/_static/image15.png))</span></span>


<span data-ttu-id="0e079-186">Aby zapisać ograniczenie klucza obcego, kliknij przycisk Zamknij, aby zakończyć poza relacje klucza obcego.</span><span class="sxs-lookup"><span data-stu-id="0e079-186">To save the foreign key constraint, click the Close button to exit out of the Foreign Key Relationships.</span></span> <span data-ttu-id="0e079-187">Kliknij ikonę Zapisz w pasku narzędzi, aby zapisać tabeli i jego relacji.</span><span class="sxs-lookup"><span data-stu-id="0e079-187">Then click the Save icon in the Toolbar to save the table and the this relationship.</span></span>

### <a name="storing-the-users-home-town-homepage-and-signature"></a><span data-ttu-id="0e079-188">Przechowywanie miejscowość głównej, strony głównej i podpis użytkownika</span><span class="sxs-lookup"><span data-stu-id="0e079-188">Storing the User's Home Town, Homepage, and Signature</span></span>

<span data-ttu-id="0e079-189">`GuestbookComments` Tabeli przedstawiono sposób przechowywania informacji, która udostępnia relacji jeden do wielu kont użytkowników.</span><span class="sxs-lookup"><span data-stu-id="0e079-189">The `GuestbookComments` table illustrates how to store information that shares a one-to-many relationship with user accounts.</span></span> <span data-ttu-id="0e079-190">Ponieważ wszystkie konta użytkowników mogą mieć dowolną liczbę skojarzonych z nimi komentarzy, ta relacja jest modelowana, tworząc tabelę do przechowywania zestaw komentarz, który zawiera kolumnę, że linki kopię każdego komentarza dla określonego użytkownika.</span><span class="sxs-lookup"><span data-stu-id="0e079-190">Since each user account may have an arbitrary number of associated comments, this relationship is modeled by creating a table to hold the set of comments that includes a column that links back each comment to a particular user.</span></span> <span data-ttu-id="0e079-191">Korzystając z `SqlMembershipProvider`, tworząc kolumny o nazwie ustanowieniu tego połączenia będzie najlepiej `UserId` typu `uniqueidentifier` i ograniczenie klucza obcego między tej kolumny i `aspnet_Users.UserId`.</span><span class="sxs-lookup"><span data-stu-id="0e079-191">When using the `SqlMembershipProvider`, this link is best established by creating a column named `UserId` of type `uniqueidentifier` and a foreign key constraint between this column and `aspnet_Users.UserId`.</span></span>

<span data-ttu-id="0e079-192">Teraz musisz skojarzyć trzy kolumny z każdego konta użytkownika do przechowywania podpisu, który pojawi się w jego komentarze księgi gości, strony głównej i miejscowość macierzystego użytkownika.</span><span class="sxs-lookup"><span data-stu-id="0e079-192">We now need to associate three columns with each user account to store the user's home town, homepage, and signature, which will appear in his guestbook comments.</span></span> <span data-ttu-id="0e079-193">Istnieją różne sposoby, w tym celu — liczba:</span><span class="sxs-lookup"><span data-stu-id="0e079-193">There are number of different ways to accomplish this:</span></span>

- <span data-ttu-id="0e079-194"><strong>Dodaj nowe kolumny</strong><strong>`aspnet_Users`</strong><strong>lub</strong><strong>`aspnet_Membership`</strong><strong>tabel.</strong></span><span class="sxs-lookup"><span data-stu-id="0e079-194"><strong>Add new columns to the</strong><strong>`aspnet_Users`</strong><strong>or</strong><strong>`aspnet_Membership`</strong><strong>tables.</strong></span></span> <span data-ttu-id="0e079-195">I czy zaleca takie podejście, ponieważ modyfikuje Schemat używany przez `SqlMembershipProvider`.</span><span class="sxs-lookup"><span data-stu-id="0e079-195">I would not recommend this approach because it modifies the schema used by the `SqlMembershipProvider`.</span></span> <span data-ttu-id="0e079-196">Ta decyzja może wrócić do mogły spowodować szkód występujących.</span><span class="sxs-lookup"><span data-stu-id="0e079-196">This decision may come back to haunt you down the road.</span></span> <span data-ttu-id="0e079-197">Na przykład, co w przypadku przyszłych wersjach programu ASP.NET używa innej `SqlMembershipProvider` schematu.</span><span class="sxs-lookup"><span data-stu-id="0e079-197">For example, what if a future version of ASP.NET uses a different `SqlMembershipProvider` schema.</span></span> <span data-ttu-id="0e079-198">Microsoft może obejmować narzędzia do migracji programu ASP.NET 2.0 `SqlMembershipProvider` danych do nowego schematu, ale jeśli zmodyfikowano ASP.NET 2.0 `SqlMembershipProvider` schematu, takie Konwersja może nie być możliwe.</span><span class="sxs-lookup"><span data-stu-id="0e079-198">Microsoft may include a tool to migrate the ASP.NET 2.0 `SqlMembershipProvider` data to the new schema, but if you have modified the ASP.NET 2.0 `SqlMembershipProvider` schema, such a conversion may not be possible.</span></span>

- <span data-ttu-id="0e079-199">**Użyj ASP. NET w profilu platformy, definiowanie właściwości profilu miejscowość macierzystego, strony głównej i podpis.**</span><span class="sxs-lookup"><span data-stu-id="0e079-199">**Use ASP.NET's Profile framework, defining a profile property for the home town, homepage, and signature.**</span></span> <span data-ttu-id="0e079-200">Program ASP.NET zawiera framework profil, który służy do przechowywania dodatkowe dane specyficzne dla użytkownika.</span><span class="sxs-lookup"><span data-stu-id="0e079-200">ASP.NET includes a Profile framework that is designed to store additional user-specific data.</span></span> <span data-ttu-id="0e079-201">Jak framework członkostwa w ramach profilu została stworzona z modelu dostawcy.</span><span class="sxs-lookup"><span data-stu-id="0e079-201">Like the Membership framework, the Profile framework is built atop the provider model.</span></span> <span data-ttu-id="0e079-202">.NET Framework jest dostarczany z `SqlProfileProvider` czy magazyny profilu danych w bazie danych programu SQL Server.</span><span class="sxs-lookup"><span data-stu-id="0e079-202">The .NET Framework ships with a `SqlProfileProvider` that stores profile data in a SQL Server database.</span></span> <span data-ttu-id="0e079-203">W rzeczywistości w naszej bazie danych ma już tabeli używanej przez `SqlProfileProvider` (`aspnet_Profile`), ponieważ zostało dodane, gdy dodaliśmy usług aplikacji ponownie [ *tworzenie schematu członkostwa w programie SQL Server* ](creating-the-membership-schema-in-sql-server-vb.md)samouczka.</span><span class="sxs-lookup"><span data-stu-id="0e079-203">In fact, our database already has the table used by the `SqlProfileProvider` (`aspnet_Profile`), as it was added when we added the application services back in the [*Creating the Membership Schema in SQL Server*](creating-the-membership-schema-in-sql-server-vb.md) tutorial.</span></span>   
  <span data-ttu-id="0e079-204">Największą zaletą framework profilu jest umożliwia deweloperom do definiowania właściwości profilu `Web.config` — żaden kod nie trzeba napisać do serializowania danych profilu do i z odpowiedni magazyn danych.</span><span class="sxs-lookup"><span data-stu-id="0e079-204">The main benefit of the Profile framework is that it allows for developers to define the profile properties in `Web.config` – no code needs to be written to serialize the profile data to and from the underlying data store.</span></span> <span data-ttu-id="0e079-205">Krótko mówiąc jest bardzo łatwe do zdefiniowania zestawu właściwości profilu i pracować z nimi w kodzie.</span><span class="sxs-lookup"><span data-stu-id="0e079-205">In short, it is incredibly easy to define a set of profile properties and to work with them in code.</span></span> <span data-ttu-id="0e079-206">Jednak system profilu opuszcza się konieczne, jeśli chodzi o wersji, tak więc jeśli korzystasz z aplikacji, w którym oczekujesz nowe właściwości specyficzne dla użytkownika do dodania w późniejszym czasie lub istniejące ma zostać usunięta lub zmodyfikowana, a następnie framework profilu nie może być  najlepszym rozwiązaniem.</span><span class="sxs-lookup"><span data-stu-id="0e079-206">However, the Profile system leaves a lot to be desired when it comes to versioning, so if you have an application where you expect new user-specific properties to be added at a later time, or existing ones to be removed or modified, then the Profile framework may not be the best option.</span></span> <span data-ttu-id="0e079-207">Ponadto `SqlProfileProvider` przechowuje właściwości profilu w sposób wysokiej nieznormalizowany, uniemożliwiając dalej do wykonywania kwerend bezpośrednio do profilu danych (takich jak, ilu użytkowników mają macierzysty miejscowość z nowego Jorku).</span><span class="sxs-lookup"><span data-stu-id="0e079-207">Moreover, the `SqlProfileProvider` stores the profile properties in a highly denormalized fashion, making it next to impossible to run queries directly against the profile data (such as, how many users have a home town of New York).</span></span>   
  <span data-ttu-id="0e079-208">Aby uzyskać więcej informacji w ramach profilu zapoznaj się w sekcji "Dalsze odczytów" na końcu tego samouczka.</span><span class="sxs-lookup"><span data-stu-id="0e079-208">For more information on the Profile framework, consult the "Further Readings" section at the end of this tutorial.</span></span>

- <span data-ttu-id="0e079-209"><strong>Dodaj te trzy kolumny do nowej tabeli w bazie danych i ustanowienia relacją między tej tabeli i</strong><strong>`aspnet_Users`</strong><strong>.</strong></span><span class="sxs-lookup"><span data-stu-id="0e079-209"><strong>Add these three columns to a new table in the database and establish a one-to-one relationship between this table and</strong><strong>`aspnet_Users`</strong><strong>.</strong></span></span> <span data-ttu-id="0e079-210">Ta metoda wymaga nieco więcej pracy niż Framework profilu, ale oferuje maksymalną elastyczność w sposób właściwości użytkownika dodatkowe są modelowane w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="0e079-210">This approach involves a bit more work than with the Profile framework, but offers maximum flexibility in how the additional user properties are modeled in the database.</span></span> <span data-ttu-id="0e079-211">Jest to opcja, które będą używane w tym samouczku.</span><span class="sxs-lookup"><span data-stu-id="0e079-211">This is the option we will use in this tutorial.</span></span>

<span data-ttu-id="0e079-212">Utworzymy nową tabelę o nazwie `UserProfiles` zapisać miejscowość macierzystego, strony głównej i podpis dla każdego użytkownika.</span><span class="sxs-lookup"><span data-stu-id="0e079-212">We will create a new table called `UserProfiles` to save the home town, homepage, and signature for each user.</span></span> <span data-ttu-id="0e079-213">Kliknij prawym przyciskiem folder tabel w oknie Eksploratora bazy danych i wybrać opcję utworzenia nowej tabeli.</span><span class="sxs-lookup"><span data-stu-id="0e079-213">Right-click on the Tables folder in the Database Explorer window and choose to create a new table.</span></span> <span data-ttu-id="0e079-214">Nazwa pierwszej kolumny `UserId` i Ustaw typ `uniqueidentifier`.</span><span class="sxs-lookup"><span data-stu-id="0e079-214">Name the first column `UserId` and set its type to `uniqueidentifier`.</span></span> <span data-ttu-id="0e079-215">Nie zezwalaj na `NULL` wartości i oznacz kolumnę jako klucz podstawowy.</span><span class="sxs-lookup"><span data-stu-id="0e079-215">Disallow `NULL` values and mark the column as a primary key.</span></span> <span data-ttu-id="0e079-216">Następnie należy dodać kolumny o nazwie: `HomeTown` typu `nvarchar(50)`; `HomepageUrl` typu `nvarchar(100)`; i podpis typu `nvarchar(500)`.</span><span class="sxs-lookup"><span data-stu-id="0e079-216">Next, add columns named: `HomeTown` of type `nvarchar(50)`; `HomepageUrl` of type `nvarchar(100)`; and Signature of type `nvarchar(500)`.</span></span> <span data-ttu-id="0e079-217">Każda z tych trzech kolumn może akceptować `NULL` wartość.</span><span class="sxs-lookup"><span data-stu-id="0e079-217">Each of these three columns can accept a `NULL` value.</span></span>


<span data-ttu-id="0e079-218">[![Utwórz tabelę UserProfiles](storing-additional-user-information-vb/_static/image17.png)](storing-additional-user-information-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="0e079-218">[![Create the UserProfiles Table](storing-additional-user-information-vb/_static/image17.png)](storing-additional-user-information-vb/_static/image16.png)</span></span>

<span data-ttu-id="0e079-219">**Rysunek 6**: tworzenie `UserProfiles` tabeli ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](storing-additional-user-information-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="0e079-219">**Figure 6**: Create the `UserProfiles` Table  ([Click to view full-size image](storing-additional-user-information-vb/_static/image18.png))</span></span>


<span data-ttu-id="0e079-220">Zapisywanie tabeli i nadaj mu nazwę `UserProfiles`.</span><span class="sxs-lookup"><span data-stu-id="0e079-220">Save the table and name it `UserProfiles`.</span></span> <span data-ttu-id="0e079-221">Ponadto ustanowić ograniczenie klucza obcego między `UserProfiles` tabeli `UserId` pola i `aspnet_Users.UserId` pola.</span><span class="sxs-lookup"><span data-stu-id="0e079-221">Lastly, establish a foreign key constraint between the `UserProfiles` table's `UserId` field and the `aspnet_Users.UserId` field.</span></span> <span data-ttu-id="0e079-222">Jak robiliśmy z ograniczenie klucza obcego między `GuestbookComments` i `aspnet_Users` tabele, mieć to ograniczenie kaskadowo usuwa.</span><span class="sxs-lookup"><span data-stu-id="0e079-222">As we did with the foreign key constraint between the `GuestbookComments` and `aspnet_Users` tables, have this constraint cascade deletes.</span></span> <span data-ttu-id="0e079-223">Ponieważ `UserId` w `UserProfiles` jest serwerem podstawowym klucza, gwarantuje to, że będą istnieć co najwyżej jeden rekord w `UserProfiles` tabeli dla każdego konta użytkownika.</span><span class="sxs-lookup"><span data-stu-id="0e079-223">Since the `UserId` field in `UserProfiles` is the primary key, this ensures that there will be no more than one record in the `UserProfiles` table for each user account.</span></span> <span data-ttu-id="0e079-224">Ten typ relacji jest określana jako jeden.</span><span class="sxs-lookup"><span data-stu-id="0e079-224">This type of relationship is referred to as one-to-one.</span></span>

<span data-ttu-id="0e079-225">Teraz, gdy mamy modelu danych tworzone są nam będzie go.</span><span class="sxs-lookup"><span data-stu-id="0e079-225">Now that we have the data model created, we are ready to use it.</span></span> <span data-ttu-id="0e079-226">Kroki 2 i 3 przedstawiono, jak wyświetlić i edytować macierzystego informacji o ich miejscowość, strony głównej i podpis aktualnie zalogowanego użytkownika.</span><span class="sxs-lookup"><span data-stu-id="0e079-226">In Steps 2 and 3 we will look at how the currently logged on user can view and edit their home town, homepage, and signature information.</span></span> <span data-ttu-id="0e079-227">Interfejs dla uwierzytelnionych użytkowników przesłać nowe komentarze do księgi gości i wyświetlić istniejące zostanie utworzony w kroku 4.</span><span class="sxs-lookup"><span data-stu-id="0e079-227">In Step 4 we will create the interface for authenticated users to submit new comments to the guestbook and view the existing ones.</span></span>

## <a name="step-2-displaying-the-users-home-town-homepage-and-signature"></a><span data-ttu-id="0e079-228">Krok 2: Wyświetlanie miejscowość głównej, strony głównej i podpis użytkownika</span><span class="sxs-lookup"><span data-stu-id="0e079-228">Step 2: Displaying the User's Home Town, Homepage, and Signature</span></span>

<span data-ttu-id="0e079-229">Istnieje wiele sposobów, aby umożliwić aktualnie zalogowanego użytkownika wyświetlić i edytować jego macierzystego informacje miejscowość, strony głównej i podpis.</span><span class="sxs-lookup"><span data-stu-id="0e079-229">There are a variety of ways to allow the currently logged on user to view and edit his home town, homepage, and signature information.</span></span> <span data-ttu-id="0e079-230">Można ręcznie utworzyć interfejsu użytkownika z polem tekstowym i formantów etykiet lub firma Microsoft może użyć jednej z danych formantów sieci Web, takich jak kontrola widoku DetailsView.</span><span class="sxs-lookup"><span data-stu-id="0e079-230">We could manually create the user interface with TextBox and Label controls or we could use one of the data Web controls, such as the DetailsView control.</span></span> <span data-ttu-id="0e079-231">Do wykonania w bazie danych `SELECT` i `UPDATE` instrukcje firma Microsoft może zapisać ADO.NET kod w klasie związanej z kodem naszą stronę lub można również stosować deklaratywne podejścia z SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="0e079-231">To perform the database `SELECT` and `UPDATE` statements we could write ADO.NET code in our page's code-behind class or, alternatively, employ a declarative approach with the SqlDataSource.</span></span> <span data-ttu-id="0e079-232">W idealnym przypadku naszej aplikacji może zawierać architektury warstwowych, firma Microsoft może to wywołać programowo z klasy związane z kodem strony lub deklaratywnie za pomocą kontrolki ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="0e079-232">Ideally our application would contain a tiered architecture, which we could either invoke programmatically from the page's code-behind class or declaratively via the ObjectDataSource control.</span></span>

<span data-ttu-id="0e079-233">Ponieważ ta seria samouczek koncentruje się na uwierzytelnianie formularzy, autoryzacji, kont użytkowników i role, nie zostanie dogłębną dyskusję te opcje dostępu do danych lub dlaczego architektura warstwowego jest preferowane bezpośrednio wykonywania instrukcji SQL na stronie platformy ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="0e079-233">Since this tutorial series focuses on forms authentication, authorization, user accounts, and roles, there will not be a thorough discussion of these different data access options or why a tiered architecture is preferred over executing SQL statements directly from the ASP.NET page.</span></span> <span data-ttu-id="0e079-234">Użyjemy przeprowadzenie przy użyciu widoku DetailsView i SqlDataSource — opcja najszybszym i najprostszym —, ale kwestie omówione pewnością można zastosować do alternatywnego logiki sieci Web formantów i dane dostępu.</span><span class="sxs-lookup"><span data-stu-id="0e079-234">I am going to walk through using a DetailsView and SqlDataSource – the quickest and easiest option – but the concepts discussed can certainly be applied to alternative Web controls and data access logic.</span></span> <span data-ttu-id="0e079-235">Aby uzyskać więcej informacji na temat pracy z danymi w programie ASP.NET odwoływać się do mojej *[Praca z danymi w programie ASP.NET 2.0](../../data-access/index.md)* samouczka serii.</span><span class="sxs-lookup"><span data-stu-id="0e079-235">For more information on working with data in ASP.NET, refer to my *[Working with Data in ASP.NET 2.0](../../data-access/index.md)* tutorial series.</span></span>

<span data-ttu-id="0e079-236">Otwórz `AdditionalUserInfo.aspx` strony `Membership` folderu i Dodaj do strony, ustawienie dla jego właściwości ID formantu widoku DetailsView `UserProfile` i wyczyszczenie jego `Width` i `Height` właściwości.</span><span class="sxs-lookup"><span data-stu-id="0e079-236">Open the `AdditionalUserInfo.aspx` page in the `Membership` folder and add a DetailsView control to the page, setting its ID property to `UserProfile` and clearing out its `Width` and `Height` properties.</span></span> <span data-ttu-id="0e079-237">Rozwiń tagów inteligentnych DetailsView i wybierz powiązać go z formantem źródła danych.</span><span class="sxs-lookup"><span data-stu-id="0e079-237">Expand the DetailsView's Smart Tag and choose to bind it to a new data source control.</span></span> <span data-ttu-id="0e079-238">Zostanie uruchomiony Kreator konfiguracji źródła danych (patrz rysunek 7).</span><span class="sxs-lookup"><span data-stu-id="0e079-238">This will launch the DataSource Configuration Wizard (see Figure 7).</span></span> <span data-ttu-id="0e079-239">Pierwszym krokiem prośba o Określ typ źródła danych.</span><span class="sxs-lookup"><span data-stu-id="0e079-239">The first step asks you to specify the data source type.</span></span> <span data-ttu-id="0e079-240">Ponieważ zamierzamy Połącz bezpośrednio do `SecurityTutorials` bazy danych, wybierz ikonę bazy danych, określając `ID` jako `UserProfileDataSource`.</span><span class="sxs-lookup"><span data-stu-id="0e079-240">Since we are going to connect directly to the `SecurityTutorials` database, choose the Database icon, specifying the `ID` as `UserProfileDataSource`.</span></span>


<span data-ttu-id="0e079-241">[![Dodaj formant SqlDataSource o nazwie UserProfileDataSource](storing-additional-user-information-vb/_static/image20.png)](storing-additional-user-information-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="0e079-241">[![Add a New SqlDataSource Control Named UserProfileDataSource](storing-additional-user-information-vb/_static/image20.png)](storing-additional-user-information-vb/_static/image19.png)</span></span>

<span data-ttu-id="0e079-242">**Rysunek 7**: Dodaj nowe kontrolki SqlDataSource, o nazwie `UserProfileDataSource` ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](storing-additional-user-information-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="0e079-242">**Figure 7**: Add a New SqlDataSource Control Named `UserProfileDataSource` ([Click to view full-size image](storing-additional-user-information-vb/_static/image21.png))</span></span>


<span data-ttu-id="0e079-243">Następnym ekranie wyświetli monit o bazy danych.</span><span class="sxs-lookup"><span data-stu-id="0e079-243">The next screen prompts for the database to use.</span></span> <span data-ttu-id="0e079-244">Parametry połączenia w został już zdefiniowany `Web.config` dla `SecurityTutorials` bazy danych.</span><span class="sxs-lookup"><span data-stu-id="0e079-244">We have already defined a connection string in `Web.config` for the `SecurityTutorials` database.</span></span> <span data-ttu-id="0e079-245">Nazwa parametrów połączenia — `SecurityTutorialsConnectionString` — powinien znajdować się na liście rozwijanej.</span><span class="sxs-lookup"><span data-stu-id="0e079-245">This connection string name – `SecurityTutorialsConnectionString` – should be in the drop-down list.</span></span> <span data-ttu-id="0e079-246">Wybierz tę opcję i kliknij przycisk Dalej.</span><span class="sxs-lookup"><span data-stu-id="0e079-246">Select this option and click Next.</span></span>


<span data-ttu-id="0e079-247">[![Z listy rozwijanej wybierz SecurityTutorialsConnectionString](storing-additional-user-information-vb/_static/image23.png)](storing-additional-user-information-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="0e079-247">[![Choose SecurityTutorialsConnectionString from the Drop-Down List](storing-additional-user-information-vb/_static/image23.png)](storing-additional-user-information-vb/_static/image22.png)</span></span>

<span data-ttu-id="0e079-248">**Rysunek 8**: Wybierz `SecurityTutorialsConnectionString` z listy rozwijanej ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](storing-additional-user-information-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="0e079-248">**Figure 8**: Choose `SecurityTutorialsConnectionString` from the Drop-Down List  ([Click to view full-size image](storing-additional-user-information-vb/_static/image24.png))</span></span>


<span data-ttu-id="0e079-249">Kolejne ekranu zapyta firmie Microsoft w celu określenia tabel i kolumn w zapytaniu.</span><span class="sxs-lookup"><span data-stu-id="0e079-249">The subsequent screen asks us to specify the table and columns to query.</span></span> <span data-ttu-id="0e079-250">Wybierz `UserProfiles` tabeli z listy rozwijanej i sprawdź wszystkie kolumny.</span><span class="sxs-lookup"><span data-stu-id="0e079-250">Choose the `UserProfiles` table from the drop-down list and check all of the columns.</span></span>


<span data-ttu-id="0e079-251">[![Przełącz kopię wszystkich kolumn z tabeli UserProfiles](storing-additional-user-information-vb/_static/image26.png)](storing-additional-user-information-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="0e079-251">[![Bring Back All of the Columns from the UserProfiles Table](storing-additional-user-information-vb/_static/image26.png)](storing-additional-user-information-vb/_static/image25.png)</span></span>

<span data-ttu-id="0e079-252">**Rysunek 9**: przełącz ponownie wszystkie kolumny `UserProfiles` tabeli ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](storing-additional-user-information-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="0e079-252">**Figure 9**: Bring Back All of the Columns from the `UserProfiles` Table  ([Click to view full-size image](storing-additional-user-information-vb/_static/image27.png))</span></span>


<span data-ttu-id="0e079-253">Bieżącego zapytania w zwraca na rysunku nr 9 *wszystkie* rekordów `UserProfiles`, ale opiszemy tylko w rekordzie aktualnie zalogowanego użytkownika.</span><span class="sxs-lookup"><span data-stu-id="0e079-253">The current query in Figure 9 returns *all* of the records in `UserProfiles`, but we are only interested in the currently logged on user's record.</span></span> <span data-ttu-id="0e079-254">Aby dodać `WHERE` klauzuli, kliknij przycisk `WHERE` przycisk, aby wyświetlić Dodaj `WHERE` klauzuli dialogowym (zobacz rysunek 10).</span><span class="sxs-lookup"><span data-stu-id="0e079-254">To add a `WHERE` clause, click the `WHERE` button to bring up the Add `WHERE` Clause dialog box (see Figure 10).</span></span> <span data-ttu-id="0e079-255">Tutaj możesz wybierać kolumny do filtrowania, operator i źródła parametru filtru.</span><span class="sxs-lookup"><span data-stu-id="0e079-255">Here you can select the column to filter on, the operator, and the source of the filter parameter.</span></span> <span data-ttu-id="0e079-256">Wybierz `UserId` jako kolumny i "=" jako operatora.</span><span class="sxs-lookup"><span data-stu-id="0e079-256">Select `UserId` as the column and "=" as the Operator.</span></span>

<span data-ttu-id="0e079-257">Niestety nie istnieje źródło parametru wbudowanych do zwrócenia aktualnie zalogowanego użytkownika `UserId` wartość.</span><span class="sxs-lookup"><span data-stu-id="0e079-257">Unfortunately there is no built-in parameter source to return the currently logged on user's `UserId` value.</span></span> <span data-ttu-id="0e079-258">Musimy programowo pobrania tej wartości.</span><span class="sxs-lookup"><span data-stu-id="0e079-258">We will need to grab this value programmatically.</span></span> <span data-ttu-id="0e079-259">W związku z tym Ustaw listy rozwijanej źródła na "Brak," kliknij przycisk Dodaj przycisk, aby dodać parametr, a następnie kliknij przycisk OK.</span><span class="sxs-lookup"><span data-stu-id="0e079-259">Therefore, set the Source drop-down list to "None," click the Add button to add the parameter, and then click OK.</span></span>


<span data-ttu-id="0e079-260">[![Dodaj parametr filtru w kolumnie identyfikator użytkownika](storing-additional-user-information-vb/_static/image29.png)](storing-additional-user-information-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="0e079-260">[![Add a Filter Parameter on the UserId Column](storing-additional-user-information-vb/_static/image29.png)](storing-additional-user-information-vb/_static/image28.png)</span></span>

<span data-ttu-id="0e079-261">**Na rysunku nr 10**: Dodaj parametr filtru na `UserId` kolumny ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](storing-additional-user-information-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="0e079-261">**Figure 10**: Add a Filter Parameter on the `UserId` Column  ([Click to view full-size image](storing-additional-user-information-vb/_static/image30.png))</span></span>


<span data-ttu-id="0e079-262">Po kliknięciu przycisku OK powrócisz do ekranu pokazano na rysunku 9.</span><span class="sxs-lookup"><span data-stu-id="0e079-262">After clicking OK you will be returned to the screen shown in Figure 9.</span></span> <span data-ttu-id="0e079-263">Teraz, jednak zapytanie SQL w dolnej części ekranu powinny zawierać `WHERE` klauzuli.</span><span class="sxs-lookup"><span data-stu-id="0e079-263">This time, however, the SQL query at the bottom of the screen should include a `WHERE` clause.</span></span> <span data-ttu-id="0e079-264">Kliknij przycisk Dalej, aby przejść do ekranu "Test zapytania".</span><span class="sxs-lookup"><span data-stu-id="0e079-264">Click Next to move on to the "Test Query" screen.</span></span> <span data-ttu-id="0e079-265">W tym miejscu można uruchomić zapytanie i wyświetlić wyniki.</span><span class="sxs-lookup"><span data-stu-id="0e079-265">Here you can run the query and see the results.</span></span> <span data-ttu-id="0e079-266">Kliknij przycisk Zakończ, aby zakończyć pracę kreatora.</span><span class="sxs-lookup"><span data-stu-id="0e079-266">Click Finish to complete the wizard.</span></span>

<span data-ttu-id="0e079-267">Po zakończeniu pracy Kreatora konfiguracji źródła danych programu Visual Studio tworzy kontrolkę SqlDataSource, na podstawie ustawień określonych w kreatorze.</span><span class="sxs-lookup"><span data-stu-id="0e079-267">Upon completing the DataSource Configuration Wizard, Visual Studio creates the SqlDataSource control based on the settings specified in the wizard.</span></span> <span data-ttu-id="0e079-268">Ponadto ręcznie dodaje BoundFields do widoku DetailsView dla każdej kolumny zwracane przez SqlDataSource `SelectCommand`.</span><span class="sxs-lookup"><span data-stu-id="0e079-268">Moreover, it manually adds BoundFields to the DetailsView for each column returned by the SqlDataSource's `SelectCommand`.</span></span> <span data-ttu-id="0e079-269">Nie istnieje potrzeba pokazanie `UserId` pola w widoku DetailsView, ponieważ użytkownik nie musi znać tej wartości.</span><span class="sxs-lookup"><span data-stu-id="0e079-269">There's no need to show the `UserId` field in the DetailsView, since the user does not need to know this value.</span></span> <span data-ttu-id="0e079-270">Można usunąć to pole bezpośrednio z poziomu znacznika deklaratywne kontrolki widoku szczegółów lub kliknij "Edytuj pola" łącze z jego tagów inteligentnych.</span><span class="sxs-lookup"><span data-stu-id="0e079-270">You can remove this field directly from the DetailsView control's declarative markup or by clicking the "Edit Fields" link from its Smart Tag.</span></span>

<span data-ttu-id="0e079-271">W tym momencie znaczników deklaratywne ze strony powinien wyglądać podobnie do następującego:</span><span class="sxs-lookup"><span data-stu-id="0e079-271">At this point your page's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](storing-additional-user-information-vb/samples/sample1.aspx)]

<span data-ttu-id="0e079-272">Musimy programowane Ustawianie formantu SqlDataSource `UserId` parametru aktualnie zalogowanego użytkownika `UserId` przed danych jest zaznaczone.</span><span class="sxs-lookup"><span data-stu-id="0e079-272">We need to programmatically set the SqlDataSource control's `UserId` parameter to the currently logged in user's `UserId` before the data is selected.</span></span> <span data-ttu-id="0e079-273">Można to zrobić, tworząc program obsługi zdarzeń dla SqlDataSource `Selecting` zdarzenia i dodanie poniższego kodu istnieje:</span><span class="sxs-lookup"><span data-stu-id="0e079-273">This can be accomplished by creating an event handler for the SqlDataSource's `Selecting` event and adding the following code there:</span></span>

[!code-vb[Main](storing-additional-user-information-vb/samples/sample2.vb)]

<span data-ttu-id="0e079-274">Powyższy kod uruchamia, uzyskując odwołanie do aktualnie zalogowanego użytkownika, wywołując `Membership` klasy `GetUser` metody.</span><span class="sxs-lookup"><span data-stu-id="0e079-274">The above code starts by obtaining a reference to the currently logged on user by calling the `Membership` class's `GetUser` method.</span></span> <span data-ttu-id="0e079-275">To polecenie zwróci `MembershipUser` obiektu, którego `ProviderUserKey` zawiera właściwość `UserId`.</span><span class="sxs-lookup"><span data-stu-id="0e079-275">This returns a `MembershipUser` object, whose `ProviderUserKey` property contains the `UserId`.</span></span> <span data-ttu-id="0e079-276">`UserId` Następnie przypisać wartości do SqlDataSource `@UserId` parametru.</span><span class="sxs-lookup"><span data-stu-id="0e079-276">The `UserId` value is then assigned to the SqlDataSource's `@UserId` parameter.</span></span>

> [!NOTE]
> <span data-ttu-id="0e079-277">`Membership.GetUser()` Metoda zwraca informacje o aktualnie zalogowanego użytkownika.</span><span class="sxs-lookup"><span data-stu-id="0e079-277">The `Membership.GetUser()` method returns information about the currently logged on user.</span></span> <span data-ttu-id="0e079-278">Jeśli użytkownik anonimowy odwiedzania strony, zwróci wartość `Nothing`.</span><span class="sxs-lookup"><span data-stu-id="0e079-278">If an anonymous user is visiting the page, it will return a value of `Nothing`.</span></span> <span data-ttu-id="0e079-279">W takim przypadku będzie to prowadzić do `NullReferenceException` na następujący wiersz kodu podczas próby odczytu `ProviderUserKey` właściwości.</span><span class="sxs-lookup"><span data-stu-id="0e079-279">In such a case, this will lead to a `NullReferenceException` on the following line of code when attempting to read the `ProviderUserKey` property.</span></span> <span data-ttu-id="0e079-280">Oczywiście nie trzeba martwić się o `Membership.GetUser()` zwracanie postanowienia `AdditionalUserInfo.aspx` strony, ponieważ został skonfigurowany Autoryzacja adresów URL z poprzedniego samouczka, dzięki czemu tylko uwierzytelnieni użytkownicy mogą uzyskiwać dostęp do zasobów ASP.NET w tym folderze.</span><span class="sxs-lookup"><span data-stu-id="0e079-280">Of course, we don't have to worry about `Membership.GetUser()` returning Nothing in the `AdditionalUserInfo.aspx` page because we configured URL authorization in a previous tutorial so that only authenticated users could access the ASP.NET resources in this folder.</span></span> <span data-ttu-id="0e079-281">Jeśli potrzebujesz dostępu do informacji o aktualnie zalogowanego użytkownika na stronie, gdy dostęp anonimowy jest dozwolone, upewnij się sprawdzić, czy `MembershipUser` obiektu zwróconego z `GetUser()` metoda nie ma nic przed jego właściwości odwołania.</span><span class="sxs-lookup"><span data-stu-id="0e079-281">If you need to access information about the currently logged on user in a page where anonymous access is permitted, make sure to check that the `MembershipUser` object returned from the `GetUser()` method is not Nothing before referencing its properties.</span></span>


<span data-ttu-id="0e079-282">W przypadku odwiedzenia `AdditionalUserInfo.aspx` strony za pośrednictwem przeglądarki zostanie wyświetlona strona puste, ponieważ mamy jeszcze żadnych wierszy, aby dodać `UserProfiles` tabeli.</span><span class="sxs-lookup"><span data-stu-id="0e079-282">If you visit the `AdditionalUserInfo.aspx` page through a browser you will see a blank page because we have yet to add any rows to the `UserProfiles` table.</span></span> <span data-ttu-id="0e079-283">W kroku 6 przedstawiono, jak dostosować formancie CreateUserWizard można automatycznie dodać nowy wiersz do `UserProfiles` tabeli po utworzeniu nowego konta użytkownika.</span><span class="sxs-lookup"><span data-stu-id="0e079-283">In Step 6 we will look at how to customize the CreateUserWizard control to automatically add a new row to the `UserProfiles` table when a new user account is created.</span></span> <span data-ttu-id="0e079-284">Jednak obecnie będzie należy ręcznie utworzyć rekord w tabeli.</span><span class="sxs-lookup"><span data-stu-id="0e079-284">For now, however, we will need to manually create a record in the table.</span></span>

<span data-ttu-id="0e079-285">Przejdź do Eksploratora bazy danych w programie Visual Studio, a następnie rozwiń folder tabel.</span><span class="sxs-lookup"><span data-stu-id="0e079-285">Navigate to the Database Explorer in Visual Studio and expand the Tables folder.</span></span> <span data-ttu-id="0e079-286">Kliknij prawym przyciskiem myszy `aspnet_Users` tabeli i wybierz opcję "Pokaż tabeli danych" Aby wyświetlić rekordy w tabeli, tak samo postąpić w `UserProfiles` tabeli.</span><span class="sxs-lookup"><span data-stu-id="0e079-286">Right-click on the `aspnet_Users` table and choose "Show Table Data" to see the records in the table; do the same thing for the `UserProfiles` table.</span></span> <span data-ttu-id="0e079-287">Rysunek 11 zawiera te wyniki podczas sąsiadująco w pionie.</span><span class="sxs-lookup"><span data-stu-id="0e079-287">Figure 11 shows these results when tiled vertically.</span></span> <span data-ttu-id="0e079-288">W bazie danych są obecnie `aspnet_Users` rekordy Bruce, Krzysztof i Tito, ale żadne rekordy w `UserProfiles` tabeli.</span><span class="sxs-lookup"><span data-stu-id="0e079-288">In my database there are currently `aspnet_Users` records for Bruce, Fred, and Tito, but no records in the `UserProfiles` table.</span></span>


<span data-ttu-id="0e079-289">[![Zawartość aspnet_Users i tabele UserProfiles są wyświetlane.](storing-additional-user-information-vb/_static/image32.png)](storing-additional-user-information-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="0e079-289">[![The Contents of the aspnet_Users and UserProfiles Tables are Displayed](storing-additional-user-information-vb/_static/image32.png)](storing-additional-user-information-vb/_static/image31.png)</span></span>

<span data-ttu-id="0e079-290">**Rysunek 11**: zawartość `aspnet_Users` i `UserProfiles` tabele są wyświetlane ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](storing-additional-user-information-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="0e079-290">**Figure 11**: The Contents of the `aspnet_Users` and `UserProfiles` Tables are Displayed  ([Click to view full-size image](storing-additional-user-information-vb/_static/image33.png))</span></span>


<span data-ttu-id="0e079-291">Dodaj nowy rekord do `UserProfiles` tabeli, ręcznie wpisując wartości `HomeTown`, `HomepageUrl`, i `Signature` pól.</span><span class="sxs-lookup"><span data-stu-id="0e079-291">Add a new record to the `UserProfiles` table by manually typing in values for the `HomeTown`, `HomepageUrl`, and `Signature` fields.</span></span> <span data-ttu-id="0e079-292">Najprostszym sposobem, aby uzyskać prawidłową `UserId` wartość w nowym `UserProfiles` rekord jest wybranie `UserId` pole z określonego konta użytkownika w `aspnet_Users` tabeli i skopiuj i wklej ją do `UserId` w `UserProfiles`.</span><span class="sxs-lookup"><span data-stu-id="0e079-292">The easiest way to get a valid `UserId` value in the new `UserProfiles` record is to select the `UserId` field from a particular user account in the `aspnet_Users` table and copy and paste it into the `UserId` field in `UserProfiles`.</span></span> <span data-ttu-id="0e079-293">Przedstawia rysunek 12 `UserProfiles` tabeli po dodaniu nowego rekordu dla Bruce.</span><span class="sxs-lookup"><span data-stu-id="0e079-293">Figure 12 shows the `UserProfiles` table after a new record has been added for Bruce.</span></span>


<span data-ttu-id="0e079-294">[![Rekord został dodany do UserProfiles dla Bruce](storing-additional-user-information-vb/_static/image35.png)](storing-additional-user-information-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="0e079-294">[![A Record was Added to UserProfiles for Bruce](storing-additional-user-information-vb/_static/image35.png)](storing-additional-user-information-vb/_static/image34.png)</span></span>

<span data-ttu-id="0e079-295">**Rysunek 12**: rekord został dodany do `UserProfiles` dla Bruce ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](storing-additional-user-information-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="0e079-295">**Figure 12**: A Record was Added to `UserProfiles` for Bruce  ([Click to view full-size image](storing-additional-user-information-vb/_static/image36.png))</span></span>


<span data-ttu-id="0e079-296">Wróć do `AdditionalUserInfo.aspx page`, zalogowany jako Bruce.</span><span class="sxs-lookup"><span data-stu-id="0e079-296">Return to the `AdditionalUserInfo.aspx page`, logged in as Bruce.</span></span> <span data-ttu-id="0e079-297">Jak pokazano na rysunku 13, Bruce jego ustawienia są wyświetlane.</span><span class="sxs-lookup"><span data-stu-id="0e079-297">As Figure 13 shows, Bruce's settings are displayed.</span></span>


<span data-ttu-id="0e079-298">[![Obecnie odwiedzający użytkownik jest wyświetlany jego ustawienia](storing-additional-user-information-vb/_static/image38.png)](storing-additional-user-information-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="0e079-298">[![The Currently Visiting User is Shown His Settings](storing-additional-user-information-vb/_static/image38.png)](storing-additional-user-information-vb/_static/image37.png)</span></span>

<span data-ttu-id="0e079-299">**Rysunek 13**: obecnie odwiedzający użytkownika jest wyświetlany jego ustawienia ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](storing-additional-user-information-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="0e079-299">**Figure 13**: The Currently Visiting User is Shown His Settings  ([Click to view full-size image](storing-additional-user-information-vb/_static/image39.png))</span></span>


> [!NOTE]
> <span data-ttu-id="0e079-300">Przejdź dalej i ręcznie dodaj rekordy w `UserProfiles` tabeli dla każdego użytkownika członkostwa.</span><span class="sxs-lookup"><span data-stu-id="0e079-300">Go ahead and manually add records in the `UserProfiles` table for each Membership user.</span></span> <span data-ttu-id="0e079-301">W kroku 6 przedstawiono, jak dostosować formancie CreateUserWizard można automatycznie dodać nowy wiersz do `UserProfiles` tabeli po utworzeniu nowego konta użytkownika.</span><span class="sxs-lookup"><span data-stu-id="0e079-301">In Step 6 we will look at how to customize the CreateUserWizard control to automatically add a new row to the `UserProfiles` table when a new user account is created.</span></span>


## <a name="step-3-allowing-the-user-to-edit-his-home-town-homepage-and-signature"></a><span data-ttu-id="0e079-302">Krok 3: Umożliwiający użytkownikowi edytowanie jego miejscowość głównej, strony głównej i podpisu</span><span class="sxs-lookup"><span data-stu-id="0e079-302">Step 3: Allowing the User to Edit His Home Town, Homepage, and Signature</span></span>

<span data-ttu-id="0e079-303">W tym momencie aktualnie zalogowanego użytkownika można wyświetlić ich miastem macierzystego, strony głównej i ustawienie podpisu, ale jeszcze nie mogą modyfikować je.</span><span class="sxs-lookup"><span data-stu-id="0e079-303">At this point the currently logged in user can view their home town, homepage, and signature setting, but they cannot yet modify them.</span></span> <span data-ttu-id="0e079-304">Teraz należy zaktualizować formantu widoku DetailsView, tak aby dane mogą być edytowane.</span><span class="sxs-lookup"><span data-stu-id="0e079-304">Let's update the DetailsView control so that the data can be edited.</span></span>

<span data-ttu-id="0e079-305">Najpierw konieczne jest dodać `UpdateCommand` dla SqlDataSource, określając `UPDATE` instrukcji do wykonania i odpowiednie parametry.</span><span class="sxs-lookup"><span data-stu-id="0e079-305">The first thing we need to do is add an `UpdateCommand` for the SqlDataSource, specifying the `UPDATE` statement to execute and its corresponding parameters.</span></span> <span data-ttu-id="0e079-306">Wybierz SqlDataSource i w oknie właściwości, kliknij przycisk wielokropka obok właściwości UpdateQuery, aby wyświetlić okno dialogowe Edytor poleceń i parametrów.</span><span class="sxs-lookup"><span data-stu-id="0e079-306">Select the SqlDataSource and, from the Properties window, click on the ellipses next to the UpdateQuery property to bring up the Command and Parameter Editor dialog box.</span></span> <span data-ttu-id="0e079-307">Wprowadź następujące `UPDATE` instrukcji w polu tekstowym:</span><span class="sxs-lookup"><span data-stu-id="0e079-307">Enter the following `UPDATE` statement into the textbox:</span></span>

[!code-sql[Main](storing-additional-user-information-vb/samples/sample3.sql)]

<span data-ttu-id="0e079-308">Następnie kliknij przycisk "Odśwież parametry", co spowoduje utworzenie parametru w formancie SqlDataSource `UpdateParameters` kolekcji dla każdego z parametrów w `UPDATE` instrukcji.</span><span class="sxs-lookup"><span data-stu-id="0e079-308">Next, click the "Refresh Parameters" button, which will create a parameter in the SqlDataSource control's `UpdateParameters` collection for each of the parameters in the `UPDATE` statement.</span></span> <span data-ttu-id="0e079-309">Pozostaw źródła dla wszystkich zestawu parametrów None, a następnie kliknij przycisk OK, aby zakończyć okno dialogowe.</span><span class="sxs-lookup"><span data-stu-id="0e079-309">Leave the source for all of the parameters set to None and click the OK button to complete the dialog box.</span></span>


<span data-ttu-id="0e079-310">[![Określ UpdateCommand SqlDataSource i UpdateParameters](storing-additional-user-information-vb/_static/image41.png)](storing-additional-user-information-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="0e079-310">[![Specify the SqlDataSource's UpdateCommand and UpdateParameters](storing-additional-user-information-vb/_static/image41.png)](storing-additional-user-information-vb/_static/image40.png)</span></span>

<span data-ttu-id="0e079-311">**Rysunek 14**: Określ SqlDataSource `UpdateCommand` i `UpdateParameters` ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](storing-additional-user-information-vb/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="0e079-311">**Figure 14**: Specify the SqlDataSource's `UpdateCommand` and `UpdateParameters` ([Click to view full-size image](storing-additional-user-information-vb/_static/image42.png))</span></span>


<span data-ttu-id="0e079-312">Z powodu dodatków wprowadziliśmy z formantem SqlDataSource, widoku DetailsView formantu można teraz obsługuje edycji.</span><span class="sxs-lookup"><span data-stu-id="0e079-312">Due to the additions we made to the SqlDataSource control, the DetailsView control can now support editing.</span></span> <span data-ttu-id="0e079-313">Z tagów inteligentnych DetailsView zaznacz pole wyboru "Włącz edytowanie".</span><span class="sxs-lookup"><span data-stu-id="0e079-313">From the DetailsView's Smart Tag, check the "Enable Editing" checkbox.</span></span> <span data-ttu-id="0e079-314">To działanie powoduje dodanie CommandField do formantu `Fields` kolekcji z jego `ShowEditButton` właściwość, ustaw wartość True.</span><span class="sxs-lookup"><span data-stu-id="0e079-314">This adds a CommandField to the control's `Fields` collection with its `ShowEditButton` property set to True.</span></span> <span data-ttu-id="0e079-315">Renderuje przycisk Edytuj, gdy widoku DetailsView jest wyświetlany w trybie tylko do odczytu i aktualizacji i przyciski Anuluj podczas wyświetlania w trybie edycji.</span><span class="sxs-lookup"><span data-stu-id="0e079-315">This renders an Edit button when the DetailsView is displayed in read-only mode and Update and Cancel buttons when displayed in edit mode.</span></span> <span data-ttu-id="0e079-316">Zamiast konieczności przez użytkownika kliknij przycisk Edytuj, jednak firma Microsoft może mieć renderowania widoku DetailsView w stanie "zawsze można edytować" przez ustawienie formantu widoku DetailsView [ `DefaultMode` właściwości](https://msdn.microsoft.com/library/system.web.ui.webcontrols.detailsview.defaultmode.aspx) do `Edit`.</span><span class="sxs-lookup"><span data-stu-id="0e079-316">Rather than requiring the user to click Edit, though, we can have the DetailsView render in an "always editable" state by setting the DetailsView control's [`DefaultMode` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.detailsview.defaultmode.aspx) to `Edit`.</span></span>

<span data-ttu-id="0e079-317">Wprowadzone zmiany znaczników deklaratywne formantu widoku DetailsView powinien wyglądać podobny do następującego:</span><span class="sxs-lookup"><span data-stu-id="0e079-317">With these changes, your DetailsView control's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](storing-additional-user-information-vb/samples/sample4.aspx)]

<span data-ttu-id="0e079-318">Należy pamiętać, dodanie CommandField i `DefaultMode` właściwości.</span><span class="sxs-lookup"><span data-stu-id="0e079-318">Note the addition of the CommandField and the `DefaultMode` property.</span></span>

<span data-ttu-id="0e079-319">Przejdź dalej i przetestować tę stronę za pośrednictwem przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="0e079-319">Go ahead and test this page through a browser.</span></span> <span data-ttu-id="0e079-320">Podczas odwiedzania z użytkownikiem, który ma odpowiadający mu rekord w `UserProfiles`, ustawienia użytkownika są wyświetlane w interfejsie można edytować.</span><span class="sxs-lookup"><span data-stu-id="0e079-320">When visiting with a user that has a corresponding record in `UserProfiles`, the user's settings are displayed in an editable interface.</span></span>


<span data-ttu-id="0e079-321">[![Można edytować interfejs renderuje widoku DetailsView](storing-additional-user-information-vb/_static/image44.png)](storing-additional-user-information-vb/_static/image43.png)</span><span class="sxs-lookup"><span data-stu-id="0e079-321">[![The DetailsView Renders an Editable Interface](storing-additional-user-information-vb/_static/image44.png)](storing-additional-user-information-vb/_static/image43.png)</span></span>

<span data-ttu-id="0e079-322">**Rysunek 15**: widoku DetailsView renderuje można edytować interfejsu ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](storing-additional-user-information-vb/_static/image45.png))</span><span class="sxs-lookup"><span data-stu-id="0e079-322">**Figure 15**: The DetailsView Renders an Editable Interface  ([Click to view full-size image](storing-additional-user-information-vb/_static/image45.png))</span></span>


<span data-ttu-id="0e079-323">Spróbuj zmianę wartości i klikając przycisk Aktualizuj.</span><span class="sxs-lookup"><span data-stu-id="0e079-323">Try changing the values and clicking the Update button.</span></span> <span data-ttu-id="0e079-324">Wygląda na to, jak gdyby nic się nie dzieje.</span><span class="sxs-lookup"><span data-stu-id="0e079-324">It appears as if nothing happens.</span></span> <span data-ttu-id="0e079-325">Brak odświeżania strony i wartości są zapisywane w bazie danych, ale nie istnieje żadne wizualny, który wystąpił podczas zapisywania.</span><span class="sxs-lookup"><span data-stu-id="0e079-325">There is a postback and the values are saved to the database, but there's no visual feedback that the save occurred.</span></span>

<span data-ttu-id="0e079-326">Aby rozwiązać ten problem, wróć do programu Visual Studio i Dodaj formant etykiety powyżej widoku DetailsView.</span><span class="sxs-lookup"><span data-stu-id="0e079-326">To remedy this, return to Visual Studio and add a Label control above the DetailsView.</span></span> <span data-ttu-id="0e079-327">Ustaw jego `ID` do `SettingsUpdatedMessage`, jego `Text` dla właściwości "Twoje ustawienia zostały zaktualizowane," i jego `Visible` i `EnableViewState` właściwości `False`.</span><span class="sxs-lookup"><span data-stu-id="0e079-327">Set its `ID` to `SettingsUpdatedMessage`, its `Text` property to "Your settings have been updated," and its `Visible` and `EnableViewState` properties to `False`.</span></span>

[!code-aspx[Main](storing-additional-user-information-vb/samples/sample5.aspx)]

<span data-ttu-id="0e079-328">Potrzebujemy wyświetlić `SettingsUpdatedMessage` etykiety przy każdej aktualizacji widoku DetailsView.</span><span class="sxs-lookup"><span data-stu-id="0e079-328">We need to display the `SettingsUpdatedMessage` Label whenever the DetailsView is updated.</span></span> <span data-ttu-id="0e079-329">W tym celu należy utworzyć program obsługi zdarzeń dla DetailsView `ItemUpdated` zdarzeń i Dodaj następujący kod:</span><span class="sxs-lookup"><span data-stu-id="0e079-329">To accomplish this, create an event handler for the DetailsView's `ItemUpdated` event and add the following code:</span></span>

[!code-vb[Main](storing-additional-user-information-vb/samples/sample6.vb)]

<span data-ttu-id="0e079-330">Wróć do `AdditionalUserInfo.aspx` strony za pośrednictwem przeglądarki i aktualizacji danych.</span><span class="sxs-lookup"><span data-stu-id="0e079-330">Return to the `AdditionalUserInfo.aspx` page through a browser and update the data.</span></span> <span data-ttu-id="0e079-331">Teraz, zostanie wyświetlony komunikat stanu przydatne.</span><span class="sxs-lookup"><span data-stu-id="0e079-331">This time, a helpful status message is displayed.</span></span>


<span data-ttu-id="0e079-332">[![Krótki komunikat jest wyświetlany podczas aktualizowanie ustawień](storing-additional-user-information-vb/_static/image47.png)](storing-additional-user-information-vb/_static/image46.png)</span><span class="sxs-lookup"><span data-stu-id="0e079-332">[![A Short Message is Displayed When the Settings are Updated](storing-additional-user-information-vb/_static/image47.png)](storing-additional-user-information-vb/_static/image46.png)</span></span>

<span data-ttu-id="0e079-333">**Rysunek 16**: krótki komunikat jest wyświetlany po zaktualizowaniu ustawień ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](storing-additional-user-information-vb/_static/image48.png))</span><span class="sxs-lookup"><span data-stu-id="0e079-333">**Figure 16**: A Short Message is Displayed When the Settings are Updated  ([Click to view full-size image](storing-additional-user-information-vb/_static/image48.png))</span></span>


> [!NOTE]
> <span data-ttu-id="0e079-334">Kontrolki widoku szczegółów elementu edycji pozostawia interfejsu się być potrzebne.</span><span class="sxs-lookup"><span data-stu-id="0e079-334">The DetailsView control's editing interface leaves a lot to be desired.</span></span> <span data-ttu-id="0e079-335">Używa standardowych wymiarach pola tekstowe, ale pole podpisu prawdopodobnie powinien być wielowierszowego pola tekstowego.</span><span class="sxs-lookup"><span data-stu-id="0e079-335">It uses standard-sized textboxes, but the Signature field should probably be a multi-line textbox.</span></span> <span data-ttu-id="0e079-336">RegularExpressionValidator mają służyć do zapewnienia, że adres URL strony głównej, czy wprowadzona, rozpoczyna się od "http://" lub "https://".</span><span class="sxs-lookup"><span data-stu-id="0e079-336">A RegularExpressionValidator should be used to ensure that the homepage URL, if entered, starts with "http://" or "https://".</span></span> <span data-ttu-id="0e079-337">Ponadto, ponieważ widoku DetailsView formant ma jego `DefaultMode` ustawioną właściwość `Edit`, przycisku Anuluj wykonywać żadnych czynności.</span><span class="sxs-lookup"><span data-stu-id="0e079-337">Moreover, since the DetailsView control has its `DefaultMode` property set to `Edit`, the Cancel button does not do anything.</span></span> <span data-ttu-id="0e079-338">Go albo należy usunąć lub, po kliknięciu przekieruje użytkownika do innej strony (takie jak `~/Default.aspx`).</span><span class="sxs-lookup"><span data-stu-id="0e079-338">It should either be removed or, when clicked, redirect the user to some other page (such as `~/Default.aspx`).</span></span> <span data-ttu-id="0e079-339">Te ulepszenia wykonywania I pozostaw dla czytnika.</span><span class="sxs-lookup"><span data-stu-id="0e079-339">I leave these enhancements as an exercise for the reader.</span></span>


### <a name="adding-a-link-to-theadditionaluserinfoaspxpage-in-the-master-page"></a><span data-ttu-id="0e079-340">Dodawanie Linku do`AdditionalUserInfo.aspx`strony w strony wzorcowej</span><span class="sxs-lookup"><span data-stu-id="0e079-340">Adding a Link to the`AdditionalUserInfo.aspx`Page in the Master Page</span></span>

<span data-ttu-id="0e079-341">Witryna sieci Web nie ma obecnie łącza do `AdditionalUserInfo.aspx` strony.</span><span class="sxs-lookup"><span data-stu-id="0e079-341">Currently, the website does not provide any links to the `AdditionalUserInfo.aspx` page.</span></span> <span data-ttu-id="0e079-342">Wprowadź adres URL strony bezpośrednio na pasku adresu przeglądarki jest jedynym sposobem, aby uzyskać do niej dostęp.</span><span class="sxs-lookup"><span data-stu-id="0e079-342">The only way to reach it is to enter the page's URL directly into the browser's Address bar.</span></span> <span data-ttu-id="0e079-343">Możemy dodać łącze do tej strony w `Site.master` strony wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="0e079-343">Let's add a link to this page in the `Site.master` master page.</span></span>

<span data-ttu-id="0e079-344">Odwołaj się, że strony wzorcowej zawiera formantu LoginView sieci Web w jego `LoginContent` ContentPlaceHolder wyświetlający różny kod znaczników dla użytkowników uwierzytelnionych i anonimowych.</span><span class="sxs-lookup"><span data-stu-id="0e079-344">Recall that the master page contains a LoginView Web control in its `LoginContent` ContentPlaceHolder that displays different markup for authenticated and anonymous visitors.</span></span> <span data-ttu-id="0e079-345">Zaktualizuj formantu LoginView `LoggedInTemplate` aby uwzględnić łącze do `AdditionalUserInfo.aspx` strony.</span><span class="sxs-lookup"><span data-stu-id="0e079-345">Update the LoginView control's `LoggedInTemplate` to include a link to the `AdditionalUserInfo.aspx` page.</span></span> <span data-ttu-id="0e079-346">Po wprowadzeniu tych zmian LoginView znaczników deklaratywne kontrolki powinien wyglądać podobnie do poniższej:</span><span class="sxs-lookup"><span data-stu-id="0e079-346">After making these changes the LoginView control's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](storing-additional-user-information-vb/samples/sample7.aspx)]

<span data-ttu-id="0e079-347">Należy pamiętać, dodanie `lnkUpdateSettings` formant hiperłącza do `LoggedInTemplate`.</span><span class="sxs-lookup"><span data-stu-id="0e079-347">Note the addition of the `lnkUpdateSettings` HyperLink control to the `LoggedInTemplate`.</span></span> <span data-ttu-id="0e079-348">Z tego łącza w miejscu uwierzytelnieni użytkownicy mogą szybko przejść do strony do wyświetlania i modyfikowania ustawień macierzystego miejscowość, strony głównej i podpis.</span><span class="sxs-lookup"><span data-stu-id="0e079-348">With this link in place, authenticated users can quickly jump to the page to view and modify their home town, homepage, and signature settings.</span></span>

## <a name="step-4-adding-new-guestbook-comments"></a><span data-ttu-id="0e079-349">Krok 4: Dodawanie nowe komentarze księgi gości</span><span class="sxs-lookup"><span data-stu-id="0e079-349">Step 4: Adding New Guestbook Comments</span></span>

<span data-ttu-id="0e079-350">`Guestbook.aspx` Jest strony, gdy uwierzytelnieni użytkownicy mogą wyświetlać księgi gości i zostaw komentarz.</span><span class="sxs-lookup"><span data-stu-id="0e079-350">The `Guestbook.aspx` page is where authenticated users can view the guestbook and leave a comment.</span></span> <span data-ttu-id="0e079-351">Zacznijmy Tworzenie interfejsu, aby dodać nowe komentarze księgi gości.</span><span class="sxs-lookup"><span data-stu-id="0e079-351">Let's start with creating the interface to add new guestbook comments.</span></span>

<span data-ttu-id="0e079-352">Otwórz `Guestbook.aspx` strony w programie Visual Studio i utworzyć interfejsu użytkownika, składające się z dwóch pól tekstowych, jeden dla podmiotu nowy komentarz i jeden dla jego treści.</span><span class="sxs-lookup"><span data-stu-id="0e079-352">Open the `Guestbook.aspx` page in Visual Studio and construct a user interface consisting of two TextBox controls, one for the new comment's subject and one for its body.</span></span> <span data-ttu-id="0e079-353">Ustaw pierwszą kontrolkę TextBox `ID` właściwości `Subject` i jego `Columns` właściwości do 40; Ustaw sekundę `ID` do `Body`, jego `TextMode` do `MultiLine`i jego `Width` i `Rows` właściwości "95%" i 8, odpowiednio.</span><span class="sxs-lookup"><span data-stu-id="0e079-353">Set the first TextBox control's `ID` property to `Subject` and its `Columns` property to 40; set second's `ID` to `Body`, its `TextMode` to `MultiLine`, and its `Width` and `Rows` properties to "95%" and 8, respectively.</span></span> <span data-ttu-id="0e079-354">Aby ukończyć interfejsu użytkownika, należy dodać kontrolkę przycisku sieci Web o nazwie `PostCommentButton` i ustawić jej `Text` dla właściwości "Comment Your" Post".</span><span class="sxs-lookup"><span data-stu-id="0e079-354">To complete the user interface, add a Button Web control named `PostCommentButton` and set its `Text` property to "Post Your Comment".</span></span>

<span data-ttu-id="0e079-355">Ponieważ każdy komentarz księgi gości wymaga temat i treść, Dodaj RequiredFieldValidator dla poszczególnych pól tekstowych.</span><span class="sxs-lookup"><span data-stu-id="0e079-355">Since each guestbook comment requires a subject and body, add a RequiredFieldValidator for each of the TextBoxes.</span></span> <span data-ttu-id="0e079-356">Ustaw `ValidationGroup` właściwości tych kontrolek do "EnterComment"; Podobnie, ustaw `PostCommentButton` formantu `ValidationGroup` dla właściwości "EnterComment".</span><span class="sxs-lookup"><span data-stu-id="0e079-356">Set the `ValidationGroup` property of these controls to "EnterComment"; likewise, set the `PostCommentButton` control's `ValidationGroup` property to "EnterComment".</span></span> <span data-ttu-id="0e079-357">Aby uzyskać więcej informacji na temat ASP. Formanty walidacji w sieci, wyewidencjonowanie [weryfikacji formularza w programie ASP.NET](http://www.4guysfromrolla.com/webtech/090200-1.shtml), [pincety formanty walidacji w programie ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx)i [samouczek kontrolek serwera sprawdzania poprawności](http://www.w3schools.com/aspnet/aspnet_refvalidationcontrols.asp) na [W3Schools](http://www.w3schools.com/).</span><span class="sxs-lookup"><span data-stu-id="0e079-357">For more information on ASP.NET's validation controls, check out [Form Validation in ASP.NET](http://www.4guysfromrolla.com/webtech/090200-1.shtml), [Dissecting the Validation Controls in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx), and the [Validation Server Controls Tutorial](http://www.w3schools.com/aspnet/aspnet_refvalidationcontrols.asp) on [W3Schools](http://www.w3schools.com/).</span></span>

<span data-ttu-id="0e079-358">Po obsługuje tworzenie interfejsu użytkownika strony ma deklaratywne znaczników powinien wyglądać jak poniżej:</span><span class="sxs-lookup"><span data-stu-id="0e079-358">After crafting the user interface your page's declarative markup should look something like the following:</span></span>

[!code-aspx[Main](storing-additional-user-information-vb/samples/sample8.aspx)]

<span data-ttu-id="0e079-359">Z pełną interfejsu użytkownika ma wstawić nowy rekord w naszym następne zadanie `GuestbookComments` tabeli, gdy `PostCommentButton` zostanie kliknięty.</span><span class="sxs-lookup"><span data-stu-id="0e079-359">With the user interface complete, our next task is to insert a new record into the `GuestbookComments` table when the `PostCommentButton` is clicked.</span></span> <span data-ttu-id="0e079-360">Można to zrobić na kilka sposobów: Firma Microsoft można napisać kod ADO.NET w przycisku `Click` obsługi zdarzeń; można dodać kontrolkę SqlDataSource ze stroną, skonfiguruj jego `InsertCommand`, a następnie wywołać jej `Insert` metody z `Click` zdarzeń Program obsługi; lub firma Microsoft może kompilacji warstwy środkowej, odpowiedzialna za wstawianie nowe komentarze księgi gości, a następnie wywołaj tę funkcję z `Click` obsługi zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="0e079-360">This can be accomplished in a number of ways: we can write ADO.NET code in the Button's `Click` event handler; we can add a SqlDataSource control to the page, configure its `InsertCommand`, and then call its `Insert` method from the `Click` event handler; or we could build a middle tier that was responsible for inserting new guestbook comments, and invoke this functionality from the `Click` event handler.</span></span> <span data-ttu-id="0e079-361">Ponieważ analizujemy przy użyciu SqlDataSource w kroku 3, Użyjmy ADO.NET kodu w tym miejscu.</span><span class="sxs-lookup"><span data-stu-id="0e079-361">Since we looked at using a SqlDataSource in Step 3, let's use ADO.NET code here.</span></span>

> [!NOTE]
> <span data-ttu-id="0e079-362">Klasy ADO.NET używana do uzyskania programowego dostępu do danych z bazy danych programu Microsoft SQL Server znajdują się w `System.Data.SqlClient` przestrzeni nazw.</span><span class="sxs-lookup"><span data-stu-id="0e079-362">The ADO.NET classes used to programmatically access data from a Microsoft SQL Server database are located in the `System.Data.SqlClient` namespace.</span></span> <span data-ttu-id="0e079-363">Może być konieczne do importowania tej przestrzeni nazw do klasy związane z kodem ze strony (tj. `Imports System.Data.SqlClient`).</span><span class="sxs-lookup"><span data-stu-id="0e079-363">You may need to import this namespace into your page's code-behind class (i.e., `Imports System.Data.SqlClient`).</span></span>


<span data-ttu-id="0e079-364">Tworzenie procedury obsługi zdarzeń dla `PostCommentButton`w `Click` zdarzeń i Dodaj następujący kod:</span><span class="sxs-lookup"><span data-stu-id="0e079-364">Create an event handler for the `PostCommentButton`'s `Click` event and add the following code:</span></span>

[!code-vb[Main](storing-additional-user-information-vb/samples/sample9.vb)]

<span data-ttu-id="0e079-365">`Click` Uruchamia program obsługi zdarzeń przez sprawdzenie, czy dane dostarczone przez użytkownika są prawidłowe.</span><span class="sxs-lookup"><span data-stu-id="0e079-365">The `Click` event handler starts by checking that the user-supplied data is valid.</span></span> <span data-ttu-id="0e079-366">Jeśli nie jest dostępne, przed wstawieniem rekordu kończy działanie programu obsługi zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="0e079-366">If it is not, the event handler exits before inserting a record.</span></span> <span data-ttu-id="0e079-367">Zakładając, że podane dane są prawidłowe, aktualnie zalogowanego użytkownika `UserId` wartość jest pobierana i przechowywane w `currentUserId` zmiennej lokalnej.</span><span class="sxs-lookup"><span data-stu-id="0e079-367">Assuming the supplied data is valid, the currently logged on user's `UserId` value is retrieved and stored in the `currentUserId` local variable.</span></span> <span data-ttu-id="0e079-368">Ta wartość jest potrzebna, ponieważ firma Microsoft dostarcza `UserId` wartości podczas wstawiania rekordów do `GuestbookComments`.</span><span class="sxs-lookup"><span data-stu-id="0e079-368">This value is needed because we must supply a `UserId` value when inserting a record into `GuestbookComments`.</span></span>

<span data-ttu-id="0e079-369">Następujące, parametrów połączenia dla `SecurityTutorials` bazy danych są pobierane z `Web.config` i `INSERT` jest określona w instrukcji SQL.</span><span class="sxs-lookup"><span data-stu-id="0e079-369">Following that, the connection string for the `SecurityTutorials` database is retrieved from `Web.config` and the `INSERT` SQL statement is specified.</span></span> <span data-ttu-id="0e079-370">A `SqlConnection` obiekt jest tworzony i otwierany.</span><span class="sxs-lookup"><span data-stu-id="0e079-370">A `SqlConnection` object is then created and opened.</span></span> <span data-ttu-id="0e079-371">Następnie `SqlCommand` obiekt jest tworzony i wartości dla parametrów używane w `INSERT` zapytania są przypisane.</span><span class="sxs-lookup"><span data-stu-id="0e079-371">Next, a `SqlCommand` object is constructed and the values for the parameters used in the `INSERT` query are assigned.</span></span> <span data-ttu-id="0e079-372">`INSERT` Następnie wykonaniu instrukcji i zamknięcie połączenia.</span><span class="sxs-lookup"><span data-stu-id="0e079-372">The `INSERT` statement is then executed and the connection closed.</span></span> <span data-ttu-id="0e079-373">Po zakończeniu obsługi zdarzeń `Subject` i `Body` pól tekstowych `Text` właściwości zostały wyczyszczone tak, aby wartości użytkownika nie są zachowywane między ogłaszania zwrotnego.</span><span class="sxs-lookup"><span data-stu-id="0e079-373">At the end of the event handler, the `Subject` and `Body` TextBoxes' `Text` properties are cleared out so that the user's values are not persisted across the postback.</span></span>

<span data-ttu-id="0e079-374">Przejdź dalej i przetestować tę stronę w przeglądarce.</span><span class="sxs-lookup"><span data-stu-id="0e079-374">Go ahead and test out this page in a browser.</span></span> <span data-ttu-id="0e079-375">Ponieważ ta strona jest `Membership` folder nie jest on dostępny dla osób odwiedzających anonimowy.</span><span class="sxs-lookup"><span data-stu-id="0e079-375">Since this page is in the `Membership` folder it is not accessible to anonymous visitors.</span></span> <span data-ttu-id="0e079-376">W związku z tym należy najpierw zalogować się na (jeśli jeszcze tego nie zrobiono).</span><span class="sxs-lookup"><span data-stu-id="0e079-376">Therefore, you will need to first log on (if you have not already).</span></span> <span data-ttu-id="0e079-377">Wprowadź wartość do `Subject` i `Body` pola tekstowe i kliknij przycisk `PostCommentButton` przycisku.</span><span class="sxs-lookup"><span data-stu-id="0e079-377">Enter a value into the `Subject` and `Body` TextBoxes and click the `PostCommentButton` button.</span></span> <span data-ttu-id="0e079-378">To spowoduje, że mają zostać dodane do nowego rekordu `GuestbookComments`.</span><span class="sxs-lookup"><span data-stu-id="0e079-378">This will cause a new record to be added to `GuestbookComments`.</span></span> <span data-ttu-id="0e079-379">Strony tematu i treści podane są czyszczone z pól tekstowych.</span><span class="sxs-lookup"><span data-stu-id="0e079-379">On postback, the subject and body you provided are wiped from the TextBoxes.</span></span>

<span data-ttu-id="0e079-380">Po kliknięciu przycisku `PostCommentButton` przycisk istnieje nie jest brak wizualne komentarz dodany do księgi gości.</span><span class="sxs-lookup"><span data-stu-id="0e079-380">After clicking the `PostCommentButton` button there is no visual feedback that the comment was added to the guestbook.</span></span> <span data-ttu-id="0e079-381">Nadal trzeba zaktualizować tę stronę, aby wyświetlić istniejące komentarze księgi gości, które spowoduje wykonanie w kroku 5.</span><span class="sxs-lookup"><span data-stu-id="0e079-381">We still need to update this page to display the existing guestbook comments, which we will do in Step 5.</span></span> <span data-ttu-id="0e079-382">Po możemy realizacji tego komentarza po prostu dodane będą wyświetlane w komentarza, zapewnienie odpowiedniej wizualne.</span><span class="sxs-lookup"><span data-stu-id="0e079-382">Once we accomplish that, the just-added comment will appear in the list of comments, providing adequate visual feedback.</span></span> <span data-ttu-id="0e079-383">Teraz należy potwierdzić, że komentarz księgi gości został zapisany, sprawdzając zawartość `GuestbookComments` tabeli.</span><span class="sxs-lookup"><span data-stu-id="0e079-383">For now, confirm that your guestbook comment was saved by examining the contents of the `GuestbookComments` table.</span></span>

<span data-ttu-id="0e079-384">Rysunek 17 wyświetlana jest zawartość `GuestbookComments` tabeli po dwóch komentarze zostały wystawione.</span><span class="sxs-lookup"><span data-stu-id="0e079-384">Figure 17 shows the contents of the `GuestbookComments` table after two comments have been left.</span></span>


<span data-ttu-id="0e079-385">[![Można wyświetlić komentarze księgi gości w tabeli GuestbookComments](storing-additional-user-information-vb/_static/image50.png)](storing-additional-user-information-vb/_static/image49.png)</span><span class="sxs-lookup"><span data-stu-id="0e079-385">[![You Can See the Guestbook Comments in the GuestbookComments Table](storing-additional-user-information-vb/_static/image50.png)](storing-additional-user-information-vb/_static/image49.png)</span></span>

<span data-ttu-id="0e079-386">**Rysunek 17**: można zapoznać się z komentarzami księgi gości w `GuestbookComments` tabeli ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](storing-additional-user-information-vb/_static/image51.png))</span><span class="sxs-lookup"><span data-stu-id="0e079-386">**Figure 17**: You Can See the Guestbook Comments in the `GuestbookComments` Table  ([Click to view full-size image](storing-additional-user-information-vb/_static/image51.png))</span></span>


> [!NOTE]
> <span data-ttu-id="0e079-387">Jeśli użytkownik próbuje Wstaw komentarz księgi gości, który zawiera potencjalnie niebezpiecznych znaczników — takich jak HTML — ASP.NET zgłosi `HttpRequestValidationException`.</span><span class="sxs-lookup"><span data-stu-id="0e079-387">If a user attempts to insert a guestbook comment that contains potentially dangerous markup – such as HTML – ASP.NET will throw an `HttpRequestValidationException`.</span></span> <span data-ttu-id="0e079-388">Aby dowiedzieć się więcej na temat tego wyjątku, dlaczego jest zgłaszany, oraz sposób zezwolić użytkownikom na przesłanie potencjalnie niebezpiecznych wartości, należy zajrzeć [żądania oficjalny dokument weryfikacji](../../../../whitepapers/request-validation.md).</span><span class="sxs-lookup"><span data-stu-id="0e079-388">To learn more about this exception, why it's thrown, and how to permit users to submit potentially dangerous values, consult the [Request Validation Whitepaper](../../../../whitepapers/request-validation.md).</span></span>


## <a name="step-5-listing-the-existing-guestbook-comments"></a><span data-ttu-id="0e079-389">Krok 5: Lista komentarze księgi gości</span><span class="sxs-lookup"><span data-stu-id="0e079-389">Step 5: Listing the Existing Guestbook Comments</span></span>

<span data-ttu-id="0e079-390">Oprócz pozostawienie komentarze, użytkownik odwiedzający `Guestbook.aspx` strony powinny również móc wyświetlić komentarze księgi gości.</span><span class="sxs-lookup"><span data-stu-id="0e079-390">In addition to leaving comments, a user visiting the `Guestbook.aspx` page should also be able to view the guestbook's existing comments.</span></span> <span data-ttu-id="0e079-391">W tym celu Dodaj formant ListView o nazwie `CommentList` do dolnej części strony.</span><span class="sxs-lookup"><span data-stu-id="0e079-391">To accomplish this, add a ListView control named `CommentList` to the bottom of the page.</span></span>

> [!NOTE]
> <span data-ttu-id="0e079-392">ListView — formant jest nowym składnikiem programu ASP.NET w wersji 3.5.</span><span class="sxs-lookup"><span data-stu-id="0e079-392">The ListView control is new to ASP.NET version 3.5.</span></span> <span data-ttu-id="0e079-393">Jest on przeznaczony do wyświetlania listy elementów w bardzo można dostosowywać i elastyczny układ, ale nadal oferuje wbudowane edytowanie, wstawianie, usuwanie, stronicowania i sortowania funkcji takich jak widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="0e079-393">It is designed to display a list of items in a very customizable and flexible layout, yet still offer built-in editing, inserting, deleting, paging, and sorting functionality like the GridView.</span></span> <span data-ttu-id="0e079-394">Jeśli używasz programu ASP.NET 2.0, należy zamiast tego użyj formant DataList lub elementu powtarzanego.</span><span class="sxs-lookup"><span data-stu-id="0e079-394">If you are using ASP.NET 2.0, you will need to use the DataList or Repeater control instead.</span></span> <span data-ttu-id="0e079-395">Aby uzyskać więcej informacji na temat używania element ListView, zobacz [Scott Guthrie](https://weblogs.asp.net/scottgu/)w wpis w blogu [asp: ListView kontroli](https://weblogs.asp.net/scottgu/archive/2007/08/10/the-asp-listview-control-part-1-building-a-product-listing-page-with-clean-css-ui.aspx)i Moje artykułu [wyświetlanie danych z formantem ListView](http://aspnet.4guysfromrolla.com/articles/122607-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="0e079-395">For more information on using the ListView, see [Scott Guthrie](https://weblogs.asp.net/scottgu/)'s blog entry, [The asp:ListView Control](https://weblogs.asp.net/scottgu/archive/2007/08/10/the-asp-listview-control-part-1-building-a-product-listing-page-with-clean-css-ui.aspx), and my article, [Displaying Data with the ListView Control](http://aspnet.4guysfromrolla.com/articles/122607-1.aspx).</span></span>


<span data-ttu-id="0e079-396">Otwórz element ListView tagów inteligentnych i z listy rozwijanej wybierz źródło danych, należy powiązać formant do nowego źródła danych.</span><span class="sxs-lookup"><span data-stu-id="0e079-396">Open the ListView's Smart Tag and, from the Choose Data Source drop-down list, bind the control to a new data source.</span></span> <span data-ttu-id="0e079-397">Jak widzieliśmy w kroku 2, zostanie uruchomiony Kreator konfiguracji źródła danych.</span><span class="sxs-lookup"><span data-stu-id="0e079-397">As we saw in Step 2, this will launch the Data Source Configuration Wizard.</span></span> <span data-ttu-id="0e079-398">Wybierz ikonę bazy danych, nazwę wynikowy SqlDataSource `CommentsDataSource`i kliknij przycisk OK.</span><span class="sxs-lookup"><span data-stu-id="0e079-398">Select the Database icon, name the resulting SqlDataSource `CommentsDataSource`, and click OK.</span></span> <span data-ttu-id="0e079-399">Następnie wybierz pozycję `SecurityTutorialsConnectionString` połączenia ciąg z listy rozwijanej i kliknij przycisk Dalej.</span><span class="sxs-lookup"><span data-stu-id="0e079-399">Next, select the `SecurityTutorialsConnectionString` connection string from the drop-down list and click Next.</span></span>

<span data-ttu-id="0e079-400">W tym momencie w kroku 2 Firma Microsoft określi dane do zapytania pobrania `UserProfiles` tabeli z listy rozwijanej i Wybieranie kolumn do zwrócenia (odwołują się do na rysunku nr 9).</span><span class="sxs-lookup"><span data-stu-id="0e079-400">At this point in Step 2 we specified the data to query by picking the `UserProfiles` table from the drop-down list and selecting the columns to return (refer back to Figure 9).</span></span> <span data-ttu-id="0e079-401">Teraz, jednak chcemy sformułować instrukcję SQL ponownie ściągający rekordy nie tylko z `GuestbookComments`, ale także osoby wystawiającej komentarz miejscowość macierzystego, strony głównej podpisu i nazwy użytkownika.</span><span class="sxs-lookup"><span data-stu-id="0e079-401">This time, however, we want to craft a SQL statement that pulls back not only the records from `GuestbookComments`, but also the commenter's home town, homepage, signature, and username.</span></span> <span data-ttu-id="0e079-402">W związku z tym wybierz przycisk radiowy "Określ niestandardową instrukcję SQL lub procedurę składowaną" i kliknij przycisk Dalej.</span><span class="sxs-lookup"><span data-stu-id="0e079-402">Therefore, select the "Specify a custom SQL statement or stored procedure" radio button and click Next.</span></span>

<span data-ttu-id="0e079-403">Zostaną wyświetlone na ekranie "Zdefiniuj niestandardowe instrukcji lub procedury przechowywane".</span><span class="sxs-lookup"><span data-stu-id="0e079-403">This will bring up the "Define Custom Statements or Stored Procedures" screen.</span></span> <span data-ttu-id="0e079-404">Kliknij przycisk konstruktora zapytań do postaci graficznej tworzenia zapytania.</span><span class="sxs-lookup"><span data-stu-id="0e079-404">Click the Query Builder button to graphically build the query.</span></span> <span data-ttu-id="0e079-405">Konstruktor kwerend rozpoczyna się od nas o określić tabelę, którą chcemy udostępnić zapytania z monitowania.</span><span class="sxs-lookup"><span data-stu-id="0e079-405">The Query Builder starts by prompting us to specify the tables we want to query from.</span></span> <span data-ttu-id="0e079-406">Wybierz `GuestbookComments`, `UserProfiles`, i `aspnet_Users` tabele i kliknij przycisk OK.</span><span class="sxs-lookup"><span data-stu-id="0e079-406">Select the `GuestbookComments`, `UserProfiles`, and `aspnet_Users` tables and click OK.</span></span> <span data-ttu-id="0e079-407">Spowoduje to dodanie wszystkie trzy tabele na powierzchnię projektu.</span><span class="sxs-lookup"><span data-stu-id="0e079-407">This will add all three tables to the design surface.</span></span> <span data-ttu-id="0e079-408">Ponieważ ma ograniczeń klucza obcego między `GuestbookComments`, `UserProfiles`, i `aspnet_Users` tabel, konstruktora zapytań automatycznie `JOIN` s tych tabel.</span><span class="sxs-lookup"><span data-stu-id="0e079-408">Since there are foreign key constraints amongst the `GuestbookComments`, `UserProfiles`, and `aspnet_Users` tables, the Query Builder automatically `JOIN` s these tables.</span></span>

<span data-ttu-id="0e079-409">Całą zawartość pozostaje do określania kolumn do zwrócenia.</span><span class="sxs-lookup"><span data-stu-id="0e079-409">All that remains is to specify the columns to return.</span></span> <span data-ttu-id="0e079-410">Z `GuestbookComments` tabeli wybierz `Subject`, `Body`, i `CommentDate` kolumn; return `HomeTown`, `HomepageUrl`, i `Signature` kolumny z `UserProfiles` tabeli; i zwracać `UserName` z `aspnet_Users`.</span><span class="sxs-lookup"><span data-stu-id="0e079-410">From the `GuestbookComments` table select the `Subject`, `Body`, and `CommentDate` columns; return the `HomeTown`, `HomepageUrl`, and `Signature` columns from the `UserProfiles` table; and return `UserName` from `aspnet_Users`.</span></span> <span data-ttu-id="0e079-411">Ponadto Dodaj "`ORDER BY CommentDate DESC`" na końcu `SELECT` zapytania, aby najpierw zwracane są najnowsze wpisy.</span><span class="sxs-lookup"><span data-stu-id="0e079-411">Also, add "`ORDER BY CommentDate DESC`" to the end of the `SELECT` query so that the most recent posts are returned first.</span></span> <span data-ttu-id="0e079-412">Po wprowadzeniu tych opcji, interfejsu konstruktora zapytań powinien wyglądać podobnie do zrzut na rysunku 18 ekranu.</span><span class="sxs-lookup"><span data-stu-id="0e079-412">After making these selections, your Query Builder interface should look similar to the screen shot in Figure 18.</span></span>


<span data-ttu-id="0e079-413">[![Zapytanie zbudowanych sprzężenia GuestbookComments, UserProfiles i tabele aspnet_Users](storing-additional-user-information-vb/_static/image53.png)](storing-additional-user-information-vb/_static/image52.png)</span><span class="sxs-lookup"><span data-stu-id="0e079-413">[![The Constructed Query JOINs the GuestbookComments, UserProfiles, and aspnet_Users Tables](storing-additional-user-information-vb/_static/image53.png)](storing-additional-user-information-vb/_static/image52.png)</span></span>

<span data-ttu-id="0e079-414">**Rysunek 18**: zapytanie wykonane `JOIN` s `GuestbookComments`, `UserProfiles`, i `aspnet_Users` tabele ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](storing-additional-user-information-vb/_static/image54.png))</span><span class="sxs-lookup"><span data-stu-id="0e079-414">**Figure 18**: The Constructed Query `JOIN` s the `GuestbookComments`, `UserProfiles`, and `aspnet_Users` Tables  ([Click to view full-size image](storing-additional-user-information-vb/_static/image54.png))</span></span>


<span data-ttu-id="0e079-415">Kliknij przycisk OK, aby zamknąć okno konstruktora zapytań i powrócić do ekranu "Zdefiniuj niestandardowe instrukcji lub procedury przechowywane".</span><span class="sxs-lookup"><span data-stu-id="0e079-415">Click OK to close the Query Builder window and return to the "Define Custom Statements or Stored Procedures" screen.</span></span> <span data-ttu-id="0e079-416">Kliknij przycisk Dalej wcześniejszym na ekranie "Zapytania Test", gdzie może wyświetlić wyniki zapytania, klikając przycisk zapytanie testu.</span><span class="sxs-lookup"><span data-stu-id="0e079-416">Click Next to advance to the "Test Query" screen, where you may view the query results by clicking the Test Query button.</span></span> <span data-ttu-id="0e079-417">Gdy wszystko będzie gotowe, kliknij przycisk Zakończ, aby zakończyć pracę Kreatora konfigurowania źródła danych.</span><span class="sxs-lookup"><span data-stu-id="0e079-417">When you're ready, click Finish to complete the Configure Data Source wizard.</span></span>

<span data-ttu-id="0e079-418">Gdy firma Microsoft ukończono pracę Kreatora konfigurowania źródła danych w kroku 2, skojarzony formant widoku DetailsView `Fields` kolekcji został zaktualizowany do uwzględnienia elementu BoundField dla każdej kolumny zwracane przez `SelectCommand`.</span><span class="sxs-lookup"><span data-stu-id="0e079-418">When we completed the Configure Data Source wizard in Step 2, the associated DetailsView control's `Fields` collection was updated to include a BoundField for each column returned by the `SelectCommand`.</span></span> <span data-ttu-id="0e079-419">Element ListView, jednak pozostanie bez zmian; nadal trzeba zdefiniować jego układ.</span><span class="sxs-lookup"><span data-stu-id="0e079-419">The ListView, however, remains unchanged; we still need to define its layout.</span></span> <span data-ttu-id="0e079-420">Układ elementu ListView można utworzyć ręcznie przy użyciu jego deklaratywne znaczników lub z opcją "Konfiguruj element ListView" w tagu inteligentnego.</span><span class="sxs-lookup"><span data-stu-id="0e079-420">The ListView's layout can be constructed manually through its declarative markup or from the "Configure ListView" option in its Smart Tag.</span></span> <span data-ttu-id="0e079-421">I zwykle woli ręcznie definiujący kod znaczników, jednak użyć dowolnej metody jest najbardziej fizyczne do Ciebie.</span><span class="sxs-lookup"><span data-stu-id="0e079-421">I usually prefer defining the markup by hand, but use whatever method is most natural to you.</span></span>

<span data-ttu-id="0e079-422">I zakończył z następującym `LayoutTemplate`, `ItemTemplate`, i `ItemSeparatorTemplate` formantu ListView:</span><span class="sxs-lookup"><span data-stu-id="0e079-422">I ended up using the following `LayoutTemplate`, `ItemTemplate`, and `ItemSeparatorTemplate` for my ListView control:</span></span>

[!code-aspx[Main](storing-additional-user-information-vb/samples/sample10.aspx)]

<span data-ttu-id="0e079-423">`LayoutTemplate` Definiuje znaczników emitowane przez formant, podczas gdy `ItemTemplate` renderuje każdego elementu zwrócony przez SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="0e079-423">The `LayoutTemplate` defines the markup emitted by the control, while the `ItemTemplate` renders each item returned by the SqlDataSource.</span></span> <span data-ttu-id="0e079-424">`ItemTemplate`Dla znaczników wynikowy jest umieszczany w `LayoutTemplate`w `itemPlaceholder` formantu.</span><span class="sxs-lookup"><span data-stu-id="0e079-424">The `ItemTemplate`'s resulting markup is placed in the `LayoutTemplate`'s `itemPlaceholder` control.</span></span> <span data-ttu-id="0e079-425">Oprócz `itemPlaceholder`, `LayoutTemplate` zawiera formant DataPager, co ogranicza element ListView do wyświetlania tylko 10 komentarze księgi gości na stronie (ustawienie domyślne) i renderuje interfejsu stronicowania.</span><span class="sxs-lookup"><span data-stu-id="0e079-425">In addition to the `itemPlaceholder`, the `LayoutTemplate` includes a DataPager control, which limits the ListView to showing just 10 guestbook comments per page (the default) and renders a paging interface.</span></span>

<span data-ttu-id="0e079-426">Moje `ItemTemplate` temat każdy komentarz księgi gości w `<h4>` element z treści znajdujących się poniżej podmiotu.</span><span class="sxs-lookup"><span data-stu-id="0e079-426">My `ItemTemplate` displays each guestbook comment's subject in an `<h4>` element with the body situated below the subject.</span></span> <span data-ttu-id="0e079-427">Składnia służąca do wyświetlania treści ma danych zwróconych przez `Eval("Body")` instrukcji wiązania danych konwertuje go na ciąg i zamienia podziały wierszy z `<br />` elementu.</span><span class="sxs-lookup"><span data-stu-id="0e079-427">Note that syntax used for displaying the body takes the data returned by the `Eval("Body")` databinding statement, converts it to a string, and replaces line breaks with the `<br />` element.</span></span> <span data-ttu-id="0e079-428">Ta konwersja wymaga Pokaż podziały wprowadzana w trakcie przesyłania komentarza, ponieważ odstęp jest ignorowana przez HTML.</span><span class="sxs-lookup"><span data-stu-id="0e079-428">This conversion is needed in order to show the line breaks entered when submitting the comment since whitespace is ignored by HTML.</span></span> <span data-ttu-id="0e079-429">Podpis użytkownika jest wyświetlana poniżej treści kursywą, po którym następuje przez użytkownika miejscowość macierzystego, link do jego głównej, daty i godziny wprowadzone komentarz oraz nazwy użytkownika osoby, która pozostanie komentarz.</span><span class="sxs-lookup"><span data-stu-id="0e079-429">The user's signature is displayed beneath the body in italics, followed by the user's home town, a link to his homepage, the date and time the comment was made, and the username of the person who left the comment.</span></span>

<span data-ttu-id="0e079-430">Poświęć chwilę, aby wyświetlić stronę za pośrednictwem przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="0e079-430">Take a moment to view the page through a browser.</span></span> <span data-ttu-id="0e079-431">Powinny pojawić się komentarze, dodawane do księgi gości w kroku 5 tutaj wyświetlane.</span><span class="sxs-lookup"><span data-stu-id="0e079-431">You should see the comments that you added to the guestbook in Step 5 displayed here.</span></span>


<span data-ttu-id="0e079-432">[![Teraz Guestbook.aspx Wyświetla komentarze księgi gości](storing-additional-user-information-vb/_static/image56.png)](storing-additional-user-information-vb/_static/image55.png)</span><span class="sxs-lookup"><span data-stu-id="0e079-432">[![Guestbook.aspx Now Displays the Guestbook's Comments](storing-additional-user-information-vb/_static/image56.png)](storing-additional-user-information-vb/_static/image55.png)</span></span>

<span data-ttu-id="0e079-433">**Rysunek 19**: `Guestbook.aspx` komentarze księgi gości są obecnie wyświetlane ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](storing-additional-user-information-vb/_static/image57.png))</span><span class="sxs-lookup"><span data-stu-id="0e079-433">**Figure 19**: `Guestbook.aspx` Now Displays the Guestbook's Comments  ([Click to view full-size image](storing-additional-user-information-vb/_static/image57.png))</span></span>


<span data-ttu-id="0e079-434">Spróbuj dodać nowy komentarz do księgi gości.</span><span class="sxs-lookup"><span data-stu-id="0e079-434">Try adding a new comment to the guestbook.</span></span> <span data-ttu-id="0e079-435">Po kliknięciu `PostCommentButton` przycisk Strona ogłoszeń Wstecz i komentarz został dodany do bazy danych, ale ListView — formant nie jest aktualizowana w celu wyświetlenia nowy komentarz.</span><span class="sxs-lookup"><span data-stu-id="0e079-435">Upon clicking the `PostCommentButton` button the page posts back and the comment is added to the database, but the ListView control is not updated to show the new comment.</span></span> <span data-ttu-id="0e079-436">Można to naprawić przez:</span><span class="sxs-lookup"><span data-stu-id="0e079-436">This can be fixed by either:</span></span>

- <span data-ttu-id="0e079-437">Aktualizowanie `PostCommentButton` przycisku `Click` obsługi zdarzeń, tak że wywołuje formant ListView `DataBind()` metody po wstawieniu nowy komentarz do bazy danych, lub</span><span class="sxs-lookup"><span data-stu-id="0e079-437">Updating the `PostCommentButton` button's `Click` event handler so that it invokes the ListView control's `DataBind()` method after inserting the new comment into the database, or</span></span>
- <span data-ttu-id="0e079-438">Ustawienia formantu ListView `EnableViewState` właściwości `False`.</span><span class="sxs-lookup"><span data-stu-id="0e079-438">Setting the ListView control's `EnableViewState` property to `False`.</span></span> <span data-ttu-id="0e079-439">Takie podejście działa, ponieważ po wyłączeniu formantu widoku stanu, należy ponownie powiązać w danych źródłowych, na każdym ogłaszania zwrotnego.</span><span class="sxs-lookup"><span data-stu-id="0e079-439">This approach works because by disabling the control's view state, it must rebind to the underlying data on every postback.</span></span>

<span data-ttu-id="0e079-440">Samouczek witryny sieci Web do pobrania z tego samouczka przedstawiono obie techniki.</span><span class="sxs-lookup"><span data-stu-id="0e079-440">The tutorial website downloadable from this tutorial illustrates both techniques.</span></span> <span data-ttu-id="0e079-441">ListView — formant `EnableViewState` właściwości `False` kodu potrzebne do programowego ponownie powiązać danych do elementu ListView jest obecna w `Click` obsługi zdarzeń, ale jest oznaczone jako komentarz.</span><span class="sxs-lookup"><span data-stu-id="0e079-441">The ListView control's `EnableViewState` property to `False` and the code needed to programmatically rebind the data to the ListView is present in the `Click` event handler, but is commented out.</span></span>

> [!NOTE]
> <span data-ttu-id="0e079-442">Obecnie `AdditionalUserInfo.aspx` strona umożliwia wyświetlanie i edytowanie ustawień macierzystego miejscowość, strony głównej i podpis.</span><span class="sxs-lookup"><span data-stu-id="0e079-442">Currently the `AdditionalUserInfo.aspx` page allows the user to view and edit their home town, homepage, and signature settings.</span></span> <span data-ttu-id="0e079-443">Może być dobry zaktualizować `AdditionalUserInfo.aspx` do wyświetlenia zalogowanego w komentarzach księgi gości użytkownika.</span><span class="sxs-lookup"><span data-stu-id="0e079-443">It might be nice to update `AdditionalUserInfo.aspx` to display the logged in user's guestbook comments.</span></span> <span data-ttu-id="0e079-444">Oznacza to, oprócz badanie i modyfikowania jej informacji, użytkownik może odwiedzić `AdditionalUserInfo.aspx` stronę, aby zobaczyć, jakie księgi gości komentarzy użytkownik znajduje się w przeszłości.</span><span class="sxs-lookup"><span data-stu-id="0e079-444">That is, in addition to examining and modifying her information, a user can visit the `AdditionalUserInfo.aspx` page to see what guestbook comments she's made in the past.</span></span> <span data-ttu-id="0e079-445">I pozostaw to wykonywania zainteresowanych czytnika.</span><span class="sxs-lookup"><span data-stu-id="0e079-445">I leave this as an exercise for the interested reader.</span></span>


## <a name="step-6-customizing-the-createuserwizard-control-to-include-an-interface-for-the-home-town-homepage-and-signature"></a><span data-ttu-id="0e079-446">Krok 6: Dostosowywanie formancie CreateUserWizard uwzględnienie interfejs miejscowość głównej, strony głównej i podpisu</span><span class="sxs-lookup"><span data-stu-id="0e079-446">Step 6: Customizing the CreateUserWizard Control to Include an Interface for the Home Town, Homepage, and Signature</span></span>

<span data-ttu-id="0e079-447">`SELECT` Zapytania używanego przez `Guestbook.aspx` strona używa `INNER JOIN` połączyć powiązane rekordy między `GuestbookComments`, `UserProfiles`, i `aspnet_Users` tabel.</span><span class="sxs-lookup"><span data-stu-id="0e079-447">The `SELECT` query used by the `Guestbook.aspx` page uses an `INNER JOIN` to combine the related records amongst the `GuestbookComments`, `UserProfiles`, and `aspnet_Users` tables.</span></span> <span data-ttu-id="0e079-448">Jeśli użytkownik, który nie ma rekordu w `UserProfiles` komentarz nawiązuje księgi gości komentarz nie będą wyświetlane w elemencie ListView, ponieważ `INNER JOIN` zwraca tylko `GuestbookComments` rekordów, gdy ma pasującego rekordów w `UserProfiles` i `aspnet_Users`.</span><span class="sxs-lookup"><span data-stu-id="0e079-448">If a user that has no record in `UserProfiles` makes a guestbook comment, the comment won't be displayed in the ListView because the `INNER JOIN` only returns `GuestbookComments` records when there are matching records in `UserProfiles` and `aspnet_Users`.</span></span> <span data-ttu-id="0e079-449">I jak widzieliśmy w kroku 3, jeśli użytkownik nie ma rekordu `UserProfiles` klika nie można wyświetlić ani edytować jej ustawienia w `AdditionalUserInfo.aspx` strony.</span><span class="sxs-lookup"><span data-stu-id="0e079-449">And as we saw in Step 3, if a user does not have a record in `UserProfiles` she cannot view or edit her settings in the `AdditionalUserInfo.aspx` page.</span></span>

<span data-ttu-id="0e079-450">Needless oznacza, ze względu na naszych projektu decyzji jest ważne, czy każde konto użytkownika w systemu członkostwa ma zgodnego rejestrowane w `UserProfiles` tabeli.</span><span class="sxs-lookup"><span data-stu-id="0e079-450">Needless to say, due to our design decisions it is important that every user account in the Membership system have a matching record in the `UserProfiles` table.</span></span> <span data-ttu-id="0e079-451">Co chcemy jest odpowiedni rekord, który ma zostać dodany do `UserProfiles` zawsze, gdy tworzone jest nowe konto użytkownika członkostwa, za pośrednictwem CreateUserWizard.</span><span class="sxs-lookup"><span data-stu-id="0e079-451">What we want is for a corresponding record to be added to `UserProfiles` whenever a new Membership user account is created through the CreateUserWizard.</span></span>

<span data-ttu-id="0e079-452">Zgodnie z opisem w [ *tworzenia kont użytkowników* ](creating-user-accounts-vb.md) zgłasza samouczek, po utworzeniu nowego konta użytkownika członkostwa w formancie CreateUserWizard jego [ `CreatedUser` zdarzenia](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.createduser.aspx).</span><span class="sxs-lookup"><span data-stu-id="0e079-452">As discussed in the [*Creating User Accounts*](creating-user-accounts-vb.md) tutorial, after the new Membership user account is created the CreateUserWizard control raises its [`CreatedUser` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.createduser.aspx).</span></span> <span data-ttu-id="0e079-453">Możemy utworzyć program obsługi zdarzeń dla tego zdarzenia, uzyskać identyfikator UserId dla użytkownika właśnie utworzony, a następnie Wstawianie rekordu do `UserProfiles` tabeli z wartościami domyślnymi dla `HomeTown`, `HomepageUrl`, i `Signature` kolumn.</span><span class="sxs-lookup"><span data-stu-id="0e079-453">We can create an event handler for this event, get the UserId for the just-created user, and then insert a record into the `UserProfiles` table with default values for the `HomeTown`, `HomepageUrl`, and `Signature` columns.</span></span> <span data-ttu-id="0e079-454">Co więcej istnieje możliwość monit o podanie wartości tych dostosowując interfejsu w formancie CreateUserWizard uwzględnienie dodatkowych pól tekstowych.</span><span class="sxs-lookup"><span data-stu-id="0e079-454">What's more, it is possible to prompt the user for these values by customizing the CreateUserWizard control's interface to include additional TextBoxes.</span></span>

<span data-ttu-id="0e079-455">Najpierw Zobaczmy, jak dodać nowy wiersz do `UserProfiles` w tabeli `CreatedUser` obsługi zdarzeń z wartościami domyślnymi.</span><span class="sxs-lookup"><span data-stu-id="0e079-455">Let's first look at how to add a new row to the `UserProfiles` table in the `CreatedUser` event handler with default values.</span></span> <span data-ttu-id="0e079-456">Następujące, przedstawiono sposób dostosowywania interfejsu użytkownika w formancie CreateUserWizard uwzględnienie dodatkowe pola do zbierania miejscowość macierzystego, strony głównej i podpis nowego użytkownika.</span><span class="sxs-lookup"><span data-stu-id="0e079-456">Following that, we will see how to customize the CreateUserWizard control's user interface to include additional form fields to collect the new user's home town, homepage, and signature.</span></span>

### <a name="adding-a-default-row-touserprofiles"></a><span data-ttu-id="0e079-457">Dodawanie wiersza do domyślnego`UserProfiles`</span><span class="sxs-lookup"><span data-stu-id="0e079-457">Adding a Default Row to`UserProfiles`</span></span>

<span data-ttu-id="0e079-458">W [ *tworzenia kont użytkowników* ](creating-user-accounts-vb.md) samouczek dodaliśmy formancie CreateUserWizard do `CreatingUserAccounts.aspx` strony `Membership` folderu.</span><span class="sxs-lookup"><span data-stu-id="0e079-458">In the [*Creating User Accounts*](creating-user-accounts-vb.md) tutorial we added a CreateUserWizard control to the `CreatingUserAccounts.aspx` page in the `Membership` folder.</span></span> <span data-ttu-id="0e079-459">Aby przypisać CreateUserWizard kontrola dodać rekordu do `UserProfiles` tabeli po utworzeniu konta użytkownika, należy zaktualizować funkcjonalność w formancie CreateUserWizard.</span><span class="sxs-lookup"><span data-stu-id="0e079-459">In order to have the CreateUserWizard control add a record to `UserProfiles` table upon user account creation, we need to update the CreateUserWizard control's functionality.</span></span> <span data-ttu-id="0e079-460">Zamiast wprowadzania tych zmian do `CreatingUserAccounts.aspx` pozycję Dodajmy zamiast tego nowego formancie CreateUserWizard do `EnhancedCreateUserWizard.aspx` i wprowadzić te zmiany w tym samouczku strony.</span><span class="sxs-lookup"><span data-stu-id="0e079-460">Rather than making these changes to the `CreatingUserAccounts.aspx` page, let's instead add a new CreateUserWizard control to `EnhancedCreateUserWizard.aspx` page and make the modifications for this tutorial there.</span></span>

<span data-ttu-id="0e079-461">Otwórz `EnhancedCreateUserWizard.aspx` strony w programie Visual Studio i przeciągnij z przybornika na stronę formancie CreateUserWizard.</span><span class="sxs-lookup"><span data-stu-id="0e079-461">Open the `EnhancedCreateUserWizard.aspx` page in Visual Studio and drag a CreateUserWizard control from the Toolbox onto the page.</span></span> <span data-ttu-id="0e079-462">Ustaw w formancie CreateUserWizard `ID` właściwości `NewUserWizard`.</span><span class="sxs-lookup"><span data-stu-id="0e079-462">Set the CreateUserWizard control's `ID` property to `NewUserWizard`.</span></span> <span data-ttu-id="0e079-463">Jak wspomniano w [ *tworzenia kont użytkowników* ](creating-user-accounts-vb.md) samouczka CreateUserWizard domyślny interfejs użytkownika wyświetla monit o niezbędne informacje.</span><span class="sxs-lookup"><span data-stu-id="0e079-463">As we discussed in the [*Creating User Accounts*](creating-user-accounts-vb.md) tutorial, the CreateUserWizard's default user interface prompts the visitor for the necessary information.</span></span> <span data-ttu-id="0e079-464">Po te informacje zostały podane, formantu wewnętrznie tworzy nowe konto użytkownika w ramach członkostwa, wszystko to bez nam konieczności pisania pojedynczy wiersz kodu.</span><span class="sxs-lookup"><span data-stu-id="0e079-464">Once this information has been supplied, the control internally creates a new user account in the Membership framework, all without us having to write a single line of code.</span></span>

<span data-ttu-id="0e079-465">W formancie CreateUserWizard podnosi liczbę zdarzeń podczas jego przepływu pracy.</span><span class="sxs-lookup"><span data-stu-id="0e079-465">The CreateUserWizard control raises a number of events during its workflow.</span></span> <span data-ttu-id="0e079-466">Obiekt odwiedzający dostarcza informacje o żądaniu i przesyła formularz, formancie CreateUserWizard początkowo generowane jego [ `CreatingUser` zdarzeń](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.creatinguser.aspx).</span><span class="sxs-lookup"><span data-stu-id="0e079-466">After a visitor supplies the request information and submits the form, the CreateUserWizard control initially fires its [`CreatingUser` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.creatinguser.aspx).</span></span> <span data-ttu-id="0e079-467">Jeśli występuje problem podczas procesu tworzenia [ `CreateUserError` zdarzeń](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.createusererror.aspx) jest uruchamiany; jednak, jeśli użytkownik została pomyślnie utworzona, a następnie [ `CreatedUser` zdarzeń](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.createduser.aspx) jest wywoływane.</span><span class="sxs-lookup"><span data-stu-id="0e079-467">If there is a problem during the create process, the [`CreateUserError` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.createusererror.aspx) is fired; however, if the user is successfully created, then the [`CreatedUser` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.createduser.aspx) is raised.</span></span> <span data-ttu-id="0e079-468">W [ *tworzenia kont użytkowników* ](creating-user-accounts-vb.md) samouczek utworzyliśmy programu obsługi zdarzeń dla `CreatingUser` zdarzeń, aby upewnić się, że podana nazwa użytkownika nie zawiera żadnych wiodące lub końcowe spacje i który Nazwa użytkownika nie pojawił się dowolne miejsce w haśle.</span><span class="sxs-lookup"><span data-stu-id="0e079-468">In the [*Creating User Accounts*](creating-user-accounts-vb.md) tutorial we created an event handler for the `CreatingUser` event to ensure that the supplied username did not contain any leading or trailing spaces, and that the username did not appear anywhere in the password.</span></span>

<span data-ttu-id="0e079-469">Aby dodać wiersz w `UserProfiles` tabeli po prostu utworzyć użytkownika, należy utworzyć programu obsługi zdarzeń dla `CreatedUser` zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="0e079-469">In order to add a row in the `UserProfiles` table for the just-created user, we need to create an event handler for the `CreatedUser` event.</span></span> <span data-ttu-id="0e079-470">W czasie `CreatedUser` zdarzenie jest wywoływane, już utworzono konto użytkownika w ramach członkostwa, pozwala nam można pobrać wartości identyfikatora użytkownika dla konta.</span><span class="sxs-lookup"><span data-stu-id="0e079-470">By the time the `CreatedUser` event has fired, the user account has already been created in the Membership framework, enabling us to retrieve the account's UserId value.</span></span>

<span data-ttu-id="0e079-471">Tworzenie procedury obsługi zdarzeń dla `NewUserWizard`w `CreatedUser` zdarzeń i Dodaj następujący kod:</span><span class="sxs-lookup"><span data-stu-id="0e079-471">Create an event handler for the `NewUserWizard`'s `CreatedUser` event and add the following code:</span></span>

[!code-vb[Main](storing-additional-user-information-vb/samples/sample11.vb)]

<span data-ttu-id="0e079-472">Powyżej istot kodu przez pobranie nazwa użytkownika konta użytkownika po prostu dodane.</span><span class="sxs-lookup"><span data-stu-id="0e079-472">The above code beings by retrieving the UserId of the just-added user account.</span></span> <span data-ttu-id="0e079-473">Jest to zrobić za pomocą `Membership.GetUser(username)` metoda zwraca informacje dotyczące określonego użytkownika, a następnie użyć `ProviderUserKey` właściwości do pobrania ich identyfikator użytkownika.</span><span class="sxs-lookup"><span data-stu-id="0e079-473">This is accomplished by using the `Membership.GetUser(username)` method to return information about a particular user, and then using the `ProviderUserKey` property to retrieve their UserId.</span></span> <span data-ttu-id="0e079-474">Nazwa użytkownika wprowadzona przez użytkownika w formancie CreateUserWizard jest dostępny za pośrednictwem jego [ `UserName` właściwości](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.username.aspx).</span><span class="sxs-lookup"><span data-stu-id="0e079-474">The username entered by the user in the CreateUserWizard control is available via its [`UserName` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.username.aspx).</span></span>

<span data-ttu-id="0e079-475">Następnie parametry połączenia są pobierane z `Web.config` i `INSERT` określono instrukcji.</span><span class="sxs-lookup"><span data-stu-id="0e079-475">Next, the connection string is retrieved from `Web.config` and the `INSERT` statement is specified.</span></span> <span data-ttu-id="0e079-476">Niezbędne ADO.NET— obiekty są tworzone i wykonania polecenia.</span><span class="sxs-lookup"><span data-stu-id="0e079-476">The necessary ADO.NET objects are instantiated and the command executed.</span></span> <span data-ttu-id="0e079-477">Przypisuje kod [ `DBNull` ](https://msdn.microsoft.com/library/system.dbnull.aspx) wystąpienie do `@HomeTown`, `@HomepageUrl`, i `@Signature` parametrów, które powoduje wstawienie bazy danych `NULL` wartości `HomeTown`, `HomepageUrl`, i `Signature` pól.</span><span class="sxs-lookup"><span data-stu-id="0e079-477">The code assigns a [`DBNull`](https://msdn.microsoft.com/library/system.dbnull.aspx) instance to the `@HomeTown`, `@HomepageUrl`, and `@Signature` parameters, which has the effect of inserting database `NULL` values for the `HomeTown`, `HomepageUrl`, and `Signature` fields.</span></span>

<span data-ttu-id="0e079-478">Odwiedź stronę `EnhancedCreateUserWizard.aspx` stronie za pośrednictwem przeglądarki, a następnie utwórz nowe konto użytkownika.</span><span class="sxs-lookup"><span data-stu-id="0e079-478">Visit the `EnhancedCreateUserWizard.aspx` page through a browser and create a new user account.</span></span> <span data-ttu-id="0e079-479">Po wykonaniu tej czynności, wróć do programu Visual Studio i sprawdź zawartość `aspnet_Users` i `UserProfiles` tabele (takich jak robiliśmy na rysunku 12).</span><span class="sxs-lookup"><span data-stu-id="0e079-479">After doing so, return to Visual Studio and examine the contents of the `aspnet_Users` and `UserProfiles` tables (like we did back in Figure 12).</span></span> <span data-ttu-id="0e079-480">Powinny pojawić się nowego konta użytkownika w `aspnet_Users` i odpowiadające mu `UserProfiles` wiersza (z `NULL` wartości `HomeTown`, `HomepageUrl`, i `Signature`).</span><span class="sxs-lookup"><span data-stu-id="0e079-480">You should see the new user account in `aspnet_Users` and a corresponding `UserProfiles` row (with `NULL` values for `HomeTown`, `HomepageUrl`, and `Signature`).</span></span>


<span data-ttu-id="0e079-481">[![Dodano nowe konto użytkownika i UserProfiles rekordu](storing-additional-user-information-vb/_static/image59.png)](storing-additional-user-information-vb/_static/image58.png)</span><span class="sxs-lookup"><span data-stu-id="0e079-481">[![A New User Account and UserProfiles Record Have Been Added](storing-additional-user-information-vb/_static/image59.png)](storing-additional-user-information-vb/_static/image58.png)</span></span>

<span data-ttu-id="0e079-482">**Rysunek 20**: A nowego konta użytkownika i `UserProfiles` dodano rekord ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](storing-additional-user-information-vb/_static/image60.png))</span><span class="sxs-lookup"><span data-stu-id="0e079-482">**Figure 20**: A New User Account and `UserProfiles` Record Have Been Added  ([Click to view full-size image](storing-additional-user-information-vb/_static/image60.png))</span></span>


<span data-ttu-id="0e079-483">Po użytkownik ma podany jego nowe informacje o koncie i kliknięty przycisk "Utwórz użytkownika", utworzono konto użytkownika i dodać wiersz do `UserProfiles` tabeli.</span><span class="sxs-lookup"><span data-stu-id="0e079-483">After the visitor has supplied his new account information and clicked the "Create User" button, the user account is created and a row added to the `UserProfiles` table.</span></span> <span data-ttu-id="0e079-484">Następnie wyświetla CreateUserWizard jego `CompleteWizardStep`, która wyświetla komunikat z potwierdzeniem i przycisku Kontynuuj.</span><span class="sxs-lookup"><span data-stu-id="0e079-484">The CreateUserWizard then displays its `CompleteWizardStep`, which displays a success message and a Continue button.</span></span> <span data-ttu-id="0e079-485">Kliknięcie przycisku Kontynuuj powoduje odświeżenie strony, ale nie podjęto żadnej akcji, pozostawiając użytkownik zablokował na `EnhancedCreateUserWizard.aspx` strony.</span><span class="sxs-lookup"><span data-stu-id="0e079-485">Clicking the Continue button causes a postback, but no action is taken, leaving the user stuck on the `EnhancedCreateUserWizard.aspx` page.</span></span>

<span data-ttu-id="0e079-486">Można określić adres URL wysłać do użytkownika, aby po kliknięciu przycisku Kontynuuj za pośrednictwem formancie CreateUserWizard [ `ContinueDestinationPageUrl` właściwości](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.continuedestinationpageurl.aspx).</span><span class="sxs-lookup"><span data-stu-id="0e079-486">We can specify a URL to send the user to when the Continue button is clicked via the CreateUserWizard control's [`ContinueDestinationPageUrl` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.continuedestinationpageurl.aspx).</span></span> <span data-ttu-id="0e079-487">Ustaw `ContinueDestinationPageUrl` dla właściwości "~ / Membership/AdditionalUserInfo.aspx".</span><span class="sxs-lookup"><span data-stu-id="0e079-487">Set the `ContinueDestinationPageUrl` property to "~/Membership/AdditionalUserInfo.aspx".</span></span> <span data-ttu-id="0e079-488">Trwa to nowemu użytkownikowi `AdditionalUserInfo.aspx`, gdzie mogą wyświetlać i aktualizować ich ustawienia.</span><span class="sxs-lookup"><span data-stu-id="0e079-488">This takes the new user to `AdditionalUserInfo.aspx`, where they can view and update their settings.</span></span>

### <a name="customizing-the-createuserwizards-interface-to-prompt-for-the-new-users-home-town-homepage-and-signature"></a><span data-ttu-id="0e079-489">Dostosowywanie interfejsu CreateUserWizard Monituj miejscowość głównej, strony głównej i podpis nowego użytkownika</span><span class="sxs-lookup"><span data-stu-id="0e079-489">Customizing the CreateUserWizard's Interface to Prompt for the New User's Home Town, Homepage, and Signature</span></span>

<span data-ttu-id="0e079-490">Interfejs domyślny formancie CreateUserWizard jest wystarczająca dla scenariuszy tworzenia prostego gdzie muszą być zbierane tylko podstawowe informacje o koncie użytkownika, takie jak nazwa użytkownika, hasło i adres e-mail.</span><span class="sxs-lookup"><span data-stu-id="0e079-490">The CreateUserWizard control's default interface is sufficient for simple account creation scenarios where only core user account information like username, password, and email need be collected.</span></span> <span data-ttu-id="0e079-491">Ale co zrobić, jeśli trzeba Monituj obiektu odwiedzającego, aby wprowadzić swoje miejscowość macierzystego, strony głównej i podpis podczas tworzenia swoje konto?</span><span class="sxs-lookup"><span data-stu-id="0e079-491">But what if we wanted to prompt the visitor to enter her home town, homepage, and signature while creating her account?</span></span> <span data-ttu-id="0e079-492">Istnieje możliwość dostosowania interfejsu w formancie CreateUserWizard do gromadzenia dodatkowych informacji podczas rejestracji, a te informacje mogą być używane w `CreatedUser` obsługi zdarzeń, aby wstawić dodatkowe rekordy do podstawowej bazy danych.</span><span class="sxs-lookup"><span data-stu-id="0e079-492">It is possible to customize the CreateUserWizard control's interface to collect additional information at signup, and this information may be used in the `CreatedUser` event handler to insert additional records into the underlying database.</span></span>

<span data-ttu-id="0e079-493">W formancie CreateUserWizard rozszerza formantu kreatora ASP.NET, który jest formant, który umożliwia dewelopera strony do definiowania serii uporządkowanych `WizardSteps`.</span><span class="sxs-lookup"><span data-stu-id="0e079-493">The CreateUserWizard control extends the ASP.NET Wizard control, which is a control that allows a page developer to define a series of ordered `WizardSteps`.</span></span> <span data-ttu-id="0e079-494">Formant kreatora renderuje aktywnego kroku i udostępnia interfejsem nawigacji, który umożliwia obiektu odwiedzającego przenieść te kroki.</span><span class="sxs-lookup"><span data-stu-id="0e079-494">The Wizard control renders the active step and provides a navigation interface that allows the visitor to move through these steps.</span></span> <span data-ttu-id="0e079-495">Kreator formantu jest idealny dla podziału długich zadań w kilku krótkich krokach.</span><span class="sxs-lookup"><span data-stu-id="0e079-495">The Wizard control is ideal for breaking down a long task into several short steps.</span></span> <span data-ttu-id="0e079-496">Aby uzyskać więcej informacji na temat formantu kreatora, zobacz [Tworzenie interfejsu użytkownika krok po kroku z formantu kreatora ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/061406-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="0e079-496">For more information on the Wizard control, see [Creating a Step-by-Step User Interface with the ASP.NET 2.0 Wizard Control](http://aspnet.4guysfromrolla.com/articles/061406-1.aspx).</span></span>

<span data-ttu-id="0e079-497">Znaczników domyślne w formancie CreateUserWizard definiuje dwie `WizardSteps`: `CreateUserWizardStep` i `CompleteWizardStep`.</span><span class="sxs-lookup"><span data-stu-id="0e079-497">The CreateUserWizard control's default markup defines two `WizardSteps`: `CreateUserWizardStep` and `CompleteWizardStep`.</span></span>

[!code-aspx[Main](storing-additional-user-information-vb/samples/sample12.aspx)]

<span data-ttu-id="0e079-498">Pierwszy `WizardStep`, `CreateUserWizardStep`, renderuje interfejs, który wyświetla monit o nazwę użytkownika, hasło, poczty e-mail i tak dalej.</span><span class="sxs-lookup"><span data-stu-id="0e079-498">The first `WizardStep`, `CreateUserWizardStep`, renders the interface that prompts for the username, password, email, and so on.</span></span> <span data-ttu-id="0e079-499">Po osoby odwiedzającej jest możliwe będzie przekazywać te informacje i kliknie przycisk "Utwórz użytkownika", jest ona wyświetlana `CompleteWizardStep`, którym będzie wyświetlany komunikat z potwierdzeniem i przycisku Kontynuuj.</span><span class="sxs-lookup"><span data-stu-id="0e079-499">After the visitor supplies this information and clicks "Create User", she is shown the `CompleteWizardStep`, which shows the success message and a Continue button.</span></span>

<span data-ttu-id="0e079-500">Aby dostosować interfejs formancie CreateUserWizard uwzględnienie dodatkowe pola, możemy:</span><span class="sxs-lookup"><span data-stu-id="0e079-500">To customize the CreateUserWizard control's interface to include additional form fields, we can:</span></span>

- <span data-ttu-id="0e079-501"><strong>Utwórz co najmniej jeden nowy</strong><strong>`WizardStep`</strong><strong>s zawierają dodatkowe elementy interfejsu użytkownika</strong>.</span><span class="sxs-lookup"><span data-stu-id="0e079-501"><strong>Create one or more new</strong><strong>`WizardStep`</strong><strong>s to contain the additional user interface elements</strong>.</span></span> <span data-ttu-id="0e079-502">Aby dodać nowy `WizardStep` aby CreateUserWizard, kliknij przycisk "Dodaj lub usuń `WizardStep` s" link z jego tagów inteligentnych można uruchomić `WizardStep` edytora kolekcji.</span><span class="sxs-lookup"><span data-stu-id="0e079-502">To add a new `WizardStep` to the CreateUserWizard, click the "Add/Remove `WizardStep` s" link from its Smart Tag to launch the `WizardStep` Collection Editor.</span></span> <span data-ttu-id="0e079-503">Z tego miejsca można dodać, usunąć lub zmienić kolejność kroków w kreatorze.</span><span class="sxs-lookup"><span data-stu-id="0e079-503">From there you can add, remove, or reorder the steps in the wizard.</span></span> <span data-ttu-id="0e079-504">To podejście, które będą używane na potrzeby tego samouczka.</span><span class="sxs-lookup"><span data-stu-id="0e079-504">This is the approach we will use for this tutorial.</span></span>

- <span data-ttu-id="0e079-505"><strong>Konwertuj</strong><strong>`CreateUserWizardStep`</strong><strong>do edycji</strong><strong>`WizardStep`</strong><strong>.</strong></span><span class="sxs-lookup"><span data-stu-id="0e079-505"><strong>Convert the</strong><strong>`CreateUserWizardStep`</strong><strong>into an editable</strong><strong>`WizardStep`</strong><strong>.</strong></span></span> <span data-ttu-id="0e079-506">Spowoduje to zastąpienie `CreateUserWizardStep` z równoważną `WizardStep` których znaczników definiuje interfejs użytkownika, który odpowiada `CreateUserWizardStep`"s.</span><span class="sxs-lookup"><span data-stu-id="0e079-506">This replaces the `CreateUserWizardStep` with an equivalent `WizardStep` whose markup defines a user interface that matches the `CreateUserWizardStep`'s.</span></span> <span data-ttu-id="0e079-507">Konwertując `CreateUserWizardStep` do `WizardStep` możemy zmiana położenia kontrolki, lub Dodaj dodatkowe elementy interfejsu użytkownika do tego kroku.</span><span class="sxs-lookup"><span data-stu-id="0e079-507">By converting the `CreateUserWizardStep` into a `WizardStep` we can reposition the controls or add additional user interface elements to this step.</span></span> <span data-ttu-id="0e079-508">Aby przekonwertować `CreateUserWizardStep` lub `CompleteWizardStep` do edycji `WizardStep`, kliknij przycisk "Krok Dostosuj tworzenia użytkownika" lub "Dostosować wykonaj krok" link z tagu formantu.</span><span class="sxs-lookup"><span data-stu-id="0e079-508">To convert the `CreateUserWizardStep` or `CompleteWizardStep` into an editable `WizardStep`, click the "Customize Create User Step" or "Customize Complete Step" link from the control's Smart Tag.</span></span>

- <span data-ttu-id="0e079-509">**Użyj kombinacji powyższych dwóch opcji.**</span><span class="sxs-lookup"><span data-stu-id="0e079-509">**Use some combination of the above two options.**</span></span>

<span data-ttu-id="0e079-510">Jest istotnym aspektem należy pamiętać, że w formancie CreateUserWizard wykonuje procesu tworzenia konta użytkownika, po kliknięciu przycisku "Tworzenie użytkownika" z poziomu jego `CreateUserWizardStep`.</span><span class="sxs-lookup"><span data-stu-id="0e079-510">One important thing to keep in mind is that the CreateUserWizard control executes its user account creation process when the "Create User" button is clicked from within its `CreateUserWizardStep`.</span></span> <span data-ttu-id="0e079-511">Nie ma znaczenia, jeśli istnieją dodatkowe `WizardStep` s po `CreateUserWizardStep` lub nie.</span><span class="sxs-lookup"><span data-stu-id="0e079-511">It doesn't matter if there are additional `WizardStep` s after the `CreateUserWizardStep` or not.</span></span>

<span data-ttu-id="0e079-512">Podczas dodawania niestandardowego `WizardStep` na formancie CreateUserWizard służąca do gromadzenia dodatkowych wprowadzania danych przez użytkownika niestandardowego `WizardStep` mogą być umieszczane przed lub po `CreateUserWizardStep`.</span><span class="sxs-lookup"><span data-stu-id="0e079-512">When adding a custom `WizardStep` to the CreateUserWizard control to collect additional user input, the custom `WizardStep` can be placed before or after the `CreateUserWizardStep`.</span></span> <span data-ttu-id="0e079-513">Jeśli znajduje się przed `CreateUserWizardStep` następnie danych wejściowych użytkownika dodatkowe są zbierane z niestandardowego `WizardStep` jest dostępna dla `CreatedUser` obsługi zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="0e079-513">If it comes before the `CreateUserWizardStep` then the additional user input collected from the custom `WizardStep` is available for the `CreatedUser` event handler.</span></span> <span data-ttu-id="0e079-514">Jednak jeśli niestandardowa `WizardStep` po `CreateUserWizardStep` następnie przez czas niestandardowego `WizardStep` jest wyświetlany już utworzono nowe konto użytkownika i `CreatedUser` zdarzenie zostało już uruchomione.</span><span class="sxs-lookup"><span data-stu-id="0e079-514">However, if the custom `WizardStep` comes after `CreateUserWizardStep` then by the time the custom `WizardStep` is displayed the new user account has already been created and the `CreatedUser` event has already fired.</span></span>

<span data-ttu-id="0e079-515">21 rysunku przedstawiono przepływ pracy po dodany `WizardStep` poprzedza `CreateUserWizardStep`.</span><span class="sxs-lookup"><span data-stu-id="0e079-515">Figure 21 shows the workflow when the added `WizardStep` precedes the `CreateUserWizardStep`.</span></span> <span data-ttu-id="0e079-516">Ponieważ informacje o dodatkowych użytkownika została pobrana przez czas `CreatedUser` aktualizacja jest generowane zdarzenie, wszystkie mamy czy `CreatedUser` obsługi zdarzeń, aby pobrać te dane wejściowe i ich użyć do `INSERT` wartości parametrów w instrukcji (zamiast `DBNull.Value`).</span><span class="sxs-lookup"><span data-stu-id="0e079-516">Since the additional user information has been collected by the time the `CreatedUser` event fires, all we have to do is update the `CreatedUser` event handler to retrieve these inputs and use those for the `INSERT` statement's parameter values (rather than `DBNull.Value`).</span></span>


<span data-ttu-id="0e079-517">[![Przepływ pracy CreateUserWizard, gdy element CreateUserWizardStep poprzedza dodatkowe WizardStep](storing-additional-user-information-vb/_static/image62.png)](storing-additional-user-information-vb/_static/image61.png)</span><span class="sxs-lookup"><span data-stu-id="0e079-517">[![The CreateUserWizard Workflow When an Additional WizardStep Precedes the CreateUserWizardStep](storing-additional-user-information-vb/_static/image62.png)](storing-additional-user-information-vb/_static/image61.png)</span></span>

<span data-ttu-id="0e079-518">**Rysunek 21**: CreateUserWizard przepływu pracy podczas dodatkowe `WizardStep` Precedes `CreateUserWizardStep` ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](storing-additional-user-information-vb/_static/image63.png))</span><span class="sxs-lookup"><span data-stu-id="0e079-518">**Figure 21**: The CreateUserWizard Workflow When an Additional `WizardStep` Precedes the `CreateUserWizardStep` ([Click to view full-size image](storing-additional-user-information-vb/_static/image63.png))</span></span>


<span data-ttu-id="0e079-519">Jeśli niestandardowa `WizardStep` znajduje się *po* `CreateUserWizardStep`, jednak proces tworzenia konta użytkownika występuje, zanim użytkownik miał możliwość wprowadź jej Miasto macierzystego, strony głównej lub podpisu.</span><span class="sxs-lookup"><span data-stu-id="0e079-519">If the custom `WizardStep` is placed *after* the `CreateUserWizardStep`, however, the create user account process occurs before the user has had a chance to enter her home town, homepage, or signature.</span></span> <span data-ttu-id="0e079-520">W takim przypadku te informacje dodatkowe potrzebuje do wstawienia do bazy danych po utworzeniu konta użytkownika, jak pokazano na rysunku 22.</span><span class="sxs-lookup"><span data-stu-id="0e079-520">In such a case, this additional information needs to be inserted into the database after the user account has been created, as Figure 22 illustrates.</span></span>


<span data-ttu-id="0e079-521">[![CreateUserWizard przepływu pracy, gdy po element CreateUserWizardStep dodatkowe WizardStep](storing-additional-user-information-vb/_static/image65.png)](storing-additional-user-information-vb/_static/image64.png)</span><span class="sxs-lookup"><span data-stu-id="0e079-521">[![The CreateUserWizard Workflow When an Additional WizardStep Comes After the CreateUserWizardStep](storing-additional-user-information-vb/_static/image65.png)](storing-additional-user-information-vb/_static/image64.png)</span></span>

<span data-ttu-id="0e079-522">**Rysunek 22**: CreateUserWizard przepływu pracy podczas dodatkowe `WizardStep` pochodzi po `CreateUserWizardStep` ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](storing-additional-user-information-vb/_static/image66.png))</span><span class="sxs-lookup"><span data-stu-id="0e079-522">**Figure 22**: The CreateUserWizard Workflow When an Additional `WizardStep` Comes After the `CreateUserWizardStep` ([Click to view full-size image](storing-additional-user-information-vb/_static/image66.png))</span></span>


<span data-ttu-id="0e079-523">Przepływ pracy pokazano na rysunku 22 czeka do wstawienia rekordu do `UserProfiles` tabeli dopiero po ukończeniu kroku 2.</span><span class="sxs-lookup"><span data-stu-id="0e079-523">The workflow shown in Figure 22 waits to insert a record into the `UserProfiles` table until after Step 2 completes.</span></span> <span data-ttu-id="0e079-524">Obiekt odwiedzający zamknięcie przeglądarki jej po wykonaniu kroku 1, jednak firma Microsoft będzie osiągnięto stanu, w którym utworzono konto użytkownika, ale żaden rekord został dodany do `UserProfiles`.</span><span class="sxs-lookup"><span data-stu-id="0e079-524">If the visitor closes her browser after step 1, however, we will have reached a state where a user account was created, but no record was added to `UserProfiles`.</span></span> <span data-ttu-id="0e079-525">Jednym z rozwiązań ma rekord z `NULL` lub wstawione do wartości domyślnych `UserProfiles` w `CreatedUser` program obsługi zdarzeń (który uruchamia się po wykonaniu kroku 1), a następnie aktualizacji to rekord po ukończeniu kroku 2.</span><span class="sxs-lookup"><span data-stu-id="0e079-525">One workaround is to have a record with `NULL` or default values inserted into `UserProfiles` in the `CreatedUser` event handler (which fires after step 1), and then update this record after step 2 completes.</span></span> <span data-ttu-id="0e079-526">Gwarantuje to, że `UserProfiles` rekord zostanie dodany do konta użytkownika nawet wtedy, gdy użytkownik zamyka połowie procesu rejestracji za pomocą.</span><span class="sxs-lookup"><span data-stu-id="0e079-526">This ensures that a `UserProfiles` record will be added for the user account even if the user quits the registration process midway through.</span></span>

<span data-ttu-id="0e079-527">W tym samouczku Utwórzmy nowy `WizardStep` występuje po `CreateUserWizardStep` lecz przed `CompleteWizardStep`.</span><span class="sxs-lookup"><span data-stu-id="0e079-527">For this tutorial let's create a new `WizardStep` that occurs after the `CreateUserWizardStep` but before the `CompleteWizardStep`.</span></span> <span data-ttu-id="0e079-528">Pierwszy get WizardStep w umieścić i skonfigurowany, a następnie firma Microsoft będzie Przyjrzyjmy się kodu.</span><span class="sxs-lookup"><span data-stu-id="0e079-528">Let's first get the WizardStep in place and configured and then we'll look at the code.</span></span>

<span data-ttu-id="0e079-529">W formancie CreateUserWizard tagów inteligentnych, wybierz opcję "Dodaj lub usuń `WizardStep` s", co spowoduje uruchomienie `WizardStep` okno dialogowe Edytor kolekcji.</span><span class="sxs-lookup"><span data-stu-id="0e079-529">From the CreateUserWizard control's Smart Tag, select the "Add/Remove `WizardStep` s", which brings up the `WizardStep` Collection Editor dialog.</span></span> <span data-ttu-id="0e079-530">Dodaj nową `WizardStep`, ustawienie jej `ID` do `UserSettings`, jego `Title` "Twoje ustawienia" i jego `StepType` do `Step`.</span><span class="sxs-lookup"><span data-stu-id="0e079-530">Add a new `WizardStep`, setting its `ID` to `UserSettings`, its `Title` to "Your Settings" and its `StepType` to `Step`.</span></span> <span data-ttu-id="0e079-531">Umieść go tak, aby po przejściu do `CreateUserWizardStep` ("zamówić Twoje nowe konto"), a przed `CompleteWizardStep` ("ukończone"), jak pokazano na rysunku 23.</span><span class="sxs-lookup"><span data-stu-id="0e079-531">Then position it so that it comes after the `CreateUserWizardStep` ("Sign Up for Your New Account") and before the `CompleteWizardStep` ("Complete"), as shown in Figure 23.</span></span>


<span data-ttu-id="0e079-532">[![Dodaj nowy element WizardStep na formancie CreateUserWizard](storing-additional-user-information-vb/_static/image68.png)](storing-additional-user-information-vb/_static/image67.png)</span><span class="sxs-lookup"><span data-stu-id="0e079-532">[![Add a New WizardStep to the CreateUserWizard Control](storing-additional-user-information-vb/_static/image68.png)](storing-additional-user-information-vb/_static/image67.png)</span></span>

<span data-ttu-id="0e079-533">**Rysunek 23**: Dodaj nowy `WizardStep` na formancie CreateUserWizard ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](storing-additional-user-information-vb/_static/image69.png))</span><span class="sxs-lookup"><span data-stu-id="0e079-533">**Figure 23**: Add a New `WizardStep` to the CreateUserWizard Control  ([Click to view full-size image](storing-additional-user-information-vb/_static/image69.png))</span></span>


<span data-ttu-id="0e079-534">Kliknij przycisk OK, aby zamknąć `WizardStep` okno dialogowe Edytor kolekcji.</span><span class="sxs-lookup"><span data-stu-id="0e079-534">Click OK to close the `WizardStep` Collection Editor dialog.</span></span> <span data-ttu-id="0e079-535">Nowe `WizardStep` świadczy formancie CreateUserWizard zaktualizowane deklaratywne znaczników:</span><span class="sxs-lookup"><span data-stu-id="0e079-535">The new `WizardStep` is evidenced by the CreateUserWizard control's updated declarative markup:</span></span>

[!code-aspx[Main](storing-additional-user-information-vb/samples/sample13.aspx)]

<span data-ttu-id="0e079-536">Należy pamiętać, nowe `<asp:WizardStep>` elementu.</span><span class="sxs-lookup"><span data-stu-id="0e079-536">Note the new `<asp:WizardStep>` element.</span></span> <span data-ttu-id="0e079-537">Musimy dodać interfejs użytkownika do gromadzenia miejscowość macierzystego, strony głównej i podpis w tym miejscu nowego użytkownika.</span><span class="sxs-lookup"><span data-stu-id="0e079-537">We need to add the user interface to collect the new user's home town, homepage, and signature here.</span></span> <span data-ttu-id="0e079-538">W składni deklaratywnej lub poprzez projektanta, można wprowadzić tej zawartości.</span><span class="sxs-lookup"><span data-stu-id="0e079-538">You can enter this content in the declarative syntax or through the Designer.</span></span> <span data-ttu-id="0e079-539">Aby użyć projektanta, wybierz w kroku "Ustawień" z listy rozwijanej w tagu inteligentnego, aby zobaczyć krok w projektancie.</span><span class="sxs-lookup"><span data-stu-id="0e079-539">To use the Designer, select the "Your Settings" step from the drop-down list in the Smart Tag to see the step in the Designer.</span></span>

> [!NOTE]
> <span data-ttu-id="0e079-540">Wybranie kroku za pomocą listy rozwijanej tagów inteligentnych aktualizacji w formancie CreateUserWizard [ `ActiveStepIndex` właściwości](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.activestepindex.aspx), który określa indeks kroku początkowego.</span><span class="sxs-lookup"><span data-stu-id="0e079-540">Selecting a step through the Smart Tag's drop-down list updates the CreateUserWizard control's [`ActiveStepIndex` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.activestepindex.aspx), which specifies the index of the starting step.</span></span> <span data-ttu-id="0e079-541">W związku z tym Jeśli używasz tej listy rozwijanej do edycji danego kroku "Ustawień" w projektancie, należy go ustawić ponownie na "Logowania w tym nowe konto", aby ten krok jest wyświetlany, jeśli najpierw odwiedzać użytkownicy `EnhancedCreateUserWizard.aspx` strony.</span><span class="sxs-lookup"><span data-stu-id="0e079-541">Therefore, if you use this drop-down list to edit the "Your Settings" step in the Designer, be sure to set it back to "Sign Up for Your New Account" so that this step is shown when users first visit the `EnhancedCreateUserWizard.aspx` page.</span></span>


<span data-ttu-id="0e079-542">Tworzenie interfejsu użytkownika w ramach krok "Twoje ustawienia", który zawiera trzy kontrolki TextBox o nazwie `HomeTown`, `HomepageUrl`, i `Signature`.</span><span class="sxs-lookup"><span data-stu-id="0e079-542">Create a user interface within the "Your Settings" step that contains three TextBox controls named `HomeTown`, `HomepageUrl`, and `Signature`.</span></span> <span data-ttu-id="0e079-543">Po konstruowania ten interfejs, znaczników deklaratywne CreateUserWizard powinien wyglądać podobny do następującego:</span><span class="sxs-lookup"><span data-stu-id="0e079-543">After constructing this interface, the CreateUserWizard's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](storing-additional-user-information-vb/samples/sample14.aspx)]

<span data-ttu-id="0e079-544">Przejdź dalej i stronie za pośrednictwem przeglądarki i utworzyć nowe konto użytkownika, określania wartości dla miejscowość macierzystego, strony głównej i podpis.</span><span class="sxs-lookup"><span data-stu-id="0e079-544">Go ahead and visit this page through a browser and create a new user account, specifying values for the home town, homepage, and signature.</span></span> <span data-ttu-id="0e079-545">Po zakończeniu `CreateUserWizardStep` utworzono konto użytkownika w ramach członkostwa i `CreatedUser` uruchamia program obsługi zdarzeń, które dodaje nowy wiersz do `UserProfiles`, ale z bazą danych `NULL` wartość `HomeTown`, `HomepageUrl`, i `Signature`.</span><span class="sxs-lookup"><span data-stu-id="0e079-545">After completing the `CreateUserWizardStep` the user account is created in the Membership framework and the `CreatedUser` event handler runs, which adds a new row to `UserProfiles`, but with a database `NULL` value for `HomeTown`, `HomepageUrl`, and `Signature`.</span></span> <span data-ttu-id="0e079-546">Wartości podane w domu miejscowość, strony głównej i podpis nigdy nie są używane.</span><span class="sxs-lookup"><span data-stu-id="0e079-546">The values entered for the home town, homepage, and signature are never used.</span></span> <span data-ttu-id="0e079-547">Wynikiem jest konto użytkownika z `UserProfiles` rekordów, których `HomeTown`, `HomepageUrl`, i `Signature` pól nie zostały jeszcze można określić.</span><span class="sxs-lookup"><span data-stu-id="0e079-547">The net result is a new user account with a `UserProfiles` record whose `HomeTown`, `HomepageUrl`, and `Signature` fields have yet to be specified.</span></span>

<span data-ttu-id="0e079-548">Musimy wykonanie kodu po wykonaniu kroku "Twoje ustawienia", przyjmuje macierzystego miejscowość, honepage i podpis wartości wprowadzonej przez użytkownika, który aktualizuje odpowiednie `UserProfiles` rekordu.</span><span class="sxs-lookup"><span data-stu-id="0e079-548">We need to execute code after the "Your Settings" step that takes the home town, honepage, and signature values entered by the user and updates the appropriate `UserProfiles` record.</span></span> <span data-ttu-id="0e079-549">Kontrolowanie każdym razem, użytkownik przechodzi między krokami w kreatorze, Kreator [ `ActiveStepChanged` zdarzeń](https://msdn.microsoft.com/library/system.web.ui.webcontrols.wizard.activestepchanged.aspx) uruchamiany.</span><span class="sxs-lookup"><span data-stu-id="0e079-549">Each time the user moves between steps in a Wizard control, the Wizard's [`ActiveStepChanged` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.wizard.activestepchanged.aspx) fires.</span></span> <span data-ttu-id="0e079-550">Można utworzyć program obsługi zdarzeń dla tego zdarzenia i aktualizację `UserProfiles` tabeli po ukończeniu tego kroku "Ustawień".</span><span class="sxs-lookup"><span data-stu-id="0e079-550">We can create an event handler for this event and update the `UserProfiles` table when the "Your Settings" step has completed.</span></span>

<span data-ttu-id="0e079-551">Dodawanie obsługi zdarzeń dla CreateUserWizard `ActiveStepChanged` zdarzeń i Dodaj następujący kod:</span><span class="sxs-lookup"><span data-stu-id="0e079-551">Add an event handler for the CreateUserWizard's `ActiveStepChanged` event and add the following code:</span></span>

[!code-vb[Main](storing-additional-user-information-vb/samples/sample15.vb)]

<span data-ttu-id="0e079-552">Powyższy kod uruchamia się za określenie, czy po prostu osiągnęliśmy kroku "Zakończ".</span><span class="sxs-lookup"><span data-stu-id="0e079-552">The above code starts by determining if we have just reached the "Complete" step.</span></span> <span data-ttu-id="0e079-553">Ponieważ krok "Zakończ" występuje natychmiast po wykonaniu kroku "Twoje ustawienia", następnie po osiągnięciu przez obiekt odwiedzający "Ukończone" krok oznaczający, że użytkownik właśnie zakończono kroku "Ustawień".</span><span class="sxs-lookup"><span data-stu-id="0e079-553">Since the "Complete" step occurs immediately after the "Your Settings" step, then when the visitor reaches "Complete" step that means she just finished the "Your Settings" step.</span></span>

<span data-ttu-id="0e079-554">W takim przypadku należy programowo odwołują się do formantów TextBox w `UserSettings WizardStep`.</span><span class="sxs-lookup"><span data-stu-id="0e079-554">In such a case, we need to programmatically reference the TextBox controls within the `UserSettings WizardStep`.</span></span> <span data-ttu-id="0e079-555">Odbywa się przy pierwszym użyciu `FindControl` programowo odwołuje się do metody `UserSettings WizardStep`, a następnie ponownie, aby odwołać się do pól tekstowych z poziomu `WizardStep`.</span><span class="sxs-lookup"><span data-stu-id="0e079-555">This is accomplished by first using the `FindControl` method to programmatically referencing the `UserSettings WizardStep`, and then again to reference the TextBoxes from within the `WizardStep`.</span></span> <span data-ttu-id="0e079-556">Po odwołaniu pól tekstowych już wszystko gotowe do wykonania `UPDATE` instrukcji.</span><span class="sxs-lookup"><span data-stu-id="0e079-556">Once the TextBoxes have been referenced, we're ready to execute the `UPDATE` statement.</span></span> <span data-ttu-id="0e079-557">`UPDATE` Instrukcji ma taką samą liczbę parametrów jako `INSERT` instrukcji w `CreatedUser` program obsługi zdarzeń, ale w tym miejscu używamy domową miejscowość, strony głównej i podpis wartości podane przez użytkownika.</span><span class="sxs-lookup"><span data-stu-id="0e079-557">The `UPDATE` statement has the same number of parameters as the `INSERT` statement in the `CreatedUser` event handler, but here we use the home town, homepage, and signature values supplied by the user.</span></span>

<span data-ttu-id="0e079-558">Z tej obsługi zdarzeń w miejscu, odwiedź stronę `EnhancedCreateUserWizard.aspx` stronie za pośrednictwem przeglądarki, a następnie utwórz nowe konto użytkownika, określania wartości dla miejscowość macierzystego, strony głównej i podpis.</span><span class="sxs-lookup"><span data-stu-id="0e079-558">With this event handler in place, visit the `EnhancedCreateUserWizard.aspx` page through a browser and create a new user account specifying values for the home town, homepage, and signature.</span></span> <span data-ttu-id="0e079-559">Po utworzeniu nowego konta powinno nastąpić przekierowanie do `AdditionalUserInfo.aspx` strony, gdzie dokładnie wprowadzane macierzystego miejscowość, strony głównej i podpis informacje są wyświetlane.</span><span class="sxs-lookup"><span data-stu-id="0e079-559">After creating the new account you should be redirected to the `AdditionalUserInfo.aspx` page, where the just-entered home town, homepage, and signature information is displayed.</span></span>

> [!NOTE]
> <span data-ttu-id="0e079-560">Nasze witryny sieci Web ma obecnie dwie strony, z których użytkownik może utworzyć nowe konto: `CreatingUserAccounts.aspx` i `EnhancedCreateUserWizard.aspx`.</span><span class="sxs-lookup"><span data-stu-id="0e079-560">Our website currently has two pages from which a visitor can create a new account: `CreatingUserAccounts.aspx` and `EnhancedCreateUserWizard.aspx`.</span></span> <span data-ttu-id="0e079-561">Mapy witryny sieci Web i strony logowania, wskaż `CreatingUserAccounts.aspx` strony, ale `CreatingUserAccounts.aspx` strony nie Monituj użytkownika o ich macierzystego miejscowość, strony głównej i podpis informacji i nie dodaje odpowiedni wiersz do `UserProfiles`.</span><span class="sxs-lookup"><span data-stu-id="0e079-561">The website's sitemap and login page point to the `CreatingUserAccounts.aspx` page, but the `CreatingUserAccounts.aspx` page does not prompt the user for their home town, homepage, and signature information and does not add a corresponding row to `UserProfiles`.</span></span> <span data-ttu-id="0e079-562">W związku z tym zaktualizować `CreatingUserAccounts.aspx` strony, dzięki czemu oferuje tej funkcji lub aktualizowanie strony mapy witryny i zaloguj się do odwołania `EnhancedCreateUserWizard.aspx` zamiast `CreatingUserAccounts.aspx`.</span><span class="sxs-lookup"><span data-stu-id="0e079-562">Therefore, either update the `CreatingUserAccounts.aspx` page so that it offers this functionality or update the sitemap and login page to reference `EnhancedCreateUserWizard.aspx` instead of `CreatingUserAccounts.aspx`.</span></span> <span data-ttu-id="0e079-563">Jeśli wybierzesz tę druga opcję należy zaktualizować `Membership` folderu `Web.config` pliku tak, aby zezwolić na dostęp do użytkowników anonimowych `EnhancedCreateUserWizard.aspx` strony.</span><span class="sxs-lookup"><span data-stu-id="0e079-563">If you choose the latter option, be sure to update the `Membership` folder's `Web.config` file so as to allow anonymous users access to the `EnhancedCreateUserWizard.aspx` page.</span></span>


## <a name="summary"></a><span data-ttu-id="0e079-564">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="0e079-564">Summary</span></span>

<span data-ttu-id="0e079-565">W tym samouczku analizujemy techniki modelowania danych, które jest powiązane z kont użytkowników w ramach członkostwa.</span><span class="sxs-lookup"><span data-stu-id="0e079-565">In this tutorial we looked at techniques for modeling data that is related to user accounts within the Membership framework.</span></span> <span data-ttu-id="0e079-566">W szczególności analizujemy modelowania podmiotom udostępniać relacji jeden do wielu kont użytkowników, a także dane, które współużytkują relacją.</span><span class="sxs-lookup"><span data-stu-id="0e079-566">In particular, we looked at modeling entities that share a one-to-many relationship with user accounts as well as data that shares a one-to-one relationship.</span></span> <span data-ttu-id="0e079-567">Ponadto widzieliśmy, jak to powiązane informacje można są wyświetlane, wstawiane i aktualizowane z przykładami za pomocą formantu SqlDataSource i inne przy użyciu kodu ADO.NET.</span><span class="sxs-lookup"><span data-stu-id="0e079-567">Furthermore, we saw how this related information could be displayed, inserted, and updated, with some examples using the SqlDataSource control and others using ADO.NET code.</span></span>

<span data-ttu-id="0e079-568">W tym samouczku wykonuje naszych przyjrzeć się konta użytkowników.</span><span class="sxs-lookup"><span data-stu-id="0e079-568">This tutorial completes our look at user accounts.</span></span> <span data-ttu-id="0e079-569">Począwszy od w następnym samouczku będziemy spowoduje wyłączenie wymagające uwagi do ról.</span><span class="sxs-lookup"><span data-stu-id="0e079-569">Starting with the next tutorial we will turn our attention to roles.</span></span> <span data-ttu-id="0e079-570">W następnych kilku samouczkach przedstawiono w ramach ról Zobacz Tworzenie nowych ról sposobu przypisywania ról użytkowników, w jaki sposób można określić, jakie role użytkownika należy do oraz w jaki sposób ma być stosowana autoryzacja oparta na rolach.</span><span class="sxs-lookup"><span data-stu-id="0e079-570">Over the next several tutorials we will look at the Roles framework, see how to create new roles, how to assign roles to users, how to determine what roles a user belongs to, and how to apply role-based authorization.</span></span>

<span data-ttu-id="0e079-571">Programowanie przyjemność!</span><span class="sxs-lookup"><span data-stu-id="0e079-571">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="0e079-572">Dalsze informacje</span><span class="sxs-lookup"><span data-stu-id="0e079-572">Further Reading</span></span>

<span data-ttu-id="0e079-573">Więcej informacji dotyczących tematów omówionych w tym samouczku można znaleźć w następujących zasobach:</span><span class="sxs-lookup"><span data-stu-id="0e079-573">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="0e079-574">Uzyskiwanie dostępu i aktualizowanie danych w programie ASP.NET 2.0</span><span class="sxs-lookup"><span data-stu-id="0e079-574">Accessing and Updating Data in ASP.NET 2.0</span></span>](http://aspnet.4guysfromrolla.com/articles/011106-1.aspx)
- [<span data-ttu-id="0e079-575">Formant ASP.NET 2.0 Kreatora</span><span class="sxs-lookup"><span data-stu-id="0e079-575">ASP.NET 2.0 Wizard Control</span></span>](https://weblogs.asp.net/scottgu/archive/2006/02/21/438732.aspx)
- [<span data-ttu-id="0e079-576">Tworzenie za pomocą programu ASP.NET 2.0 Kreator formantu interfejsu użytkownika krok po kroku</span><span class="sxs-lookup"><span data-stu-id="0e079-576">Creating a Step-by-Step User Interface with the ASP.NET 2.0 Wizard Control</span></span>](http://aspnet.4guysfromrolla.com/articles/061406-1.aspx)
- [<span data-ttu-id="0e079-577">Tworzenie parametrów sterujących niestandardowe źródło danych</span><span class="sxs-lookup"><span data-stu-id="0e079-577">Creating Custom DataSource Control Parameters</span></span>](http://aspnet.4guysfromrolla.com/articles/110106-1.aspx)
- [<span data-ttu-id="0e079-578">Dostosowywanie formancie CreateUserWizard</span><span class="sxs-lookup"><span data-stu-id="0e079-578">Customizing the CreateUserWizard Control</span></span>](http://aspnet.4guysfromrolla.com/articles/070506-1.aspx)
- [<span data-ttu-id="0e079-579">Przewodniki Szybki Start formantu widoku DetailsView</span><span class="sxs-lookup"><span data-stu-id="0e079-579">DetailsView Control QuickStarts</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/data/detailsview.aspx)
- [<span data-ttu-id="0e079-580">Wyświetlanie danych za pomocą formantu ListView</span><span class="sxs-lookup"><span data-stu-id="0e079-580">Displaying Data with the ListView Control</span></span>](http://aspnet.4guysfromrolla.com/articles/122607-1.aspx)
- [<span data-ttu-id="0e079-581">Pincety formanty walidacji w programie ASP.NET 2.0</span><span class="sxs-lookup"><span data-stu-id="0e079-581">Dissecting the Validation Controls in ASP.NET 2.0</span></span>](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx)
- [<span data-ttu-id="0e079-582">Wstaw edytowanie i usuwanie danych</span><span class="sxs-lookup"><span data-stu-id="0e079-582">Editing Insert and Deleting Data</span></span>](../../data-access/editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md)
- [<span data-ttu-id="0e079-583">Sprawdzanie poprawności formularz w programie ASP.NET</span><span class="sxs-lookup"><span data-stu-id="0e079-583">Form Validation in ASP.NET</span></span>](http://www.4guysfromrolla.com/webtech/090200-1.shtml)
- [<span data-ttu-id="0e079-584">Zbieranie informacji o rejestracji użytkownika niestandardowego</span><span class="sxs-lookup"><span data-stu-id="0e079-584">Gathering Custom User Registration Information</span></span>](https://weblogs.asp.net/scottgu/archive/2006/07/05/Tip_2F00_Trick_3A00_-Gathering-Custom-User-Registration-Information.aspx)
- [<span data-ttu-id="0e079-585">Profilów w programie ASP.NET 2.0</span><span class="sxs-lookup"><span data-stu-id="0e079-585">Profiles in ASP.NET 2.0</span></span>](http://www.odetocode.com/Articles/440.aspx)
- [<span data-ttu-id="0e079-586">Formant asp: ListView</span><span class="sxs-lookup"><span data-stu-id="0e079-586">The asp:ListView Control</span></span>](https://weblogs.asp.net/scottgu/archive/2007/08/10/the-asp-listview-control-part-1-building-a-product-listing-page-with-clean-css-ui.aspx)
- [<span data-ttu-id="0e079-587">Szybki Start profilów użytkownika</span><span class="sxs-lookup"><span data-stu-id="0e079-587">User Profiles QuickStart</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/profile/default.aspx)

### <a name="about-the-author"></a><span data-ttu-id="0e079-588">Informacje o autorze</span><span class="sxs-lookup"><span data-stu-id="0e079-588">About the Author</span></span>

<span data-ttu-id="0e079-589">Scott Bento, Utwórz wiele książek ASP/ASP.NET i twórcę 4GuysFromRolla.com, pracuje z technologii Microsoft Web od 1998.</span><span class="sxs-lookup"><span data-stu-id="0e079-589">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="0e079-590">Scott działa jako niezależnego konsultanta trainer i składnika zapisywania.</span><span class="sxs-lookup"><span data-stu-id="0e079-590">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="0e079-591">Jest jego najnowszej książki  *[Sams nauczyć się ASP.NET 2.0 w ciągu 24 godzin](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span><span class="sxs-lookup"><span data-stu-id="0e079-591">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="0e079-592">Scott jest osiągalny w [ mitchell@4guysfromrolla.com ](mailto:mitchell@4guysfromrolla.com) lub za pośrednictwem jego blogu w [ http://ScottOnWriting.NET ](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="0e079-592">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="0e079-593">Specjalne podziękowania dla...</span><span class="sxs-lookup"><span data-stu-id="0e079-593">Special Thanks To…</span></span>

<span data-ttu-id="0e079-594">Ten samouczek serii zostało sprawdzone przez wiele recenzentów przydatne.</span><span class="sxs-lookup"><span data-stu-id="0e079-594">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="0e079-595">Zainteresowani recenzowania Moje nadchodzących artykuły MSDN?</span><span class="sxs-lookup"><span data-stu-id="0e079-595">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="0e079-596">Jeśli tak, Porzuć mnie linii w [ mitchell@4GuysFromRolla.com ](mailto:mitchell@4GuysFromRolla.com).</span><span class="sxs-lookup"><span data-stu-id="0e079-596">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com).</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="0e079-597">Poprzednie</span><span class="sxs-lookup"><span data-stu-id="0e079-597">Previous</span></span>](user-based-authorization-vb.md)
