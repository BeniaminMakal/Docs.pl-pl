---
uid: web-forms/overview/older-versions-getting-started/master-pages/interacting-with-the-content-page-from-the-master-page-cs
title: Interakcji ze strony zawartość z strony wzorcowej (C#) | Dokumentacja firmy Microsoft
author: rick-anderson
description: Sprawdza, czy sposób wywołania metody, ustaw właściwości, etc. zawartości strony z kodu na stronie wzorcowej.
ms.author: aspnetcontent
manager: wpickett
ms.date: 07/11/2008
ms.topic: article
ms.assetid: 3282df5e-516c-4972-8666-313828b90fb5
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/older-versions-getting-started/master-pages/interacting-with-the-content-page-from-the-master-page-cs
msc.type: authoredcontent
ms.openlocfilehash: 7c845c7b0077e6d3fb5ce770029b4f9f48609b17
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/06/2018
---
<a name="interacting-with-the-content-page-from-the-master-page-c"></a><span data-ttu-id="6d4cf-103">Interakcji ze strony zawartość z strony wzorcowej (C#)</span><span class="sxs-lookup"><span data-stu-id="6d4cf-103">Interacting with the Content Page from the Master Page (C#)</span></span>
====================
<span data-ttu-id="6d4cf-104">przez [Bento Scott](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="6d4cf-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="6d4cf-105">[Pobierz kod](http://download.microsoft.com/download/1/8/4/184e24fa-fcc8-47fa-ac99-4b6a52d41e97/ASPNET_MasterPages_Tutorial_07_CS.zip) lub [pobierania plików PDF](http://download.microsoft.com/download/e/b/4/eb4abb10-c416-4ba4-9899-32577715b1bd/ASPNET_MasterPages_Tutorial_07_CS.pdf)</span><span class="sxs-lookup"><span data-stu-id="6d4cf-105">[Download Code](http://download.microsoft.com/download/1/8/4/184e24fa-fcc8-47fa-ac99-4b6a52d41e97/ASPNET_MasterPages_Tutorial_07_CS.zip) or [Download PDF](http://download.microsoft.com/download/e/b/4/eb4abb10-c416-4ba4-9899-32577715b1bd/ASPNET_MasterPages_Tutorial_07_CS.pdf)</span></span>

> <span data-ttu-id="6d4cf-106">Sprawdza, czy sposób wywołania metody, ustaw właściwości, etc. zawartości strony z kodu na stronie wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-106">Examines how to call methods, set properties, etc. of the Content Page from code in the Master Page.</span></span>


## <a name="introduction"></a><span data-ttu-id="6d4cf-107">Wprowadzenie</span><span class="sxs-lookup"><span data-stu-id="6d4cf-107">Introduction</span></span>

<span data-ttu-id="6d4cf-108">Samouczek poprzedniego zbadać sposobu ustawiania strony zawartości programowo interakcji z jego strony wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-108">The preceding tutorial examined how to have the content page programmatically interact with its master page.</span></span> <span data-ttu-id="6d4cf-109">Odwołania, że Zaktualizowaliśmy stronę wzorcową do uwzględnienia w kontrolce GridView wymienionego pięć ostatnio dodane produktów.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-109">Recall that we updated the master page to include a GridView control that listed the five most recently added products.</span></span> <span data-ttu-id="6d4cf-110">Następnie utworzyliśmy strony zawartości, w którym użytkownik może dodać nowego produktu.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-110">We then created a content page from which the user could add a new product.</span></span> <span data-ttu-id="6d4cf-111">Po dodaniu nowego produktu, strony zawartości potrzebne, aby poinstruować strony wzorcowej, aby odświeżyć jej GridView tak, aby go to po prostu dodane produktu.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-111">Upon adding a new product, the content page needed to instruct the master page to refresh its GridView so that it would include the just-added product.</span></span> <span data-ttu-id="6d4cf-112">Ta funkcja została realizowane przez dodanie publicznej metody strony wzorcowej, aby odświeżyć dane powiązane widoku GridView, a następnie wywołania tej metody na stronie zawartości.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-112">This functionality was accomplished by adding a public method to the master page that refreshed the data bound to the GridView, and then invoking that method from the content page.</span></span>

<span data-ttu-id="6d4cf-113">Najczęściej zawartości i interakcji z strony wzorcowej pochodzi ze strony zawartość.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-113">The most common form of content and master page interaction originates from the content page.</span></span> <span data-ttu-id="6d4cf-114">Jednak jest możliwe w dla strony wzorcowej do rouse bieżącej strony zawartości do akcji, a tych funkcji mogą być wymagane, jeśli strony wzorcowej zawiera elementy interfejsu użytkownika, które umożliwiają użytkownikom modyfikowanie danych wyświetlanych na stronie zawartości.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-114">However, it is possible for the master page to rouse the current content page into action, and such functionality may be needed if the master page contains user interface elements that enable users to modify data that is also displayed on the content page.</span></span> <span data-ttu-id="6d4cf-115">Należy wziąć pod uwagę strony zawartości, że wyświetla informacji o produktach, w widoku GridView control i strony głównej, która zawiera przycisk kontrolować, po kliknięciu, podwaja ceny wszystkich produktów.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-115">Consider a content page that displays the products information in a GridView control and a master page that includes a Button control that, when clicked, doubles the prices of all products.</span></span> <span data-ttu-id="6d4cf-116">Podobnie jak w przykładzie w poprzednim samouczek widoku GridView konieczne jest odświeżenie po Podwójna cena, który przycisk zostanie kliknięty, tak aby wyświetlone nowe ceny, ale w tym scenariuszu jest strony wzorcowej wymagającym rouse strony zawartości do akcji.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-116">Much like the example in the preceding tutorial, the GridView needs to be refreshed after the double price Button is clicked so that it displays the new prices, but in this scenario it's the master page that needs to rouse the content page into action.</span></span>

<span data-ttu-id="6d4cf-117">W tym samouczku Eksploruje sposobu ustawiania wywołania funkcji zdefiniowane na stronie zawartości strony wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-117">This tutorial explores how to have the master page invoke functionality defined in the content page.</span></span>

### <a name="instigating-programmatic-interaction-via-an-event-and-event-handlers"></a><span data-ttu-id="6d4cf-118">Podżeganie programowe interakcji za pomocą zdarzeń i procedury obsługi zdarzeń</span><span class="sxs-lookup"><span data-stu-id="6d4cf-118">Instigating Programmatic Interaction via an Event and Event Handlers</span></span>

<span data-ttu-id="6d4cf-119">Wywoływanie funkcji strona zawartości ze strony wzorcowej jest trudniejsze niż odwrotnie.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-119">Invoking content page functionality from a master page is more challenging than the other way around.</span></span> <span data-ttu-id="6d4cf-120">Ponieważ zawartość strony ma jednej strony wzorcowej, gdy podżeganie programowe interakcji ze strony zawartość wiemy publicznej metody i właściwości są nasze dyspozycji.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-120">Because a content page has a single master page, when instigating the programmatic interaction from the content page we know what public methods and properties are at our disposal.</span></span> <span data-ttu-id="6d4cf-121">Strony wzorcowej, jednak może mieć wiele różnych zawartości stron, a każda z zestawem właściwości i metod.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-121">A master page, however, can have many different content pages, each with its own set of properties and methods.</span></span> <span data-ttu-id="6d4cf-122">Jak następnie możemy pisać kod na stronie głównej na wykonanie akcji na stronie jej zawartości, jeśli nie wiadomo, jaki strony zawartość zostanie wywołany, aż do środowiska wykonawczego?</span><span class="sxs-lookup"><span data-stu-id="6d4cf-122">How, then, can we write code in the master page to perform some action in its content page when we don't know what content page will be invoked until runtime?</span></span>

<span data-ttu-id="6d4cf-123">Należy wziąć pod uwagę formant sieci Web ASP.NET, takich jak formantu przycisku.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-123">Consider an ASP.NET Web control, such as the Button control.</span></span> <span data-ttu-id="6d4cf-124">Kontrolka przycisku może występować na dowolnej liczbie stron ASP.NET i musi mechanizm, za pomocą której go może generować alerty strony został kliknięty.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-124">A Button control can appear on any number of ASP.NET pages and needs a mechanism by which it can alert the page that it has been clicked.</span></span> <span data-ttu-id="6d4cf-125">Jest to realizowane przy użyciu *zdarzenia*.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-125">This is accomplished using *events*.</span></span> <span data-ttu-id="6d4cf-126">W szczególności zgłasza formantu przycisku jego `Click` zdarzenie po kliknięciu; strony ASP.NET, która zawiera przycisk opcjonalnie może odpowiadać na powiadomienia za pośrednictwem *obsługi zdarzeń*.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-126">In particular, the Button control raises its `Click` event when it is clicked; the ASP.NET page that contains the Button can optionally respond to that notification via an *event handler*.</span></span>

<span data-ttu-id="6d4cf-127">Tego samego wzorca może służyć do ma funkcje wyzwalacza strony wzorcowej w jej zawartości strony:</span><span class="sxs-lookup"><span data-stu-id="6d4cf-127">This same pattern can be used to have a master page trigger functionality in its content pages:</span></span>

1. <span data-ttu-id="6d4cf-128">Dodawanie zdarzenia strony wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-128">Add an event to the master page.</span></span>
2. <span data-ttu-id="6d4cf-129">Wywołaj zdarzenie, gdy strony wzorcowej musi łączyć się z jego zawartości strony.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-129">Raise the event whenever the master page needs to communicate with its content page.</span></span> <span data-ttu-id="6d4cf-130">Na przykład jeśli strony wzorcowej musi alertów jego strony zawartości, czy użytkownik ma podwójny cen, jej zdarzenia będą zgłaszane, natychmiast po ceny zostały podwójny.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-130">For example, if the master page needs to alert its content page that the user has doubled the prices, its event would be raised immediately after the prices have been doubled.</span></span>
3. <span data-ttu-id="6d4cf-131">Utwórz program obsługi zdarzeń w tych strony zawartości, które należy wykonać kilka akcji.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-131">Create an event handler in those content pages that need to take some action.</span></span>

<span data-ttu-id="6d4cf-132">Ta pozostałej części tego samouczka implementację przykładzie opisano we wprowadzeniu; to znaczy strony zawartości, który zawiera listę produktów w bazie danych i strony głównej, która zawiera przycisk kontrolować dwukrotnie ceny.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-132">This remainder of this tutorial implements the example outlined in the Introduction; namely, a content page that lists the products in the database and a master page that includes a Button control to double the prices.</span></span>

## <a name="step-1-displaying-products-in-a-content-page"></a><span data-ttu-id="6d4cf-133">Krok 1: Wyświetlanie produktów na stronie zawartości</span><span class="sxs-lookup"><span data-stu-id="6d4cf-133">Step 1: Displaying Products in a Content Page</span></span>

<span data-ttu-id="6d4cf-134">Nasza pierwszy firma w kolejności polega na utworzeniu strony zawartości, który zawiera listę produktów z bazy danych Northwind.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-134">Our first order of business is to create a content page that lists the products from the Northwind database.</span></span> <span data-ttu-id="6d4cf-135">(Dodaliśmy bazy danych Northwind do projektu w poprzednim samouczka [ *interakcji ze stroną wzorcową ze strony zawartość*](interacting-with-the-master-page-from-the-content-page-cs.md).) Rozpocznij od dodania nowej strony ASP.NET do `~/Admin` folder o nazwie `Products.aspx`, wprowadzania się, że aby powiązać `Site.master` strony wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-135">(We added the Northwind database to the project in the preceding tutorial, [*Interacting with the Master Page from the Content Page*](interacting-with-the-master-page-from-the-content-page-cs.md).) Start by adding a new ASP.NET page to the `~/Admin` folder named `Products.aspx`, making sure to bind it to the `Site.master` master page.</span></span> <span data-ttu-id="6d4cf-136">Rysunek 1 Pokazuje Eksplorator rozwiązań po dodaniu tej strony w witrynie sieci Web.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-136">Figure 1 shows the Solution Explorer after this page has been added to the website.</span></span>


<span data-ttu-id="6d4cf-137">[![Dodaj nową stronę ASP.NET do folderu Admin.](interacting-with-the-content-page-from-the-master-page-cs/_static/image2.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="6d4cf-137">[![Add a New ASP.NET Page to the Admin Folder](interacting-with-the-content-page-from-the-master-page-cs/_static/image2.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image1.png)</span></span>

<span data-ttu-id="6d4cf-138">**Rysunek 01**: Dodaj nową stronę ASP.NET do `Admin` Folder ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](interacting-with-the-content-page-from-the-master-page-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="6d4cf-138">**Figure 01**: Add a New ASP.NET Page to the `Admin` Folder ([Click to view full-size image](interacting-with-the-content-page-from-the-master-page-cs/_static/image3.png))</span></span>


<span data-ttu-id="6d4cf-139">Odwołaj w [ *określenie tytułu, tagi Meta i inne nagłówków HTML na stronie wzorcowej* ](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-cs.md) samouczek utworzyliśmy klasy niestandardowej strony podstawowej o nazwie `BasePage` generujący tytuł strony, jeśli nie jest jawnie ustawione.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-139">Recall that in the [*Specifying the Title, Meta Tags, and Other HTML Headers in the Master Page*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-cs.md) tutorial we created a custom base page class named `BasePage` that generates the page's title if it is not explicitly set.</span></span> <span data-ttu-id="6d4cf-140">Przejdź do `Products.aspx` kodem strony klasy i została ona pochodzić od `BasePage` (a nie z `System.Web.UI.Page`).</span><span class="sxs-lookup"><span data-stu-id="6d4cf-140">Go to the `Products.aspx` page's code-behind class and have it derive from `BasePage` (instead of from `System.Web.UI.Page`).</span></span>

<span data-ttu-id="6d4cf-141">Na koniec zaktualizuj `Web.sitemap` pliku, aby uwzględnić wpis dla tej lekcji.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-141">Finally, update the `Web.sitemap` file to include an entry for this lesson.</span></span> <span data-ttu-id="6d4cf-142">Dodaj następujący kod pod `<siteMapNode>` zawartości do lekcji interakcji strony wzorca:</span><span class="sxs-lookup"><span data-stu-id="6d4cf-142">Add the following markup beneath the `<siteMapNode>` for the Content to Master Page Interaction lesson:</span></span>


[!code-xml[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample1.xml)]

<span data-ttu-id="6d4cf-143">Dodanie tego `<siteMapNode>` element jest widoczny w wnioski liście (patrz rysunek 5).</span><span class="sxs-lookup"><span data-stu-id="6d4cf-143">The addition of this `<siteMapNode>` element is reflected in the Lessons list (see Figure 5).</span></span>

<span data-ttu-id="6d4cf-144">Wróć do `Products.aspx`.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-144">Return to `Products.aspx`.</span></span> <span data-ttu-id="6d4cf-145">W zawartości formantu `MainContent`, Dodaj formant widoku GridView i nadaj mu nazwę `ProductsGrid`.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-145">In the Content control for `MainContent`, add a GridView control and name it `ProductsGrid`.</span></span> <span data-ttu-id="6d4cf-146">Powiązać widoku GridView formant SqlDataSource o nazwie `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-146">Bind the GridView to a new SqlDataSource control named `ProductsDataSource`.</span></span>


<span data-ttu-id="6d4cf-147">[![Nowy formant SqlDataSource powiązać widoku GridView](interacting-with-the-content-page-from-the-master-page-cs/_static/image5.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="6d4cf-147">[![Bind the GridView to a New SqlDataSource Control](interacting-with-the-content-page-from-the-master-page-cs/_static/image5.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image4.png)</span></span>

<span data-ttu-id="6d4cf-148">**Rysunek 02**: powiązać widoku GridView nowy formant SqlDataSource ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](interacting-with-the-content-page-from-the-master-page-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="6d4cf-148">**Figure 02**: Bind the GridView to a New SqlDataSource Control  ([Click to view full-size image](interacting-with-the-content-page-from-the-master-page-cs/_static/image6.png))</span></span>


<span data-ttu-id="6d4cf-149">Skonfiguruj kreatora, tak aby były używane z bazą danych Northwind.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-149">Configure the wizard so that it uses the Northwind database.</span></span> <span data-ttu-id="6d4cf-150">Jeśli działał samouczkiem poprzedniej, ma już ciąg połączenia o nazwie `NorthwindConnectionString` w `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-150">If you worked through the previous tutorial then you should already have a connection string named `NorthwindConnectionString` in `Web.config`.</span></span> <span data-ttu-id="6d4cf-151">Wybierz z listy rozwijanej te parametry połączenia, jak pokazano na rysunku 3.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-151">Choose this connection string from the drop-down list, as shown in Figure 3.</span></span>


<span data-ttu-id="6d4cf-152">[![Skonfigurować SqlDataSource korzystanie z bazy danych Northwind](interacting-with-the-content-page-from-the-master-page-cs/_static/image8.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="6d4cf-152">[![Configure the SqlDataSource to Use the Northwind Database](interacting-with-the-content-page-from-the-master-page-cs/_static/image8.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image7.png)</span></span>

<span data-ttu-id="6d4cf-153">**Rysunek 03**: skonfigurować SqlDataSource korzystanie z bazy danych Northwind ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](interacting-with-the-content-page-from-the-master-page-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="6d4cf-153">**Figure 03**: Configure the SqlDataSource to Use the Northwind Database  ([Click to view full-size image](interacting-with-the-content-page-from-the-master-page-cs/_static/image9.png))</span></span>


<span data-ttu-id="6d4cf-154">Następnie określ kontroli źródła danych `SELECT` instrukcji przez wybranie tabeli Produkty z listy rozwijanej i zwracanie `ProductName` i `UnitPrice` kolumn (patrz rysunek 4).</span><span class="sxs-lookup"><span data-stu-id="6d4cf-154">Next, specify the data source control's `SELECT` statement by choosing the Products table from the drop-down list and returning the `ProductName` and `UnitPrice` columns (see Figure 4).</span></span> <span data-ttu-id="6d4cf-155">Kliknij przycisk Dalej, a następnie Zakończ, aby zakończyć pracę Kreatora konfigurowania źródła danych.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-155">Click Next and then Finish to complete the Configure Data Source wizard.</span></span>


<span data-ttu-id="6d4cf-156">[![Zwraca ProductName i UnitPrice pola z tabeli Produkty](interacting-with-the-content-page-from-the-master-page-cs/_static/image11.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="6d4cf-156">[![Return the ProductName and UnitPrice Fields from the Products Table](interacting-with-the-content-page-from-the-master-page-cs/_static/image11.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image10.png)</span></span>

<span data-ttu-id="6d4cf-157">**Rysunek 04**: zwraca `ProductName` i `UnitPrice` pola z `Products` tabeli ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](interacting-with-the-content-page-from-the-master-page-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="6d4cf-157">**Figure 04**: Return the `ProductName` and `UnitPrice` Fields from the `Products` Table  ([Click to view full-size image](interacting-with-the-content-page-from-the-master-page-cs/_static/image12.png))</span></span>


<span data-ttu-id="6d4cf-158">To wszystko jest do niego!</span><span class="sxs-lookup"><span data-stu-id="6d4cf-158">That's all there is to it!</span></span> <span data-ttu-id="6d4cf-159">Po zakończeniu działania kreatora programu Visual Studio dodaje dwa BoundFields do widoku GridView dublowanego dwa pola zwrócony przez formant SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-159">After completing the wizard Visual Studio adds two BoundFields to the GridView to mirror the two fields returned by the SqlDataSource control.</span></span> <span data-ttu-id="6d4cf-160">Formanty widoku GridView i SqlDataSource znaczników jest zgodna.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-160">The GridView and SqlDataSource controls' markup follows.</span></span> <span data-ttu-id="6d4cf-161">Rysunek 5. pokazuje wyniki podczas wyświetlania za pośrednictwem przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-161">Figure 5 shows the results when viewed through a browser.</span></span>


[!code-aspx[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample2.aspx)]


<span data-ttu-id="6d4cf-162">[![W widoku GridView jest wyświetlany każdego produktu i jego ceny](interacting-with-the-content-page-from-the-master-page-cs/_static/image14.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="6d4cf-162">[![Each Product and its Price is Listed in the GridView](interacting-with-the-content-page-from-the-master-page-cs/_static/image14.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image13.png)</span></span>

<span data-ttu-id="6d4cf-163">**Rysunek 05**: każdego produktu i jego ceny znajduje się w widoku GridView ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](interacting-with-the-content-page-from-the-master-page-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="6d4cf-163">**Figure 05**: Each Product and its Price is Listed in the GridView  ([Click to view full-size image](interacting-with-the-content-page-from-the-master-page-cs/_static/image15.png))</span></span>


> [!NOTE]
> <span data-ttu-id="6d4cf-164">Możesz także oczyszczanie widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-164">Feel free to clean up the appearance of the GridView.</span></span> <span data-ttu-id="6d4cf-165">Sugestie obejmują formatowania wyświetlanej wartości UnitPrice jako walutę i przy użyciu czcionki i kolory tła, aby poprawić wygląd siatki.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-165">Some suggestions include formatting the displayed UnitPrice value as a currency and using background colors and fonts to improve the grid's appearance.</span></span> <span data-ttu-id="6d4cf-166">Aby uzyskać więcej informacji na wyświetlanie i formatowania danych w programie ASP.NET odwoływać się do mojej [pracy z samouczkiem serii danych](../../data-access/index.md).</span><span class="sxs-lookup"><span data-stu-id="6d4cf-166">For more information on displaying and formatting data in ASP.NET, refer to my [Working with Data tutorial series](../../data-access/index.md).</span></span>


## <a name="step-2-adding-a-double-prices-button-to-the-master-page"></a><span data-ttu-id="6d4cf-167">Krok 2: Dodawanie przycisku podwójne cen do strony wzorcowej</span><span class="sxs-lookup"><span data-stu-id="6d4cf-167">Step 2: Adding a Double Prices Button to the Master Page</span></span>

<span data-ttu-id="6d4cf-168">Nasze następne zadanie jest można dodać formantu przycisku sieci Web do wzorca strony, po kliknięciu będzie Podwójna cena wszystkich produktów w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-168">Our next task is to add a Button Web control to the master page that, when clicked, will double the price of all products in the database.</span></span> <span data-ttu-id="6d4cf-169">Otwórz `Site.master` strony wzorcowej i przeciągnij element Button z przybornika do projektanta umieszczenia go pod `RecentProductsDataSource` kontroli SqlDataSource dodaliśmy poprzedniej samouczka.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-169">Open the `Site.master` master page and drag a Button from the Toolbox onto the Designer, placing it beneath the `RecentProductsDataSource` SqlDataSource control we added in the previous tutorial.</span></span> <span data-ttu-id="6d4cf-170">Ustaw przycisku `ID` właściwości `DoublePrice` i jego `Text` dla właściwości "Double cen produktu".</span><span class="sxs-lookup"><span data-stu-id="6d4cf-170">Set the Button's `ID` property to `DoublePrice` and its `Text` property to "Double Product Prices".</span></span>

<span data-ttu-id="6d4cf-171">Następnie dodaj formant SqlDataSource strony wzorcowej, nadając mu nazwę `DoublePricesDataSource`.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-171">Next, add a SqlDataSource control to the master page, naming it `DoublePricesDataSource`.</span></span> <span data-ttu-id="6d4cf-172">SqlDataSource to będzie można używać do wykonywania `UPDATE` instrukcji podwojenia wszystkie ceny.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-172">This SqlDataSource will be used to execute the `UPDATE` statement to double all prices.</span></span> <span data-ttu-id="6d4cf-173">W szczególności należy ustawić jego `ConnectionString` i `UpdateCommand` właściwości na ciąg połączenia i `UPDATE` instrukcji.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-173">Specifically, we need to set its `ConnectionString` and `UpdateCommand` properties to the appropriate connection string and `UPDATE` statement.</span></span> <span data-ttu-id="6d4cf-174">Następnie należy wywołać ten formant SqlDataSource `Update` metody podczas `DoublePrice` kliknięciu przycisku.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-174">Then we need to call this SqlDataSource control's `Update` method when the `DoublePrice` Button is clicked.</span></span> <span data-ttu-id="6d4cf-175">Aby ustawić `ConnectionString` i `UpdateCommand` właściwości, wybierz kontrolkę SqlDataSource, a następnie przejdź do okna właściwości.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-175">To set the `ConnectionString` and `UpdateCommand` properties, select the SqlDataSource control and then go to the Properties window.</span></span> <span data-ttu-id="6d4cf-176">`ConnectionString` Właściwość zawiera listę tych parametrów połączenia przechowywanych w `Web.config` na liście rozwijanej wybierz `NorthwindConnectionString` opcji, jak pokazano na rysunku 6.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-176">The `ConnectionString` property lists those connection strings already stored in `Web.config` in a drop-down list; choose the `NorthwindConnectionString` option as shown in Figure 6.</span></span>


<span data-ttu-id="6d4cf-177">[![Skonfigurować SqlDataSource do użycia NorthwindConnectionString](interacting-with-the-content-page-from-the-master-page-cs/_static/image17.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="6d4cf-177">[![Configure the SqlDataSource to Use the NorthwindConnectionString](interacting-with-the-content-page-from-the-master-page-cs/_static/image17.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image16.png)</span></span>

<span data-ttu-id="6d4cf-178">**Rysunek 06**: skonfigurować SqlDataSource użyć `NorthwindConnectionString` ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](interacting-with-the-content-page-from-the-master-page-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="6d4cf-178">**Figure 06**: Configure the SqlDataSource to Use the `NorthwindConnectionString` ([Click to view full-size image](interacting-with-the-content-page-from-the-master-page-cs/_static/image18.png))</span></span>


<span data-ttu-id="6d4cf-179">Aby ustawić `UpdateCommand` właściwości, zlokalizować opcję UpdateQuery w oknie właściwości.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-179">To set the `UpdateCommand` property, locate the UpdateQuery option in the Properties window.</span></span> <span data-ttu-id="6d4cf-180">Tej właściwości, gdy zaznaczone, wyświetli się przycisk z wielokropkiem; Kliknij ten przycisk, aby wyświetlić okno dialogowe Edytor poleceń i parametrów pokazano na rysunku 7.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-180">This property, when selected, displays a button with ellipses; click this button to display the Command and Parameter Editor dialog box shown in Figure 7.</span></span> <span data-ttu-id="6d4cf-181">Wpisz następujące polecenie `UPDATE` instrukcji w oknie dialogowym tekstowym:</span><span class="sxs-lookup"><span data-stu-id="6d4cf-181">Type the following `UPDATE` statement into the dialog box's textbox:</span></span>


[!code-sql[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample3.sql)]

<span data-ttu-id="6d4cf-182">Po wykonaniu tej instrukcji zostanie dwukrotnie `UnitPrice` wartość dla każdego rekordu w `Products` tabeli.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-182">This statement, when executed, will double the `UnitPrice` value for each record in the `Products` table.</span></span>


<span data-ttu-id="6d4cf-183">[![Ustaw właściwość elementu UpdateCommand w źródle SqlDataSource](interacting-with-the-content-page-from-the-master-page-cs/_static/image20.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="6d4cf-183">[![Set SqlDataSource's UpdateCommand Property](interacting-with-the-content-page-from-the-master-page-cs/_static/image20.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image19.png)</span></span>

<span data-ttu-id="6d4cf-184">**Rysunek 07**: Ustaw SqlDataSource `UpdateCommand` właściwości ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](interacting-with-the-content-page-from-the-master-page-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="6d4cf-184">**Figure 07**: Set SqlDataSource's `UpdateCommand` Property  ([Click to view full-size image](interacting-with-the-content-page-from-the-master-page-cs/_static/image21.png))</span></span>


<span data-ttu-id="6d4cf-185">Po ustawieniu właściwości, znaczników deklaratywne przycisk i SqlDataSource formantów powinien wyglądać podobny do następującego:</span><span class="sxs-lookup"><span data-stu-id="6d4cf-185">After setting these properties, your Button and SqlDataSource controls' declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample4.aspx)]

<span data-ttu-id="6d4cf-186">Wszystkie opcje, które pozostaje jest wywołanie jego `Update` — metoda podczas `DoublePrice` przycisk zostanie kliknięty.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-186">All that remains is to call its `Update` method when the `DoublePrice` Button is clicked.</span></span> <span data-ttu-id="6d4cf-187">Utwórz `Click` programu obsługi zdarzeń dla `DoublePrice` przycisk i Dodaj następujący kod:</span><span class="sxs-lookup"><span data-stu-id="6d4cf-187">Create a `Click` event handler for the `DoublePrice` Button and add the following code:</span></span>


[!code-csharp[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample5.cs)]

<span data-ttu-id="6d4cf-188">Aby przetestować tę funkcję, odwiedź stronę `~/Admin/Products.aspx` strony możemy utworzone w kroku 1 i kliknij przycisk "Double cen produktu".</span><span class="sxs-lookup"><span data-stu-id="6d4cf-188">To test this functionality, visit the `~/Admin/Products.aspx` page we created in Step 1 and click the "Double Product Prices" button.</span></span> <span data-ttu-id="6d4cf-189">Kliknięcie przycisku powoduje odświeżenie strony i wykonuje `DoublePrice` przycisku `Click` program obsługi zdarzeń, podwajając ceny wszystkich produktów.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-189">Clicking the button causes a postback and executes the `DoublePrice` Button's `Click` event handler, doubling the prices of all products.</span></span> <span data-ttu-id="6d4cf-190">Następnie ponownie realizacją strony i znaczników zwrócił i ponownie wyświetlić w przeglądarce.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-190">The page is then re-rendered and the markup is returned and re-displayed in the browser.</span></span> <span data-ttu-id="6d4cf-191">Na stronie zawartości widoku GridView jednak listy ceny tej samej, jako przed "Double cen produktu" przycisk został kliknięty.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-191">The GridView in the content page, however, lists the same prices as before the "Double Product Prices" button was clicked.</span></span> <span data-ttu-id="6d4cf-192">Jest to spowodowane stanu przechowywane w stan widoku, więc nie są ładowane na ogłaszania zwrotnego, chyba że poinstruowany miał danych wstępnie załadowane w widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-192">This is because the data initially loaded in the GridView had its state stored in view state, so it's not reloaded on postbacks unless instructed otherwise.</span></span> <span data-ttu-id="6d4cf-193">Jeśli można znaleźć w innej strony, a następnie wróć do `~/Admin/Products.aspx` strony zobaczysz ceny zaktualizowane.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-193">If you visit a different page and then return to the `~/Admin/Products.aspx` page you'll see the updated prices.</span></span>

## <a name="step-3-raising-an-event-when-the-prices-are-doubled"></a><span data-ttu-id="6d4cf-194">Krok 3: Wywoływanie zdarzeń ceny połączeń po są podwójny.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-194">Step 3: Raising an Event When the Prices are Doubled</span></span>

<span data-ttu-id="6d4cf-195">Ponieważ w widoku GridView `~/Admin/Products.aspx` strony nie natychmiast odzwierciedla podwojenie cen, użytkownik understandably może założyć, że nie kliknij przycisk "Double cen produktu" lub że nie działa.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-195">Because the GridView in the `~/Admin/Products.aspx` page does not immediately reflect the price doubling, a user may understandably think that they did not click the "Double Product Prices" button, or that it didn't work.</span></span> <span data-ttu-id="6d4cf-196">Może próbują kliknięcie przycisku więcej kilka razy, podwajając ceny wielokrotnie.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-196">They may try clicking the button a few more times, doubling the prices again and again.</span></span> <span data-ttu-id="6d4cf-197">Aby naprawić to musimy mieć siatki w zawartości Strona wyświetlana nowych cen natychmiast po ich są podwójny.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-197">To fix this we need to have the grid in the content page display the new prices immediately after they are doubled.</span></span>

<span data-ttu-id="6d4cf-198">Zgodnie z opisem we wcześniejszej części tego samouczka, należy wywołać zdarzenie na stronie głównej, gdy użytkownik kliknie `DoublePrice` przycisku.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-198">As discussed earlier in this tutorial, we need to raise an event in the master page whenever the user clicks the `DoublePrice` Button.</span></span> <span data-ttu-id="6d4cf-199">Zdarzenie jest sposobem powiadomienia inny zestaw innych klas (subskrybentów zdarzeń), które coś interesującego wystąpił dla jednej klasy (Wydawca zdarzeń).</span><span class="sxs-lookup"><span data-stu-id="6d4cf-199">An event is a way for one class (an event publisher) to notify another a set of other classes (the event subscribers) that something interesting has occurred.</span></span> <span data-ttu-id="6d4cf-200">W tym przykładzie strony wzorcowej jest wydawca zdarzeń; zawartość tych stron, które o czasie `DoublePrice` przycisku są subskrybentów.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-200">In this example, the master page is the event publisher; those content pages that care about when the `DoublePrice` Button is clicked are the subscribers.</span></span>

<span data-ttu-id="6d4cf-201">Klasa subskrybuje zdarzenia przez utworzenie *obsługi zdarzeń*, czyli metody, która jest wykonywana w odpowiedzi na zdarzenie jest wywoływane.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-201">A class subscribes to an event by creating an *event handler*, which is a method that is executed in response to the event being raised.</span></span> <span data-ttu-id="6d4cf-202">Wydawca definiuje zdarzenia zgłasza on definiując *delegata zdarzenia*.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-202">The publisher defines the events he raises by defining an *event delegate*.</span></span> <span data-ttu-id="6d4cf-203">Delegata zdarzenia określa, jakie parametrów wejściowych zaakceptować programu obsługi zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-203">The event delegate specifies what input parameters the event handler must accept.</span></span> <span data-ttu-id="6d4cf-204">W programie .NET Framework zdarzeń delegaty nie zwraca żadnej wartości i dwóch parametrów wejściowych zaakceptować:</span><span class="sxs-lookup"><span data-stu-id="6d4cf-204">In the .NET Framework, event delegates do not return any value and accept two input parameters:</span></span>

- <span data-ttu-id="6d4cf-205">`Object`, Który identyfikuje źródło zdarzenia i</span><span class="sxs-lookup"><span data-stu-id="6d4cf-205">An `Object`, which identifies the event source, and</span></span>
- <span data-ttu-id="6d4cf-206">Klasy pochodne `System.EventArgs`</span><span class="sxs-lookup"><span data-stu-id="6d4cf-206">A class derived from `System.EventArgs`</span></span>

<span data-ttu-id="6d4cf-207">Drugi parametr przekazany do programu obsługi zdarzeń może zawierać dodatkowe informacje o zdarzeniu.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-207">The second parameter passed to an event handler can include additional information about the event.</span></span> <span data-ttu-id="6d4cf-208">Podczas podstawowym `EventArgs` klasy nie przekazują informacje, .NET Framework zawiera szereg klas, które rozszerzają `EventArgs` i obejmować dodatkowe właściwości.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-208">While the base `EventArgs` class does not pass along any information, the .NET Framework includes a number of classes that extend `EventArgs` and encompass additional properties.</span></span> <span data-ttu-id="6d4cf-209">Na przykład `CommandEventArgs` wystąpienie zostanie przekazany do procedury obsługi zdarzeń, które odpowiadają na `Command` zdarzeń i zawiera dwie właściwości informacyjną: `CommandArgument` i `CommandName`.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-209">For example, a `CommandEventArgs` instance is passed to event handlers that respond to the `Command` event, and includes two informational properties: `CommandArgument` and `CommandName`.</span></span>

> [!NOTE]
> <span data-ttu-id="6d4cf-210">Aby uzyskać więcej informacji na temat tworzenia wywoływanie i obsługa zdarzeń, zobacz [zdarzenia i delegatów](https://msdn.microsoft.com/library/17sde2xt.aspx) i [delegatów zdarzeń w prosty angielskim](http://www.codeproject.com/KB/cs/eventdelegates.aspx).</span><span class="sxs-lookup"><span data-stu-id="6d4cf-210">For more information on creating, raising, and handling events, see [Events and Delegates](https://msdn.microsoft.com/library/17sde2xt.aspx) and [Event Delegates in Simple English](http://www.codeproject.com/KB/cs/eventdelegates.aspx).</span></span>


<span data-ttu-id="6d4cf-211">Aby zdefiniować zdarzenia, użyj następującej składni:</span><span class="sxs-lookup"><span data-stu-id="6d4cf-211">To define an event use the following syntax:</span></span>


[!code-csharp[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample6.cs)]

<span data-ttu-id="6d4cf-212">Ponieważ musimy alertów strony zawartości, gdy użytkownik kliknął przycisk `DoublePrice` przycisk i nie trzeba przekazać dodatkowe informacje, możemy użyć delegata zdarzenia `EventHandler`, który definiuje program obsługi zdarzeń, który akceptuje jako jego Parametr typu obiektu `System.EventArgs`.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-212">Because we only need to alert the content page when the user has clicked the `DoublePrice` Button and do not need to pass along any other additional information, we can use the event delegate `EventHandler`, which defines an event handler that accepts as its second parameter an object of type `System.EventArgs`.</span></span> <span data-ttu-id="6d4cf-213">Aby utworzyć zdarzenia na stronie głównej, Dodaj następujący wiersz kodu do klasy związane z kodem strony wzorcowej:</span><span class="sxs-lookup"><span data-stu-id="6d4cf-213">To create the event in the master page, add the following line of code to the master page's code-behind class:</span></span>


[!code-csharp[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample7.cs)]

<span data-ttu-id="6d4cf-214">Powyższy kod dodaje zdarzenie publiczne strony wzorcowej o nazwie `PricesDoubled`.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-214">The above code adds a public event to the master page named `PricesDoubled`.</span></span> <span data-ttu-id="6d4cf-215">Teraz musisz zgłosić to zdarzenie po ceny zostały podwójny.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-215">We now need to raise this event after the prices have been doubled.</span></span> <span data-ttu-id="6d4cf-216">Aby zgłosić zdarzenie, użyj następującej składni:</span><span class="sxs-lookup"><span data-stu-id="6d4cf-216">To raise an event use the following syntax:</span></span>


[!code-csharp[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample8.cs)]

<span data-ttu-id="6d4cf-217">Gdzie *nadawcy* i *eventArgs* wartości mają zostać przekazane do programu obsługi zdarzeń abonenta.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-217">Where *sender* and *eventArgs* are the values you want to pass to the subscriber's event handler.</span></span>

<span data-ttu-id="6d4cf-218">Aktualizacja `DoublePrice` `Click` obsługi zdarzeń z następującym kodem:</span><span class="sxs-lookup"><span data-stu-id="6d4cf-218">Update the `DoublePrice` `Click` event handler with the following code:</span></span>


[!code-csharp[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample9.cs)]

<span data-ttu-id="6d4cf-219">Jak wcześniej `Click` obsługi zdarzeń, który rozpoczyna się od wywołania `DoublePricesDataSource` kontroli SqlDataSource `Update` metody podwojenia ceny wszystkich produktów.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-219">As before, the `Click` event handler starts by calling the `DoublePricesDataSource` SqlDataSource control's `Update` method to double the prices of all products.</span></span> <span data-ttu-id="6d4cf-220">Po, że istnieją dwa dodatki do obsługi zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-220">Following that there are two additions to the event handler.</span></span> <span data-ttu-id="6d4cf-221">Najpierw `RecentProducts` odświeżania danych w widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-221">First, the `RecentProducts` GridView's data is refreshed.</span></span> <span data-ttu-id="6d4cf-222">Ten element GridView został dodany do strony głównej w poprzednim samouczek i wyświetla pięć produktów najczęściej ostatnio dodane.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-222">This GridView was added to the master page in the preceding tutorial and displays the five most recently-added products.</span></span> <span data-ttu-id="6d4cf-223">Musimy odświeżyć tej siatki, tak aby pokazywał just podwójny cen tych produktów pięć.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-223">We need to refresh this grid so that it shows the just-doubled prices for these five products.</span></span> <span data-ttu-id="6d4cf-224">Następujące, `PricesDoubled` zdarzenia.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-224">Following that, the `PricesDoubled` event is raised.</span></span> <span data-ttu-id="6d4cf-225">Odwołanie do samej strony wzorcowej (`this`) są wysyłane do programu obsługi zdarzeń jako źródło zdarzeń i pustą `EventArgs` obiektu jest wysyłany jako argumenty zdarzenia.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-225">A reference to the master page itself (`this`) is sent to the event handler as the event source and an empty `EventArgs` object is sent as the event arguments.</span></span>

## <a name="step-4-handling-the-event-in-the-content-page"></a><span data-ttu-id="6d4cf-226">Krok 4: Obsługa zdarzeń w zawartości strony</span><span class="sxs-lookup"><span data-stu-id="6d4cf-226">Step 4: Handling the Event in the Content Page</span></span>

<span data-ttu-id="6d4cf-227">W tym momencie zgłasza strony wzorcowej jego `PricesDoubled` zdarzenia przy każdym `DoublePrice` Button — formant zostanie kliknięty.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-227">At this point the master page raises its `PricesDoubled` event whenever the `DoublePrice` Button control is clicked.</span></span> <span data-ttu-id="6d4cf-228">Jednak jest to tylko połowa bitwy — nadal należy do obsługi zdarzeń w subskrybenta.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-228">However, this is only half the battle - we still need to handle the event in the subscriber.</span></span> <span data-ttu-id="6d4cf-229">Ten proces obejmuje dwa kroki: tworzenie obsługi zdarzeń i dodawanie kod okablowania zdarzenia, aby po wywołaniu zdarzenia programu obsługi zdarzeń jest wykonywany.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-229">This involves two steps: creating the event handler and adding event wiring code so that when the event is raised the event handler is executed.</span></span>

<span data-ttu-id="6d4cf-230">Rozpocznij od utworzenia programu obsługi zdarzeń o nazwie `Master_PricesDoubled`.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-230">Start by creating an event handler named `Master_PricesDoubled`.</span></span> <span data-ttu-id="6d4cf-231">Ze względu na sposób zdefiniowanego `PricesDoubled` zdarzenia na stronie głównej dwóch parametrów wejściowych obsługi zdarzeń musi być typu `Object` i `EventArgs`odpowiednio.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-231">Because of how we defined the `PricesDoubled` event in the master page the event handler's two input parameters must be of types `Object` and `EventArgs`, respectively.</span></span> <span data-ttu-id="6d4cf-232">W wywołaniu procedury obsługi zdarzeń `ProductsGrid` w widoku GridView `DataBind` metodę, aby ponownie powiązać dane do siatki.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-232">In the event handler call the `ProductsGrid` GridView's `DataBind` method to rebind the data to the grid.</span></span>


[!code-csharp[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample10.cs)]

<span data-ttu-id="6d4cf-233">Kod obsługi zdarzeń jest pełny, ale jeszcze mamy się do strony wzorcowej okablować `PricesDoubled` zdarzenie, aby ten program obsługi zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-233">The code for the event handler is complete but we've yet to wire the master page's `PricesDoubled` event to this event handler.</span></span> <span data-ttu-id="6d4cf-234">Subskrybent wiążący zdarzenia do obsługi zdarzeń za pomocą następującej składni:</span><span class="sxs-lookup"><span data-stu-id="6d4cf-234">The subscriber wires an event to an event handler via the following syntax:</span></span>


[!code-csharp[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample11.cs)]

<span data-ttu-id="6d4cf-235">*Wydawca* jest odwołanie do obiektu, który oferuje zdarzenia *eventName*, i *methodName* to nazwa programu obsługi zdarzeń zdefiniowanych w subskrybencie, który ma podpis odpowiadający *eventDelegate*.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-235">*publisher* is a reference to the object that offers the event *eventName*, and *methodName* is the name of the event handler defined in the subscriber that has a signature corresponding to the *eventDelegate*.</span></span> <span data-ttu-id="6d4cf-236">Innymi słowy, jeśli delegata zdarzenia jest `EventHandler`, następnie *methodName* musi być nazwą metody w subskrybencie, który nie może zwracać wartości i akceptuje dwa parametry o typach w danych wejściowych `Object` i `EventArgs`, odpowiednio.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-236">In other words, if the event delegate is `EventHandler`, then *methodName* must be the name of a method in the subscriber that does not return a value and accepts two input parameters of types `Object` and `EventArgs`, respectively.</span></span>

<span data-ttu-id="6d4cf-237">Ten kod okablowania zdarzenia musi zostać wykonana na pierwszej wizyty strony i kolejne ogłaszania zwrotnego i powinny występować w momencie w cyklu życia strony poprzedzający podczas może zostać zgłoszone zdarzenie.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-237">This event wiring code must be executed on the first page visit and subsequent postbacks and should occur at a point in the page lifecycle that precedes when the event may be raised.</span></span> <span data-ttu-id="6d4cf-238">Odpowiedni moment, aby dodać kod okablowania zdarzenia jest na etapie PreInit występuje bardzo wczesnym etapie cyklu życia strony.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-238">A good time to add event wiring code is in the PreInit stage, which occurs very early in the page lifecycle.</span></span>

<span data-ttu-id="6d4cf-239">Otwórz `~/Admin/Products.aspx` i Utwórz `Page_PreInit` obsługi zdarzeń:</span><span class="sxs-lookup"><span data-stu-id="6d4cf-239">Open `~/Admin/Products.aspx` and create a `Page_PreInit` event handler:</span></span>


[!code-csharp[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample12.cs)]

<span data-ttu-id="6d4cf-240">Aby ukończyć ten kod okablowania potrzebujemy programowe odwołanie do strony wzorcowej ze strony zawartość.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-240">In order to complete this wiring code we need a programmatic reference to the master page from the content page.</span></span> <span data-ttu-id="6d4cf-241">Jak wspomniano w poprzedniej samouczek, istnieją to zrobić na dwa sposoby:</span><span class="sxs-lookup"><span data-stu-id="6d4cf-241">As noted in the previous tutorial, there are two ways to do this:</span></span>

- <span data-ttu-id="6d4cf-242">Przez rzutowanie z typowaniem luźnym `Page.Master` właściwość do typu odpowiednie strony wzorcowej lub</span><span class="sxs-lookup"><span data-stu-id="6d4cf-242">By casting the loosely-typed `Page.Master` property to the appropriate master page type, or</span></span>
- <span data-ttu-id="6d4cf-243">Dodając `@MasterType` dyrektywę `.aspx` strony, a następnie użyć jednoznacznie `Master` właściwości.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-243">By adding a `@MasterType` directive in the `.aspx` page and then using the strongly-typed `Master` property.</span></span>

<span data-ttu-id="6d4cf-244">Użyjmy drugie podejście.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-244">Let's use the latter approach.</span></span> <span data-ttu-id="6d4cf-245">Dodaj następujące `@MasterType` dyrektywy do górnej części strony deklaratywne znaczników:</span><span class="sxs-lookup"><span data-stu-id="6d4cf-245">Add the following `@MasterType` directive to the top of the page's declarative markup:</span></span>


[!code-aspx[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample13.aspx)]

<span data-ttu-id="6d4cf-246">Następnie dodaj następujący kod okablowania zdarzeń w `Page_PreInit` obsługi zdarzeń:</span><span class="sxs-lookup"><span data-stu-id="6d4cf-246">Then add the following event wiring code in the `Page_PreInit` event handler:</span></span>


[!code-csharp[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample14.cs)]

<span data-ttu-id="6d4cf-247">Z tego kodu w miejscu widoku GridView na stronie zawartości są odświeżane przy każdym `DoublePrice` kliknięciu przycisku.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-247">With this code in place, the GridView in the content page is refreshed whenever the `DoublePrice` Button is clicked.</span></span>

<span data-ttu-id="6d4cf-248">Rysunki 8 do 9 zilustrowanie tego zachowania.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-248">Figures 8 and 9 illustrate this behavior.</span></span> <span data-ttu-id="6d4cf-249">Rysunek nr 8 przedstawia strony po odwiedzeniu najpierw.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-249">Figure 8 shows the page when first visited.</span></span> <span data-ttu-id="6d4cf-250">Należy pamiętać, że ceny wartości w obu `RecentProducts` GridView (w lewej kolumnie strony głównej) i `ProductsGrid` GridView (na stronie zawartości).</span><span class="sxs-lookup"><span data-stu-id="6d4cf-250">Note that price values in both the `RecentProducts` GridView (in the left column of the master page) and the `ProductsGrid` GridView (in the content page).</span></span> <span data-ttu-id="6d4cf-251">Na rysunku nr 9 przedstawiono takie same ekranu natychmiast po `DoublePrice` przycisk został kliknięty.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-251">Figure 9 shows the same screen immediately after the `DoublePrice` Button has been clicked.</span></span> <span data-ttu-id="6d4cf-252">Jak widać, nowych cen natychmiast odzwierciedlone w obu GridViews.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-252">As you can see, the new prices are instantaneously reflected in both GridViews.</span></span>


<span data-ttu-id="6d4cf-253">[![Wartości początkowej cen](interacting-with-the-content-page-from-the-master-page-cs/_static/image23.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="6d4cf-253">[![The Initial Price Values](interacting-with-the-content-page-from-the-master-page-cs/_static/image23.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image22.png)</span></span>

<span data-ttu-id="6d4cf-254">**Rysunek 08**: początkowej wartości cen ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](interacting-with-the-content-page-from-the-master-page-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="6d4cf-254">**Figure 08**: The Initial Price Values  ([Click to view full-size image](interacting-with-the-content-page-from-the-master-page-cs/_static/image24.png))</span></span>


<span data-ttu-id="6d4cf-255">[![Ceny Just-Doubled są wyświetlane w GridViews](interacting-with-the-content-page-from-the-master-page-cs/_static/image26.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="6d4cf-255">[![The Just-Doubled Prices are Displayed in the GridViews](interacting-with-the-content-page-from-the-master-page-cs/_static/image26.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image25.png)</span></span>

<span data-ttu-id="6d4cf-256">**Rysunek 09**: The Just-Doubled ceny są wyświetlane w GridViews ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](interacting-with-the-content-page-from-the-master-page-cs/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="6d4cf-256">**Figure 09**: The Just-Doubled Prices are Displayed in the GridViews  ([Click to view full-size image](interacting-with-the-content-page-from-the-master-page-cs/_static/image27.png))</span></span>


## <a name="summary"></a><span data-ttu-id="6d4cf-257">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="6d4cf-257">Summary</span></span>

<span data-ttu-id="6d4cf-258">W idealnym przypadku strony wzorcowej i na stronach zawartości są całkowicie niezależne od siebie i wymagają żaden poziom interakcji.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-258">Ideally, a master page and its content pages are completely separate from one another and require no level of interaction.</span></span> <span data-ttu-id="6d4cf-259">Jednak jeśli strony wzorcowej lub zawartości Strona, wyświetlająca dane, które mogą być modyfikowane z strony wzorcowej lub strony zawartości, następnie konieczne może mieć strony wzorcowej alertów strony zawartości (lub odwrotnie a) modyfikacji danych tak, aby mógł zostać zaktualizowany ekran.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-259">However, if you have a master page or content page that displays data that can be modified from the master page or content page, then you may need to have the master page alert the content page (or vice-a-versa) when data is modified so that the display can be updated.</span></span> <span data-ttu-id="6d4cf-260">W poprzednim samouczek widzieliśmy sposobu ustawiania strony zawartości programowo interakcji z jego strony wzorcowej; w tym samouczku analizujemy sposobu ustawiania inicjowania strony wzorcowej interakcji.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-260">In the preceding tutorial we saw how to have a content page programmatically interact with its master page; in this tutorial we looked at how to have a master page initiate the interaction.</span></span>

<span data-ttu-id="6d4cf-261">Podczas programowe interakcji między zawartości i strony wzorcowej można pochodzą z zawartości lub strony wzorcowej, wzorzec interakcji używany jest zależna od inicjowanie.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-261">While programmatic interaction between a content and master page can originate from either the content or master page, the interaction pattern used depends on the origination.</span></span> <span data-ttu-id="6d4cf-262">Różnice są wynika z faktu, że zawartość strony ma jednej strony wzorcowej, ale strony wzorcowej może mieć wiele różnych stron zawartości.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-262">The differences are due to the fact that a content page has a single master page, but a master page can have many different content pages.</span></span> <span data-ttu-id="6d4cf-263">Zamiast bezpośrednio interakcji ze strony zawartości strony wzorcowej lepszym rozwiązaniem jest strony wzorcowej zgłosić zdarzenie, która sygnalizuje, że niektóre akcje, miało miejsce.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-263">Rather than having a master page directly interact with a content page, a better approach is to have the master page raise an event to signal that some action has taken place.</span></span> <span data-ttu-id="6d4cf-264">Te strony zawartości, które interesujących akcji można utworzyć procedury obsługi zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-264">Those content pages that care about the action can create event handlers.</span></span>

<span data-ttu-id="6d4cf-265">Programowanie przyjemność!</span><span class="sxs-lookup"><span data-stu-id="6d4cf-265">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="6d4cf-266">Dalsze informacje</span><span class="sxs-lookup"><span data-stu-id="6d4cf-266">Further Reading</span></span>

<span data-ttu-id="6d4cf-267">Więcej informacji dotyczących tematów omówionych w tym samouczku można znaleźć w następujących zasobach:</span><span class="sxs-lookup"><span data-stu-id="6d4cf-267">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="6d4cf-268">Uzyskiwanie dostępu i aktualizowanie danych w programie ASP.NET</span><span class="sxs-lookup"><span data-stu-id="6d4cf-268">Accessing and Updating Data in ASP.NET</span></span>](http://aspnet.4guysfromrolla.com/articles/011106-1.aspx)
- [<span data-ttu-id="6d4cf-269">Zdarzenia i Delegaty</span><span class="sxs-lookup"><span data-stu-id="6d4cf-269">Events and Delegates</span></span>](https://msdn.microsoft.com/library/17sde2xt.aspx)
- [<span data-ttu-id="6d4cf-270">Przekazywanie informacji między zawartości i stron wzorcowych</span><span class="sxs-lookup"><span data-stu-id="6d4cf-270">Passing Information Between Content and Master Pages</span></span>](http://aspnet.4guysfromrolla.com/articles/013107-1.aspx)
- [<span data-ttu-id="6d4cf-271">Praca z danymi w samouczkach ASP.NET</span><span class="sxs-lookup"><span data-stu-id="6d4cf-271">Working with Data in ASP.NET Tutorials</span></span>](../../data-access/index.md)

### <a name="about-the-author"></a><span data-ttu-id="6d4cf-272">Informacje o autorze</span><span class="sxs-lookup"><span data-stu-id="6d4cf-272">About the Author</span></span>

<span data-ttu-id="6d4cf-273">[Scott Bento](http://www.4guysfromrolla.com/ScottMitchell.shtml), autora wielu książek ASP/ASP.NET i twórcę 4GuysFromRolla.com pracuje z technologii Microsoft Web od 1998.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-273">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="6d4cf-274">Scott działa jako niezależnego konsultanta trainer i składnika zapisywania.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-274">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="6d4cf-275">Jest jego najnowszej książki [ *Sams nauczyć się ASP.NET 3.5 w ciągu 24 godzin*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="6d4cf-275">His latest book is [*Sams Teach Yourself ASP.NET 3.5 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco).</span></span> <span data-ttu-id="6d4cf-276">Scott jest osiągalny w [ mitchell@4GuysFromRolla.com ](mailto:mitchell@4GuysFromRolla.com) lub za pośrednictwem jego blogu w [ http://ScottOnWriting.NET ](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="6d4cf-276">Scott can be reached at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="6d4cf-277">Specjalne podziękowania dla</span><span class="sxs-lookup"><span data-stu-id="6d4cf-277">Special Thanks To</span></span>

<span data-ttu-id="6d4cf-278">Ten samouczek serii zostało sprawdzone przez wiele recenzentów przydatne.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-278">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="6d4cf-279">Recenzenta realizacji w tym samouczku został Suchi Banerjee.</span><span class="sxs-lookup"><span data-stu-id="6d4cf-279">Lead reviewer for this tutorial was Suchi Banerjee.</span></span> <span data-ttu-id="6d4cf-280">Zainteresowani recenzowania Moje nadchodzących artykuły MSDN?</span><span class="sxs-lookup"><span data-stu-id="6d4cf-280">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="6d4cf-281">Jeśli tak, Porzuć mnie linii w [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="6d4cf-281">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="6d4cf-282">[Poprzednie](interacting-with-the-master-page-from-the-content-page-cs.md)
> [dalej](master-pages-and-asp-net-ajax-cs.md)</span><span class="sxs-lookup"><span data-stu-id="6d4cf-282">[Previous](interacting-with-the-master-page-from-the-content-page-cs.md)
[Next](master-pages-and-asp-net-ajax-cs.md)</span></span>
