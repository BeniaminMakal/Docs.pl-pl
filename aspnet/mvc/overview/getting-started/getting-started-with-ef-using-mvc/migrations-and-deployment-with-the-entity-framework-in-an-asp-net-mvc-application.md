---
uid: mvc/overview/getting-started/getting-started-with-ef-using-mvc/migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application
title: "Kod najpierw migracje i wdrażanie za pomocą programu Entity Framework w aplikacji platformy ASP.NET MVC | Dokumentacja firmy Microsoft"
author: tdykstra
description: "Przykładową aplikację sieci web firmy Contoso University przedstawia sposób tworzenia aplikacji ASP.NET MVC 5 za pomocą Entity Framework 6 Code First i Visual Studio..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 11/07/2014
ms.topic: article
ms.assetid: d4dfc435-bda6-4621-9762-9ba270f8de4e
ms.technology: dotnet-mvc
ms.prod: .net-framework
msc.legacyurl: /mvc/overview/getting-started/getting-started-with-ef-using-mvc/migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application
msc.type: authoredcontent
ms.openlocfilehash: 2294f2aba3f765d7849d1f407e85f424dc8b2518
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 11/10/2017
---
<a name="code-first-migrations-and-deployment-with-the-entity-framework-in-an-aspnet-mvc-application"></a><span data-ttu-id="8337f-103">Kod najpierw migracje i wdrażanie za pomocą programu Entity Framework w aplikacji platformy ASP.NET MVC</span><span class="sxs-lookup"><span data-stu-id="8337f-103">Code First Migrations and Deployment with the Entity Framework in an ASP.NET MVC Application</span></span>
====================
<span data-ttu-id="8337f-104">przez [Dykstra niestandardowy](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="8337f-104">by [Tom Dykstra](https://github.com/tdykstra)</span></span>

<span data-ttu-id="8337f-105">[Pobieranie ukończone projektu](http://code.msdn.microsoft.com/ASPNET-MVC-Application-b01a9fe8) lub [pobierania plików PDF](http://download.microsoft.com/download/0/F/B/0FBFAA46-2BFD-478F-8E56-7BF3C672DF9D/Getting%20Started%20with%20Entity%20Framework%206%20Code%20First%20using%20MVC%205.pdf)</span><span class="sxs-lookup"><span data-stu-id="8337f-105">[Download Completed Project](http://code.msdn.microsoft.com/ASPNET-MVC-Application-b01a9fe8) or [Download PDF](http://download.microsoft.com/download/0/F/B/0FBFAA46-2BFD-478F-8E56-7BF3C672DF9D/Getting%20Started%20with%20Entity%20Framework%206%20Code%20First%20using%20MVC%205.pdf)</span></span>

> <span data-ttu-id="8337f-106">Przykładową aplikację sieci web firmy Contoso University przedstawia sposób tworzenia aplikacji ASP.NET MVC 5 za pomocą Entity Framework 6 Code First i Visual Studio 2013.</span><span class="sxs-lookup"><span data-stu-id="8337f-106">The Contoso University sample web application demonstrates how to create ASP.NET MVC 5 applications using the Entity Framework 6 Code First and Visual Studio 2013.</span></span> <span data-ttu-id="8337f-107">Informacje o samouczek serii, zobacz [pierwszy samouczek z tej serii](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application.md).</span><span class="sxs-lookup"><span data-stu-id="8337f-107">For information about the tutorial series, see [the first tutorial in the series](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application.md).</span></span>

<span data-ttu-id="8337f-108">Do tej pory aplikacja była uruchomiona lokalnie w usługach IIS Express na komputerze deweloperskim.</span><span class="sxs-lookup"><span data-stu-id="8337f-108">So far the application has been running locally in IIS Express on your development computer.</span></span> <span data-ttu-id="8337f-109">Aby udostępnić rzeczywistej aplikacji dla innych osób do użycia w Internecie, należy wdrożyć ją do usługi hosta sieci web.</span><span class="sxs-lookup"><span data-stu-id="8337f-109">To make a real application available for other people to use over the Internet, you have to deploy it to a web hosting provider.</span></span> <span data-ttu-id="8337f-110">W tym samouczku aplikacja Contoso University w chmurze na platformie Azure zostanie wdrożona.</span><span class="sxs-lookup"><span data-stu-id="8337f-110">In this tutorial, you'll deploy the Contoso University application to the cloud in Azure.</span></span>

<span data-ttu-id="8337f-111">Samouczek zawiera następujące sekcje:</span><span class="sxs-lookup"><span data-stu-id="8337f-111">The tutorial contains the following sections:</span></span>

- <span data-ttu-id="8337f-112">Włącz migracje Code First.</span><span class="sxs-lookup"><span data-stu-id="8337f-112">Enable Code First Migrations.</span></span> <span data-ttu-id="8337f-113">Funkcja migracji umożliwia zmienić modelu na model danych i wdrażanie zmiany w środowisku produkcyjnym, aktualizując schemat bazy danych bez konieczności porzucenia i ponownego utworzenia bazy danych.</span><span class="sxs-lookup"><span data-stu-id="8337f-113">The Migrations feature enables you to change the data model and deploy your changes to production by updating the database schema without having to drop and re-create the database.</span></span>
- <span data-ttu-id="8337f-114">Wdrażanie na platformie Azure.</span><span class="sxs-lookup"><span data-stu-id="8337f-114">Deploy to Azure.</span></span> <span data-ttu-id="8337f-115">Ten krok jest opcjonalny; Możesz kontynuować pozostałych samouczków, bez konieczności wdrożony projekt.</span><span class="sxs-lookup"><span data-stu-id="8337f-115">This step is optional; you can continue with the remaining tutorials without having deployed the project.</span></span>

<span data-ttu-id="8337f-116">Firma Microsoft zaleca, użyj procesu ciągłej integracji z kontroli źródła dla wdrożenia, że w tym samouczku nie obejmuje tych tematów.</span><span class="sxs-lookup"><span data-stu-id="8337f-116">We recommend that you use a continuous integration process with source control for deployment, but this tutorial does not cover those topics.</span></span> <span data-ttu-id="8337f-117">Aby uzyskać więcej informacji, zobacz [kontroli źródła](xref:aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/source-control) i [ciągłej integracji](xref:aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/continuous-integration-and-continuous-delivery) rozdziałów [tworzenia rzeczywistych aplikacji w chmurze platformy Azure](xref:aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/introduction) Książka elektroniczna.</span><span class="sxs-lookup"><span data-stu-id="8337f-117">For more information, see the [source control](xref:aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/source-control) and [continuous integration](xref:aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/continuous-integration-and-continuous-delivery) chapters of the [Building Real-World Cloud Apps with Azure](xref:aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/introduction) e-book.</span></span>

## <a name="enable-code-first-migrations"></a><span data-ttu-id="8337f-118">Włącz migracje Code First</span><span class="sxs-lookup"><span data-stu-id="8337f-118">Enable Code First Migrations</span></span>

<span data-ttu-id="8337f-119">Podczas opracowywania nowej aplikacji modelu danych zmienia często i zawsze zmian modelu, pobiera zsynchronizowane z bazą danych.</span><span class="sxs-lookup"><span data-stu-id="8337f-119">When you develop a new application, your data model changes frequently, and each time the model changes, it gets out of sync with the database.</span></span> <span data-ttu-id="8337f-120">Skonfigurowano programu Entity Framework, aby automatycznie Porzuć i ponownie utworzyć bazę danych w każdej zmianie modelu danych.</span><span class="sxs-lookup"><span data-stu-id="8337f-120">You have configured the Entity Framework to automatically drop and re-create the database each time you change the data model.</span></span> <span data-ttu-id="8337f-121">Gdy dodać, usunąć, lub zmień klas jednostek lub zmienić Twojego `DbContext` klasy, przy następnym uruchomieniu aplikacji automatycznie usuwa istniejącą bazę danych, tworzy nową, zgodny z modelem, którą nasiona go z danych testowych.</span><span class="sxs-lookup"><span data-stu-id="8337f-121">When you add, remove, or change entity classes or change your `DbContext` class, the next time you run the application it automatically deletes your existing database, creates a new one that matches the model, and seeds it with test data.</span></span>

<span data-ttu-id="8337f-122">Synchronizacja bazy danych w modelu danych z tej metody działa poprawnie, dopóki możesz wdrożyć aplikację w środowisku produkcyjnym.</span><span class="sxs-lookup"><span data-stu-id="8337f-122">This method of keeping the database in sync with the data model works well until you deploy the application to production.</span></span> <span data-ttu-id="8337f-123">Gdy aplikacja działa w środowisku produkcyjnym, jest zazwyczaj przechowywana dane, które chcesz zachować, a nie chcesz utracić wszystkie zawsze, gdy zostaną wprowadzone zmiany, takie jak dodawanie nowej kolumny.</span><span class="sxs-lookup"><span data-stu-id="8337f-123">When the application is running in production, it is usually storing data that you want to keep, and you don't want to lose everything each time you make a change such as adding a new column.</span></span> <span data-ttu-id="8337f-124">[Migracje Code First](https://msdn.microsoft.com/data/jj591621) funkcji rozwiązuje ten problem, należy włączyć Code First zaktualizować schemat bazy danych zamiast usunięcie i ponowne utworzenie bazy danych.</span><span class="sxs-lookup"><span data-stu-id="8337f-124">The [Code First Migrations](https://msdn.microsoft.com/data/jj591621) feature solves this problem by enabling Code First to update the database schema instead of dropping and re-creating the database.</span></span> <span data-ttu-id="8337f-125">W tym samouczku aplikacja zostanie wdrożona, a do przygotowania tego włączona migracji.</span><span class="sxs-lookup"><span data-stu-id="8337f-125">In this tutorial, you'll deploy the application, and to prepare for that you'll enable Migrations.</span></span>

1. <span data-ttu-id="8337f-126">Wyłącz inicjatora skonfigurowane wcześniej komentowania lub usuwając `contexts` element, który został dodany do pliku Web.config aplikacji.</span><span class="sxs-lookup"><span data-stu-id="8337f-126">Disable the initializer that you set up earlier by commenting out or deleting the `contexts` element that you added to the application Web.config file.</span></span>

    [!code-xml[Main](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample1.xml?highlight=2,6)]
2. <span data-ttu-id="8337f-127">Również w aplikacji *Web.config* pliku, Zmień nazwę bazy danych w parametrach połączenia ContosoUniversity2.</span><span class="sxs-lookup"><span data-stu-id="8337f-127">Also in the application *Web.config* file, change the name of the database in the connection string to ContosoUniversity2.</span></span>

    [!code-xml[Main](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample2.xml?highlight=2)]

    <span data-ttu-id="8337f-128">Ta zmiana skonfigurowanie projektu, aby pierwszy migracji spowoduje utworzenie nowej bazy danych.</span><span class="sxs-lookup"><span data-stu-id="8337f-128">This change sets up the project so that the first migration will create a new database.</span></span> <span data-ttu-id="8337f-129">Nie jest to wymagane, ale pojawi się później dlaczego jest dobrym rozwiązaniem.</span><span class="sxs-lookup"><span data-stu-id="8337f-129">This isn't required but you'll see later why it's a good idea.</span></span>
3. <span data-ttu-id="8337f-130">Z **narzędzia** menu, kliknij przycisk **Menedżer pakietów biblioteki** , a następnie **Konsola Menedżera pakietów**.</span><span class="sxs-lookup"><span data-stu-id="8337f-130">From the **Tools** menu, click **Library Package Manager** and then **Package Manager Console**.</span></span>

    ![Selecting_Package_Manager_Console](https://asp.net/media/4336350/1pm.png)
4. <span data-ttu-id="8337f-132">W `PM>` monitu wprowadź następujące polecenia:</span><span class="sxs-lookup"><span data-stu-id="8337f-132">At the `PM>` prompt enter the following commands:</span></span>

    `enable-migrations`  
    `add-migration InitialCreate`

    ![polecenia enable-migrations](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/image1.png)

    <span data-ttu-id="8337f-134">`enable-migrations` Polecenie tworzy *migracje* folderu projektu ContosoUniversity i umieszcza w tym folderze *Configuration.cs* pliku, który można edytować w celu konfigurowania migracji.</span><span class="sxs-lookup"><span data-stu-id="8337f-134">The `enable-migrations` command creates a *Migrations* folder in the ContosoUniversity project, and it puts in that folder a *Configuration.cs* file that you can edit to configure Migrations.</span></span>

    <span data-ttu-id="8337f-135">(Jeśli pominięte powyżej krok, który kieruje użytkownika do zmiany nazwy bazy danych migracji znajdzie istniejącą bazę danych i automatycznie `add-migration` polecenia.</span><span class="sxs-lookup"><span data-stu-id="8337f-135">(If you missed the step above that directs you to change the database name, Migrations will find the existing database and automatically do the `add-migration` command.</span></span> <span data-ttu-id="8337f-136">To normalne, po prostu oznacza to, że nie będzie uruchomienie testu kodu migracji, przed wdrożeniem bazy danych.</span><span class="sxs-lookup"><span data-stu-id="8337f-136">That's OK, it just means you won't run a test of the migrations code before you deploy the database.</span></span> <span data-ttu-id="8337f-137">Nowsze, po uruchomieniu `update-database` polecenia nic się nie stanie, ponieważ baza danych będzie już istnieje.)</span><span class="sxs-lookup"><span data-stu-id="8337f-137">Later when you run the `update-database` command nothing will happen because the database will already exist.)</span></span>

    ![Migrations folder](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/image2.png)

    <span data-ttu-id="8337f-139">Klasa inicjatora, który był wyświetlany poprzednio, takich jak `Configuration` klasa zawiera `Seed` metody.</span><span class="sxs-lookup"><span data-stu-id="8337f-139">Like the initializer class that you saw earlier, the `Configuration` class includes a `Seed` method.</span></span>

    [!code-csharp[Main](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample3.cs)]

    <span data-ttu-id="8337f-140">Celem [inicjatora](https://msdn.microsoft.com/library/hh829453(v=vs.103).aspx) metody jest umożliwienie można wstawić ani zaktualizować dane testowe, po pierwszym kod tworzy lub aktualizuje bazę danych.</span><span class="sxs-lookup"><span data-stu-id="8337f-140">The purpose of the [Seed](https://msdn.microsoft.com/library/hh829453(v=vs.103).aspx) method is to enable you to insert or update test data after Code First creates or updates the database.</span></span> <span data-ttu-id="8337f-141">Metoda jest wywoływana po utworzeniu bazy danych, a za każdym razem, gdy schemat bazy danych jest aktualizowany po zmianie modelu danych.</span><span class="sxs-lookup"><span data-stu-id="8337f-141">The method is called when the database is created and every time the database schema is updated after a data model change.</span></span>

### <a name="set-up-the-seed-method"></a><span data-ttu-id="8337f-142">Konfigurowanie Seed — metoda</span><span class="sxs-lookup"><span data-stu-id="8337f-142">Set up the Seed Method</span></span>

<span data-ttu-id="8337f-143">Gdy są porzucenie i ponowne utworzenie bazy danych dla każdej zmiany modelu danych, należy użyć klasy inicjatora `Seed` do wstawienia danych testowych, ponieważ po każdej zmianie modelu bazy danych zostanie porzucony i wszystkich danych testowych zostaną utracone.</span><span class="sxs-lookup"><span data-stu-id="8337f-143">When you are dropping and re-creating the database for every data model change, you use the initializer class's `Seed` method to insert test data, because after every model change the database is dropped and all the test data is lost.</span></span> <span data-ttu-id="8337f-144">Migracje Code First, test dane zostaną zachowane po wprowadzeniu zmian w bazie danych, więc tym dane testowe w [inicjatora](https://msdn.microsoft.com/library/hh829453(v=vs.103).aspx) zwykle — metoda nie jest konieczne.</span><span class="sxs-lookup"><span data-stu-id="8337f-144">With Code First Migrations, test data is retained after database changes, so including test data in the [Seed](https://msdn.microsoft.com/library/hh829453(v=vs.103).aspx) method is typically not necessary.</span></span> <span data-ttu-id="8337f-145">W rzeczywistości nie chcesz `Seed` do wstawienia danych testowych, jeśli należy używać migracji do wdrażania bazy danych do środowiska produkcyjnego, ponieważ `Seed` metody zostanie uruchomiony w środowisku produkcyjnym.</span><span class="sxs-lookup"><span data-stu-id="8337f-145">In fact, you don't want the `Seed` method to insert test data if you'll be using Migrations to deploy the database to production, because the `Seed` method will run in production.</span></span> <span data-ttu-id="8337f-146">W takim przypadku ma `Seed` do wstawienia do bazy danych tylko dane potrzebne w środowisku produkcyjnym.</span><span class="sxs-lookup"><span data-stu-id="8337f-146">In that case you want the `Seed` method to insert into the database only the data that you need in production.</span></span> <span data-ttu-id="8337f-147">Na przykład można znaleźć w bazie danych działu rzeczywistej nazwy w `Department` tabeli po udostępnieniu aplikacji, w środowisku produkcyjnym.</span><span class="sxs-lookup"><span data-stu-id="8337f-147">For example, you might want the database to include actual department names in the `Department` table when the application becomes available in production.</span></span>

<span data-ttu-id="8337f-148">W tym samouczku, należy używać migracje dla wdrożenia, ale Twoje `Seed` metody powoduje wstawienie danych testowych mimo to w celu ułatwienia zobaczyć, jak działa funkcji aplikacji bez konieczności wstawiać ręcznie partii danych.</span><span class="sxs-lookup"><span data-stu-id="8337f-148">For this tutorial, you'll be using Migrations for deployment, but your `Seed` method will insert test data anyway in order to make it easier to see how application functionality works without having to manually insert a lot of data.</span></span>

1. <span data-ttu-id="8337f-149">Zastąp zawartość *Configuration.cs* pliku z następującym kodem, który będzie ładowanie danych testowych do nowej bazy danych.</span><span class="sxs-lookup"><span data-stu-id="8337f-149">Replace the contents of the *Configuration.cs* file with the following code, which will load test data into the new database.</span></span> 

    [!code-csharp[Main](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample4.cs)]

    <span data-ttu-id="8337f-150">[Inicjatora](https://msdn.microsoft.com/library/hh829453(v=vs.103).aspx) metoda przyjmuje jako parametr wejściowy obiekt kontekstu bazy danych i kod w metodzie używa tego obiektu, aby dodać nowe jednostki w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="8337f-150">The [Seed](https://msdn.microsoft.com/library/hh829453(v=vs.103).aspx) method takes the database context object as an input parameter, and the code in the method uses that object to add new entities to the database.</span></span> <span data-ttu-id="8337f-151">Dla poszczególnych typów jednostek kodu tworzy kolekcję nowych jednostek, dodaje je do odpowiednich [DbSet](https://msdn.microsoft.com/library/system.data.entity.dbset(v=vs.103).aspx) właściwości, a następnie zapisuje zmiany w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="8337f-151">For each entity type, the code creates a collection of new entities, adds them to the appropriate [DbSet](https://msdn.microsoft.com/library/system.data.entity.dbset(v=vs.103).aspx) property, and then saves the changes to the database.</span></span> <span data-ttu-id="8337f-152">Nie trzeba wywołać [SaveChanges](https://msdn.microsoft.com/library/system.data.entity.dbcontext.savechanges(v=VS.103).aspx) metody po każdej grupie jednostek, jak odbywa się w tym miejscu, ale które pomaga Znajdź źródło problemu w przypadku wystąpienia wyjątku, gdy kod jest zapisywania do bazy danych.</span><span class="sxs-lookup"><span data-stu-id="8337f-152">It isn't necessary to call the [SaveChanges](https://msdn.microsoft.com/library/system.data.entity.dbcontext.savechanges(v=VS.103).aspx) method after each group of entities, as is done here, but doing that helps you locate the source of a problem if an exception occurs while the code is writing to the database.</span></span>

    <span data-ttu-id="8337f-153">Niektóre z oświadczeń, które wstawiają dane użycia [AddOrUpdate](https://msdn.microsoft.com/library/system.data.entity.migrations.idbsetextensions.addorupdate(v=vs.103).aspx) metodę można wykonać operacji "upsert".</span><span class="sxs-lookup"><span data-stu-id="8337f-153">Some of the statements that insert data use the [AddOrUpdate](https://msdn.microsoft.com/library/system.data.entity.migrations.idbsetextensions.addorupdate(v=vs.103).aspx) method to perform an "upsert" operation.</span></span> <span data-ttu-id="8337f-154">Ponieważ `Seed` metoda jest uruchamiana za każdym razem, gdy będzie wykonanie `update-database` polecenia zwykle po każdym migracji, po prostu nie można wstawić danych, ponieważ wierszy chcesz dodać już będą dostępne po pierwszej migracji, które utworzy bazę danych.</span><span class="sxs-lookup"><span data-stu-id="8337f-154">Because the `Seed` method runs every time you execute the `update-database` command, typically after each migration, you can't just insert data, because the rows you are trying to add will already be there after the first migration that creates the database.</span></span> <span data-ttu-id="8337f-155">Operacja "upsert" uniemożliwia błędów, które może się zdarzyć, jeśli podczas próby wstawienia wiersza, który już istnieje, ale ***zastępuje*** wszelkie zmiany danych, które mogły zostać wprowadzone podczas testowania aplikacji.</span><span class="sxs-lookup"><span data-stu-id="8337f-155">The "upsert" operation prevents errors that would happen if you try to insert a row that already exists, but it ***overrides*** any changes to data that you may have made while testing the application.</span></span> <span data-ttu-id="8337f-156">Z danych testowych w niektórych tabel nie można się zdarzyć, że: w niektórych przypadkach po zmianie danych podczas testowania ma zmiany po aktualizacji bazy danych.</span><span class="sxs-lookup"><span data-stu-id="8337f-156">With test data in some tables you might not want that to happen: in some cases when you change data while testing you want your changes to remain after database updates.</span></span> <span data-ttu-id="8337f-157">W takim przypadku chcesz wykonać operację wstawiania warunkowe: Wstaw wiersz tylko wtedy, gdy jeszcze nie istnieje.</span><span class="sxs-lookup"><span data-stu-id="8337f-157">In that case you want to do a conditional insert operation: insert a row only if it doesn't already exist.</span></span> <span data-ttu-id="8337f-158">Seed — metoda korzysta z obu podejść.</span><span class="sxs-lookup"><span data-stu-id="8337f-158">The Seed method uses both approaches.</span></span>

    <span data-ttu-id="8337f-159">Pierwszy parametr przekazany do [AddOrUpdate](https://msdn.microsoft.com/library/system.data.entity.migrations.idbsetextensions.addorupdate(v=vs.103).aspx) metody Określa właściwość, można użyć do sprawdzenia, czy wiersz już istnieje.</span><span class="sxs-lookup"><span data-stu-id="8337f-159">The first parameter passed to the [AddOrUpdate](https://msdn.microsoft.com/library/system.data.entity.migrations.idbsetextensions.addorupdate(v=vs.103).aspx) method specifies the property to use to check if a row already exists.</span></span> <span data-ttu-id="8337f-160">Dla danych uczniów testów, które udostępniasz `LastName` właściwość może być używana w tym celu, ponieważ każdy nazwisko na liście jest unikatowa:</span><span class="sxs-lookup"><span data-stu-id="8337f-160">For the test student data that you are providing, the `LastName` property can be used for this purpose since each last name in the list is unique:</span></span>

    [!code-csharp[Main](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample5.cs)]

    <span data-ttu-id="8337f-161">Ten kod przyjęto założenie, że ostatni nazwy są unikatowe.</span><span class="sxs-lookup"><span data-stu-id="8337f-161">This code assumes that last names are unique.</span></span> <span data-ttu-id="8337f-162">Ręcznie Dodaj uczniów ze zduplikowaną nazwą ostatniego, otrzymasz następujący wyjątek podczas następnego przeprowadzenie migracji.</span><span class="sxs-lookup"><span data-stu-id="8337f-162">If you manually add a student with a duplicate last name, you'll get the following exception the next time you perform a migration.</span></span>

    <span data-ttu-id="8337f-163">Sekwencja zawiera więcej niż jeden element</span><span class="sxs-lookup"><span data-stu-id="8337f-163">Sequence contains more than one element</span></span>

    <span data-ttu-id="8337f-164">Aby uzyskać informacje dotyczące obsługi nadmiarowych danych, takich jak dwóm studentom / o nazwie "Alexander Carson", zobacz [wstępnego wypełniania i bazami danych debugowanie Entity Framework (EF)](https://blogs.msdn.com/b/rickandy/archive/2013/02/12/seeding-and-debugging-entity-framework-ef-dbs.aspx) na blogu Ricka Andersona.</span><span class="sxs-lookup"><span data-stu-id="8337f-164">For information about how to handle redundant data such as two students named "Alexander Carson", see [Seeding and Debugging Entity Framework (EF) DBs](https://blogs.msdn.com/b/rickandy/archive/2013/02/12/seeding-and-debugging-entity-framework-ef-dbs.aspx) on Rick Anderson's blog.</span></span> <span data-ttu-id="8337f-165">Aby uzyskać więcej informacji na temat `AddOrUpdate` metody, zobacz [zajmie się za pomocą metody AddOrUpdate EF 4.3](http://thedatafarm.com/blog/data-access/take-care-with-ef-4-3-addorupdate-method/) na blogu Julie Lerman.</span><span class="sxs-lookup"><span data-stu-id="8337f-165">For more information about the `AddOrUpdate` method, see [Take care with EF 4.3 AddOrUpdate Method](http://thedatafarm.com/blog/data-access/take-care-with-ef-4-3-addorupdate-method/) on Julie Lerman's blog.</span></span>

    <span data-ttu-id="8337f-166">Kod, który tworzy `Enrollment` jednostek zakłada masz `ID` wartość jednostek w `students` kolekcji, chociaż nie zostały ustawione właściwości w kodzie, który tworzy kolekcję.</span><span class="sxs-lookup"><span data-stu-id="8337f-166">The code that creates `Enrollment` entities assumes you have the `ID` value in the entities in the `students` collection, although you didn't set that property in the code that creates the collection.</span></span>

    [!code-csharp[Main](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample6.cs?highlight=2)]

    <span data-ttu-id="8337f-167">Można użyć `ID` właściwości tutaj ponieważ `ID` wartość jest ustawiana po wywołaniu `SaveChanges` dla `students` kolekcji.</span><span class="sxs-lookup"><span data-stu-id="8337f-167">You can use the `ID` property here because the `ID` value is set when you call `SaveChanges` for the `students` collection.</span></span> <span data-ttu-id="8337f-168">Gdy jednostka do wstawienia do bazy danych i aktualizuje EF automatycznie pobiera wartość klucza podstawowego `ID` właściwości jednostki w pamięci.</span><span class="sxs-lookup"><span data-stu-id="8337f-168">EF automatically gets the primary key value when it inserts an entity into the database, and it updates the `ID` property of the entity in memory.</span></span>

    <span data-ttu-id="8337f-169">Kod, który dodaje `Enrollment` jednostki do `Enrollments` nie korzysta z zestawu jednostek `AddOrUpdate` metody.</span><span class="sxs-lookup"><span data-stu-id="8337f-169">The code that adds each `Enrollment` entity to the `Enrollments` entity set doesn't use the `AddOrUpdate` method.</span></span> <span data-ttu-id="8337f-170">Sprawdza, czy jednostka już istnieje i wstawi jednostkę, jeśli nie istnieje.</span><span class="sxs-lookup"><span data-stu-id="8337f-170">It checks if an entity already exists and inserts the entity if it doesn't exist.</span></span> <span data-ttu-id="8337f-171">Takie podejście zostanie zachować zmiany wprowadzone do klasy rejestracji przy użyciu interfejsu użytkownika aplikacji.</span><span class="sxs-lookup"><span data-stu-id="8337f-171">This approach will preserve changes you make to an enrollment grade by using the application UI.</span></span> <span data-ttu-id="8337f-172">Kod w pętli każdy element członkowski `Enrollment` [listy](https://msdn.microsoft.com/library/6sh2ey19.aspx) i jeśli rejestracja nie zostanie znaleziony w bazie danych, dodaje rejestracji z bazą danych.</span><span class="sxs-lookup"><span data-stu-id="8337f-172">The code loops through each member of the `Enrollment`[List](https://msdn.microsoft.com/library/6sh2ey19.aspx) and if the enrollment is not found in the database, it adds the enrollment to the database.</span></span> <span data-ttu-id="8337f-173">Po raz pierwszy aktualizacji bazy danych, bazy danych jest pusta, tak spowoduje dodanie każdego rejestracji.</span><span class="sxs-lookup"><span data-stu-id="8337f-173">The first time you update the database, the database will be empty, so it will add each enrollment.</span></span>

    [!code-csharp[Main](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample7.cs)]
2. <span data-ttu-id="8337f-174">Skompiluj projekt.</span><span class="sxs-lookup"><span data-stu-id="8337f-174">Build the project.</span></span>

### <a name="execute-the-first-migration"></a><span data-ttu-id="8337f-175">Wykonanie pierwszej migracji</span><span class="sxs-lookup"><span data-stu-id="8337f-175">Execute the First Migration</span></span>

<span data-ttu-id="8337f-176">Kiedy wykonać `add-migration` polecenia migracji wygenerowanego kodu, które mogą utworzyć bazy danych od podstaw.</span><span class="sxs-lookup"><span data-stu-id="8337f-176">When you executed the `add-migration` command, Migrations generated the code that would create the database from scratch.</span></span> <span data-ttu-id="8337f-177">Ten kod jest również w *migracje* folder, w pliku o nazwie  *&lt;sygnatury czasowej&gt;\_InitialCreate.cs*.</span><span class="sxs-lookup"><span data-stu-id="8337f-177">This code is also in the *Migrations* folder, in the file named *&lt;timestamp&gt;\_InitialCreate.cs*.</span></span> <span data-ttu-id="8337f-178">`Up` Metody `InitialCreate` klasy tworzy tabele bazy danych, które odpowiadają zestawów jednostek modelu danych, i `Down` metoda usuwa je.</span><span class="sxs-lookup"><span data-stu-id="8337f-178">The `Up` method of the `InitialCreate` class creates the database tables that correspond to the data model entity sets, and the `Down` method deletes them.</span></span>

[!code-csharp[Main](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample8.cs)]

<span data-ttu-id="8337f-179">Migracje wywołania `Up` metody implementacji zmian modelu danych do migracji.</span><span class="sxs-lookup"><span data-stu-id="8337f-179">Migrations calls the `Up` method to implement the data model changes for a migration.</span></span> <span data-ttu-id="8337f-180">Po wprowadzeniu polecenia, aby wycofać aktualizacji, migracje wywołania `Down` metody.</span><span class="sxs-lookup"><span data-stu-id="8337f-180">When you enter a command to roll back the update, Migrations calls the `Down` method.</span></span>

<span data-ttu-id="8337f-181">Jest to początkowej migracji, który został utworzony po wprowadzeniu `add-migration InitialCreate` polecenia.</span><span class="sxs-lookup"><span data-stu-id="8337f-181">This is the initial migration that was created when you entered the `add-migration InitialCreate` command.</span></span> <span data-ttu-id="8337f-182">Parametr (`InitialCreate` w przykładzie) jest używane dla pliku nazwy i może być dowolne; zazwyczaj wybierz słowo lub frazę podsumowanie, co jest wykonywana w procesie migracji.</span><span class="sxs-lookup"><span data-stu-id="8337f-182">The parameter (`InitialCreate` in the example) is used for the file name and can be whatever you want; you typically choose a word or phrase that summarizes what is being done in the migration.</span></span> <span data-ttu-id="8337f-183">Na przykład możesz nazwać nowsze migracji &quot;AddDepartmentTable&quot;.</span><span class="sxs-lookup"><span data-stu-id="8337f-183">For example, you might name a later migration &quot;AddDepartmentTable&quot;.</span></span>

<span data-ttu-id="8337f-184">Jeśli utworzono początkowej migracji, gdy baza danych już istnieje, jest generowany kod tworzenia bazy danych, ale nie ma działać, ponieważ w bazie danych jest już zgodny z modelem danych.</span><span class="sxs-lookup"><span data-stu-id="8337f-184">If you created the initial migration when the database already exists, the database creation code is generated but it doesn't have to run because the database already matches the data model.</span></span> <span data-ttu-id="8337f-185">Gdy wdrażasz aplikację do innego środowiska, w których bazy danych nie istnieje jeszcze tego kodu zostaną uruchomione, aby utworzyć bazę danych, dlatego jest dobrym rozwiązaniem jest przetestowanie go.</span><span class="sxs-lookup"><span data-stu-id="8337f-185">When you deploy the app to another environment where the database doesn't exist yet, this code will run to create your database, so it's a good idea to test it first.</span></span> <span data-ttu-id="8337f-186">Dlatego zmienić nazwę bazy danych w parametrach połączenia wcześniej — tak, aby migracji można utworzyć nową od początku.</span><span class="sxs-lookup"><span data-stu-id="8337f-186">That's why you changed the name of the database in the connection string earlier -- so that migrations can create a new one from scratch.</span></span>

1. <span data-ttu-id="8337f-187">W **Konsola Menedżera pakietów** okna, wprowadź następujące polecenie:</span><span class="sxs-lookup"><span data-stu-id="8337f-187">In the **Package Manager Console** window, enter the following command:</span></span>

    `update-database`

    ![](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/image3.png)

    <span data-ttu-id="8337f-188">`update-database` Polecenia `Up` metodę w celu utworzenia bazy danych, a następnie go uruchamia `Seed` metodę, aby Wypełnianie bazy danych.</span><span class="sxs-lookup"><span data-stu-id="8337f-188">The `update-database` command runs the `Up` method to create the database and then it runs the `Seed` method to populate the database.</span></span> <span data-ttu-id="8337f-189">Ten sam proces zostanie uruchomiony automatycznie w środowisku produkcyjnym po wdrożeniu aplikacji, jak można zauważyć w następnej sekcji.</span><span class="sxs-lookup"><span data-stu-id="8337f-189">The same process will run automatically in production after you deploy the application, as you'll see in the following section.</span></span>
- <span data-ttu-id="8337f-190">Użyj **Eksploratora serwera** inspekcji bazy danych, tak jak w pierwszym samouczku i uruchom aplikację, aby sprawdzić, czy wszystkie elementy nadal działa tak samo, jak poprzednio.</span><span class="sxs-lookup"><span data-stu-id="8337f-190">Use **Server Explorer** to inspect the database as you did in the first tutorial, and run the application to verify that everything still works the same as before.</span></span>

## <a name="deploy-to-azure"></a><span data-ttu-id="8337f-191">Wdrażanie na platformie Azure</span><span class="sxs-lookup"><span data-stu-id="8337f-191">Deploy to Azure</span></span>

<span data-ttu-id="8337f-192">Do tej pory aplikacja była uruchomiona lokalnie w usługach IIS Express na komputerze deweloperskim.</span><span class="sxs-lookup"><span data-stu-id="8337f-192">So far the application has been running locally in IIS Express on your development computer.</span></span> <span data-ttu-id="8337f-193">Aby udostępnić innym użytkownikom za pośrednictwem Internetu, należy wdrożyć ją do usługi hosta sieci web.</span><span class="sxs-lookup"><span data-stu-id="8337f-193">To make it available for other people to use over the Internet, you have to deploy it to a web hosting provider.</span></span> <span data-ttu-id="8337f-194">W tej części samouczka będziesz ją wdrożyć na platformie Azure.</span><span class="sxs-lookup"><span data-stu-id="8337f-194">In this section of the tutorial you'll deploy it to Azure.</span></span> <span data-ttu-id="8337f-195">Ta sekcja jest opcjonalna. można pominąć to i kontynuować samouczek następujące lub dostosować instrukcje w tej sekcji innego dostawcy hostingu wybranych przez użytkownika.</span><span class="sxs-lookup"><span data-stu-id="8337f-195">This section is optional; you can skip this and continue with the following tutorial, or you can adapt the instructions in this section for a different hosting provider of your choice.</span></span>

### <a name="using-code-first-migrations-to-deploy-the-database"></a><span data-ttu-id="8337f-196">Wdrażanie bazy danych za pomocą migracje Code First</span><span class="sxs-lookup"><span data-stu-id="8337f-196">Using Code First Migrations to Deploy the Database</span></span>

<span data-ttu-id="8337f-197">Aby wdrożyć bazy danych będzie wykonaj migracje Code First.</span><span class="sxs-lookup"><span data-stu-id="8337f-197">To deploy the database you'll use Code First Migrations.</span></span> <span data-ttu-id="8337f-198">Gdy tworzysz profil publikowania, który służy do konfigurowania ustawień wdrażania w programie Visual Studio, należy wybrać pole wyboru z etykietą **aktualizacji bazy danych**.</span><span class="sxs-lookup"><span data-stu-id="8337f-198">When you create the publish profile that you use to configure settings for deploying from Visual Studio, you'll select a check box labeled **Update Database**.</span></span> <span data-ttu-id="8337f-199">To ustawienie powoduje, że proces wdrażania automatycznie skonfigurować aplikację *Web.config* plików na serwerze docelowym, aby używał Code First `MigrateDatabaseToLatestVersion` klasy inicjatora.</span><span class="sxs-lookup"><span data-stu-id="8337f-199">This setting causes the deployment process to automatically configure the application *Web.config* file on the destination server so that Code First uses the `MigrateDatabaseToLatestVersion` initializer class.</span></span>

<span data-ttu-id="8337f-200">Visual Studio nie są wykonywane w bazie danych podczas procesu wdrażania podczas kopiuje projektu na serwerze docelowym.</span><span class="sxs-lookup"><span data-stu-id="8337f-200">Visual Studio doesn't do anything with the database during the deployment process while it is copying your project to the destination server.</span></span> <span data-ttu-id="8337f-201">Po uruchomieniu wdrożonej aplikacji i uzyskuje dostęp do bazy danych po raz pierwszy po wdrożeniu, Code First sprawdza, czy bazy danych jest zgodny z modelem danych.</span><span class="sxs-lookup"><span data-stu-id="8337f-201">When you run the deployed application and it accesses the database for the first time after deployment, Code First checks if the database matches the data model.</span></span> <span data-ttu-id="8337f-202">Jeśli występuje niezgodność, Code First automatycznie utworzy bazę danych (Jeśli nie istnieje jeszcze) lub aktualizuje schemat bazy danych do najnowszej wersji (jeśli istnieje bazy danych, ale nie jest zgodny z modelem).</span><span class="sxs-lookup"><span data-stu-id="8337f-202">If there's a mismatch, Code First automatically creates the database (if it doesn't exist yet) or updates the database schema to the latest version (if a database exists but doesn't match the model).</span></span> <span data-ttu-id="8337f-203">Jeśli aplikacja korzysta migracje `Seed` metody, uruchamia metody po utworzeniu bazy danych lub schemat jest aktualizowany.</span><span class="sxs-lookup"><span data-stu-id="8337f-203">If the application implements a Migrations `Seed` method, the method runs after the database is created or the schema is updated.</span></span>

<span data-ttu-id="8337f-204">Migracji `Seed` metody wstawia dane testowe.</span><span class="sxs-lookup"><span data-stu-id="8337f-204">Your Migrations `Seed` method inserts test data.</span></span> <span data-ttu-id="8337f-205">Jeśli są wdrażane w środowisku produkcyjnym, należy zmienić `Seed` metodę, tak że tylko wstawia dane, które ma zostać wstawiony do bazy danych produkcyjnych.</span><span class="sxs-lookup"><span data-stu-id="8337f-205">If you were deploying to a production environment, you would have to change the `Seed` method so that it only inserts data that you want to be inserted into your production database.</span></span> <span data-ttu-id="8337f-206">Na przykład w bieżącym modelu danych możesz mieć rzeczywistych kursów, ale fikcyjnej studentów w projektowej bazie danych.</span><span class="sxs-lookup"><span data-stu-id="8337f-206">For example, in your current data model you might want to have real courses but fictional students in the development database.</span></span> <span data-ttu-id="8337f-207">Można napisać `Seed` metodę, aby załadować zarówno w rozwoju, a następnie Oznacz jako komentarz fikcyjnej studentów przed wdrożeniem w środowisku produkcyjnym.</span><span class="sxs-lookup"><span data-stu-id="8337f-207">You can write a `Seed` method to load both in development, and then comment out the fictional students before you deploy to production.</span></span> <span data-ttu-id="8337f-208">Lub może zapisywać `Seed` metodę, aby załadować tylko kursy, a następnie wprowadź fikcyjnej studentów w bazie danych testu ręcznie przy użyciu interfejsu użytkownika aplikacji.</span><span class="sxs-lookup"><span data-stu-id="8337f-208">Or you can write a `Seed` method to load only courses, and enter the fictional students in the test database manually by using the application's UI.</span></span>

### <a name="get-an-azure-account"></a><span data-ttu-id="8337f-209">Uzyskaj konto platformy Azure</span><span class="sxs-lookup"><span data-stu-id="8337f-209">Get an Azure account</span></span>

<span data-ttu-id="8337f-210">Konieczne będzie konto platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="8337f-210">You'll need an Azure account.</span></span> <span data-ttu-id="8337f-211">Jeśli nie masz już konto, ale ma subskrypcji programu Visual Studio, możesz [Aktywuj swoje korzyści z subskrypcji](https://azure.microsoft.com/pricing/member-offers/msdn-benefits-details/).</span><span class="sxs-lookup"><span data-stu-id="8337f-211">If you don't already have one, but you do have a Visual Studio subscription, you can [activate your subscription benefits](https://azure.microsoft.com/pricing/member-offers/msdn-benefits-details/).</span></span> <span data-ttu-id="8337f-212">W przeciwnym razie możesz utworzyć bezpłatne konto próbne w zaledwie kilka minut.</span><span class="sxs-lookup"><span data-stu-id="8337f-212">Otherwise, you can create a free trial account in just a couple of minutes.</span></span> <span data-ttu-id="8337f-213">Aby uzyskać więcej informacji, zobacz [bezpłatnej wersji próbnej Azure](https://azure.microsoft.com/free/).</span><span class="sxs-lookup"><span data-stu-id="8337f-213">For details, see [Azure Free Trial](https://azure.microsoft.com/free/).</span></span>

### <a name="create-a-web-site-and-a-sql-database-in-azure"></a><span data-ttu-id="8337f-214">Tworzenie witryny sieci web i bazy danych SQL na platformie Azure</span><span class="sxs-lookup"><span data-stu-id="8337f-214">Create a web site and a SQL database in Azure</span></span>

<span data-ttu-id="8337f-215">Aplikacja sieci web na platformie Azure zostanie uruchomiony w środowisku macierzystym udostępnionego, co oznacza, że jest uruchamiany na maszynach wirtualnych (VM), które są współużytkowane z innymi klientami Azure.</span><span class="sxs-lookup"><span data-stu-id="8337f-215">Your web app in Azure will run in a shared hosting environment, which means it runs on virtual machines (VMs) that are shared with other Azure clients.</span></span> <span data-ttu-id="8337f-216">Udostępniony środowisko macierzyste to sposób ekonomicznych wprowadzenie w chmurze.</span><span class="sxs-lookup"><span data-stu-id="8337f-216">A shared hosting environment is a low-cost way to get started in the cloud.</span></span> <span data-ttu-id="8337f-217">Później Jeśli powoduje zwiększenie ruchu w sieci web, aplikację można skalować spełnia potrzeby, uruchamiając na dedykowanych maszynach wirtualnych.</span><span class="sxs-lookup"><span data-stu-id="8337f-217">Later, if your web traffic increases, the application can scale to meet the need by running on dedicated VMs.</span></span> <span data-ttu-id="8337f-218">Aby dowiedzieć się więcej o opcjach ceny dla usługi Azure App Service, zapoznaj się z dokumentacją na [Azure Docs](https://azure.microsoft.com/pricing/details/app-service/)</span><span class="sxs-lookup"><span data-stu-id="8337f-218">To learn more about Pricing Options for Azure App Service, read the documentation on [Azure Docs](https://azure.microsoft.com/pricing/details/app-service/)</span></span>

<span data-ttu-id="8337f-219">Poniżej przedstawiono wdrażania bazy danych do bazy danych SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="8337f-219">You'll deploy the database to Azure SQL Database.</span></span> <span data-ttu-id="8337f-220">Baza danych SQL jest oparta na chmurze usługą relacyjnych baz danych, który jest oparty na technologii programu SQL Server.</span><span class="sxs-lookup"><span data-stu-id="8337f-220">SQL Database is a cloud-based relational database service that is built on SQL Server technologies.</span></span> <span data-ttu-id="8337f-221">Narzędzia i aplikacje, które współpracują z programem SQL Server również współpracować z bazy danych SQL.</span><span class="sxs-lookup"><span data-stu-id="8337f-221">Tools and applications that work with SQL Server also work with SQL Database.</span></span>

1. <span data-ttu-id="8337f-222">W [portalu zarządzania Azure](https://portal.azure.com), kliknij przycisk **nowy** na karcie po lewej stronie kliknij **zobaczyć wszystkie** w nowym bloku, a następnie kliknij przycisk **aplikacji sieci Web i SQL** w **Web** sekcji i w końcu **Utwórz**.</span><span class="sxs-lookup"><span data-stu-id="8337f-222">In the [Azure Management Portal](https://portal.azure.com), click **New** in the left tab, click **See all** in new blade, and then click **Web App & SQL** in the **Web** Section and finally **Create**.</span></span>

    ![Przycisk Nowy w portalu zarządzania](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/CreateWeb-Sql.png)

 <span data-ttu-id="8337f-224">**Nowej aplikacji sieci Web & SQL — tworzenie** zostanie otwarty Kreator.</span><span class="sxs-lookup"><span data-stu-id="8337f-224">The **New Web App & SQL - Create** wizard opens.</span></span>

2. <span data-ttu-id="8337f-225">W bloku, wprowadź ciąg w **Nazwa aplikacji** pole ma być używana jako unikatowy adres URL aplikacji.</span><span class="sxs-lookup"><span data-stu-id="8337f-225">In the blade, enter a string in the **App name** box to use as the unique URL for your application.</span></span> <span data-ttu-id="8337f-226">Pełny adres URL będzie zawierał co wprowadzony w tym miejscu i domyślną domenę usługi aplikacji Azure (. azurewebsites.net).</span><span class="sxs-lookup"><span data-stu-id="8337f-226">The complete URL will consist of what you enter here plus the default domain of Azure App Services (.azurewebsites.net).</span></span> <span data-ttu-id="8337f-227">Jeśli **Nazwa aplikacji** jest już zajęty, Kreator wyświetli powiadomienie tego czerwonym znakiem *Nazwa aplikacji jest niedostępna* wiadomości.</span><span class="sxs-lookup"><span data-stu-id="8337f-227">If the **App name** is already taken, the Wizard will notify you of this with a red *The app name is not available* message.</span></span> <span data-ttu-id="8337f-228">Jeśli **Nazwa aplikacji** jest dostępny, zostanie wyświetlony na zielonym znacznikiem wyboru.</span><span class="sxs-lookup"><span data-stu-id="8337f-228">If the **App name** is available, you will get a green checkmark.</span></span>

    ![Utwórz łącze bazy danych w portalu zarządzania](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Create-WebApp.png)

3. <span data-ttu-id="8337f-230">W **subskrypcji** listy rozwijanej wybierz subskrypcję Azure, w którym mają **usługi aplikacji** mogą teraz być przechowywane.</span><span class="sxs-lookup"><span data-stu-id="8337f-230">In the **Subscription** Dropdown, please choose the Azure Subscription in which you want the **App Service** to reside.</span></span>

4. <span data-ttu-id="8337f-231">W **grupy zasobów** pole tekstowe, wybierz grupę zasobów lub Utwórz nową.</span><span class="sxs-lookup"><span data-stu-id="8337f-231">In the **Resource Group** text box, choose a Resource Group or create a new one.</span></span> <span data-ttu-id="8337f-232">To ustawienie określa centrum danych, które witryny sieci web jest uruchamiana w.</span><span class="sxs-lookup"><span data-stu-id="8337f-232">This setting specifies which data center your web site will run in.</span></span> <span data-ttu-id="8337f-233">Aby uzyskać więcej informacji na temat grup zasobów, zapoznaj się z dokumentacją na [Azure Docs](https://docs.microsoft.com/azure/azure-resource-manager/resource-group-overview#resource-groups).</span><span class="sxs-lookup"><span data-stu-id="8337f-233">For more information about Resource Groups, read the documentation on [Azure Docs](https://docs.microsoft.com/azure/azure-resource-manager/resource-group-overview#resource-groups).</span></span>
5. <span data-ttu-id="8337f-234">Utwórz nową **Plan usługi aplikacji** klikając *sekcji usługi aplikacji*, **Utwórz nowy**i wypełnij **planu usługi aplikacji** (może mieć tej samej nazwie jak Usługi aplikacji), **lokalizacji**, i **warstwa cenowa** (jest bezpłatną opcją).</span><span class="sxs-lookup"><span data-stu-id="8337f-234">Create a new **App Service Plan** by clicking the *App Service section*, **Create New**, and fill in **App Service plan** (can be same name as App Service), **Location**, and **Pricing tier** (there is a free option).</span></span>

    ![](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Create-AppService.png)
6. <span data-ttu-id="8337f-235">Kliknij przycisk **bazy danych SQL**i wybierz polecenie *Utwórz nowy* lub wybierz istniejącą bazę danych</span><span class="sxs-lookup"><span data-stu-id="8337f-235">Click the **SQL Database**, and choose *Create New* or select an existing database</span></span>

    ![](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Create-Database.png)

7. <span data-ttu-id="8337f-236">W **nazwa** wprowadź nazwę bazy danych.</span><span class="sxs-lookup"><span data-stu-id="8337f-236">In the **Name** box, enter a name for your database.</span></span>
8. <span data-ttu-id="8337f-237">Kliknij przycisk **serwer docelowy** wybierz opcję **Utwórz nowy serwer**.</span><span class="sxs-lookup"><span data-stu-id="8337f-237">Click the **Target Server** box, select **Create a new server**.</span></span> <span data-ttu-id="8337f-238">Alternatywnie wcześniej utworzonego serwera, można wybrać tego serwera z listy dostępnych serwerów.</span><span class="sxs-lookup"><span data-stu-id="8337f-238">Alternatively, if you previously created a server, you can select that server from list of available servers.</span></span>
9. <span data-ttu-id="8337f-239">Wybierz **warstwa cenowa** wybierz *wolne*.</span><span class="sxs-lookup"><span data-stu-id="8337f-239">Choose **Pricing tier** section, choose *Free*.</span></span> <span data-ttu-id="8337f-240">Jeśli potrzebne są dodatkowe zasoby, bazy danych można skalować w w dowolnym momencie.</span><span class="sxs-lookup"><span data-stu-id="8337f-240">If additional resources are needed, the database can be scaled up at any time.</span></span> <span data-ttu-id="8337f-241">Aby dowiedzieć się więcej o cenach SQL Azure, zapoznaj się z dokumentacją na [Azure Docs](https://azure.microsoft.com/pricing/details/sql-database/).</span><span class="sxs-lookup"><span data-stu-id="8337f-241">To learn more on Azure SQL Pricing, read the documentation on [Azure Docs](https://azure.microsoft.com/pricing/details/sql-database/).</span></span>
10. <span data-ttu-id="8337f-242">Modyfikowanie [sortowania](https://docs.microsoft.com/sql/relational-databases/collations/collation-and-unicode-support) zgodnie z potrzebami.</span><span class="sxs-lookup"><span data-stu-id="8337f-242">Modify [collation](https://docs.microsoft.com/sql/relational-databases/collations/collation-and-unicode-support) as needed.</span></span>
11. <span data-ttu-id="8337f-243">Wprowadź administrator **nazwa użytkownika administratora SQL** i **hasło administratora SQL**.</span><span class="sxs-lookup"><span data-stu-id="8337f-243">Enter an administrator **SQL Admin Username** and **SQL Admin Password**.</span></span> <span data-ttu-id="8337f-244">W przypadku wybrania **nowej bazy danych SQL server**, nie wprowadzasz istniejącej nazwy i hasła w tym miejscu, podajesz nową nazwę i hasło definiowane w tej chwili do użycia w przyszłości podczas dostępu do bazy danych.</span><span class="sxs-lookup"><span data-stu-id="8337f-244">If you selected **New SQL Database server**, you aren't entering an existing name and password here, you're entering a new name and password that you're defining now to use later when you access the database.</span></span> <span data-ttu-id="8337f-245">W przypadku wybrania wcześniej utworzonego serwera zostanie wprowadź poświadczenia dla tego serwera.</span><span class="sxs-lookup"><span data-stu-id="8337f-245">If you selected a server that you created previously, you'll enter credentials for that server.</span></span>
12. <span data-ttu-id="8337f-246">Kolekcja danych telemetrycznych można włączyć dla aplikacji za pomocą usługi Application Insights.</span><span class="sxs-lookup"><span data-stu-id="8337f-246">Telemetry collection can be enabled for App Service using Application Insights.</span></span> <span data-ttu-id="8337f-247">Usługi Application Insights z małego konfiguracją zbiera dane zdarzeń cenne, wyjątków, zależności, żądania i informacje o śledzeniu.</span><span class="sxs-lookup"><span data-stu-id="8337f-247">Application Insights with little configuration collects valuable event, exception, dependency, request, and trace information.</span></span> <span data-ttu-id="8337f-248">Aby dowiedzieć się więcej na temat usługi Application Insights, wprowadzenie [Azure Docs](https://azure.microsoft.com/services/application-insights/).</span><span class="sxs-lookup"><span data-stu-id="8337f-248">To learn more about Application Insights, get started in [Azure Docs](https://azure.microsoft.com/services/application-insights/).</span></span>
12. <span data-ttu-id="8337f-249">Kliknij przycisk **Utwórz** w dolnej części bloku, aby wskazać, że wszystko jest gotowe.</span><span class="sxs-lookup"><span data-stu-id="8337f-249">Click **Create** at the bottom of the blade to indicate that you're finished.</span></span>
  
 <span data-ttu-id="8337f-250">Portal zarządzania zwróci do strony pulpitów nawigacyjnych i **powiadomienia** zawiera blok, w górnej części strony witryny jest tworzona.</span><span class="sxs-lookup"><span data-stu-id="8337f-250">The Management Portal returns to the Dashboards page, and the **Notifications** blade at the top of the page shows that the site is being created.</span></span> <span data-ttu-id="8337f-251">Po chwili (zazwyczaj mniej niż minutę) będzie powiadomienie, że wdrożenie zakończyło się pomyślnie.</span><span class="sxs-lookup"><span data-stu-id="8337f-251">After a while (typically less than a minute), there will be a notification that the Deployment succeeded.</span></span> <span data-ttu-id="8337f-252">Na pasku nawigacyjnym po lewej stronie nowe **usługi aplikacji** pojawia się w *usługi aplikacji* sekcji i nowych **bazy danych SQL** pojawia się w *bazy danych SQL*  sekcji.</span><span class="sxs-lookup"><span data-stu-id="8337f-252">In the navigation bar at the left, the new **App Service** appears in the *App Services* section and the new **SQL Database** appears in the *SQL Databases* section.</span></span>

### <a name="deploy-the-application-to-azure"></a><span data-ttu-id="8337f-253">Wdrażanie aplikacji na platformie Azure</span><span class="sxs-lookup"><span data-stu-id="8337f-253">Deploy the application to Azure</span></span>

1. <span data-ttu-id="8337f-254">W programie Visual Studio, kliknij prawym przyciskiem myszy projekt w **Eksploratora rozwiązań** i wybierz **publikowania** z menu kontekstowego.</span><span class="sxs-lookup"><span data-stu-id="8337f-254">In Visual Studio, right-click the project in **Solution Explorer** and select **Publish** from the context menu.</span></span>
  
    ![Opublikuj w menu kontekstowego projektu](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/image10.png)
2. <span data-ttu-id="8337f-256">W **profilu** karcie **publikowanie w sieci Web** kreatora, kliknij przycisk **Microsoft Azure App Service**.</span><span class="sxs-lookup"><span data-stu-id="8337f-256">In the **Profile** tab of the **Publish Web** wizard, click **Microsoft Azure App Service**.</span></span>
  
    ![Importowanie ustawień publikowania](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Publish-ChooseTarget.png)
3. <span data-ttu-id="8337f-258">Jeśli nie zostały wcześniej dodane subskrypcji platformy Azure w programie Visual Studio, wykonaj kroki na ekranie.</span><span class="sxs-lookup"><span data-stu-id="8337f-258">If you have not previously added your Azure subscription in Visual Studio, perform the steps on the screen.</span></span> <span data-ttu-id="8337f-259">Kroki te włączają Visual Studio, aby połączyć się z subskrypcją platformy Azure tak że listę **usługi aplikacji** uwzględni witryny sieci web.</span><span class="sxs-lookup"><span data-stu-id="8337f-259">These steps enable Visual Studio to connect to your Azure subscription so that the list of **App Services** will include your web site.</span></span>
 
4. <span data-ttu-id="8337f-260">Wybierz **subskrypcji** możesz dodawać usługi App Service, następnie **planu usługi App Service** folderu usługi aplikacji jest częścią, a na końcu **usługi aplikacji** sam następuje **Ok**.</span><span class="sxs-lookup"><span data-stu-id="8337f-260">Select the **Subscription** you added the App Service to, then the **App Service Plan** folder your App Service is a part of, and finally the **App Service** itself followed by **Ok**.</span></span>

    ![Wybierz usługę aplikacji](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Publish-AppService.png)
5. <span data-ttu-id="8337f-262">Po skonfigurowaniu profilu **połączenia** kartę będą wyświetlane.</span><span class="sxs-lookup"><span data-stu-id="8337f-262">After the Profile has been configured, the **Connection** tab will be shown.</span></span> <span data-ttu-id="8337f-263">Kliknij przycisk **sprawdzania poprawności połączenia** aby upewnić się, że ustawienia są poprawne</span><span class="sxs-lookup"><span data-stu-id="8337f-263">Click **Validate Connection** to make sure that the settings are correct</span></span>

    ![Weryfikacja połączenia](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Publish-Connection.png)
7. <span data-ttu-id="8337f-265">Po sprawdzeniu poprawności połączenia zielony znacznik wyboru jest wyświetlany obok pozycji **sprawdzania poprawności połączenia** przycisku.</span><span class="sxs-lookup"><span data-stu-id="8337f-265">When the connection has been validated, a green check mark is shown next to the **Validate Connection** button.</span></span> <span data-ttu-id="8337f-266">Kliknij przycisk **Dalej**.</span><span class="sxs-lookup"><span data-stu-id="8337f-266">Click **Next**.</span></span>
  
    ![Pomyślnie zweryfikowane połączenia](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Publish-SettingsValidated.png)
8. <span data-ttu-id="8337f-268">Otwórz **ciąg połączenia zdalnego** listy rozwijanej w obszarze **SchoolContext** i wybierz parametry połączenia dla bazy danych został utworzony.</span><span class="sxs-lookup"><span data-stu-id="8337f-268">Open the **Remote connection string** drop-down list under **SchoolContext** and select the connection string for the database you created.</span></span>
9. <span data-ttu-id="8337f-269">Wybierz **aktualizacji bazy danych**.</span><span class="sxs-lookup"><span data-stu-id="8337f-269">Select **Update database**.</span></span>

    ![Karta Ustawienia](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Publish-Settings.png)

    <span data-ttu-id="8337f-271">To ustawienie powoduje, że proces wdrażania automatycznie skonfigurować aplikację *Web.config* plików na serwerze docelowym, aby używał Code First `MigrateDatabaseToLatestVersion` klasy inicjatora.</span><span class="sxs-lookup"><span data-stu-id="8337f-271">This setting causes the deployment process to automatically configure the application *Web.config* file on the destination server so that Code First uses the `MigrateDatabaseToLatestVersion` initializer class.</span></span>
10. <span data-ttu-id="8337f-272">Kliknij przycisk **Dalej**.</span><span class="sxs-lookup"><span data-stu-id="8337f-272">Click **Next**.</span></span>
11. <span data-ttu-id="8337f-273">W **Podgląd** , kliknij pozycję **Uruchom Podgląd**.</span><span class="sxs-lookup"><span data-stu-id="8337f-273">In the **Preview** tab, click **Start Preview**.</span></span>
  
    ![Przycisk StartPreview w karcie podglądu](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Publish-Preview.png)
  
 <span data-ttu-id="8337f-275">Karcie zostanie wyświetlona lista plików, które zostaną skopiowane na serwer.</span><span class="sxs-lookup"><span data-stu-id="8337f-275">The tab displays a list of the files that will be copied to the server.</span></span> <span data-ttu-id="8337f-276">Wyświetlanie podglądu nie jest wymagane, aby opublikować aplikację, ale jest to funkcja przydatna pod uwagę.</span><span class="sxs-lookup"><span data-stu-id="8337f-276">Displaying the preview isn't required to publish the application but is a useful function to be aware of.</span></span> <span data-ttu-id="8337f-277">W takim przypadku nie trzeba wykonywać żadnych czynności z listy plików, który jest wyświetlany.</span><span class="sxs-lookup"><span data-stu-id="8337f-277">In this case, you don't need to do anything with the list of files that is displayed.</span></span> <span data-ttu-id="8337f-278">Przy następnym wdrażania tej aplikacji będzie tylko te pliki, które zostały zmienione na tej liście.</span><span class="sxs-lookup"><span data-stu-id="8337f-278">The next time you deploy this application, only the files that have changed will be in this list.</span></span>
    <span data-ttu-id="8337f-279">![Dane wyjściowe pliku StartPreview](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Publish-PreviewLoaded.png)</span><span class="sxs-lookup"><span data-stu-id="8337f-279">![StartPreview file output](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Publish-PreviewLoaded.png)</span></span>

12. <span data-ttu-id="8337f-280">Kliknij przycisk **publikowania**.</span><span class="sxs-lookup"><span data-stu-id="8337f-280">Click **Publish**.</span></span>
 <span data-ttu-id="8337f-281">Visual Studio rozpoczyna proces kopiowania plików na serwer platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="8337f-281">Visual Studio begins the process of copying the files to the Azure server.</span></span>
13. <span data-ttu-id="8337f-282">**Dane wyjściowe** okna pokazuje, jakie akcje wdrażania zostały pobrane i raporty pomyślnego wdrożenia.</span><span class="sxs-lookup"><span data-stu-id="8337f-282">The **Output** window shows what deployment actions were taken and reports successful completion of the deployment.</span></span>
  
    ![Okno danych wyjściowych raportowania pomyślnego wdrożenia](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Publish-BuildOutput.png)
14. <span data-ttu-id="8337f-284">Po pomyślnym wdrożeniu przeglądarka domyślna automatycznie otwiera adres URL wdrożonej witryny sieci web.</span><span class="sxs-lookup"><span data-stu-id="8337f-284">Upon successful deployment, the default browser automatically opens to the URL of the deployed web site.</span></span>
 <span data-ttu-id="8337f-285">Utworzoną aplikację jest teraz uruchomiona w chmurze.</span><span class="sxs-lookup"><span data-stu-id="8337f-285">The application you created is now running in the cloud.</span></span> 
  
    ![Students_index_page_with_paging](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Publish-Site.png)

<span data-ttu-id="8337f-287">W tym momencie z *SchoolContext* utworzono bazę danych w bazie danych SQL Azure, ponieważ wybrano **wykonaj migracje Code First (wywoływane po uruchomieniu aplikacji)**.</span><span class="sxs-lookup"><span data-stu-id="8337f-287">At this point your *SchoolContext* database has been created in the Azure SQL Database because you selected **Execute Code First Migrations (runs on app start)**.</span></span> <span data-ttu-id="8337f-288">*Web.config* plik wdrożonej witryny sieci web został zmieniony, aby [MigrateDatabaseToLatestVersion](https://msdn.microsoft.com/library/hh829476(v=vs.103).aspx) inicjator jest uruchamiana po raz pierwszy kod odczytuje i zapisuje dane w bazie danych (co się stało Jeśli wybrano **studentów** kartę):</span><span class="sxs-lookup"><span data-stu-id="8337f-288">The *Web.config* file in the deployed web site has been changed so that the [MigrateDatabaseToLatestVersion](https://msdn.microsoft.com/library/hh829476(v=vs.103).aspx) initializer runs the first time your code reads or writes data in the database (which happened when you selected the **Students** tab):</span></span>

![](https://asp.net/media/4367421/mig.png)

<span data-ttu-id="8337f-289">Proces wdrażania również utworzyć nowe parametry połączenia *(SchoolContext\_DatabasePublish*) dla migracje Code First na potrzeby aktualizacji schematu bazy danych i wstępne wypełnianie bazy danych.</span><span class="sxs-lookup"><span data-stu-id="8337f-289">The deployment process also created a new connection string *(SchoolContext\_DatabasePublish*) for Code First Migrations to use for updating the database schema and seeding the database.</span></span>

![Parametry połączenia Database_Publish](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/image26.png)

<span data-ttu-id="8337f-291">Można znaleźć wdrożoną wersję pliku Web.config na komputerze w *ContosoUniversity\obj\Release\Package\PackageTmp\Web.config*. Dostęp do wdrożonych *Web.config* samego pliku przy użyciu protokołu FTP.</span><span class="sxs-lookup"><span data-stu-id="8337f-291">You can find the deployed version of the Web.config file on your own computer in *ContosoUniversity\obj\Release\Package\PackageTmp\Web.config*. You can access the deployed *Web.config* file itself by using FTP.</span></span> <span data-ttu-id="8337f-292">Aby uzyskać instrukcje, zobacz [wdrożenia sieci Web ASP.NET przy użyciu programu Visual Studio: Wdrażanie aktualizacji kodu](xref:web-forms/overview/deployment/visual-studio-web-deployment/deploying-a-code-update).</span><span class="sxs-lookup"><span data-stu-id="8337f-292">For instructions, see [ASP.NET Web Deployment using Visual Studio: Deploying a Code Update](xref:web-forms/overview/deployment/visual-studio-web-deployment/deploying-a-code-update).</span></span> <span data-ttu-id="8337f-293">Postępuj zgodnie z instrukcjami rozpoczynających się od "Aby użyć narzędzia FTP, niezbędne są trzy elementy: adres URL FTP, nazwę użytkownika i hasło."</span><span class="sxs-lookup"><span data-stu-id="8337f-293">Follow the instructions that start with "To use an FTP tool, you need three things: the FTP URL, the user name, and the password."</span></span>

> [!NOTE]
> <span data-ttu-id="8337f-294">Aplikacja sieci web nie zawiera implementacji zabezpieczeń, więc każda osoba, która znajdzie adres URL Zmień dane.</span><span class="sxs-lookup"><span data-stu-id="8337f-294">The web app doesn't implement security, so anyone who finds the URL can change the data.</span></span> <span data-ttu-id="8337f-295">Aby uzyskać instrukcje na temat sposobu zabezpieczenie witryny sieci web, zobacz [wdrażanie aplikacji bezpiecznego ASP.NET MVC z członkostwa, OAuth i bazy danych SQL Azure](https://docs.microsoft.com/aspnet/core/security/authorization/secure-data).</span><span class="sxs-lookup"><span data-stu-id="8337f-295">For instructions on how to secure the web site, see [Deploy a Secure ASP.NET MVC app with Membership, OAuth, and SQL Database to Azure](https://docs.microsoft.com/aspnet/core/security/authorization/secure-data).</span></span> <span data-ttu-id="8337f-296">Można zapobiec użyciu lokacji za pomocą portalu zarządzania Azure przez inne osoby lub **Eksploratora serwera** w programie Visual Studio można zatrzymać witryny.</span><span class="sxs-lookup"><span data-stu-id="8337f-296">You can prevent other people from using the site by using the Azure Management Portal or **Server Explorer** in Visual Studio to stop the site.</span></span>


![](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Stop-Service.png)

## <a name="advanced-migrations-scenarios"></a><span data-ttu-id="8337f-297">Scenariusze migracji zaawansowane</span><span class="sxs-lookup"><span data-stu-id="8337f-297">Advanced Migrations Scenarios</span></span>

<span data-ttu-id="8337f-298">Jeśli wdrożyć bazę danych, uruchamiając migracji automatycznie, jak pokazano w tym samouczku, a następnie wdrażasz do witryny sieci web, która działa na wielu serwerach, można pobrać wielu serwerów w trakcie uruchamiania migracji w tym samym czasie.</span><span class="sxs-lookup"><span data-stu-id="8337f-298">If you deploy a database by running migrations automatically as shown in this tutorial, and you are deploying to a web site that runs on multiple servers, you could get multiple servers trying to run migrations at the same time.</span></span> <span data-ttu-id="8337f-299">Migracje są atomic, dwa serwery próby uruchomienia tej samej migracji, co powiedzie się i innych zakończy się niepowodzeniem (przy założeniu, że dwa razy nie można wykonać operacji).</span><span class="sxs-lookup"><span data-stu-id="8337f-299">Migrations are atomic, so if two servers try to run the same migration, one will succeed and the other will fail (assuming the operations can't be done twice).</span></span> <span data-ttu-id="8337f-300">W tym scenariuszu jeśli chcesz uniknąć tych problemów, można wywołać ręcznie migracji i skonfigurować własny kod, aby go odbywa się tylko raz.</span><span class="sxs-lookup"><span data-stu-id="8337f-300">In that scenario if you want to avoid those issues, you can call migrations manually and set up your own code so that it only happens once.</span></span> <span data-ttu-id="8337f-301">Aby uzyskać więcej informacji, zobacz [pracy i skrypty migracji z kodu](http://romiller.com/2012/02/09/running-scripting-migrations-from-code/) na blogu Tomaszewski Rowan i [Migrate.exe](https://msdn.microsoft.com/data/jj618307) (w przypadku wykonywania migracji z wiersza polecenia) w witrynie MSDN.</span><span class="sxs-lookup"><span data-stu-id="8337f-301">For more information, see [Running and Scripting Migrations from Code](http://romiller.com/2012/02/09/running-scripting-migrations-from-code/) on Rowan Miller's blog and [Migrate.exe](https://msdn.microsoft.com/data/jj618307) (for executing migrations from the command line) on MSDN.</span></span>

<span data-ttu-id="8337f-302">Aby uzyskać informacje o innych scenariuszy migracji, zobacz [serii Screencast migracje](https://blogs.msdn.com/b/adonet/archive/2014/03/12/migrations-screencast-series.aspx).</span><span class="sxs-lookup"><span data-stu-id="8337f-302">For information about other migrations scenarios, see [Migrations Screencast Series](https://blogs.msdn.com/b/adonet/archive/2014/03/12/migrations-screencast-series.aspx).</span></span>

## <a name="code-first-initializers"></a><span data-ttu-id="8337f-303">Inicjatory pierwszy kodu</span><span class="sxs-lookup"><span data-stu-id="8337f-303">Code First Initializers</span></span>

<span data-ttu-id="8337f-304">W sekcji wdrożenia widać [MigrateDatabaseToLatestVersion](https://msdn.microsoft.com/library/hh829476(v=vs.103).aspx) inicjatora używane.</span><span class="sxs-lookup"><span data-stu-id="8337f-304">In the deployment section you saw the [MigrateDatabaseToLatestVersion](https://msdn.microsoft.com/library/hh829476(v=vs.103).aspx) initializer being used.</span></span> <span data-ttu-id="8337f-305">Kod najpierw zawiera również inne inicjatory, w tym [CreateDatabaseIfNotExists](https://msdn.microsoft.com/library/gg679221(v=vs.103).aspx) (ustawienie domyślne), [DropCreateDatabaseIfModelChanges](https://msdn.microsoft.com/library/gg679604(v=VS.103).aspx) (który użyto wcześniej) i [ DropCreateDatabaseAlways](https://msdn.microsoft.com/library/gg679506(v=VS.103).aspx).</span><span class="sxs-lookup"><span data-stu-id="8337f-305">Code First also provides other initializers, including [CreateDatabaseIfNotExists](https://msdn.microsoft.com/library/gg679221(v=vs.103).aspx) (the default), [DropCreateDatabaseIfModelChanges](https://msdn.microsoft.com/library/gg679604(v=VS.103).aspx) (which you used earlier) and [DropCreateDatabaseAlways](https://msdn.microsoft.com/library/gg679506(v=VS.103).aspx).</span></span> <span data-ttu-id="8337f-306">`DropCreateAlways` Inicjatora może być przydatne w przypadku konfigurowania warunki dla testów jednostkowych.</span><span class="sxs-lookup"><span data-stu-id="8337f-306">The `DropCreateAlways` initializer can be useful for setting up conditions for unit tests.</span></span> <span data-ttu-id="8337f-307">Można również napisać własny inicjatory i można wywołać inicjatora jawnie, jeśli nie chcesz czekać, aż do aplikacji odczytuje z lub zapisuje w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="8337f-307">You can also write your own initializers, and you can call an initializer explicitly if you don't want to wait until the application reads from or writes to the database.</span></span> <span data-ttu-id="8337f-308">Z chwili utworzenia tego samouczka jest zapisywana w listopadzie 2013 można używać tylko inicjatory tworzenie i DropCreate przed włączeniem migracji.</span><span class="sxs-lookup"><span data-stu-id="8337f-308">At the time this tutorial is being written in November, 2013, you can only use the Create and DropCreate initializers before you enable migrations.</span></span> <span data-ttu-id="8337f-309">Zespół programu Entity Framework pracuje nad wprowadzania tych inicjatory można używać z także migracji.</span><span class="sxs-lookup"><span data-stu-id="8337f-309">The Entity Framework team is working on making these initializers usable with migrations as well.</span></span>

<span data-ttu-id="8337f-310">Aby uzyskać więcej informacji na temat inicjatory, zobacz [opis inicjatory bazy danych w Entity Framework Code First](http://www.codeguru.com/csharp/article.php/c19999/Understanding-Database-Initializers-in-Entity-Framework-Code-First.htm) i rozdział 6 książki [programowania Entity Framework: Code First](http://shop.oreilly.com/product/0636920022220.do) przez Julie Lerman i Tomaszewski Rowan.</span><span class="sxs-lookup"><span data-stu-id="8337f-310">For more information about initializers, see [Understanding Database Initializers in Entity Framework Code First](http://www.codeguru.com/csharp/article.php/c19999/Understanding-Database-Initializers-in-Entity-Framework-Code-First.htm) and chapter 6 of the book [Programming Entity Framework: Code First](http://shop.oreilly.com/product/0636920022220.do) by Julie Lerman and Rowan Miller.</span></span>

## <a name="summary"></a><span data-ttu-id="8337f-311">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="8337f-311">Summary</span></span>

<span data-ttu-id="8337f-312">W tym samouczku przedstawiono sposób włączyć migracje i wdrażania aplikacji.</span><span class="sxs-lookup"><span data-stu-id="8337f-312">In this tutorial you've seen how to enable migrations and deploy the application.</span></span> <span data-ttu-id="8337f-313">W następnym samouczku zostaną patrzeć bardziej zaawansowanych tematów, rozwijając modelu danych.</span><span class="sxs-lookup"><span data-stu-id="8337f-313">In the next tutorial you'll begin looking at more advanced topics by expanding the data model.</span></span>

<span data-ttu-id="8337f-314">Wystaw opinię na jak zbędne tego samouczka i co można możemy ulepszyć.</span><span class="sxs-lookup"><span data-stu-id="8337f-314">Please leave feedback on how you liked this tutorial and what we could improve.</span></span> <span data-ttu-id="8337f-315">Możesz również poprosić o nowe tematy w [Pokaż mnie jak z kodu](http://aspnet.uservoice.com/forums/228522-show-me-how-with-code).</span><span class="sxs-lookup"><span data-stu-id="8337f-315">You can also request new topics at [Show Me How With Code](http://aspnet.uservoice.com/forums/228522-show-me-how-with-code).</span></span>

<span data-ttu-id="8337f-316">Linki do innych zasobów programu Entity Framework, można znaleźć w [dostępu do danych programu ASP.NET - zalecane zasobów](xref:whitepapers/aspnet-data-access-content-map).</span><span class="sxs-lookup"><span data-stu-id="8337f-316">Links to other Entity Framework resources can be found in [ASP.NET Data Access - Recommended Resources](xref:whitepapers/aspnet-data-access-content-map).</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="8337f-317">[Poprzednie](xref:mvc/overview/getting-started/getting-started-with-ef-using-mvc/connection-resiliency-and-command-interception-with-the-entity-framework-in-an-asp-net-mvc-application)
[dalej](xref:mvc/overview/getting-started/getting-started-with-ef-using-mvc/creating-a-more-complex-data-model-for-an-asp-net-mvc-application)</span><span class="sxs-lookup"><span data-stu-id="8337f-317">[Previous](xref:mvc/overview/getting-started/getting-started-with-ef-using-mvc/connection-resiliency-and-command-interception-with-the-entity-framework-in-an-asp-net-mvc-application)
[Next](xref:mvc/overview/getting-started/getting-started-with-ef-using-mvc/creating-a-more-complex-data-model-for-an-asp-net-mvc-application)</span></span>
