---
uid: web-forms/overview/data-access/working-with-batched-data/batch-updating-vb
title: Wsadowe aktualizacji (VB) | Dokumentacja firmy Microsoft
author: rick-anderson
description: Dowiedz się, jak zaktualizować wiele rekordów bazy danych w ramach jednej operacji. W warstwie interfejsu użytkownika budujemy Element GridView każdego wiersza w przypadku edycji. W danych...
ms.author: aspnetcontent
manager: wpickett
ms.date: 06/26/2007
ms.topic: article
ms.assetid: d191a204-d7ea-458d-b81c-0b9049ecb55f
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/working-with-batched-data/batch-updating-vb
msc.type: authoredcontent
ms.openlocfilehash: 2c5119410057b39e7b9a03eca3a2dbdbc315ce00
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/06/2018
ms.locfileid: "30888253"
---
<a name="batch-updating-vb"></a><span data-ttu-id="b1a06-105">Wsadowe aktualizacji (VB)</span><span class="sxs-lookup"><span data-stu-id="b1a06-105">Batch Updating (VB)</span></span>
====================
<span data-ttu-id="b1a06-106">przez [Bento Scott](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="b1a06-106">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="b1a06-107">[Pobierz kod](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_64_VB.zip) lub [pobierania plików PDF](batch-updating-vb/_static/datatutorial64vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="b1a06-107">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_64_VB.zip) or [Download PDF](batch-updating-vb/_static/datatutorial64vb1.pdf)</span></span>

> <span data-ttu-id="b1a06-108">Dowiedz się, jak zaktualizować wiele rekordów bazy danych w ramach jednej operacji.</span><span class="sxs-lookup"><span data-stu-id="b1a06-108">Learn how to update multiple database records in a single operation.</span></span> <span data-ttu-id="b1a06-109">W warstwie interfejsu użytkownika budujemy Element GridView każdego wiersza w przypadku edycji.</span><span class="sxs-lookup"><span data-stu-id="b1a06-109">In the User Interface Layer we build a GridView where each row is editable.</span></span> <span data-ttu-id="b1a06-110">W warstwie dostępu do danych Firma Microsoft zawijać wiele operacji aktualizacji w ramach transakcji, aby upewnić się, czy wszystkie aktualizacje powiedzie się lub wszystkie aktualizacje są przywracane.</span><span class="sxs-lookup"><span data-stu-id="b1a06-110">In the Data Access Layer we wrap the multiple Update operations within a transaction to ensure that all updates succeed or all updates are rolled back.</span></span>


## <a name="introduction"></a><span data-ttu-id="b1a06-111">Wprowadzenie</span><span class="sxs-lookup"><span data-stu-id="b1a06-111">Introduction</span></span>

<span data-ttu-id="b1a06-112">W [poprzedniego samouczek](wrapping-database-modifications-within-a-transaction-vb.md) widzieliśmy jak rozszerzyć Warstwa dostępu do danych, aby dodać obsługę transakcji bazy danych.</span><span class="sxs-lookup"><span data-stu-id="b1a06-112">In the [preceding tutorial](wrapping-database-modifications-within-a-transaction-vb.md) we saw how to extend the Data Access Layer to add support for database transactions.</span></span> <span data-ttu-id="b1a06-113">Transakcji bazy danych gwarantuje, że szereg instrukcji modyfikacji danych będą traktowane jako jedna operacja atomic, który zapewnia, że wszystkie modyfikacje zakończy się niepowodzeniem lub wszystkie powiedzie się.</span><span class="sxs-lookup"><span data-stu-id="b1a06-113">Database transactions guarantee that a series of data modification statements will be treated as one atomic operation, which ensures that all modifications will fail or all will succeed.</span></span> <span data-ttu-id="b1a06-114">Z tym niskiego poziomu funkcjach warstwy DAL do końca możemy re przygotowanie włączyć wymagające uwagi do tworzenia partii interfejsów modyfikacji danych.</span><span class="sxs-lookup"><span data-stu-id="b1a06-114">With this low-level DAL functionality out of the way, we re ready to turn our attention to creating batch data modification interfaces.</span></span>

<span data-ttu-id="b1a06-115">W tym samouczku będziesz budujemy GridView, w którym każdy wiersz jest edytowalny (zobacz rysunek 1).</span><span class="sxs-lookup"><span data-stu-id="b1a06-115">In this tutorial we'll build a GridView where each row is editable (see Figure 1).</span></span> <span data-ttu-id="b1a06-116">Ponieważ każdy wiersz jest renderowany w interfejsie edycji tam s kolumnę Edycja nie jest konieczne, zaktualizuj i przyciski "Anuluj".</span><span class="sxs-lookup"><span data-stu-id="b1a06-116">Since each row is rendered in its editing interface, there s no need for a column of Edit, Update, and Cancel buttons.</span></span> <span data-ttu-id="b1a06-117">Zamiast tego, dostępne są dwa przyciski aktualizacji produktów na stronie, po kliknięciu wyliczyć wierszach widoku GridView i aktualizowania bazy danych.</span><span class="sxs-lookup"><span data-stu-id="b1a06-117">Instead, there are two Update Products buttons on the page that, when clicked, enumerate the GridView rows and update the database.</span></span>


<span data-ttu-id="b1a06-118">[![Każdego wiersza w widoku GridView jest edytowalna](batch-updating-vb/_static/image1.gif)](batch-updating-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="b1a06-118">[![Each Row in the GridView is Editable](batch-updating-vb/_static/image1.gif)](batch-updating-vb/_static/image1.png)</span></span>

<span data-ttu-id="b1a06-119">**Rysunek 1**: każdego wiersza w widoku GridView jest edytowalna ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](batch-updating-vb/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="b1a06-119">**Figure 1**: Each Row in the GridView is Editable ([Click to view full-size image](batch-updating-vb/_static/image2.png))</span></span>


<span data-ttu-id="b1a06-120">Rozpoczynanie pracy dzięki s!</span><span class="sxs-lookup"><span data-stu-id="b1a06-120">Let s get started!</span></span>

> [!NOTE]
> <span data-ttu-id="b1a06-121">W [przeprowadzania aktualizacji wsadowych](../editing-and-deleting-data-through-the-datalist/performing-batch-updates-vb.md) samouczek utworzyliśmy edycji partii interfejs, za pomocą formant DataList.</span><span class="sxs-lookup"><span data-stu-id="b1a06-121">In the [Performing Batch Updates](../editing-and-deleting-data-through-the-datalist/performing-batch-updates-vb.md) tutorial we created a batch editing interface using the DataList control.</span></span> <span data-ttu-id="b1a06-122">W tym samouczku różni się od poprzedniej w którym jest używana Element GridView i wykonać aktualizację partii w zakresie transakcji.</span><span class="sxs-lookup"><span data-stu-id="b1a06-122">This tutorial differs from the previous one in that is uses a GridView and the batch update is performed within the scope of a transaction.</span></span> <span data-ttu-id="b1a06-123">Po ukończeniu tego samouczka I zachęca do wróć do wcześniejszych samouczka i zaktualizuj go do korzystania z bazy danych dotyczące transakcji funkcji dodanej w poprzednim samouczka.</span><span class="sxs-lookup"><span data-stu-id="b1a06-123">After completing this tutorial I encourage you to return to the earlier tutorial and update it to use the database transaction-related functionality added in the preceding tutorial.</span></span>


## <a name="examining-the-steps-for-making-all-gridview-rows-editable"></a><span data-ttu-id="b1a06-124">Badanie kroki dokonywania można edytować wszystkie wiersze w widoku GridView</span><span class="sxs-lookup"><span data-stu-id="b1a06-124">Examining the Steps for Making All GridView Rows Editable</span></span>

<span data-ttu-id="b1a06-125">Zgodnie z opisem w [omówienie Wstawianie, aktualizowanie i usuwanie danych](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) samouczka widoku GridView udostępnia wbudowaną obsługę edytowanie jej odpowiednie dane na podstawie na wiersz.</span><span class="sxs-lookup"><span data-stu-id="b1a06-125">As discussed in the [An Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) tutorial, the GridView offers built-in support for editing its underlying data on a per-row basis.</span></span> <span data-ttu-id="b1a06-126">Wewnętrznie widoku GridView notatki wiersza można edytować za pomocą jego [ `EditIndex` właściwości](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.editindex(VS.80).aspx).</span><span class="sxs-lookup"><span data-stu-id="b1a06-126">Internally, the GridView notes what row is editable through its [`EditIndex` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.editindex(VS.80).aspx).</span></span> <span data-ttu-id="b1a06-127">Ponieważ w widoku GridView jest związany ze swoim źródłem danych, sprawdza każdego wiersza, aby zobaczyć, jeśli indeks wiersza jest równa wartości `EditIndex`.</span><span class="sxs-lookup"><span data-stu-id="b1a06-127">As the GridView is being bound to its data source, it checks each row to see if the index of the row equals the value of `EditIndex`.</span></span> <span data-ttu-id="b1a06-128">Jeśli tak, aby wiersz s, który ich edycję pola mają być renderowane interfejsów.</span><span class="sxs-lookup"><span data-stu-id="b1a06-128">If so, that row s fields are rendered using their editing interfaces.</span></span> <span data-ttu-id="b1a06-129">BoundFields, interfejs edytowania jest pole tekstowe których `Text` właściwości jest przypisywana wartość pola danych, określonej przez s elementu BoundField `DataField` właściwości.</span><span class="sxs-lookup"><span data-stu-id="b1a06-129">For BoundFields, the editing interface is a TextBox whose `Text` property is assigned the value of the data field specified by the BoundField s `DataField` property.</span></span> <span data-ttu-id="b1a06-130">Dla TemplateFields `EditItemTemplate` jest używany zamiast `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="b1a06-130">For TemplateFields, the `EditItemTemplate` is used in place of the `ItemTemplate`.</span></span>

<span data-ttu-id="b1a06-131">Odwołaj, gdy użytkownik kliknie przycisk Edytuj wiersz s rozpoczyna się edytowania przepływu pracy.</span><span class="sxs-lookup"><span data-stu-id="b1a06-131">Recall that the editing workflow starts when a user clicks a row s Edit button.</span></span> <span data-ttu-id="b1a06-132">To powoduje odświeżenie strony, ustawia GridView s `EditIndex` właściwości indeks wiersza klikniętej s i rebinds danych do siatki.</span><span class="sxs-lookup"><span data-stu-id="b1a06-132">This causes a postback, sets the GridView s `EditIndex` property to the clicked row s index, and rebinds the data to the grid.</span></span> <span data-ttu-id="b1a06-133">Po kliknięciu przycisku Anuluj wiersza s na ogłaszania zwrotnego `EditIndex` ma ustawioną wartość `-1` przed ponownego wiązania danych do siatki.</span><span class="sxs-lookup"><span data-stu-id="b1a06-133">When a row s Cancel button is clicked, on postback the `EditIndex` is set to a value of `-1` before rebinding the data to the grid.</span></span> <span data-ttu-id="b1a06-134">Ponieważ wierszy s GridView uruchomić indeksowania na zero, ustawienie `EditIndex` do `-1` powoduje wyświetlanie widoku GridView w trybie tylko do odczytu.</span><span class="sxs-lookup"><span data-stu-id="b1a06-134">Since the GridView s rows start indexing at zero, setting `EditIndex` to `-1` has the effect of displaying the GridView in read-only mode.</span></span>

<span data-ttu-id="b1a06-135">`EditIndex` Właściwość sprawdza się w przypadku edycji na wiersz, ale nie jest przeznaczony do edycji partii.</span><span class="sxs-lookup"><span data-stu-id="b1a06-135">The `EditIndex` property works well for per-row editing, but is not designed for batch editing.</span></span> <span data-ttu-id="b1a06-136">Aby całego widoku GridView edytowalny, musimy każdy wiersz renderowania przy użyciu jego edycji interfejsu.</span><span class="sxs-lookup"><span data-stu-id="b1a06-136">To make the entire GridView editable, we need to have each row render using its editing interface.</span></span> <span data-ttu-id="b1a06-137">Najprostszym sposobem, w tym celu jest utworzenie, gdzie każde pole można edytować zaimplementowano zgodnie z definicją TemplateField z jego edycji interfejs w `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="b1a06-137">The easiest way to accomplish this is to create where each editable field is implemented as a TemplateField with its editing interface defined in the `ItemTemplate`.</span></span>

<span data-ttu-id="b1a06-138">W następnych kilku kroków utworzymy całkowicie można edytować widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="b1a06-138">Over the next several steps we'll create a completely editable GridView.</span></span> <span data-ttu-id="b1a06-139">W kroku 1 nasz Rozpocznij od utworzenia widoku GridView i jego ObjectDataSource i konwertować TemplateFields jego BoundFields i w polu CheckBoxField.</span><span class="sxs-lookup"><span data-stu-id="b1a06-139">In Step 1 we'll start by creating the GridView and its ObjectDataSource and convert its BoundFields and CheckBoxField into TemplateFields.</span></span> <span data-ttu-id="b1a06-140">Kroki 2 i 3 możemy przeniesienie edycji interfejsów z TemplateFields `EditItemTemplate` s, aby ich `ItemTemplate` s.</span><span class="sxs-lookup"><span data-stu-id="b1a06-140">In Steps 2 and 3 we'll move the editing interfaces from the TemplateFields `EditItemTemplate` s to their `ItemTemplate` s.</span></span>

## <a name="step-1-displaying-product-information"></a><span data-ttu-id="b1a06-141">Krok 1: Wyświetlanie informacji o produkcie</span><span class="sxs-lookup"><span data-stu-id="b1a06-141">Step 1: Displaying Product Information</span></span>

<span data-ttu-id="b1a06-142">Zanim firma Microsoft martwić się o tworzeniu widoku GridView skutkującej wierszy są edytowalne, let s uruchomić po prostu wyświetlanie informacji o produkcie.</span><span class="sxs-lookup"><span data-stu-id="b1a06-142">Before we worry about creating a GridView where are rows are editable, let s start by simply displaying the product information.</span></span> <span data-ttu-id="b1a06-143">Otwórz `BatchUpdate.aspx` strony `BatchData` folder i przeciągnij element GridView z przybornika do projektanta.</span><span class="sxs-lookup"><span data-stu-id="b1a06-143">Open the `BatchUpdate.aspx` page in the `BatchData` folder and drag a GridView from the Toolbox onto the Designer.</span></span> <span data-ttu-id="b1a06-144">Ustaw GridView s `ID` do `ProductsGrid` i z jego tagów inteligentnych, wybierz powiązać nowy element ObjectDataSource o nazwie `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="b1a06-144">Set the GridView s `ID` to `ProductsGrid` and, from its smart tag, choose to bind it to a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="b1a06-145">Skonfiguruj ObjectDataSource można pobrać danych z `ProductsBLL` klasy s `GetProducts` metody.</span><span class="sxs-lookup"><span data-stu-id="b1a06-145">Configure the ObjectDataSource to retrieve its data from the `ProductsBLL` class s `GetProducts` method.</span></span>


<span data-ttu-id="b1a06-146">[![Skonfiguruj ObjectDataSource do użycia klasy ProductsBLL](batch-updating-vb/_static/image2.gif)](batch-updating-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="b1a06-146">[![Configure the ObjectDataSource to Use the ProductsBLL Class](batch-updating-vb/_static/image2.gif)](batch-updating-vb/_static/image3.png)</span></span>

<span data-ttu-id="b1a06-147">**Rysunek 2**: Konfigurowanie ObjectDataSource użyć `ProductsBLL` klasy ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](batch-updating-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="b1a06-147">**Figure 2**: Configure the ObjectDataSource to Use the `ProductsBLL` Class ([Click to view full-size image](batch-updating-vb/_static/image4.png))</span></span>


<span data-ttu-id="b1a06-148">[![Pobieranie danych produktu przy użyciu metody GetProducts](batch-updating-vb/_static/image3.gif)](batch-updating-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="b1a06-148">[![Retrieve the Product Data Using the GetProducts Method](batch-updating-vb/_static/image3.gif)](batch-updating-vb/_static/image5.png)</span></span>

<span data-ttu-id="b1a06-149">**Rysunek 3**: pobieranie danych produkt za pomocą `GetProducts` — metoda ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](batch-updating-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="b1a06-149">**Figure 3**: Retrieve the Product Data Using the `GetProducts` Method ([Click to view full-size image](batch-updating-vb/_static/image6.png))</span></span>


<span data-ttu-id="b1a06-150">Jak GridView funkcji modyfikacji s ObjectDataSource są przeznaczone do pracy na podstawie na wiersz.</span><span class="sxs-lookup"><span data-stu-id="b1a06-150">Like the GridView, the ObjectDataSource s modification features are designed to work on a per-row basis.</span></span> <span data-ttu-id="b1a06-151">Aby można było zaktualizować zestawu rekordów, potrzebujemy zapisać fragmentem kodu w klasie związanej z kodem strony ASP.NET, partii danych i przekazująca je do logiki warstwy Biznesowej.</span><span class="sxs-lookup"><span data-stu-id="b1a06-151">In order to update a set of records, we'll need to write a bit of code in the ASP.NET page s code-behind class that batches the data and passes it to the BLL.</span></span> <span data-ttu-id="b1a06-152">W związku z tym Ustaw list rozwijanych w elemencie ObjectDataSource s UPDATE, INSERT i DELETE karty na (Brak).</span><span class="sxs-lookup"><span data-stu-id="b1a06-152">Therefore, set the drop-down lists in the ObjectDataSource s UPDATE, INSERT, and DELETE tabs to (None).</span></span> <span data-ttu-id="b1a06-153">Kliknij przycisk Zakończ, aby zakończyć pracę kreatora.</span><span class="sxs-lookup"><span data-stu-id="b1a06-153">Click Finish to complete the wizard.</span></span>


<span data-ttu-id="b1a06-154">[![Ustawianie list rozwijanych w UPDATE, INSERT i usuwanie kart na (Brak)](batch-updating-vb/_static/image4.gif)](batch-updating-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="b1a06-154">[![Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None)](batch-updating-vb/_static/image4.gif)](batch-updating-vb/_static/image7.png)</span></span>

<span data-ttu-id="b1a06-155">**Rysunek 4**: wartość listy rozwijane w AKTUALIZOWANIA, WSTAWIANIA i usuwanie kart (None) ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](batch-updating-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="b1a06-155">**Figure 4**: Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None) ([Click to view full-size image](batch-updating-vb/_static/image8.png))</span></span>


<span data-ttu-id="b1a06-156">Po zakończeniu pracy Kreatora konfigurowania źródła danych, znaczników deklaratywne s ObjectDataSource powinien wyglądać następująco:</span><span class="sxs-lookup"><span data-stu-id="b1a06-156">After completing the Configure Data Source wizard, the ObjectDataSource s declarative markup should look like the following:</span></span>


[!code-aspx[Main](batch-updating-vb/samples/sample1.aspx)]

<span data-ttu-id="b1a06-157">Kończenie pracy Kreatora konfigurowania źródła danych powoduje także, że Visual Studio, aby utworzyć BoundFields i CheckBoxField dla pól danych produktu w widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="b1a06-157">Completing the Configure Data Source wizard also causes Visual Studio to create BoundFields and a CheckBoxField for the product data fields in the GridView.</span></span> <span data-ttu-id="b1a06-158">W tym samouczku umożliwiają s tylko Zezwalaj użytkownikom na wyświetlanie i edytowanie nazwy s produktu, kategoria, ceny i stan wycofane.</span><span class="sxs-lookup"><span data-stu-id="b1a06-158">For this tutorial, let s only allow the user to view and edit the product s name, category, price, and discontinued status.</span></span> <span data-ttu-id="b1a06-159">Usuń wszystkie elementy oprócz `ProductName`, `CategoryName`, `UnitPrice`, i `Discontinued` pól i Zmień nazwę `HeaderText` właściwości pierwsze trzy pola odpowiednio do produktu, kategorii i cenę.</span><span class="sxs-lookup"><span data-stu-id="b1a06-159">Remove all but the `ProductName`, `CategoryName`, `UnitPrice`, and `Discontinued` fields and rename the `HeaderText` properties of the first three fields to Product, Category, and Price, respectively.</span></span> <span data-ttu-id="b1a06-160">Sprawdź też, Włącz stronicowanie i włączyć sortowanie pola wyboru w widoku GridView tag inteligentny s.</span><span class="sxs-lookup"><span data-stu-id="b1a06-160">Lastly, check the Enable Paging and Enable Sorting checkboxes in the GridView s smart tag.</span></span>

<span data-ttu-id="b1a06-161">W tym momencie widoku GridView ma trzy BoundFields (`ProductName`, `CategoryName`, i `UnitPrice`) i CheckBoxField (`Discontinued`).</span><span class="sxs-lookup"><span data-stu-id="b1a06-161">At this point the GridView has three BoundFields (`ProductName`, `CategoryName`, and `UnitPrice`) and a CheckBoxField (`Discontinued`).</span></span> <span data-ttu-id="b1a06-162">Musimy przekonwertować czterech pól na TemplateFields, a następnie przesuń interfejs edytowania z TemplateField s `EditItemTemplate` do jego `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="b1a06-162">We need to convert these four fields into TemplateFields and then move the editing interface from the TemplateField s `EditItemTemplate` to its `ItemTemplate`.</span></span>

> [!NOTE]
> <span data-ttu-id="b1a06-163">Firma Microsoft zbadane, tworzenie i dostosowywanie TemplateFields w [Dostosowywanie interfejs modyfikacji danych](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) samouczka.</span><span class="sxs-lookup"><span data-stu-id="b1a06-163">We explored creating and customizing TemplateFields in the [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) tutorial.</span></span> <span data-ttu-id="b1a06-164">Zostanie omówiony kroki konwertowania BoundFields i CheckBoxField na TemplateFields i definiowanie ich edytowanie interfejsy w ich `ItemTemplate` s, ale jeśli zostać zablokowane lub wymagają odświeżenia, ADAM t się odwołują się do tego samouczka wcześniejszych.</span><span class="sxs-lookup"><span data-stu-id="b1a06-164">We'll walk through the steps of converting the BoundFields and CheckBoxField into TemplateFields and defining their editing interfaces in their `ItemTemplate` s, but if you get stuck or need a refresher, don t hesitate to refer back to this earlier tutorial.</span></span>


<span data-ttu-id="b1a06-165">Z widoku GridView s tagu kliknij łącze Edytowanie kolumn, aby otworzyć okno dialogowe pola.</span><span class="sxs-lookup"><span data-stu-id="b1a06-165">From the GridView s smart tag, click the Edit Columns link to open the Fields dialog box.</span></span> <span data-ttu-id="b1a06-166">Następnie wybierz każdego pola i kliknij przycisk Konwertuj to pole na pole TemplateField łącze.</span><span class="sxs-lookup"><span data-stu-id="b1a06-166">Next, select each field and click the Convert this field into a TemplateField link.</span></span>


![Konwertowanie TemplateFields istniejących BoundFields i CheckBoxField](batch-updating-vb/_static/image5.gif)

<span data-ttu-id="b1a06-168">**Rysunek 5**: konwertowanie TemplateFields istniejących BoundFields i CheckBoxField</span><span class="sxs-lookup"><span data-stu-id="b1a06-168">**Figure 5**: Convert the Existing BoundFields and CheckBoxField Into TemplateFields</span></span>


<span data-ttu-id="b1a06-169">Teraz, każde pole jest TemplateField, możemy re wszystko gotowe do przeniesienia edycji interfejsu z `EditItemTemplate` s do `ItemTemplate` s.</span><span class="sxs-lookup"><span data-stu-id="b1a06-169">Now that each field is a TemplateField, we re ready to move the editing interface from the `EditItemTemplate` s to the `ItemTemplate` s.</span></span>

## <a name="step-2-creating-theproductnameunitprice-anddiscontinuedediting-interfaces"></a><span data-ttu-id="b1a06-170">Krok 2: Tworzenie`ProductName`,`UnitPrice`, i`Discontinued`edycji interfejsów</span><span class="sxs-lookup"><span data-stu-id="b1a06-170">Step 2: Creating the`ProductName`,`UnitPrice`, and`Discontinued`Editing Interfaces</span></span>

<span data-ttu-id="b1a06-171">Tworzenie `ProductName`, `UnitPrice`, i `Discontinued` edycji interfejsy są tematu tego kroku i są bardzo proste, jak każdy interfejs jest już zdefiniowany w elemencie TemplateField s `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="b1a06-171">Creating the `ProductName`, `UnitPrice`, and `Discontinued` editing interfaces are the topic of this step and are pretty straightforward, as each interface is already defined in the TemplateField s `EditItemTemplate`.</span></span> <span data-ttu-id="b1a06-172">Tworzenie `CategoryName` edycji interfejsu jest nieco bardziej skomplikowane, ponieważ należy utworzyć DropDownList odpowiednich kategorii.</span><span class="sxs-lookup"><span data-stu-id="b1a06-172">Creating the `CategoryName` editing interface is a bit more involved since we need to create a DropDownList of the applicable categories.</span></span> <span data-ttu-id="b1a06-173">To `CategoryName` edycji interfejsu, jest opisany w kroku 3.</span><span class="sxs-lookup"><span data-stu-id="b1a06-173">This `CategoryName` editing interface is tackled in Step 3.</span></span>

<span data-ttu-id="b1a06-174">Let s rozpoczynać `ProductName` TemplateField.</span><span class="sxs-lookup"><span data-stu-id="b1a06-174">Let s start with the `ProductName` TemplateField.</span></span> <span data-ttu-id="b1a06-175">Kliknij łącze Edytuj szablony z widoku GridView tag inteligentny s, a następnie Drąż w dół do `ProductName` TemplateField s `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="b1a06-175">Click on the Edit Templates link from the GridView s smart tag and drill down to the `ProductName` TemplateField s `EditItemTemplate`.</span></span> <span data-ttu-id="b1a06-176">Wybierz pole tekstowe, skopiuj go do Schowka, a następnie wklej go do `ProductName` TemplateField s `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="b1a06-176">Select the TextBox, copy it to the clipboard, and then paste it to the `ProductName` TemplateField s `ItemTemplate`.</span></span> <span data-ttu-id="b1a06-177">Zmień s pole tekstowe `ID` właściwości `ProductName`.</span><span class="sxs-lookup"><span data-stu-id="b1a06-177">Change the TextBox s `ID` property to `ProductName`.</span></span>

<span data-ttu-id="b1a06-178">Następnie dodaj RequiredFieldValidator do `ItemTemplate` aby upewnić się, że użytkownik zawiera wartość dla każdej nazwy produktu s.</span><span class="sxs-lookup"><span data-stu-id="b1a06-178">Next, add a RequiredFieldValidator to the `ItemTemplate` to ensure that the user provides a value for each product s name.</span></span> <span data-ttu-id="b1a06-179">Ustaw `ControlToValidate` właściwości NazwaProduktu, `ErrorMessage` właściwości należy podać nazwę produktu.</span><span class="sxs-lookup"><span data-stu-id="b1a06-179">Set the `ControlToValidate` property to ProductName, the `ErrorMessage` property to You must provide the product's name.</span></span> <span data-ttu-id="b1a06-180">i `Text` właściwości \*.</span><span class="sxs-lookup"><span data-stu-id="b1a06-180">and the `Text` property to \*.</span></span> <span data-ttu-id="b1a06-181">Po wprowadzeniu tych dodatków do `ItemTemplate`, ekranu powinien wyglądać podobnie do rysunek 6.</span><span class="sxs-lookup"><span data-stu-id="b1a06-181">After making these additions to the `ItemTemplate`, your screen should look similar to Figure 6.</span></span>


<span data-ttu-id="b1a06-182">[![Teraz TemplateField ProductName zawiera pole tekstowe i RequiredFieldValidator](batch-updating-vb/_static/image6.gif)](batch-updating-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="b1a06-182">[![The ProductName TemplateField Now Includes a TextBox and a RequiredFieldValidator](batch-updating-vb/_static/image6.gif)](batch-updating-vb/_static/image9.png)</span></span>

<span data-ttu-id="b1a06-183">**Rysunek 6**: `ProductName` TemplateField zawiera teraz pole tekstowe i RequiredFieldValidator ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](batch-updating-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="b1a06-183">**Figure 6**: The `ProductName` TemplateField Now Includes a TextBox and a RequiredFieldValidator ([Click to view full-size image](batch-updating-vb/_static/image10.png))</span></span>


<span data-ttu-id="b1a06-184">Aby uzyskać `UnitPrice` edycji interfejsu, Rozpocznij od kopiowanie pole tekstowe z `EditItemTemplate` do `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="b1a06-184">For the `UnitPrice` editing interface, start by copying the TextBox from the `EditItemTemplate` to the `ItemTemplate`.</span></span> <span data-ttu-id="b1a06-185">Następnie należy umieścić $ przed pole tekstowe i ustaw jego `ID` właściwości UnitPrice i jego `Columns` właściwości do 8.</span><span class="sxs-lookup"><span data-stu-id="b1a06-185">Next, place a $ in front of the TextBox and set its `ID` property to UnitPrice and its `Columns` property to 8 .</span></span>

<span data-ttu-id="b1a06-186">Również dodać CompareValidator do `UnitPrice` s `ItemTemplate` w celu zapewnienia prawidłową walutę wartość większa niż lub równa 0,00 wartości wprowadzonej przez użytkownika.</span><span class="sxs-lookup"><span data-stu-id="b1a06-186">Also add a CompareValidator to the `UnitPrice` s `ItemTemplate` to ensure that the value entered by the user is a valid currency value greater than or equal to $0.00.</span></span> <span data-ttu-id="b1a06-187">Ustaw s modułu sprawdzania poprawności `ControlToValidate` właściwości UnitPrice, jego `ErrorMessage` właściwości można wprowadzić wartość waluty prawidłowe.</span><span class="sxs-lookup"><span data-stu-id="b1a06-187">Set the validator s `ControlToValidate` property to UnitPrice, its `ErrorMessage` property to You must enter a valid currency value.</span></span> <span data-ttu-id="b1a06-188">Można pominąć wszystkie waluty symboli., jego `Text` właściwości \*, jego `Type` właściwości `Currency`, jego `Operator` właściwości `GreaterThanEqual`i jego `ValueToCompare` właściwości na 0.</span><span class="sxs-lookup"><span data-stu-id="b1a06-188">Please omit any currency symbols., its `Text` property to \*, its `Type` property to `Currency`, its `Operator` property to `GreaterThanEqual`, and its `ValueToCompare` property to 0 .</span></span>


<span data-ttu-id="b1a06-189">[![Dodaj CompareValidator zapewnienie wprowadzona cen to wartość waluty nieujemną.](batch-updating-vb/_static/image7.gif)](batch-updating-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="b1a06-189">[![Add a CompareValidator to Ensure the Price Entered is a Non-Negative Currency Value](batch-updating-vb/_static/image7.gif)](batch-updating-vb/_static/image11.png)</span></span>

<span data-ttu-id="b1a06-190">**Rysunek 7**: Dodaj CompareValidator zapewnienie wprowadzona cen jest wartość waluty nieujemną ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](batch-updating-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="b1a06-190">**Figure 7**: Add a CompareValidator to Ensure the Price Entered is a Non-Negative Currency Value ([Click to view full-size image](batch-updating-vb/_static/image12.png))</span></span>


<span data-ttu-id="b1a06-191">Aby uzyskać `Discontinued` TemplateField można użyć pola wyboru już zdefiniowana w `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="b1a06-191">For the `Discontinued` TemplateField you can use the CheckBox already defined in the `ItemTemplate`.</span></span> <span data-ttu-id="b1a06-192">Wystarczy ustawić jej `ID` do wycofany i jego `Enabled` właściwości `True`.</span><span class="sxs-lookup"><span data-stu-id="b1a06-192">Simply set its `ID` to Discontinued and its `Enabled` property to `True`.</span></span>

## <a name="step-3-creating-thecategorynameediting-interface"></a><span data-ttu-id="b1a06-193">Krok 3: Tworzenie`CategoryName`edycji — interfejs</span><span class="sxs-lookup"><span data-stu-id="b1a06-193">Step 3: Creating the`CategoryName`Editing Interface</span></span>

<span data-ttu-id="b1a06-194">Interfejs edytowania w `CategoryName` TemplateField s `EditItemTemplate` zawiera pole tekstowe, który zawiera wartość `CategoryName` pola danych.</span><span class="sxs-lookup"><span data-stu-id="b1a06-194">The editing interface in the `CategoryName` TemplateField s `EditItemTemplate` contains a TextBox that displays the value of the `CategoryName` data field.</span></span> <span data-ttu-id="b1a06-195">Należy zastąpić tę DropDownList, który zawiera listę możliwych kategorii.</span><span class="sxs-lookup"><span data-stu-id="b1a06-195">We need to replace this with a DropDownList that lists the possible categories.</span></span>

> [!NOTE]
> <span data-ttu-id="b1a06-196">[Dostosowywanie interfejs modyfikacji danych](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) samouczek zawiera bardziej dokładne i kompletne omówione dostosowywania szablonu, aby uwzględnić DropDownList w przeciwieństwie do pola tekstowego.</span><span class="sxs-lookup"><span data-stu-id="b1a06-196">The [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) tutorial contains a more thorough and complete discussion on customizing a template to include a DropDownList as opposed to a TextBox.</span></span> <span data-ttu-id="b1a06-197">Gdy zakończeniu kroków w tym miejscu są przedstawione lapidarnie.</span><span class="sxs-lookup"><span data-stu-id="b1a06-197">While the steps here are complete, they are presented tersely.</span></span> <span data-ttu-id="b1a06-198">Na pełniejsze przyjrzeć się tworzeniem i konfigurowaniem kategorie lista DropDownList, odwołaj się do [Dostosowywanie interfejs modyfikacji danych](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) samouczka.</span><span class="sxs-lookup"><span data-stu-id="b1a06-198">For a more in-depth look at creating and configuring the categories DropDownList, refer back to the [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) tutorial.</span></span>


<span data-ttu-id="b1a06-199">Przeciągnij z przybornika do DropDownList `CategoryName` TemplateField s `ItemTemplate`, ustawienie jej `ID` do `Categories`.</span><span class="sxs-lookup"><span data-stu-id="b1a06-199">Drag a DropDownList from the Toolbox onto the `CategoryName` TemplateField s `ItemTemplate`, setting its `ID` to `Categories`.</span></span> <span data-ttu-id="b1a06-200">Na tym etapie firma Microsoft będzie zazwyczaj zdefiniowanie DropDownLists s źródła danych za pośrednictwem jego tagów inteligentnych Tworzenie nowego elementu ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="b1a06-200">At this point we would usually define the DropDownLists s data source through its smart tag, creating a new ObjectDataSource.</span></span> <span data-ttu-id="b1a06-201">Jednakże, spowoduje to dodanie ObjectDataSource w `ItemTemplate`, co spowoduje wystąpienie elementu ObjectDataSource utworzone dla każdego wiersza w widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="b1a06-201">However, this will add the ObjectDataSource within the `ItemTemplate`, which will result in an ObjectDataSource instance created for each GridView row.</span></span> <span data-ttu-id="b1a06-202">Zamiast tego można pozwolić utworzyć ObjectDataSource poza GridView s TemplateFields s.</span><span class="sxs-lookup"><span data-stu-id="b1a06-202">Instead, let s create the ObjectDataSource outside of the GridView s TemplateFields.</span></span> <span data-ttu-id="b1a06-203">Zakończyć edytowanie szablonu i przeciągnij element ObjectDataSource z przybornika do projektanta poniżej `ProductsDataSource` ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="b1a06-203">End the template editing and drag an ObjectDataSource from the Toolbox onto the Designer beneath the `ProductsDataSource` ObjectDataSource.</span></span> <span data-ttu-id="b1a06-204">Nazwa nowego elementu ObjectDataSource `CategoriesDataSource` i skonfigurować go do używania `CategoriesBLL` klasy s `GetCategories` metody.</span><span class="sxs-lookup"><span data-stu-id="b1a06-204">Name the new ObjectDataSource `CategoriesDataSource` and configure it to use the `CategoriesBLL` class s `GetCategories` method.</span></span>


<span data-ttu-id="b1a06-205">[![Skonfiguruj ObjectDataSource do użycia klasy CategoriesBLL](batch-updating-vb/_static/image8.gif)](batch-updating-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="b1a06-205">[![Configure the ObjectDataSource to Use the CategoriesBLL Class](batch-updating-vb/_static/image8.gif)](batch-updating-vb/_static/image13.png)</span></span>

<span data-ttu-id="b1a06-206">**Rysunek 8**: Konfigurowanie ObjectDataSource użyć `CategoriesBLL` klasy ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](batch-updating-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="b1a06-206">**Figure 8**: Configure the ObjectDataSource to Use the `CategoriesBLL` Class ([Click to view full-size image](batch-updating-vb/_static/image14.png))</span></span>


<span data-ttu-id="b1a06-207">[![Pobieranie danych kategorii przy użyciu metody GetCategories](batch-updating-vb/_static/image9.gif)](batch-updating-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="b1a06-207">[![Retrieve the Category Data Using the GetCategories Method](batch-updating-vb/_static/image9.gif)](batch-updating-vb/_static/image15.png)</span></span>

<span data-ttu-id="b1a06-208">**Rysunek 9**: pobrać za pomocą danych kategorii `GetCategories` — metoda ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](batch-updating-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="b1a06-208">**Figure 9**: Retrieve the Category Data Using the `GetCategories` Method ([Click to view full-size image](batch-updating-vb/_static/image16.png))</span></span>


<span data-ttu-id="b1a06-209">Ponieważ ten element ObjectDataSource jest używany tylko w celu pobrania danych, należy ustawić list rozwijanych w kartach UPDATE i DELETE na (Brak).</span><span class="sxs-lookup"><span data-stu-id="b1a06-209">Since this ObjectDataSource is used merely to retrieve data, set the drop-down lists in the UPDATE and DELETE tabs to (None).</span></span> <span data-ttu-id="b1a06-210">Kliknij przycisk Zakończ, aby zakończyć pracę kreatora.</span><span class="sxs-lookup"><span data-stu-id="b1a06-210">Click Finish to complete the wizard.</span></span>


<span data-ttu-id="b1a06-211">[![Zestaw list rozwijanych w aktualizacjach UPDATE i DELETE karty na (Brak)](batch-updating-vb/_static/image10.gif)](batch-updating-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="b1a06-211">[![Set the Drop-Down Lists in the UPDATE and DELETE Tabs to (None)](batch-updating-vb/_static/image10.gif)](batch-updating-vb/_static/image17.png)</span></span>

<span data-ttu-id="b1a06-212">**Na rysunku nr 10**: Ustaw listy rozwijane w aktualizacja i usuwanie kart na (Brak) ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](batch-updating-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="b1a06-212">**Figure 10**: Set the Drop-Down Lists in the UPDATE and DELETE Tabs to (None) ([Click to view full-size image](batch-updating-vb/_static/image18.png))</span></span>


<span data-ttu-id="b1a06-213">Po zakończeniu pracy kreatora, `CategoriesDataSource` znaczników deklaratywne s powinna wyglądać następująco:</span><span class="sxs-lookup"><span data-stu-id="b1a06-213">After completing the wizard, the `CategoriesDataSource` s declarative markup should look like the following:</span></span>


[!code-aspx[Main](batch-updating-vb/samples/sample2.aspx)]

<span data-ttu-id="b1a06-214">Z `CategoriesDataSource` utworzone i skonfigurowane, wróć do `CategoryName` TemplateField s `ItemTemplate` i tagów inteligentnych s DropDownList kliknij Link, wybierz źródło danych.</span><span class="sxs-lookup"><span data-stu-id="b1a06-214">With the `CategoriesDataSource` created and configured, return to the `CategoryName` TemplateField s `ItemTemplate` and, from the DropDownList s smart tag, click on the Choose Data Source link.</span></span> <span data-ttu-id="b1a06-215">W Kreatorze konfiguracji źródła danych, wybierz `CategoriesDataSource` opcję z pierwszej listy rozwijanej i wybrać opcję `CategoryName` używany do wyświetlania i `CategoryID` jako wartość.</span><span class="sxs-lookup"><span data-stu-id="b1a06-215">In the Data Source Configuration wizard, select the `CategoriesDataSource` option from the first drop-down list and choose to have `CategoryName` used for the display and `CategoryID` as the value.</span></span>


<span data-ttu-id="b1a06-216">[![Powiązać DropDownList CategoriesDataSource](batch-updating-vb/_static/image11.gif)](batch-updating-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="b1a06-216">[![Bind the DropDownList to the CategoriesDataSource](batch-updating-vb/_static/image11.gif)](batch-updating-vb/_static/image19.png)</span></span>

<span data-ttu-id="b1a06-217">**Rysunek 11**: powiązać DropDownList do `CategoriesDataSource` ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](batch-updating-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="b1a06-217">**Figure 11**: Bind the DropDownList to the `CategoriesDataSource` ([Click to view full-size image](batch-updating-vb/_static/image20.png))</span></span>


<span data-ttu-id="b1a06-218">W tym momencie `Categories` DropDownList zawiera listę wszystkich kategorii, ale go nie zostały jeszcze automatycznie wybierz odpowiednią kategorię produktu powiązany z wiersza elementu GridView.</span><span class="sxs-lookup"><span data-stu-id="b1a06-218">At this point the `Categories` DropDownList lists all of the categories, but it does not yet automatically select the appropriate category for the product bound to the GridView row.</span></span> <span data-ttu-id="b1a06-219">Należy ustawić w tym celu `Categories` DropDownList s `SelectedValue` produktu s `CategoryID` wartość.</span><span class="sxs-lookup"><span data-stu-id="b1a06-219">To accomplish this we need to set the `Categories` DropDownList s `SelectedValue` to the product s `CategoryID` value.</span></span> <span data-ttu-id="b1a06-220">Kliknij łącze Edytuj powiązania DataBindings z tagów inteligentnych s DropDownList i skojarz `SelectedValue` właściwości o `CategoryID` pola danych, jak pokazano na rysunku 12.</span><span class="sxs-lookup"><span data-stu-id="b1a06-220">Click on the Edit DataBindings link from the DropDownList s smart tag and associate the `SelectedValue` property with the `CategoryID` data field as shown in Figure 12.</span></span>


![Powiązać wartości CategoryID produktu s właściwości SelectedValue DropDownList s](batch-updating-vb/_static/image12.gif)

<span data-ttu-id="b1a06-222">**Rysunek 12**: powiązać produktu s `CategoryID` wartość s DropDownList `SelectedValue` właściwości</span><span class="sxs-lookup"><span data-stu-id="b1a06-222">**Figure 12**: Bind the Product s `CategoryID` Value to the DropDownList s `SelectedValue` Property</span></span>


<span data-ttu-id="b1a06-223">Jeden ostatniego pozostaje problem: Jeśli t produktu `CategoryID` określona wartość następnie instrukcji wiązania z danymi na `SelectedValue` spowoduje wygenerowanie wyjątku.</span><span class="sxs-lookup"><span data-stu-id="b1a06-223">One last problem remains: if the product doesn t have a `CategoryID` value specified then the databinding statement on `SelectedValue` will result in an exception.</span></span> <span data-ttu-id="b1a06-224">Wynika to z faktu DropDownList zawiera tylko elementy dla kategorii i nie oferuje opcja dla tych produktów, które mają `NULL` bazy danych wartości `CategoryID`.</span><span class="sxs-lookup"><span data-stu-id="b1a06-224">This is because the DropDownList contains only items for the categories and does not offer an option for those products that have a `NULL` database value for `CategoryID`.</span></span> <span data-ttu-id="b1a06-225">Aby rozwiązać ten problem, ustaw DropDownList s `AppendDataBoundItems` właściwości `True` i Dodaj nowy element do DropDownList, pomijając `Value` właściwość ze składni deklaratywnej.</span><span class="sxs-lookup"><span data-stu-id="b1a06-225">To remedy this, set the DropDownList s `AppendDataBoundItems` property to `True` and add a new item to the DropDownList, omitting the `Value` property from the declarative syntax.</span></span> <span data-ttu-id="b1a06-226">Oznacza to, upewnij się, że `Categories` składni deklaratywnej s DropDownList wygląda podobnie do następującej:</span><span class="sxs-lookup"><span data-stu-id="b1a06-226">That is, make sure that the `Categories` DropDownList s declarative syntax looks like the following:</span></span>


[!code-aspx[Main](batch-updating-vb/samples/sample3.aspx)]

<span data-ttu-id="b1a06-227">Uwaga jak `<asp:ListItem Value="">` — wybierz jedną — zawiera jego `Value` atrybutu jawnie ustawiona na pusty ciąg.</span><span class="sxs-lookup"><span data-stu-id="b1a06-227">Note how the `<asp:ListItem Value="">` -- Select One -- has its `Value` attribute explicitly set to an empty string.</span></span> <span data-ttu-id="b1a06-228">Odwołaj się do [Dostosowywanie interfejs modyfikacji danych](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) samouczka bardziej szczegółowe omówienie na dlaczego tego dodatkowe elementu DropDownList jest potrzebne do obsługi `NULL` przypadku i dlaczego przypisanie `Value` istotne jest pusty ciąg dla właściwości.</span><span class="sxs-lookup"><span data-stu-id="b1a06-228">Refer back to the [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) tutorial for a more thorough discussion on why this additional DropDownList item is needed to handle the `NULL` case and why assignment of the `Value` property to an empty string is essential.</span></span>

> [!NOTE]
> <span data-ttu-id="b1a06-229">Istnieje potencjalne wydajności i skalowalności problem tutaj który warto zauważyć.</span><span class="sxs-lookup"><span data-stu-id="b1a06-229">There is a potential performance and scalability issue here that is worth mentioning.</span></span> <span data-ttu-id="b1a06-230">Ponieważ każdy wiersz zawiera DropDownList, która używa `CategoriesDataSource` jako źródło danych, `CategoriesBLL` klasy s `GetCategories` metoda zostanie wywołana *n* razy na stronie odwiedzać, gdzie *n* jest liczbą wierszy w widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="b1a06-230">Since each row has a DropDownList that uses the `CategoriesDataSource` as its data source, the `CategoriesBLL` class s `GetCategories` method will be called *n* times per page visit, where *n* is the number of rows in the GridView.</span></span> <span data-ttu-id="b1a06-231">Te *n* wywołań `GetCategories` spowodować *n* zapytania do bazy danych.</span><span class="sxs-lookup"><span data-stu-id="b1a06-231">These *n* calls to `GetCategories` result in *n* queries to the database.</span></span> <span data-ttu-id="b1a06-232">Tej wpływa na bazie danych może to buforując zwrócony kategorii w pamięci podręcznej na żądanie lub przez warstwę buforowanie przy użyciu SQL buforowanie zależności lub bardzo krótkim na podstawie czasu wygaśnięcia.</span><span class="sxs-lookup"><span data-stu-id="b1a06-232">This impact on the database could be lessened by caching the returned categories either in a per-request cache or through the Caching Layer using a SQL caching dependency or a very short time-based expiry.</span></span> <span data-ttu-id="b1a06-233">Aby uzyskać więcej informacji na żądanie na buforowanie opcji, zobacz [ `HttpContext.Items` magazynu pamięci podręcznej na żądanie](http://aspnet.4guysfromrolla.com/articles/060904-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="b1a06-233">For more information on the per-request caching option, see [`HttpContext.Items` a Per-Request Cache Store](http://aspnet.4guysfromrolla.com/articles/060904-1.aspx).</span></span>


## <a name="step-4-completing-the-editing-interface"></a><span data-ttu-id="b1a06-234">Krok 4: Kończenie edycji interfejsu</span><span class="sxs-lookup"><span data-stu-id="b1a06-234">Step 4: Completing the Editing Interface</span></span>

<span data-ttu-id="b1a06-235">Firma Microsoft Zapisz wprowadzone liczbę zmian w szablonach s GridView bez wstrzymywania, aby wyświetlić postęp naszych.</span><span class="sxs-lookup"><span data-stu-id="b1a06-235">We ve made a number of changes to the GridView s templates without pausing to view our progress.</span></span> <span data-ttu-id="b1a06-236">Poświęć chwilę, aby wyświetlić postęp naszych za pośrednictwem przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="b1a06-236">Take a moment to view our progress through a browser.</span></span> <span data-ttu-id="b1a06-237">Jak pokazano na rysunku 13, każdy wiersz jest renderowany przy użyciu jego `ItemTemplate`, zawierającą s komórki edycji interfejsu.</span><span class="sxs-lookup"><span data-stu-id="b1a06-237">As Figure 13 shows, each row is rendered using its `ItemTemplate`, which contains the cell s editing interface.</span></span>


<span data-ttu-id="b1a06-238">[![Każdego wiersza w widoku GridView jest edytowalna](batch-updating-vb/_static/image13.gif)](batch-updating-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="b1a06-238">[![Each GridView Row is Editable](batch-updating-vb/_static/image13.gif)](batch-updating-vb/_static/image21.png)</span></span>

<span data-ttu-id="b1a06-239">**Rysunek 13**: każdego wiersza w widoku GridView jest edytowalna ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](batch-updating-vb/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="b1a06-239">**Figure 13**: Each GridView Row is Editable ([Click to view full-size image](batch-updating-vb/_static/image22.png))</span></span>


<span data-ttu-id="b1a06-240">Istnieje kilka drobne problemy formatowania, które powinien Dbamy o w tym momencie.</span><span class="sxs-lookup"><span data-stu-id="b1a06-240">There are a few minor formatting issues that we should take care of at this point.</span></span> <span data-ttu-id="b1a06-241">Najpierw należy pamiętać, że `UnitPrice` wartość zawiera cztery miejsc dziesiętnych.</span><span class="sxs-lookup"><span data-stu-id="b1a06-241">First, note that the `UnitPrice` value contains four decimal points.</span></span> <span data-ttu-id="b1a06-242">Aby rozwiązać ten problem, wróć do `UnitPrice` TemplateField s `ItemTemplate` i z tagów inteligentnych s pola tekstowego, kliknij łącze Edytuj powiązania danych.</span><span class="sxs-lookup"><span data-stu-id="b1a06-242">To fix this, return to the `UnitPrice` TemplateField s `ItemTemplate` and, from the TextBox s smart tag, click on the Edit DataBindings link.</span></span> <span data-ttu-id="b1a06-243">Następnie należy określić, że `Text` właściwości powinien być sformatowany jako liczby.</span><span class="sxs-lookup"><span data-stu-id="b1a06-243">Next, specify that the `Text` property should be formatted as a number.</span></span>


![Właściwość tekstu w formacie numeru](batch-updating-vb/_static/image14.gif)

<span data-ttu-id="b1a06-245">**Rysunek 14**: Format `Text` właściwości jako liczby</span><span class="sxs-lookup"><span data-stu-id="b1a06-245">**Figure 14**: Format the `Text` Property as a Number</span></span>


<span data-ttu-id="b1a06-246">Drugie let s Centrum checkbox w `Discontinued` kolumny (zamiast jego wyrównane do lewej).</span><span class="sxs-lookup"><span data-stu-id="b1a06-246">Second, let s center the checkbox in the `Discontinued` column (rather than having it left-aligned).</span></span> <span data-ttu-id="b1a06-247">Kliknij Edytuj kolumny w widoku GridView tag inteligentny s i wybierz pozycję `Discontinued` TemplateField z listy pól w lewym dolnym rogu.</span><span class="sxs-lookup"><span data-stu-id="b1a06-247">Click on Edit Columns from the GridView s smart tag and select the `Discontinued` TemplateField from the list of fields in the bottom left corner.</span></span> <span data-ttu-id="b1a06-248">Przejdź do szczegółów `ItemStyle` i ustaw `HorizontalAlign` właściwości Centrum, jak pokazano na rys. 15.</span><span class="sxs-lookup"><span data-stu-id="b1a06-248">Drill down into `ItemStyle` and set the `HorizontalAlign` property to Center as shown in Figure 15.</span></span>


![Centrum wycofane wyboru](batch-updating-vb/_static/image15.gif)

<span data-ttu-id="b1a06-250">**Rysunek 15**: Center `Discontinued` wyboru</span><span class="sxs-lookup"><span data-stu-id="b1a06-250">**Figure 15**: Center the `Discontinued` CheckBox</span></span>


<span data-ttu-id="b1a06-251">Następnie na stronie Dodaj formant ValidationSummary i ustawić jej `ShowMessageBox` właściwości `True` i jego `ShowSummary` właściwości `False`.</span><span class="sxs-lookup"><span data-stu-id="b1a06-251">Next, add a ValidationSummary control to the page and set its `ShowMessageBox` property to `True` and its `ShowSummary` property to `False`.</span></span> <span data-ttu-id="b1a06-252">Również dodać Web przycisk formantów, które, po kliknięciu, nastąpi aktualizacja zmiany s użytkownika.</span><span class="sxs-lookup"><span data-stu-id="b1a06-252">Also add the Button Web controls that, when clicked, will update the user s changes.</span></span> <span data-ttu-id="b1a06-253">W szczególności należy dodać dwóch formantów sieci Web przycisk jeden nad widoku GridView i jeden poniżej zarówno kontroluje `Text` właściwości do aktualizacji produktów.</span><span class="sxs-lookup"><span data-stu-id="b1a06-253">Specifically, add two Button Web controls, one above the GridView and one below it, setting both controls `Text` properties to Update Products .</span></span>

<span data-ttu-id="b1a06-254">Ponieważ GridView s edycji interfejsu jest zdefiniowany w jego TemplateFields `ItemTemplate` s, `EditItemTemplate` s są zbędny i mogą zostać usunięte.</span><span class="sxs-lookup"><span data-stu-id="b1a06-254">Since the GridView s editing interface is defined in its TemplateFields `ItemTemplate` s, the `EditItemTemplate` s are superfluous and may be deleted.</span></span>

<span data-ttu-id="b1a06-255">Po co powyższych wymienione zmiany formatowania, dodawanie kontrolek przycisków i usuwanie niepotrzebne `EditItemTemplate` s, składni deklaratywnej Twojej stronie s powinna wyglądać następująco:</span><span class="sxs-lookup"><span data-stu-id="b1a06-255">After making the above mentioned formatting changes, adding the Button controls, and removing the unnecessary `EditItemTemplate` s, your page s declarative syntax should look like the following:</span></span>


[!code-aspx[Main](batch-updating-vb/samples/sample4.aspx)]

<span data-ttu-id="b1a06-256">Rysunek 16 zawiera tę stronę, podczas wyświetlania za pośrednictwem przeglądarki, po dodaniu formantów sieci Web przycisk i formatowania zmian.</span><span class="sxs-lookup"><span data-stu-id="b1a06-256">Figure 16 shows this page when viewed through a browser after the Button Web controls have been added and the formatting changes made.</span></span>


<span data-ttu-id="b1a06-257">[![Teraz strony zawiera dwa przyciski produktów aktualizacji](batch-updating-vb/_static/image16.gif)](batch-updating-vb/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="b1a06-257">[![The Page Now Includes Two Update Products Buttons](batch-updating-vb/_static/image16.gif)](batch-updating-vb/_static/image23.png)</span></span>

<span data-ttu-id="b1a06-258">**Rysunek 16**: strona teraz obejmuje dwa aktualizacji produktów przyciski ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](batch-updating-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="b1a06-258">**Figure 16**: The Page Now Includes Two Update Products Buttons ([Click to view full-size image](batch-updating-vb/_static/image24.png))</span></span>


## <a name="step-5-updating-the-products"></a><span data-ttu-id="b1a06-259">Krok 5: Aktualizowanie produktów</span><span class="sxs-lookup"><span data-stu-id="b1a06-259">Step 5: Updating the Products</span></span>

<span data-ttu-id="b1a06-260">Gdy użytkownik odwiedzi tę stronę one będzie wprowadzić swoje zmiany, a następnie kliknij jeden z dwóch przycisków aktualizacji produktów.</span><span class="sxs-lookup"><span data-stu-id="b1a06-260">When a user visits this page they will make their modifications and then click one of the two Update Products buttons.</span></span> <span data-ttu-id="b1a06-261">W takiej sytuacji należy zapisać w jakiś sposób wprowadzonych przez użytkownika wartości dla każdego wiersza w `ProductsDataTable` wystąpienia, a następnie przekazać który metodę logiki warstwy Biznesowej, który następnie przekazuje `ProductsDataTable` wystąpienia s DAL `UpdateWithTransaction` metody.</span><span class="sxs-lookup"><span data-stu-id="b1a06-261">At that point we need to somehow save the user-entered values for each row into a `ProductsDataTable` instance and then pass that to a BLL method that will then pass that `ProductsDataTable` instance to the DAL s `UpdateWithTransaction` method.</span></span> <span data-ttu-id="b1a06-262">`UpdateWithTransaction` Metodę, która utworzyliśmy w [poprzedniego samouczek](wrapping-database-modifications-within-a-transaction-vb.md), zapewnia aktualizowanie partii zmiany jako operacją niepodzielną.</span><span class="sxs-lookup"><span data-stu-id="b1a06-262">The `UpdateWithTransaction` method, which we created in the [preceding tutorial](wrapping-database-modifications-within-a-transaction-vb.md), ensures that the batch of changes will be updated as an atomic operation.</span></span>

<span data-ttu-id="b1a06-263">Utwórz metodę o nazwie `BatchUpdate` w `BatchUpdate.aspx.vb` i Dodaj następujący kod:</span><span class="sxs-lookup"><span data-stu-id="b1a06-263">Create a method named `BatchUpdate` in `BatchUpdate.aspx.vb` and add the following code:</span></span>


[!code-vb[Main](batch-updating-vb/samples/sample5.vb)]

<span data-ttu-id="b1a06-264">Ta metoda rozpoczyna się od pobrania wszystkich produktów w `ProductsDataTable` rozmów na s logiki warstwy Biznesowej `GetProducts` metody.</span><span class="sxs-lookup"><span data-stu-id="b1a06-264">This method starts out by getting all of the products back in a `ProductsDataTable` via a call to the BLL s `GetProducts` method.</span></span> <span data-ttu-id="b1a06-265">Następnie wylicza `ProductGrid` GridView s [ `Rows` kolekcji](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.rows(VS.80).aspx).</span><span class="sxs-lookup"><span data-stu-id="b1a06-265">It then enumerates the `ProductGrid` GridView s [`Rows` collection](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.rows(VS.80).aspx).</span></span> <span data-ttu-id="b1a06-266">`Rows` Kolekcja zawiera [ `GridViewRow` wystąpienia](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridviewrow.aspx) dla każdego wiersza wyświetlany w widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="b1a06-266">The `Rows` collection contains a [`GridViewRow` instance](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridviewrow.aspx) for each row displayed in the GridView.</span></span> <span data-ttu-id="b1a06-267">Ponieważ firma Microsoft są wyświetlane maksymalnie dziesięciu wierszy na stronie, GridView s `Rows` kolekcji nie odniesie nie więcej niż dziesięć elementów.</span><span class="sxs-lookup"><span data-stu-id="b1a06-267">Since we are showing at most ten rows per page, the GridView s `Rows` collection will have no more than ten items.</span></span>

<span data-ttu-id="b1a06-268">Dla każdego wiersza `ProductID` jest pobierany z `DataKeys` kolekcji i odpowiednie `ProductsRow` wybrano `ProductsDataTable`.</span><span class="sxs-lookup"><span data-stu-id="b1a06-268">For each row the `ProductID` is grabbed from the `DataKeys` collection and the appropriate `ProductsRow` is selected from the `ProductsDataTable`.</span></span> <span data-ttu-id="b1a06-269">Programowo odwołuje się cztery kontrolki wejściowe TemplateField i ich wartości przypisane do `ProductsRow` wystąpienia właściwości s.</span><span class="sxs-lookup"><span data-stu-id="b1a06-269">The four TemplateField input controls are programmatically referenced and their values assigned to the `ProductsRow` instance s properties.</span></span> <span data-ttu-id="b1a06-270">Po każdym widoku GridView wartości wierszy s zostały już użyte do zaktualizowania `ProductsDataTable`, go s przekazany do s logiki warstwy Biznesowej `UpdateWithTransaction` metodę, która jako widzieliśmy w poprzednim samouczek, po prostu wywołuje w dół do DAL s `UpdateWithTransaction` metody.</span><span class="sxs-lookup"><span data-stu-id="b1a06-270">After each GridView row s values have been used to update the `ProductsDataTable`, it s passed to the BLL s `UpdateWithTransaction` method which, as we saw in the preceding tutorial, simply calls down into the DAL s `UpdateWithTransaction` method.</span></span>

<span data-ttu-id="b1a06-271">Algorytm aktualizacji partii używany na potrzeby tego samouczka aktualizuje każdego wiersza w `ProductsDataTable` odpowiadającej wiersza w widoku GridView, niezależnie od tego, czy zmieniono informacji o produkcie s.</span><span class="sxs-lookup"><span data-stu-id="b1a06-271">The batch update algorithm used for this tutorial updates each row in the `ProductsDataTable` that corresponds to a row in the GridView, regardless of whether the product s information has been changed.</span></span> <span data-ttu-id="b1a06-272">Gdy blind takie aktualizacje nie są zazwyczaj problem z wydajnością, może prowadzić do rekordów zbędny w przypadku której inspekcja zmiany do tabeli bazy danych.</span><span class="sxs-lookup"><span data-stu-id="b1a06-272">While such blind updates aren t usually a performance issue, they can lead to superfluous records if you re auditing changes to the database table.</span></span> <span data-ttu-id="b1a06-273">W [przeprowadzania aktualizacji wsadowych](../editing-and-deleting-data-through-the-datalist/performing-batch-updates-vb.md) samouczku będziemy przedstawione partii aktualizowania interfejsu za pomocą elementu DataList i dodaje kod, który zaktualizuje tylko te rekordy, które faktycznie zostały zmodyfikowane przez użytkownika.</span><span class="sxs-lookup"><span data-stu-id="b1a06-273">Back in the [Performing Batch Updates](../editing-and-deleting-data-through-the-datalist/performing-batch-updates-vb.md) tutorial we explored a batch updating interface with the DataList and added code that would only update those records that were actually modified by the user.</span></span> <span data-ttu-id="b1a06-274">Możesz korzystać z metod z [przeprowadzania aktualizacji wsadowych](../editing-and-deleting-data-through-the-datalist/performing-batch-updates-vb.md) można zaktualizować kodu w tym samouczku, w razie potrzeby.</span><span class="sxs-lookup"><span data-stu-id="b1a06-274">Feel free to use the techniques from [Performing Batch Updates](../editing-and-deleting-data-through-the-datalist/performing-batch-updates-vb.md) to update the code in this tutorial, if desired.</span></span>

> [!NOTE]
> <span data-ttu-id="b1a06-275">Podczas wiązania ze źródłem danych widoku GridView za pośrednictwem jego tagów inteligentnych, Visual Studio automatycznie przypisuje danych źródła s głównej wartości klucza do widoku GridView s `DataKeyNames` właściwości.</span><span class="sxs-lookup"><span data-stu-id="b1a06-275">When binding the data source to the GridView through its smart tag, Visual Studio automatically assigns the data source s primary key value(s) to the GridView s `DataKeyNames` property.</span></span> <span data-ttu-id="b1a06-276">Jeśli użytkownik nie został powiązany element ObjectDataSource do widoku GridView za pomocą tagów inteligentnych s GridView w sposób opisany w kroku 1, a następnie konieczne będzie ręczne ustawienie GridView s `DataKeyNames` ProductID w celu uzyskania dostępu do właściwości `ProductID` wartość dla każdego wiersza za pomocą `DataKeys` kolekcji.</span><span class="sxs-lookup"><span data-stu-id="b1a06-276">If you did not bind the ObjectDataSource to the GridView through the GridView s smart tag as outlined in Step 1, then you will need to manually set the GridView s `DataKeyNames` property to ProductID in order to access the `ProductID` value for each row through the `DataKeys` collection.</span></span>


<span data-ttu-id="b1a06-277">Kod używany w `BatchUpdate` przebiega podobnie jak w s logiki warstwy Biznesowej `UpdateProduct` metody, główną różnicą jest, że w `UpdateProduct` metody tylko jeden `ProductRow` wystąpienia są pobierane z architektury.</span><span class="sxs-lookup"><span data-stu-id="b1a06-277">The code used in `BatchUpdate` is similar to that used in the BLL s `UpdateProduct` methods, the main difference being that in the `UpdateProduct` methods only a single `ProductRow` instance is retrieved from the architecture.</span></span> <span data-ttu-id="b1a06-278">Kod, który przypisuje właściwości `ProductRow` jest taka sama między `UpdateProducts` metody i kod w `For Each` pętli w `BatchUpdate`, ponieważ jest ogólny model.</span><span class="sxs-lookup"><span data-stu-id="b1a06-278">The code that assigns the properties of the `ProductRow` is the same between the `UpdateProducts` methods and the code within the `For Each` loop in `BatchUpdate`, as is the overall pattern.</span></span>

<span data-ttu-id="b1a06-279">Do ukończenia tego samouczka, musimy mieć `BatchUpdate` metoda wywoływana, gdy jeden z przycisków produktów aktualizacji zostanie kliknięty.</span><span class="sxs-lookup"><span data-stu-id="b1a06-279">To complete this tutorial, we need to have the `BatchUpdate` method invoked when either of the Update Products buttons is clicked.</span></span> <span data-ttu-id="b1a06-280">Tworzenie obsługi zdarzeń dla `Click` zdarzenia tych dwóch przycisk i Dodaj następujący kod w obsłudze zdarzeń:</span><span class="sxs-lookup"><span data-stu-id="b1a06-280">Create event handlers for the `Click` events of these two Button controls and add the following code in the event handlers:</span></span>


[!code-vb[Main](batch-updating-vb/samples/sample6.vb)]

<span data-ttu-id="b1a06-281">Najpierw połączenie jest nawiązywane w przypadku `BatchUpdate`.</span><span class="sxs-lookup"><span data-stu-id="b1a06-281">First a call is made to `BatchUpdate`.</span></span> <span data-ttu-id="b1a06-282">Następnie [ `ClientScript` właściwości](https://msdn.microsoft.com/library/system.web.ui.page.clientscript(VS.80).aspx) służy do dodania JavaScript wyświetlające element messagebox odczytujący produkty zostały zaktualizowane.</span><span class="sxs-lookup"><span data-stu-id="b1a06-282">Next, the [`ClientScript` property](https://msdn.microsoft.com/library/system.web.ui.page.clientscript(VS.80).aspx) is used to inject JavaScript that will display a messagebox that reads The products have been updated.</span></span>

<span data-ttu-id="b1a06-283">Zabrać kilka minut, aby przetestować ten kod.</span><span class="sxs-lookup"><span data-stu-id="b1a06-283">Take a minute to test out this code.</span></span> <span data-ttu-id="b1a06-284">Odwiedź stronę `BatchUpdate.aspx` za pośrednictwem przeglądarki, Edytuj liczbę wierszy i kliknij jeden z przycisków aktualizacji produktów.</span><span class="sxs-lookup"><span data-stu-id="b1a06-284">Visit `BatchUpdate.aspx` through a browser, edit a number of rows, and click one of the Update Products buttons.</span></span> <span data-ttu-id="b1a06-285">Zakładając, że nie ma żadnych błędów sprawdzania poprawności danych wejściowych, powinien zostać wyświetlony element messagebox odczytujący się, że produkty zostały zaktualizowane.</span><span class="sxs-lookup"><span data-stu-id="b1a06-285">Assuming there are no input validation errors, you should see a messagebox that reads The products have been updated.</span></span> <span data-ttu-id="b1a06-286">Aby sprawdzić niepodzielność aktualizacji, należy rozważyć dodanie losowe `CHECK` ograniczenia, takie jak, który nie zezwala na `UnitPrice` wartości wartość 1234,56.</span><span class="sxs-lookup"><span data-stu-id="b1a06-286">To verify the atomicity of the update, consider adding a random `CHECK` constraint, like one that disallows `UnitPrice` values of 1234.56.</span></span> <span data-ttu-id="b1a06-287">Następnie z `BatchUpdate.aspx`, edytować wiele rekordów, upewniając się ustawić jeden produkt s `UnitPrice` niedozwolonych wartość (wartość 1234,56).</span><span class="sxs-lookup"><span data-stu-id="b1a06-287">Then from `BatchUpdate.aspx`, edit a number of records, making sure to set one of the product s `UnitPrice` value to the forbidden value ( 1234.56 ).</span></span> <span data-ttu-id="b1a06-288">Powinno to spowodować błąd po kliknięciu aktualizacji produktów z innych zmian podczas tej operacji zbiorczej z powrotem obniżyć do ich oryginalnych wartości.</span><span class="sxs-lookup"><span data-stu-id="b1a06-288">This should result in an error when clicking Update Products with the other changes during that batch operation rolled back to their original values.</span></span>

## <a name="an-alternativebatchupdatemethod"></a><span data-ttu-id="b1a06-289">Zamiast`BatchUpdate`— metoda</span><span class="sxs-lookup"><span data-stu-id="b1a06-289">An Alternative`BatchUpdate`Method</span></span>

<span data-ttu-id="b1a06-290">`BatchUpdate` Metody możemy just zbadane pobiera *wszystkie* produktów z s logiki warstwy Biznesowej `GetProducts` metody, a następnie aktualizuje tylko te rekordy, które są wyświetlane w widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="b1a06-290">The `BatchUpdate` method we just examined retrieves *all* of the products from the BLL s `GetProducts` method and then updates just those records that appear in the GridView.</span></span> <span data-ttu-id="b1a06-291">Takie podejście jest idealny w widoku GridView nie używa stronicowania, ale jeśli tak, może istnieć setki tysięcy i dziesiątki tysięcy produktów, ale tylko dziesięć wierszy w widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="b1a06-291">This approach is ideal if the GridView does not use paging, but if it does, there may be hundreds, thousands, or tens of thousands of products, but only ten rows in the GridView.</span></span> <span data-ttu-id="b1a06-292">W takim przypadku pobieranie wszystkich produktów z bazy danych tylko do modyfikowania 10 z nich jest mniejsza niż idealny.</span><span class="sxs-lookup"><span data-stu-id="b1a06-292">In such a case, getting all of the products from the database only to modify 10 of them is less than ideal.</span></span>

<span data-ttu-id="b1a06-293">Dla tych typów sytuacjach należy rozważyć użycie następujących `BatchUpdateAlternate` metody zamiast tego:</span><span class="sxs-lookup"><span data-stu-id="b1a06-293">For those types of situations, consider using the following `BatchUpdateAlternate` method instead:</span></span>


[!code-vb[Main](batch-updating-vb/samples/sample7.vb)]

<span data-ttu-id="b1a06-294">`BatchMethodAlternate` Uruchamia, tworząc nowe puste `ProductsDataTable` o nazwie `products`.</span><span class="sxs-lookup"><span data-stu-id="b1a06-294">`BatchMethodAlternate` starts by creating a new empty `ProductsDataTable` named `products`.</span></span> <span data-ttu-id="b1a06-295">Następnie kroki do widoku GridView s `Rows` kolekcji i dla każdego wiersza pobiera informacje o określonym produktem przy użyciu logiki warstwy Biznesowej s `GetProductByProductID(productID)` metody.</span><span class="sxs-lookup"><span data-stu-id="b1a06-295">It then steps through the GridView s `Rows` collection and for each row gets the particular product information using the BLL s `GetProductByProductID(productID)` method.</span></span> <span data-ttu-id="b1a06-296">Pobranej `ProductsRow` wystąpienie ma właściwości zaktualizowane w taki sam sposób jak `BatchUpdate`, ale po zaktualizowaniu wiersza jest importowany do `products` `ProductsDataTable` za pośrednictwem DataTable s [ `ImportRow(DataRow)` —Metoda](https://msdn.microsoft.com/library/system.data.datatable.importrow(VS.80).aspx).</span><span class="sxs-lookup"><span data-stu-id="b1a06-296">The retrieved `ProductsRow` instance has its properties updated in the same fashion as `BatchUpdate`, but after updating the row it is imported into the `products` `ProductsDataTable` via the DataTable s [`ImportRow(DataRow)` method](https://msdn.microsoft.com/library/system.data.datatable.importrow(VS.80).aspx).</span></span>

<span data-ttu-id="b1a06-297">Po `For Each` pętli zakończeniu `products` zawiera jeden `ProductsRow` wystąpienia dla każdego wiersza w widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="b1a06-297">After the `For Each` loop completes, `products` contains one `ProductsRow` instance for each row in the GridView.</span></span> <span data-ttu-id="b1a06-298">Ponieważ każdy z `ProductsRow` wystąpienia zostały dodane do `products` (zamiast aktualizacji), jeśli ślepo jest przekazywana do `UpdateWithTransaction` — metoda `ProductsTableAdatper` podejmie próbę wstawienia każdego rekordu do bazy danych.</span><span class="sxs-lookup"><span data-stu-id="b1a06-298">Since each of the `ProductsRow` instances have been added to the `products` (instead of updated), if we blindly pass it to the `UpdateWithTransaction` method the `ProductsTableAdatper` will try to insert each of the records into the database.</span></span> <span data-ttu-id="b1a06-299">Zamiast tego należy określić, że każdy z tych wierszy została zmodyfikowana (nie dodany).</span><span class="sxs-lookup"><span data-stu-id="b1a06-299">Instead, we need to specify that each of these rows has been modified (not added).</span></span>

<span data-ttu-id="b1a06-300">Można to osiągnąć przez dodanie nowej metody do logiki warstwy Biznesowej o nazwie `UpdateProductsWithTransaction`.</span><span class="sxs-lookup"><span data-stu-id="b1a06-300">This can be accomplished by adding a new method to the BLL named `UpdateProductsWithTransaction`.</span></span> <span data-ttu-id="b1a06-301">`UpdateProductsWithTransaction`, pokazano poniżej, ustawia `RowState` poszczególnych `ProductsRow` wystąpień w `ProductsDataTable` do `Modified` , a następnie przekazuje `ProductsDataTable` s DAL `UpdateWithTransaction` — metoda.</span><span class="sxs-lookup"><span data-stu-id="b1a06-301">`UpdateProductsWithTransaction`, shown below, sets the `RowState` of each of the `ProductsRow` instances in the `ProductsDataTable` to `Modified` and then passes the `ProductsDataTable` to the DAL s `UpdateWithTransaction` method.</span></span>


[!code-vb[Main](batch-updating-vb/samples/sample8.vb)]

## <a name="summary"></a><span data-ttu-id="b1a06-302">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="b1a06-302">Summary</span></span>

<span data-ttu-id="b1a06-303">Widoku GridView udostępnia funkcje edycji wiersza wbudowanych, ale nie ma obsługi tworzenia interfejsów pełni edytowalne.</span><span class="sxs-lookup"><span data-stu-id="b1a06-303">The GridView provides built-in per-row editing capabilities, but lacks support for creating fully editable interfaces.</span></span> <span data-ttu-id="b1a06-304">Jak widzieliśmy w tym samouczku interfejsy są możliwe, ale wymaga nieco pracy.</span><span class="sxs-lookup"><span data-stu-id="b1a06-304">As we saw in this tutorial, such interfaces are possible, but require a bit of work.</span></span> <span data-ttu-id="b1a06-305">Aby utworzyć element GridView, gdzie każdy wiersz jest edytowalny, musimy przekonwertować pola s GridView TemplateFields i zdefiniować edycji interfejs w ramach `ItemTemplate` s.</span><span class="sxs-lookup"><span data-stu-id="b1a06-305">To create a GridView where every row is editable, we need to convert the GridView s fields into TemplateFields and define the editing interface within the `ItemTemplate` s.</span></span> <span data-ttu-id="b1a06-306">Ponadto aktualizacji wszystkich — typ kontrolki przycisku w sieci Web musi zostać dodany do strony, niezależnie od widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="b1a06-306">Additionally, Update All -type Button Web controls must be added to the page, separate from the GridView.</span></span> <span data-ttu-id="b1a06-307">Tych przycisków `Click` procedury obsługi zdarzeń należy wyliczyć GridView s `Rows` kolekcji, zapisać zmiany w `ProductsDataTable`, a następnie przekaż zaktualizowane informacje do odpowiedniej metody logiki warstwy Biznesowej.</span><span class="sxs-lookup"><span data-stu-id="b1a06-307">These Buttons `Click` event handlers need to enumerate the GridView s `Rows` collection, store the changes in a `ProductsDataTable`, and pass the updated information into the appropriate BLL method.</span></span>

<span data-ttu-id="b1a06-308">W następnym samouczku przedstawiono będzie jak utworzyć interfejs usuwania partii.</span><span class="sxs-lookup"><span data-stu-id="b1a06-308">In the next tutorial we'll see how to create an interface for batch deleting.</span></span> <span data-ttu-id="b1a06-309">W szczególności każdego wiersza w widoku GridView będzie zawierać pola wyboru i zamiast Aktualizuj wszystkie — typ przycisków, firma Microsoft zapewnia przycisków usunąć zaznaczone wiersze.</span><span class="sxs-lookup"><span data-stu-id="b1a06-309">In particular, each GridView row will include a checkbox and instead of Update All -type buttons, we'll have Delete Selected Rows buttons.</span></span>

<span data-ttu-id="b1a06-310">Programowanie przyjemność!</span><span class="sxs-lookup"><span data-stu-id="b1a06-310">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="b1a06-311">Informacje o autorze</span><span class="sxs-lookup"><span data-stu-id="b1a06-311">About the Author</span></span>

<span data-ttu-id="b1a06-312">[Scott Bento](http://www.4guysfromrolla.com/ScottMitchell.shtml), autora siedmiu książek ASP/ASP.NET i twórcę z [4GuysFromRolla.com](http://www.4guysfromrolla.com), pracuje z technologii Microsoft Web od 1998.</span><span class="sxs-lookup"><span data-stu-id="b1a06-312">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="b1a06-313">Scott działa jako niezależnego konsultanta trainer i składnika zapisywania.</span><span class="sxs-lookup"><span data-stu-id="b1a06-313">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="b1a06-314">Jest jego najnowszej książki [ *Sams nauczyć się ASP.NET 2.0 w ciągu 24 godzin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="b1a06-314">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="b1a06-315">Piotr można uzyskać pod adresem [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) lub za pośrednictwem jego blog, który znajduje się w temacie [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="b1a06-315">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="b1a06-316">Specjalne podziękowania dla</span><span class="sxs-lookup"><span data-stu-id="b1a06-316">Special Thanks To</span></span>

<span data-ttu-id="b1a06-317">Ten samouczek serii zostało sprawdzone przez wiele recenzentów przydatne.</span><span class="sxs-lookup"><span data-stu-id="b1a06-317">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="b1a06-318">Prowadzić osób dokonujących przeglądu, w tym samouczku zostały Teresa Murphy i Suru Dominika.</span><span class="sxs-lookup"><span data-stu-id="b1a06-318">Lead reviewers for this tutorial were Teresa Murphy and David Suru.</span></span> <span data-ttu-id="b1a06-319">Zainteresowani recenzowania Moje nadchodzących artykuły MSDN?</span><span class="sxs-lookup"><span data-stu-id="b1a06-319">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="b1a06-320">Jeśli tak, Porzuć mnie linii w [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="b1a06-320">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="b1a06-321">[Poprzednie](wrapping-database-modifications-within-a-transaction-vb.md)
> [dalej](batch-deleting-vb.md)</span><span class="sxs-lookup"><span data-stu-id="b1a06-321">[Previous](wrapping-database-modifications-within-a-transaction-vb.md)
[Next](batch-deleting-vb.md)</span></span>
