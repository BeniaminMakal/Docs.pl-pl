---
uid: web-forms/overview/data-access/enhancing-the-gridview/inserting-a-new-record-from-the-gridview-s-footer-vb
title: Wstawianie nowego rekordu w widoku GridView stopki (VB) | Dokumentacja firmy Microsoft
author: rick-anderson
description: "Gdy kontrolki widoku siatki nie zapewnia wbudowaną obsługę dla Wstawianie nowego rekordu danych, w tym samouczku pokazano, jak rozszerzyć widoku GridView, aby uwzględnić..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 03/06/2007
ms.topic: article
ms.assetid: 528acc48-f20c-4b4e-aa16-4cc02f068ebb
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/enhancing-the-gridview/inserting-a-new-record-from-the-gridview-s-footer-vb
msc.type: authoredcontent
ms.openlocfilehash: 4d452e15ced52fd9dcac8201598146cb9ef38d7b
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 11/10/2017
---
<a name="inserting-a-new-record-from-the-gridviews-footer-vb"></a><span data-ttu-id="a00e2-103">Wstawianie nowego rekordu w widoku GridView stopki (VB)</span><span class="sxs-lookup"><span data-stu-id="a00e2-103">Inserting a New Record from the GridView's Footer (VB)</span></span>
====================
<span data-ttu-id="a00e2-104">przez [Bento Scott](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="a00e2-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="a00e2-105">[Pobierz przykładową aplikację](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_53_VB.exe) lub [pobierania plików PDF](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/datatutorial53vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="a00e2-105">[Download Sample App](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_53_VB.exe) or [Download PDF](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/datatutorial53vb1.pdf)</span></span>

> <span data-ttu-id="a00e2-106">Gdy kontrolki widoku siatki nie zapewnia wbudowaną obsługę dla Wstawianie nowego rekordu danych, w tym samouczku pokazano, jak rozszerzyć GridView uwzględnienie Wstawianie interfejsu.</span><span class="sxs-lookup"><span data-stu-id="a00e2-106">While the GridView control does not provide built-in support for inserting a new record of data, this tutorial shows how to augment the GridView to include an inserting interface.</span></span>


## <a name="introduction"></a><span data-ttu-id="a00e2-107">Wprowadzenie</span><span class="sxs-lookup"><span data-stu-id="a00e2-107">Introduction</span></span>

<span data-ttu-id="a00e2-108">Zgodnie z opisem w [omówienie Wstawianie, aktualizowanie i usuwanie danych](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) samouczek, dostępne kontrolki każdego widoku GridView widoku DetailsView i FormView Web funkcji modyfikacji danych wbudowanych.</span><span class="sxs-lookup"><span data-stu-id="a00e2-108">As discussed in the [An Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) tutorial, the GridView, DetailsView, and FormView Web controls each include built-in data modification capabilities.</span></span> <span data-ttu-id="a00e2-109">W przypadku użycia z kontrolki źródła dane deklaratywne, te trzy formantów sieci Web można szybko i łatwo skonfigurować do modyfikowania danych — w scenariuszach bez konieczności zapisu pojedynczy wiersz kodu.</span><span class="sxs-lookup"><span data-stu-id="a00e2-109">When used with declarative data source controls, these three Web controls can be quickly and easily configured to modify data - and in scenarios without needing to write a single line of code.</span></span> <span data-ttu-id="a00e2-110">Niestety tylko formanty widoku DetailsView i FormView Podaj wbudowanych Wstawianie, edytowanie i usuwanie funkcji.</span><span class="sxs-lookup"><span data-stu-id="a00e2-110">Unfortunately, only the DetailsView and FormView controls provide built-in inserting, editing, and deleting capabilities.</span></span> <span data-ttu-id="a00e2-111">Widoku GridView umożliwia tylko edytowanie i usuwanie pomocy technicznej.</span><span class="sxs-lookup"><span data-stu-id="a00e2-111">The GridView only offers editing and deleting support.</span></span> <span data-ttu-id="a00e2-112">Jednak nieco smarem kątowa, możemy rozszerzyć GridView uwzględnienie Wstawianie interfejsu.</span><span class="sxs-lookup"><span data-stu-id="a00e2-112">However, with a little elbow grease, we can augment the GridView to include an inserting interface.</span></span>

<span data-ttu-id="a00e2-113">W Dodawanie funkcji wstawianie do widoku GridView, firma Microsoft są zobowiązani do podejmowania decyzji, w jaki sposób nowe rekordy zostaną dodane, tworzenie Wstawianie interfejsu i pisanie kodu, aby wstawić nowy rekord.</span><span class="sxs-lookup"><span data-stu-id="a00e2-113">In adding inserting capabilities to the GridView, we are responsible for deciding on how new records will be added, creating the inserting interface, and writing the code to insert the new record.</span></span> <span data-ttu-id="a00e2-114">W tym samouczku przedstawiono dodawanie Wstawianie interfejsu do stopki s GridView wierszy (zobacz rysunek 1).</span><span class="sxs-lookup"><span data-stu-id="a00e2-114">In this tutorial we will look at adding the inserting interface to the GridView s footer row (see Figure 1).</span></span> <span data-ttu-id="a00e2-115">Komórka stopki dla każdej kolumny zawiera odpowiednie dane kolekcji elementu interfejsu użytkownika (pole tekstowe nazwy produktu s, DropDownList dla dostawcy i tak dalej).</span><span class="sxs-lookup"><span data-stu-id="a00e2-115">The footer cell for each column includes the appropriate data collection user interface element (a TextBox for the product s name, a DropDownList for the supplier, and so on).</span></span> <span data-ttu-id="a00e2-116">Potrzebujemy kolumny Dodaj przycisku, gdy kliknięto, będą powodować odświeżenie strony i wstawić nowy rekord w `Products` tabeli, używając wartości podane w wierszu stopki.</span><span class="sxs-lookup"><span data-stu-id="a00e2-116">We also need a column for an Add button that, when clicked, will cause a postback and insert a new record into the `Products` table using the values supplied in the footer row.</span></span>


<span data-ttu-id="a00e2-117">[![Wiersz stopki zawiera interfejs umożliwiający dodawanie nowych produktów](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image1.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="a00e2-117">[![The Footer Row Provides an Interface for Adding New Products](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image1.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image1.png)</span></span>

<span data-ttu-id="a00e2-118">**Rysunek 1**: wiersz stopki zawiera interfejs umożliwiający dodawanie nowych produktów ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="a00e2-118">**Figure 1**: The Footer Row Provides an Interface for Adding New Products ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image2.png))</span></span>


## <a name="step-1-displaying-product-information-in-a-gridview"></a><span data-ttu-id="a00e2-119">Krok 1: Wyświetlanie informacji o produkcie, w widoku GridView</span><span class="sxs-lookup"><span data-stu-id="a00e2-119">Step 1: Displaying Product Information in a GridView</span></span>

<span data-ttu-id="a00e2-120">Zanim firma Microsoft dotyczą nad z tworzeniem Wstawianie interfejsu w stopce s widoku GridView chętnie s pierwszy fokus na dodawanie widoku GridView do strony, która zawiera listę produktów w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="a00e2-120">Before we concern ourselves with creating the inserting interface in the GridView s footer, let s first focus on adding a GridView to the page that lists the products in the database.</span></span> <span data-ttu-id="a00e2-121">Uruchamianie przez otwarcie `InsertThroughFooter.aspx` strony `EnhancedGridView` folder i przeciągnij element GridView z przybornika do projektanta, ustawienie GridView s `ID` właściwości `Products`.</span><span class="sxs-lookup"><span data-stu-id="a00e2-121">Start by opening the `InsertThroughFooter.aspx` page in the `EnhancedGridView` folder and drag a GridView from the Toolbox onto the Designer, setting the GridView s `ID` property to `Products`.</span></span> <span data-ttu-id="a00e2-122">Następnie użyj tagów inteligentnych s GridView, aby powiązać go z nowego elementu ObjectDataSource o nazwie `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="a00e2-122">Next, use the GridView s smart tag to bind it to a new ObjectDataSource named `ProductsDataSource`.</span></span>


<span data-ttu-id="a00e2-123">[![Utwórz nowy element ObjectDataSource o nazwie ProductsDataSource](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image2.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="a00e2-123">[![Create a New ObjectDataSource Named ProductsDataSource](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image2.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image3.png)</span></span>

<span data-ttu-id="a00e2-124">**Rysunek 2**: Utwórz nowy składnik o nazwie ObjectDataSource `ProductsDataSource` ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="a00e2-124">**Figure 2**: Create a New ObjectDataSource Named `ProductsDataSource` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image4.png))</span></span>


<span data-ttu-id="a00e2-125">Element ObjectDataSource umożliwia konfigurowanie `ProductsBLL` klasy s `GetProducts()` metody do pobierania informacji o produkcie.</span><span class="sxs-lookup"><span data-stu-id="a00e2-125">Configure the ObjectDataSource to use the `ProductsBLL` class s `GetProducts()` method to retrieve product information.</span></span> <span data-ttu-id="a00e2-126">W tym samouczku pozwalają fokus s wyłącznie na dodawanie Wstawianie funkcji i nie martw się o edytowanie i usuwanie.</span><span class="sxs-lookup"><span data-stu-id="a00e2-126">For this tutorial, let s focus strictly on adding inserting capabilities and not worry about editing and deleting.</span></span> <span data-ttu-id="a00e2-127">W związku z tym, upewnij się, że listy rozwijanej na karcie Wstawianie jest ustawiona na `AddProduct()` i że list rozwijanych w kartach UPDATE i DELETE są ustawione na (Brak).</span><span class="sxs-lookup"><span data-stu-id="a00e2-127">Therefore, make sure that the drop-down list in the INSERT tab is set to `AddProduct()` and that the drop-down lists in the UPDATE and DELETE tabs are set to (None) .</span></span>


<span data-ttu-id="a00e2-128">[![Mapa metody AddProduct do metody operacji Insert() s ObjectDataSource](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image3.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="a00e2-128">[![Map the AddProduct Method to the ObjectDataSource s Insert() Method](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image3.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image5.png)</span></span>

<span data-ttu-id="a00e2-129">**Rysunek 3**: mapy `AddProduct` metodę ObjectDataSource s `Insert()` — metoda ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="a00e2-129">**Figure 3**: Map the `AddProduct` Method to the ObjectDataSource s `Insert()` Method ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image6.png))</span></span>


<span data-ttu-id="a00e2-130">[![Ustawianie list rozwijanych UPDATE i DELETE karty na (Brak)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image4.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="a00e2-130">[![Set the UPDATE and DELETE Tabs Drop-Down Lists to (None)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image4.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image7.png)</span></span>

<span data-ttu-id="a00e2-131">**Rysunek 4**: Ustaw aktualizacji i usuwania listy rozwijanej karty na (Brak) ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="a00e2-131">**Figure 4**: Set the UPDATE and DELETE Tabs Drop-Down Lists to (None) ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image8.png))</span></span>


<span data-ttu-id="a00e2-132">Po zakończeniu pracy kreatora skonfiguruj źródło danych s ObjectDataSource, Visual Studio spowoduje automatyczne dodanie pola do widoku GridView dla każdego z odpowiednich pól danych.</span><span class="sxs-lookup"><span data-stu-id="a00e2-132">After completing the ObjectDataSource s Configure Data Source wizard, Visual Studio will automatically add fields to the GridView for each of the corresponding data fields.</span></span> <span data-ttu-id="a00e2-133">Na razie pozostaw wszystkie pola dodane przez program Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="a00e2-133">For now, leave all of the fields added by Visual Studio.</span></span> <span data-ttu-id="a00e2-134">W dalszej części tego samouczka, firma Microsoft będzie wrócić i usunąć niektóre pola, których wartości ADAM t muszą być określone podczas dodawania nowego rekordu.</span><span class="sxs-lookup"><span data-stu-id="a00e2-134">Later in this tutorial we'll come back and remove some of the fields whose values don t need to be specified when adding a new record.</span></span>

<span data-ttu-id="a00e2-135">Ponieważ blisko 80 produktów w bazie danych, użytkownik będzie musiał przewiń w dół do dolnej części strony sieci web, aby dodać nowy rekord.</span><span class="sxs-lookup"><span data-stu-id="a00e2-135">Since there are close to 80 products in the database, a user will have to scroll all the way down to the bottom of the web page in order to add a new record.</span></span> <span data-ttu-id="a00e2-136">W związku z tym pozwolić, aby włączyć stronicowanie bardziej widoczne i dostępny Wstawianie interfejsu s.</span><span class="sxs-lookup"><span data-stu-id="a00e2-136">Therefore, let s enable paging to make the inserting interface more visible and accessible.</span></span> <span data-ttu-id="a00e2-137">Aby włączyć stronicowanie, po prostu zaznacz pole wyboru Włącz stronicowanie z tagów inteligentnych s widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="a00e2-137">To turn on paging, simply check the Enable Paging checkbox from the GridView s smart tag.</span></span>

<span data-ttu-id="a00e2-138">W tym momencie znaczników deklaratywne s GridView i ObjectDataSource powinien wyglądać podobnie do następującego:</span><span class="sxs-lookup"><span data-stu-id="a00e2-138">At this point, the GridView and ObjectDataSource s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample1.aspx)]


<span data-ttu-id="a00e2-139">[![Wszystkie pola danych produktu są wyświetlane w widoku GridView stronicowanej](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image5.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="a00e2-139">[![All Product Data Fields are Displayed in a Paged GridView](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image5.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image9.png)</span></span>

<span data-ttu-id="a00e2-140">**Rysunek 5**: wszystkie pola danych produktu są wyświetlane w widoku GridView stronicowanej ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="a00e2-140">**Figure 5**: All Product Data Fields are Displayed in a Paged GridView ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image10.png))</span></span>


## <a name="step-2-adding-a-footer-row"></a><span data-ttu-id="a00e2-141">Krok 2: Dodawanie wiersza stopki</span><span class="sxs-lookup"><span data-stu-id="a00e2-141">Step 2: Adding a Footer Row</span></span>

<span data-ttu-id="a00e2-142">Wraz z jego nagłówka i wiersze danych widoku GridView zawiera wiersz stopki.</span><span class="sxs-lookup"><span data-stu-id="a00e2-142">Along with its header and data rows, the GridView includes a footer row.</span></span> <span data-ttu-id="a00e2-143">Wiersze nagłówków i stopek są wyświetlane w zależności od wartości GridView s [ `ShowHeader` ](https://msdn.microsoft.com/en-gb/library/system.web.ui.webcontrols.gridview.showheader.aspx) i [ `ShowFooter` ](https://msdn.microsoft.com/en-gb/library/system.web.ui.webcontrols.gridview.showfooter.aspx) właściwości.</span><span class="sxs-lookup"><span data-stu-id="a00e2-143">The header and footer rows are displayed depending on the values of the GridView s [`ShowHeader`](https://msdn.microsoft.com/en-gb/library/system.web.ui.webcontrols.gridview.showheader.aspx) and [`ShowFooter`](https://msdn.microsoft.com/en-gb/library/system.web.ui.webcontrols.gridview.showfooter.aspx) properties.</span></span> <span data-ttu-id="a00e2-144">Aby wyświetlić wiersz stopki, po prostu ustaw `ShowFooter` właściwości `True`.</span><span class="sxs-lookup"><span data-stu-id="a00e2-144">To show the footer row, simply set the `ShowFooter` property to `True`.</span></span> <span data-ttu-id="a00e2-145">Jak pokazano w rysunek 6, ustawienie `ShowFooter` właściwości `True` dodaje stopki do siatki.</span><span class="sxs-lookup"><span data-stu-id="a00e2-145">As Figure 6 illustrates, setting the `ShowFooter` property to `True` adds a footer row to the grid.</span></span>


<span data-ttu-id="a00e2-146">[![Aby wyświetlić wiersz stopki, ustaw ShowFooter wartość True](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image6.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="a00e2-146">[![To Display the Footer Row, Set ShowFooter to True](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image6.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image11.png)</span></span>

<span data-ttu-id="a00e2-147">**Rysunek 6**: Ustaw wiersz stopki do wyświetlenia `ShowFooter` do `True` ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="a00e2-147">**Figure 6**: To Display the Footer Row, Set `ShowFooter` to `True` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image12.png))</span></span>


<span data-ttu-id="a00e2-148">Należy pamiętać, że wiersz stopki zawiera kolor tła red ciemny.</span><span class="sxs-lookup"><span data-stu-id="a00e2-148">Note that the footer row has a dark red background color.</span></span> <span data-ttu-id="a00e2-149">Jest to spowodowane motywu DataWebControls, możemy utworzyć i stosowane do wszystkich stron w [wyświetlanie danych z ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-vb.md) samouczka.</span><span class="sxs-lookup"><span data-stu-id="a00e2-149">This is due to the DataWebControls Theme we created and applied to all pages back in the [Displaying Data With the ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-vb.md) tutorial.</span></span> <span data-ttu-id="a00e2-150">W szczególności `GridView.skin` konfiguruje pliku `FooterStyle` właściwość takie używa `FooterStyle` klasę CSS.</span><span class="sxs-lookup"><span data-stu-id="a00e2-150">Specifically, the `GridView.skin` file configures the `FooterStyle` property such that is uses the `FooterStyle` CSS class.</span></span> <span data-ttu-id="a00e2-151">`FooterStyle` Klasa jest zdefiniowana w `Styles.css` w następujący sposób:</span><span class="sxs-lookup"><span data-stu-id="a00e2-151">The `FooterStyle` class is defined in `Styles.css` as follows:</span></span>


[!code-css[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample2.css)]

> [!NOTE]
> <span data-ttu-id="a00e2-152">Firma Microsoft kolejnych zbadane, korzystania z widoku GridView s stopki wiersza w poprzednim samouczki.</span><span class="sxs-lookup"><span data-stu-id="a00e2-152">We ve explored using the GridView s footer row in previous tutorials.</span></span> <span data-ttu-id="a00e2-153">Jeśli to konieczne, odwołaj się do [wyświetlanie informacji podsumowania w stopce w widoku GridView](../custom-formatting/displaying-summary-information-in-the-gridview-s-footer-vb.md) samouczka dla odświeżacz.</span><span class="sxs-lookup"><span data-stu-id="a00e2-153">If needed, refer back to the [Displaying Summary Information in the GridView's Footer](../custom-formatting/displaying-summary-information-in-the-gridview-s-footer-vb.md) tutorial for a refresher.</span></span>


<span data-ttu-id="a00e2-154">Po ustawieniu `ShowFooter` właściwości `True`, Poświęć chwilę, aby wyświetlić dane wyjściowe w przeglądarce.</span><span class="sxs-lookup"><span data-stu-id="a00e2-154">After setting the `ShowFooter` property to `True`, take a moment to view the output in a browser.</span></span> <span data-ttu-id="a00e2-155">Obecnie t wiersza stopki zawierać tekst i formantów sieci Web.</span><span class="sxs-lookup"><span data-stu-id="a00e2-155">Currently the footer row doesn t contain any text or Web controls.</span></span> <span data-ttu-id="a00e2-156">W kroku 3 Firma Microsoft będzie zmodyfikować stopkę dla każdego pola w widoku GridView co zawierają one odpowiedni interfejs Wstawianie.</span><span class="sxs-lookup"><span data-stu-id="a00e2-156">In Step 3 we'll modify the footer for each GridView field so that it includes the appropriate inserting interface.</span></span>


<span data-ttu-id="a00e2-157">[![Wiersz Pusta stopka jest wyświetlone powyżej stronicowania formantów interfejsu](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image7.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="a00e2-157">[![The Empty Footer Row is Displayed Above the Paging Interface Controls](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image7.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image13.png)</span></span>

<span data-ttu-id="a00e2-158">**Rysunek 7**: Stopka pusty wiersz jest wyświetlone powyżej stronicowania formantów interfejsu ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="a00e2-158">**Figure 7**: The Empty Footer Row is Displayed Above the Paging Interface Controls ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image14.png))</span></span>


## <a name="step-3-customizing-the-footer-row"></a><span data-ttu-id="a00e2-159">Krok 3: Dostosowywanie wiersz stopki</span><span class="sxs-lookup"><span data-stu-id="a00e2-159">Step 3: Customizing the Footer Row</span></span>

<span data-ttu-id="a00e2-160">W [przy użyciu TemplateFields w kontrolce GridView](../custom-formatting/using-templatefields-in-the-gridview-control-vb.md) samouczek widzieliśmy znacznie dostosowywania wyświetlania określonej kolumny widoku GridView przy użyciu TemplateFields (w przeciwieństwie BoundFields lub CheckBoxFields); w [ Dostosowywanie interfejsu modyfikacji danych](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) analizujemy przy użyciu TemplateFields do dostosowania interfejsu edycji w widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="a00e2-160">Back in the [Using TemplateFields in the GridView Control](../custom-formatting/using-templatefields-in-the-gridview-control-vb.md) tutorial we saw how to greatly customize the display of a particular GridView column using TemplateFields (as opposed to BoundFields or CheckBoxFields); in [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) we looked at using TemplateFields to customize the editing interface in a GridView.</span></span> <span data-ttu-id="a00e2-161">Odwołanie składa się z liczbą szablony definiuje kombinację znaczników, formantów sieci Web i składnia wiązania z danymi TemplateField używaną do pewnych typów wierszy.</span><span class="sxs-lookup"><span data-stu-id="a00e2-161">Recall that a TemplateField is composed of a number of templates that defines the mix of markup, Web controls, and databinding syntax used for certain types of rows.</span></span> <span data-ttu-id="a00e2-162">`ItemTemplate`, Na przykład Określa szablon używany do wierszy tylko do odczytu, podczas gdy `EditItemTemplate` definiuje szablonu można edytować wiersza.</span><span class="sxs-lookup"><span data-stu-id="a00e2-162">The `ItemTemplate`, for example, specifies the template used for read-only rows, while the `EditItemTemplate` defines the template for the editable row.</span></span>

<span data-ttu-id="a00e2-163">Wraz z programem `ItemTemplate` i `EditItemTemplate`, obejmuje także TemplateField `FooterTemplate` zawartości dla stopki wiersza, który określa.</span><span class="sxs-lookup"><span data-stu-id="a00e2-163">Along with the `ItemTemplate` and `EditItemTemplate`, the TemplateField also includes a `FooterTemplate` that specifies the content for the footer row.</span></span> <span data-ttu-id="a00e2-164">W związku z tym można dodawać formanty sieci Web wymagane dla każdego pola s Wstawianie interfejs do `FooterTemplate`.</span><span class="sxs-lookup"><span data-stu-id="a00e2-164">Therefore, we can add the Web controls needed for each field s inserting interface into the `FooterTemplate`.</span></span> <span data-ttu-id="a00e2-165">Aby rozpocząć, przekonwertować wszystkie pola w widoku GridView TemplateFields.</span><span class="sxs-lookup"><span data-stu-id="a00e2-165">To start, convert all of the fields in the GridView to TemplateFields.</span></span> <span data-ttu-id="a00e2-166">Można to zrobić kliknięcie łącza Edytuj kolumny w widoku GridView s tagu, wybierając każdego pola w lewym dolnym rogu i kliknięcie przycisku Konwertuj to pole na pole TemplateField łącze.</span><span class="sxs-lookup"><span data-stu-id="a00e2-166">This can be done by clicking the Edit Columns link in the GridView s smart tag, selecting each field in the lower left corner, and clicking the Convert this field into a TemplateField link.</span></span>


![Konwertuj każde pole na pole TemplateField](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image8.gif)

<span data-ttu-id="a00e2-168">**Rysunek 8**: konwertowanie każde pole na pole TemplateField</span><span class="sxs-lookup"><span data-stu-id="a00e2-168">**Figure 8**: Convert Each Field Into a TemplateField</span></span>


<span data-ttu-id="a00e2-169">Kliknięcie przycisku Konwertuj to pole na pole TemplateField włącza bieżącego typu pola w TemplateField równoważne.</span><span class="sxs-lookup"><span data-stu-id="a00e2-169">Clicking the Convert this field into a TemplateField turns the current field type into an equivalent TemplateField.</span></span> <span data-ttu-id="a00e2-170">Na przykład każdego elementu BoundField zastępuje TemplateField z `ItemTemplate` zawiera etykietę, która zawiera odpowiednie pole danych i `EditItemTemplate` który wyświetla pole danych w polu tekstowym.</span><span class="sxs-lookup"><span data-stu-id="a00e2-170">For example, each BoundField is replaced by a TemplateField with an `ItemTemplate` that contains a Label that displays the corresponding data field and an `EditItemTemplate` that displays the data field in a TextBox.</span></span> <span data-ttu-id="a00e2-171">`ProductName` Elementu BoundField został przekonwertowany na następujący kod znaczników TemplateField:</span><span class="sxs-lookup"><span data-stu-id="a00e2-171">The `ProductName` BoundField has been converted into the following TemplateField markup:</span></span>


[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample3.aspx)]

<span data-ttu-id="a00e2-172">Podobnie `Discontinued` CheckBoxField został przekonwertowany na pole TemplateField którego `ItemTemplate` i `EditItemTemplate` zawierać formant wyboru sieci Web (o `ItemTemplate` s wyłączone pole wyboru).</span><span class="sxs-lookup"><span data-stu-id="a00e2-172">Likewise, the `Discontinued` CheckBoxField has been converted into a TemplateField whose `ItemTemplate` and `EditItemTemplate` contain a CheckBox Web control (with the `ItemTemplate` s CheckBox disabled).</span></span> <span data-ttu-id="a00e2-173">Tylko do odczytu `ProductID` elementu BoundField został przekonwertowany na pole TemplateField za pomocą formantu etykiety w obu `ItemTemplate` i `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="a00e2-173">The read-only `ProductID` BoundField has been converted into a TemplateField with a Label control in both the `ItemTemplate` and `EditItemTemplate`.</span></span> <span data-ttu-id="a00e2-174">Krótko mówiąc pole na pole TemplateField Konwertowanie istniejącego widoku GridView jest szybki i łatwy sposób przełączyć się do więcej można dostosowywać TemplateField bez utraty istniejących funkcjonalności pola s.</span><span class="sxs-lookup"><span data-stu-id="a00e2-174">In short, converting an existing GridView field into a TemplateField is a quick and easy way to switch to the more customizable TemplateField without losing any of the existing field s functionality.</span></span>

<span data-ttu-id="a00e2-175">Ponieważ w widoku GridView możemy odnośnie do pracy z edycji Obsługa t możesz usunąć `EditItemTemplate` z każdym TemplateField, pozostawiając tylko `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="a00e2-175">Since the GridView we re working with doesn t support editing, feel free to remove the `EditItemTemplate` from each TemplateField, leaving just the `ItemTemplate`.</span></span> <span data-ttu-id="a00e2-176">Po wykonaniu tej czynności deklaratywne GridView znaczników w s powinna wyglądać następująco:</span><span class="sxs-lookup"><span data-stu-id="a00e2-176">After doing this, your GridView s declarative markup should look like the following:</span></span>


[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample4.aspx)]

<span data-ttu-id="a00e2-177">Teraz, gdy każdego pola w widoku GridView został przekonwertowany na pole TemplateField, możemy wprowadź odpowiedni interfejs wstawianie do każdego pola s `FooterTemplate`.</span><span class="sxs-lookup"><span data-stu-id="a00e2-177">Now that each GridView field has been converted into a TemplateField, we can enter the appropriate inserting interface into each field s `FooterTemplate`.</span></span> <span data-ttu-id="a00e2-178">Niektóre pola nie zostaną Wstawianie interfejsu (`ProductID`, na przykład); inne osoby będą się różnić w formantach sieci Web, używane do zbierania informacji o produkcie s nowe.</span><span class="sxs-lookup"><span data-stu-id="a00e2-178">Some of the fields will not have an inserting interface (`ProductID`, for instance); others will vary in the Web controls used to collect the new product s information.</span></span>

<span data-ttu-id="a00e2-179">Aby utworzyć interfejs edytowania, wybierz link Edytuj szablony z tagów inteligentnych s widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="a00e2-179">To create the editing interface, choose the Edit Templates link from the GridView s smart tag.</span></span> <span data-ttu-id="a00e2-180">Z listy rozwijanej wybierz odpowiednie pole s `FooterTemplate` i przeciągnij odpowiednie formant z przybornika do projektanta.</span><span class="sxs-lookup"><span data-stu-id="a00e2-180">Then, from the drop-down list, select the appropriate field s `FooterTemplate` and drag the appropriate control from the Toolbox onto the Designer.</span></span>


<span data-ttu-id="a00e2-181">[![Dodaj odpowiedni interfejs wstawianie do elementu FooterTemplate każdego pola s](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image9.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="a00e2-181">[![Add the Appropriate Inserting Interface to Each Field s FooterTemplate](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image9.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image15.png)</span></span>

<span data-ttu-id="a00e2-182">**Rysunek 9**: dodać odpowiedni interfejs wstawianie do każdego pola s `FooterTemplate` ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="a00e2-182">**Figure 9**: Add the Appropriate Inserting Interface to Each Field s `FooterTemplate` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image16.png))</span></span>


<span data-ttu-id="a00e2-183">Poniższa lista punktowana wylicza pola widoku GridView Określanie Wstawianie interfejsu do dodania:</span><span class="sxs-lookup"><span data-stu-id="a00e2-183">The following bulleted list enumerates the GridView fields, specifying the inserting interface to add:</span></span>

- <span data-ttu-id="a00e2-184">`ProductID`Brak.</span><span class="sxs-lookup"><span data-stu-id="a00e2-184">`ProductID` none.</span></span>
- <span data-ttu-id="a00e2-185">`ProductName`Dodaj pole tekstowe i ustaw jego `ID` do `NewProductName`.</span><span class="sxs-lookup"><span data-stu-id="a00e2-185">`ProductName` add a TextBox and set its `ID` to `NewProductName`.</span></span> <span data-ttu-id="a00e2-186">Dodawanie formantu RequiredFieldValidator również, aby upewnić się, że użytkownik wprowadza wartość dla nowej nazwy produktu s.</span><span class="sxs-lookup"><span data-stu-id="a00e2-186">Add a RequiredFieldValidator control as well to ensure that the user enters a value for the new product s name.</span></span>
- <span data-ttu-id="a00e2-187">`SupplierID`Brak.</span><span class="sxs-lookup"><span data-stu-id="a00e2-187">`SupplierID` none.</span></span>
- <span data-ttu-id="a00e2-188">`CategoryID`Brak.</span><span class="sxs-lookup"><span data-stu-id="a00e2-188">`CategoryID` none.</span></span>
- <span data-ttu-id="a00e2-189">`QuantityPerUnit`Dodaj pole tekstowe, ustawienie jej `ID` do `NewQuantityPerUnit`.</span><span class="sxs-lookup"><span data-stu-id="a00e2-189">`QuantityPerUnit` add a TextBox, setting its `ID` to `NewQuantityPerUnit`.</span></span>
- <span data-ttu-id="a00e2-190">`UnitPrice`Dodaj pole tekstowe o nazwie `NewUnitPrice` i CompareValidator, które powodują wprowadzona wartość jest większa lub równa zero wartości waluty.</span><span class="sxs-lookup"><span data-stu-id="a00e2-190">`UnitPrice` add a TextBox named `NewUnitPrice` and a CompareValidator that ensures the value entered is a currency value greater than or equal to zero.</span></span>
- <span data-ttu-id="a00e2-191">`UnitsInStock`Zastosuj pole tekstowe, którego `ID` ma ustawioną wartość `NewUnitsInStock`.</span><span class="sxs-lookup"><span data-stu-id="a00e2-191">`UnitsInStock` use a TextBox whose `ID` is set to `NewUnitsInStock`.</span></span> <span data-ttu-id="a00e2-192">Obejmują CompareValidator, który zapewnia, że wprowadzona wartość jest wartość całkowita większa lub równa zero.</span><span class="sxs-lookup"><span data-stu-id="a00e2-192">Include a CompareValidator that ensures that the value entered is an integer value greater than or equal to zero.</span></span>
- <span data-ttu-id="a00e2-193">`UnitsOnOrder`Zastosuj pole tekstowe, którego `ID` ma ustawioną wartość `NewUnitsOnOrder`.</span><span class="sxs-lookup"><span data-stu-id="a00e2-193">`UnitsOnOrder` use a TextBox whose `ID` is set to `NewUnitsOnOrder`.</span></span> <span data-ttu-id="a00e2-194">Obejmują CompareValidator, który zapewnia, że wprowadzona wartość jest wartość całkowita większa lub równa zero.</span><span class="sxs-lookup"><span data-stu-id="a00e2-194">Include a CompareValidator that ensures that the value entered is an integer value greater than or equal to zero.</span></span>
- <span data-ttu-id="a00e2-195">`ReorderLevel`Zastosuj pole tekstowe, którego `ID` ma ustawioną wartość `NewReorderLevel`.</span><span class="sxs-lookup"><span data-stu-id="a00e2-195">`ReorderLevel` use a TextBox whose `ID` is set to `NewReorderLevel`.</span></span> <span data-ttu-id="a00e2-196">Obejmują CompareValidator, który zapewnia, że wprowadzona wartość jest wartość całkowita większa lub równa zero.</span><span class="sxs-lookup"><span data-stu-id="a00e2-196">Include a CompareValidator that ensures that the value entered is an integer value greater than or equal to zero.</span></span>
- <span data-ttu-id="a00e2-197">`Discontinued`pola wyboru, ustawienie jej `ID` do `NewDiscontinued`.</span><span class="sxs-lookup"><span data-stu-id="a00e2-197">`Discontinued` add a CheckBox, setting its `ID` to `NewDiscontinued`.</span></span>
- <span data-ttu-id="a00e2-198">`CategoryName`Dodaj DropDownList i ustaw jej `ID` do `NewCategoryID`.</span><span class="sxs-lookup"><span data-stu-id="a00e2-198">`CategoryName` add a DropDownList and set its `ID` to `NewCategoryID`.</span></span> <span data-ttu-id="a00e2-199">Powiązać go z nowego elementu ObjectDataSource o nazwie `CategoriesDataSource` i skonfigurować go do używania `CategoriesBLL` klasy s `GetCategories()` metody.</span><span class="sxs-lookup"><span data-stu-id="a00e2-199">Bind it to a new ObjectDataSource named `CategoriesDataSource` and configure it to use the `CategoriesBLL` class s `GetCategories()` method.</span></span> <span data-ttu-id="a00e2-200">Ma DropDownList s `ListItem` wyświetlania s `CategoryName` danych pola `CategoryID` pola danych jako ich wartości.</span><span class="sxs-lookup"><span data-stu-id="a00e2-200">Have the DropDownList s `ListItem` s display the `CategoryName` data field, using the `CategoryID` data field as their values.</span></span>
- <span data-ttu-id="a00e2-201">`SupplierName`Dodaj DropDownList i ustaw jej `ID` do `NewSupplierID`.</span><span class="sxs-lookup"><span data-stu-id="a00e2-201">`SupplierName` add a DropDownList and set its `ID` to `NewSupplierID`.</span></span> <span data-ttu-id="a00e2-202">Powiązać go z nowego elementu ObjectDataSource o nazwie `SuppliersDataSource` i skonfigurować go do używania `SuppliersBLL` klasy s `GetSuppliers()` metody.</span><span class="sxs-lookup"><span data-stu-id="a00e2-202">Bind it to a new ObjectDataSource named `SuppliersDataSource` and configure it to use the `SuppliersBLL` class s `GetSuppliers()` method.</span></span> <span data-ttu-id="a00e2-203">Ma DropDownList s `ListItem` wyświetlania s `CompanyName` danych pola `SupplierID` pola danych jako ich wartości.</span><span class="sxs-lookup"><span data-stu-id="a00e2-203">Have the DropDownList s `ListItem` s display the `CompanyName` data field, using the `SupplierID` data field as their values.</span></span>

<span data-ttu-id="a00e2-204">Dla każdego z formanty walidacji wyczyszczenie `ForeColor` właściwości, aby `FooterStyle` kolor biały klasy s CSS będzie używany zamiast domyślnego czerwony.</span><span class="sxs-lookup"><span data-stu-id="a00e2-204">For each of the validation controls, clear out the `ForeColor` property so that the `FooterStyle` CSS class s white foreground color will be used in place of the default red.</span></span> <span data-ttu-id="a00e2-205">Również użyć `ErrorMessage` właściwość szczegółowy opis, ale wartość `Text` właściwości gwiazdkę.</span><span class="sxs-lookup"><span data-stu-id="a00e2-205">Also use the `ErrorMessage` property for a detailed description, but set the `Text` property to an asterisk.</span></span> <span data-ttu-id="a00e2-206">Aby zapobiec tekst formantu s sprawdzania poprawności spowodował Wstawianie interfejsu, który ma być zawijany do dwóch wierszy, ustaw `FooterStyle` s `Wrap` właściwości na wartość false dla każdego `FooterTemplate` s, który formant sprawdzania poprawności.</span><span class="sxs-lookup"><span data-stu-id="a00e2-206">To prevent the validation control s text from causing the inserting interface to wrap to two lines, set the `FooterStyle` s `Wrap` property to false for each of the `FooterTemplate` s that use a validation control.</span></span> <span data-ttu-id="a00e2-207">Na koniec Dodaj formant ValidationSummary poniżej widoku GridView i ustaw jej `ShowMessageBox` właściwości `True` i jego `ShowSummary` właściwości `False`.</span><span class="sxs-lookup"><span data-stu-id="a00e2-207">Finally, add a ValidationSummary control beneath the GridView and set its `ShowMessageBox` property to `True` and its `ShowSummary` property to `False`.</span></span>

<span data-ttu-id="a00e2-208">Podczas dodawania nowego produktu, należy podać `CategoryID` i `SupplierID`.</span><span class="sxs-lookup"><span data-stu-id="a00e2-208">When adding a new product, we need to provide the `CategoryID` and `SupplierID`.</span></span> <span data-ttu-id="a00e2-209">Te informacje są przechwytywane przez DropDownLists w komórkach stopkę dla `CategoryName` i `SupplierName` pól.</span><span class="sxs-lookup"><span data-stu-id="a00e2-209">This information is captured through the DropDownLists in the footer cells for the `CategoryName` and `SupplierName` fields.</span></span> <span data-ttu-id="a00e2-210">Został wybrany do użycia tych pól, w przeciwieństwie do `CategoryID` i `SupplierID` TemplateFields, ponieważ w siatce s wiersze danych, użytkownik jest prawdopodobnie bardziej interesują wyświetlanie nazwy kategorii i dostawcy, a nie ich wartości Identyfikatora.</span><span class="sxs-lookup"><span data-stu-id="a00e2-210">I chose to use these fields as opposed to the `CategoryID` and `SupplierID` TemplateFields because in the grid s data rows the user is likely more interested in seeing the category and supplier names rather than their ID values.</span></span> <span data-ttu-id="a00e2-211">Ponieważ `CategoryID` i `SupplierID` teraz przechwytywanych wartości w `CategoryName` i `SupplierName` pola s Wstawianie interfejsów usunąć `CategoryID` i `SupplierID` TemplateFields z widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="a00e2-211">Since the `CategoryID` and `SupplierID` values are now being captured in the `CategoryName` and `SupplierName` field s inserting interfaces, we can remove the `CategoryID` and `SupplierID` TemplateFields from the GridView.</span></span>

<span data-ttu-id="a00e2-212">Podobnie `ProductID` nie jest używany podczas dodawania nowego produktu, więc `ProductID` TemplateField można również usunąć.</span><span class="sxs-lookup"><span data-stu-id="a00e2-212">Similarly, the `ProductID` is not used when adding a new product, so the `ProductID` TemplateField can be removed as well.</span></span> <span data-ttu-id="a00e2-213">Jednak umożliwia s pozostaw `ProductID` w siatce.</span><span class="sxs-lookup"><span data-stu-id="a00e2-213">However, let s leave the `ProductID` field in the grid.</span></span> <span data-ttu-id="a00e2-214">Oprócz pól tekstowych, DropDownLists, pola wyboru i formanty walidacji, wchodzące w skład Wstawianie interfejsu, poprosimy Cię o również Dodawanie przycisku, po kliknięciu wykonuje logiki można dodać nowego produktu do bazy danych.</span><span class="sxs-lookup"><span data-stu-id="a00e2-214">In addition to the TextBoxes, DropDownLists, CheckBoxes, and validation controls that make up the inserting interface, we'll also need an Add button that, when clicked, performs the logic to add the new product to the database.</span></span> <span data-ttu-id="a00e2-215">W kroku 4 możemy obejmują przycisk Dodaj w interfejsie wstawianie `ProductID` TemplateField s `FooterTemplate`.</span><span class="sxs-lookup"><span data-stu-id="a00e2-215">In Step 4 we'll include an Add button in the inserting interface in the `ProductID` TemplateField s `FooterTemplate`.</span></span>

<span data-ttu-id="a00e2-216">Możesz także poprawić wygląd pola widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="a00e2-216">Feel free to improve the appearance of the various GridView fields.</span></span> <span data-ttu-id="a00e2-217">Na przykład możesz chcieć formatu `UnitPrice` wartości waluty, wyrównanie do prawej `UnitsInStock`, `UnitsOnOrder`, i `ReorderLevel` pól i aktualizacji `HeaderText` wartości TemplateFields.</span><span class="sxs-lookup"><span data-stu-id="a00e2-217">For example, you might want to format the `UnitPrice` values as a currency, right-align the `UnitsInStock`, `UnitsOnOrder`, and `ReorderLevel` fields, and update the `HeaderText` values for the TemplateFields.</span></span>

<span data-ttu-id="a00e2-218">Po utworzeniu slew wstawiania interfejsy `FooterTemplate` s, usuwanie `SupplierID`, i `CategoryID` TemplateFields i poprawia estetykę siatki za pośrednictwem formatowanie i wyrównywanie TemplateFields Twojego deklaratywne s widoku GridView Kod znaczników powinien wyglądać podobnie do następującego:</span><span class="sxs-lookup"><span data-stu-id="a00e2-218">After creating the slew of inserting interfaces in the `FooterTemplate` s, removing the `SupplierID`, and `CategoryID` TemplateFields, and improving the aesthetics of the grid through formatting and aligning the TemplateFields, your GridView s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample5.aspx)]

<span data-ttu-id="a00e2-219">Podczas wyświetlania za pośrednictwem przeglądarki, wiersz stopki s GridView zawiera teraz ukończonej Wstawianie interfejsu (zobacz rysunek 10).</span><span class="sxs-lookup"><span data-stu-id="a00e2-219">When viewed through a browser, the GridView s footer row now includes the completed inserting interface (see Figure 10).</span></span> <span data-ttu-id="a00e2-220">W tym momencie Wstawianie t interfejsu obejmują oznacza dla użytkownika wskazać, że s tych wprowadzonych danych dotyczących nowego produktu i chce wstawić nowy rekord w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="a00e2-220">At this point, the inserting interface doesn t include a means for the user to indicate that she s entered the data for the new product and wants to insert a new record into the database.</span></span> <span data-ttu-id="a00e2-221">Ponadto firma Microsoft Przenieś jeszcze do rozwiązania, jak dane wprowadzane w stopce przekształci się na nowy rekord w `Products` bazy danych.</span><span class="sxs-lookup"><span data-stu-id="a00e2-221">Also, we ve yet to address how the data entered into the footer will translate into a new record in the `Products` database.</span></span> <span data-ttu-id="a00e2-222">W kroku 4 wyjaśniono sposób obejmują przycisk Dodaj, aby Wstawianie interfejsu i wykonanie kodu na ogłaszanie, gdy jego s kliknięty.</span><span class="sxs-lookup"><span data-stu-id="a00e2-222">In Step 4 we'll look at how to include an Add button to the inserting interface and how to execute code on postback when it s clicked.</span></span> <span data-ttu-id="a00e2-223">Krok 5 pokazano, jak wstawić nowy rekord przy użyciu danych z stopki.</span><span class="sxs-lookup"><span data-stu-id="a00e2-223">Step 5 shows how to insert a new record using the data from the footer.</span></span>


<span data-ttu-id="a00e2-224">[![Stopka GridView udostępnia interfejs dla dodawania nowego rekordu](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image10.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="a00e2-224">[![The GridView Footer Provides an Interface for Adding a New Record](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image10.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image17.png)</span></span>

<span data-ttu-id="a00e2-225">**Na rysunku nr 10**: Stopka GridView udostępnia interfejs dla dodawania nowego rekordu ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="a00e2-225">**Figure 10**: The GridView Footer Provides an Interface for Adding a New Record ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image18.png))</span></span>


## <a name="step-4-including-an-add-button-in-the-inserting-interface"></a><span data-ttu-id="a00e2-226">Krok 4: W tym przycisk Dodaj w interfejsie Wstawianie</span><span class="sxs-lookup"><span data-stu-id="a00e2-226">Step 4: Including an Add Button in the Inserting Interface</span></span>

<span data-ttu-id="a00e2-227">Musimy dołączyć przycisku Dodaj gdzieś w interfejsie Wstawianie ponieważ s wiersza stopki Wstawianie interfejsu obecnie nie ma oznacza, że dla użytkownika wskazać, że zakończyły się wprowadzania nowych informacji o produkcie s.</span><span class="sxs-lookup"><span data-stu-id="a00e2-227">We need to include an Add button somewhere in the inserting interface since the footer row s inserting interface currently lacks the means for the user to indicate that they have completed entering the new product s information.</span></span> <span data-ttu-id="a00e2-228">Może to być umieszczone w jeden z istniejących `FooterTemplate` s lub możemy można dodać nowej kolumny do tabeli w tym celu.</span><span class="sxs-lookup"><span data-stu-id="a00e2-228">This could be placed in one of the existing `FooterTemplate` s or we could add a new column to the grid for this purpose.</span></span> <span data-ttu-id="a00e2-229">W tym samouczku let s umieścić przycisk Dodaj w `ProductID` TemplateField s `FooterTemplate`.</span><span class="sxs-lookup"><span data-stu-id="a00e2-229">For this tutorial, let s place the Add button in the `ProductID` TemplateField s `FooterTemplate`.</span></span>

<span data-ttu-id="a00e2-230">Przy użyciu projektanta, kliknij łącze Edytuj szablony w widoku GridView tag inteligentny s, a następnie wybierz pozycję `ProductID` pola s `FooterTemplate` z listy rozwijanej.</span><span class="sxs-lookup"><span data-stu-id="a00e2-230">From the Designer, click on the Edit Templates link in the GridView s smart tag and then choose the `ProductID` field s `FooterTemplate` from the drop-down list.</span></span> <span data-ttu-id="a00e2-231">Dodawanie formantu przycisku sieci Web (lub LinkButton lub ImageButton, jeśli wolisz) do szablonu, ustawienie jej identyfikator na `AddProduct`, jego `CommandName` do wstawienia, a jego `Text` właściwość do dodania, jak pokazano na rysunku nr 11.</span><span class="sxs-lookup"><span data-stu-id="a00e2-231">Add a Button Web control (or a LinkButton or ImageButton, if you prefer) to the template, setting its ID to `AddProduct`, its `CommandName` to Insert, and its `Text` property to Add as shown in Figure 11.</span></span>


<span data-ttu-id="a00e2-232">[![Umieść przycisk Dodaj w elementu FooterTemplate s ProductID TemplateField](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image11.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="a00e2-232">[![Place the Add Button in the ProductID TemplateField s FooterTemplate](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image11.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image19.png)</span></span>

<span data-ttu-id="a00e2-233">**Rysunek 11**: umieść przycisk Dodaj w `ProductID` TemplateField s `FooterTemplate` ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="a00e2-233">**Figure 11**: Place the Add Button in the `ProductID` TemplateField s `FooterTemplate` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image20.png))</span></span>


<span data-ttu-id="a00e2-234">Gdy był dołączony przycisk Dodaj, należy przetestować strony w przeglądarce.</span><span class="sxs-lookup"><span data-stu-id="a00e2-234">Once you ve included the Add button, test out the page in a browser.</span></span> <span data-ttu-id="a00e2-235">Należy pamiętać, że po kliknięciu przycisku Dodaj z nieprawidłowe dane w interfejsie Wstawianie ogłaszania zwrotnego jest krótko circuited oraz formant ValidationSummary wskazuje nieprawidłowe dane (patrz rysunek 12).</span><span class="sxs-lookup"><span data-stu-id="a00e2-235">Note that when clicking the Add button with invalid data in the inserting interface, the postback is short circuited and the ValidationSummary control indicates the invalid data (see Figure 12).</span></span> <span data-ttu-id="a00e2-236">Z odpowiednią wprowadzone dane klikając przycisk Dodaj powoduje odświeżenie strony.</span><span class="sxs-lookup"><span data-stu-id="a00e2-236">With appropriate data entered, clicking the Add button causes a postback.</span></span> <span data-ttu-id="a00e2-237">Żaden rekord jest jednak dodane do bazy danych.</span><span class="sxs-lookup"><span data-stu-id="a00e2-237">No record is added to the database, however.</span></span> <span data-ttu-id="a00e2-238">Firma Microsoft będzie konieczne napisanie nieco kod, aby dokonać insert.</span><span class="sxs-lookup"><span data-stu-id="a00e2-238">We will need to write a bit of code to actually perform the insert.</span></span>


<span data-ttu-id="a00e2-239">[![Dodawanie przycisku s ogłaszania zwrotnego wynosi krótki Circuited nieprawidłowe dane w interfejsie Wstawianie](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image12.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="a00e2-239">[![The Add Button s Postback is Short Circuited if There is Invalid Data in the Inserting Interface](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image12.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image21.png)</span></span>

<span data-ttu-id="a00e2-240">**Rysunek 12**: Dodawanie przycisku s ogłaszania zwrotnego wynosi krótki Circuited nieprawidłowe dane w interfejsie Wstawianie ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="a00e2-240">**Figure 12**: The Add Button s Postback is Short Circuited if There is Invalid Data in the Inserting Interface ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image22.png))</span></span>


> [!NOTE]
> <span data-ttu-id="a00e2-241">Formanty walidacji w interfejsie Wstawianie nie zostały przypisane do grupy sprawdzania poprawności.</span><span class="sxs-lookup"><span data-stu-id="a00e2-241">The validation controls in the inserting interface were not assigned to a validation group.</span></span> <span data-ttu-id="a00e2-242">Dobrze działa tak długo, jak wstawianie interfejs jest tylko zestaw formanty walidacji na tej stronie.</span><span class="sxs-lookup"><span data-stu-id="a00e2-242">This works fine so long as the inserting interface is the only set of validation controls on the page.</span></span> <span data-ttu-id="a00e2-243">Jeśli istnieją inne formanty walidacji na stronie (np. formanty walidacji w interfejsie edycji siatki s), formanty walidacji w Wstawianie interfejsu i Dodaj s przycisk `ValidationGroup` można przypisać właściwości taką samą wartość tak, aby skojarzenia tych kontrolek z grupy określonej sprawdzania poprawności.</span><span class="sxs-lookup"><span data-stu-id="a00e2-243">If, however, there are other validation controls on the page (such as validation controls in the grid s editing interface), the validation controls in the inserting interface and Add button s `ValidationGroup` properties should be assigned the same value so as to associate these controls with a particular validation group.</span></span> <span data-ttu-id="a00e2-244">Zobacz [pincety formanty walidacji w programie ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx) uzyskać więcej informacji na temat partycjonowania przyciski strony i formanty walidacji w grupach sprawdzania poprawności.</span><span class="sxs-lookup"><span data-stu-id="a00e2-244">See [Dissecting the Validation Controls in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx) for more information on partitioning the validation controls and buttons on a page into validation groups.</span></span>


## <a name="step-5-inserting-a-new-record-into-theproductstable"></a><span data-ttu-id="a00e2-245">Krok 5: Wstawianie nowych rekordów do`Products`tabeli</span><span class="sxs-lookup"><span data-stu-id="a00e2-245">Step 5: Inserting a New Record Into the`Products`Table</span></span>

<span data-ttu-id="a00e2-246">Przy użyciu wbudowanych funkcji edytowania GridView, widoku GridView automatycznie obsługuje wszystkie niezbędne do wykonywania aktualizacji pracy.</span><span class="sxs-lookup"><span data-stu-id="a00e2-246">When utilizing the built-in editing features of the GridView, the GridView automatically handles all of the work necessary for performing the update.</span></span> <span data-ttu-id="a00e2-247">W szczególności, po kliknięciu przycisku Aktualizuj są kopiowane wartości wprowadzone w interfejsie edycji do parametrów w elemencie ObjectDataSource s `UpdateParameters` kolekcji i kopnięć poza aktualizacji przez element ObjectDataSource s `Update()` metody.</span><span class="sxs-lookup"><span data-stu-id="a00e2-247">In particular, when the Update button is clicked it copies the values entered from the editing interface to the parameters in the ObjectDataSource s `UpdateParameters` collection and kicks off the update by invoking the ObjectDataSource s `Update()` method.</span></span> <span data-ttu-id="a00e2-248">Ponieważ w widoku GridView nie zapewnia takiego wbudowanej funkcji wstawiania, musimy zaimplementować kod, który wywołuje element ObjectDataSource s `Insert()` — metoda i kopiuje wartości z Wstawianie interfejsu s ObjectDataSource `InsertParameters` kolekcji .</span><span class="sxs-lookup"><span data-stu-id="a00e2-248">Since the GridView does not provide such built-in functionality for inserting, we must implement code that calls the ObjectDataSource s `Insert()` method and copies the values from the inserting interface to the ObjectDataSource s `InsertParameters` collection.</span></span>

<span data-ttu-id="a00e2-249">Tę logikę wstawiania powinien być wykonywany po kliknięciu przycisku Dodaj.</span><span class="sxs-lookup"><span data-stu-id="a00e2-249">This insert logic should be executed after the Add button has been clicked.</span></span> <span data-ttu-id="a00e2-250">Zgodnie z opisem w [Dodawanie i reagowanie na przyciski w widoku GridView](../custom-button-actions/adding-and-responding-to-buttons-to-a-gridview-vb.md) samouczek, w dowolnym momencie przycisk, LinkButton lub ImageButton w widoku GridView zostanie kliknięty, GridView s `RowCommand` uruchamiany zdarzenia odświeżania strony.</span><span class="sxs-lookup"><span data-stu-id="a00e2-250">As discussed in the [Adding and Responding to Buttons in a GridView](../custom-button-actions/adding-and-responding-to-buttons-to-a-gridview-vb.md) tutorial, anytime a Button, LinkButton, or ImageButton in a GridView is clicked, the GridView s `RowCommand` event fires on postback.</span></span> <span data-ttu-id="a00e2-251">To zdarzenie jest generowane czy przycisku, LinkButton lub ImageButton dodano jawnie takich jak przycisk Dodaj w wierszu stopki, lub jeśli została automatycznie dodana przez widoku GridView (takie jak LinkButtons na początku każdej kolumny, gdy zaznaczono pole wyboru Włącz sortowanie, lub LinkButtons w interfejsie stronicowania po wybraniu włączenia stronicowania).</span><span class="sxs-lookup"><span data-stu-id="a00e2-251">This event fires whether the Button, LinkButton, or ImageButton was added explicitly such as the Add button in the footer row or if it was automatically added by the GridView (such as the LinkButtons at the top of each column when Enable Sorting is selected, or the LinkButtons in the paging interface when Enable Paging is selected).</span></span>

<span data-ttu-id="a00e2-252">W związku z tym, aby odpowiedzieć użytkownik, klikając przycisk Dodaj, należy utworzyć programu obsługi zdarzeń dla widoku GridView s `RowCommand` zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="a00e2-252">Therefore, to respond to the user clicking the Add button, we need to create an event handler for the GridView s `RowCommand` event.</span></span> <span data-ttu-id="a00e2-253">Ponieważ to zdarzenie jest generowane po każdej zmianie *żadnych* po kliknięciu przycisku, LinkButton lub ImageButton w widoku GridView go s istotne, że będziemy kontynuować, tylko z logiką wstawianie `CommandName` właściwości przekazany do mapowania programu obsługi zdarzeń do `CommandName` wartość przycisk Dodaj (Wstaw).</span><span class="sxs-lookup"><span data-stu-id="a00e2-253">Since this event fires whenever *any* Button, LinkButton, or ImageButton in the GridView is clicked, it s vital that we only proceed with the inserting logic if the `CommandName` property passed into the event handler maps to the `CommandName` value of the Add button ( Insert ).</span></span> <span data-ttu-id="a00e2-254">Ponadto firma Microsoft również kontynuować, tylko formanty walidacji raport prawidłowe dane.</span><span class="sxs-lookup"><span data-stu-id="a00e2-254">Moreover, we should also only proceed if the validation controls report valid data.</span></span> <span data-ttu-id="a00e2-255">Aby to umożliwić, należy utworzyć programu obsługi zdarzeń dla `RowCommand` zdarzeń z następującym kodem:</span><span class="sxs-lookup"><span data-stu-id="a00e2-255">To accommodate this, create an event handler for the `RowCommand` event with the following code:</span></span>


[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample6.vb)]

> [!NOTE]
> <span data-ttu-id="a00e2-256">Możesz się zastanawiać, dlaczego program obsługi zdarzeń bothers sprawdzanie `Page.IsValid` właściwości.</span><span class="sxs-lookup"><span data-stu-id="a00e2-256">You may be wondering why the event handler bothers checking the `Page.IsValid` property.</span></span> <span data-ttu-id="a00e2-257">Po wszystkich wykorzystanej t ogłaszania zwrotnego można pominąć, jeśli podano nieprawidłowe dane w interfejsie Wstawianie?</span><span class="sxs-lookup"><span data-stu-id="a00e2-257">After all, won t the postback be suppressed if invalid data is provided in the inserting interface?</span></span> <span data-ttu-id="a00e2-258">To założenie jest poprawna, dopóki użytkownik nie ma wyłączone JavaScript lub podjęła kroki obejścia logikę weryfikacji po stronie klienta.</span><span class="sxs-lookup"><span data-stu-id="a00e2-258">This assumption is correct as long as the user has not disabled JavaScript or has taken steps to circumvent the client-side validation logic.</span></span> <span data-ttu-id="a00e2-259">Krótko mówiąc jeden nigdy nie będą miały ściśle weryfikacji po stronie klienta; sprawdzenia poprawności po stronie serwera powinny być zawsze wykonywane przed rozpoczęciem pracy z danymi.</span><span class="sxs-lookup"><span data-stu-id="a00e2-259">In short, one should never rely strictly on client-side validation; a server-side check for validity should always be performed before working with the data.</span></span>


<span data-ttu-id="a00e2-260">W kroku 1 utworzyliśmy `ProductsDataSource` ObjectDataSource tak, aby jego `Insert()` metody jest mapowany na `ProductsBLL` klasy s `AddProduct` metody.</span><span class="sxs-lookup"><span data-stu-id="a00e2-260">In Step 1 we created the `ProductsDataSource` ObjectDataSource such that its `Insert()` method is mapped to the `ProductsBLL` class s `AddProduct` method.</span></span> <span data-ttu-id="a00e2-261">Aby wstawić nowy rekord w `Products` tabeli, firma Microsoft może po prostu wywołać ObjectDataSource s `Insert()` metody:</span><span class="sxs-lookup"><span data-stu-id="a00e2-261">To insert the new record into the `Products` table, we can simply invoke the ObjectDataSource s `Insert()` method:</span></span>


[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample7.vb)]

<span data-ttu-id="a00e2-262">Teraz, gdy `Insert()` metoda została wywołana, wszystkie punkty, które pozostaje ma na celu Kopiowanie wartości z interfejsu Wstawianie parametry przekazywane do `ProductsBLL` klasy s `AddProduct` metody.</span><span class="sxs-lookup"><span data-stu-id="a00e2-262">Now that the `Insert()` method has been invoked, all that remains is to copy the values from the inserting interface to the parameters passed to the `ProductsBLL` class s `AddProduct` method.</span></span> <span data-ttu-id="a00e2-263">Jak widzieliśmy w [badanie zdarzeń skojarzonych z Wstawianie, aktualizowanie i usuwanie](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-vb.md) samouczek, można to zrobić przez element ObjectDataSource s `Inserting` zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="a00e2-263">As we saw back in the [Examining the Events Associated with Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-vb.md) tutorial, this can be accomplished through the ObjectDataSource s `Inserting` event.</span></span> <span data-ttu-id="a00e2-264">W `Inserting` zdarzenia musimy programowo odwołują się do formantów z `Products` stopki s GridView wiersz i przypisać wartości do `e.InputParameters` kolekcji.</span><span class="sxs-lookup"><span data-stu-id="a00e2-264">In the `Inserting` event we need to programmatically reference the controls from the `Products` GridView s footer row and assign their values to the `e.InputParameters` collection.</span></span> <span data-ttu-id="a00e2-265">Jeśli użytkownik pomija wartości, takich jak pozostawienie `ReorderLevel` puste pole tekstowe, należy określić wartość wstawione do bazy danych należy `NULL`.</span><span class="sxs-lookup"><span data-stu-id="a00e2-265">If the user omits a value such as leaving the `ReorderLevel` TextBox blank we need to specify that the value inserted into the database should be `NULL`.</span></span> <span data-ttu-id="a00e2-266">Ponieważ `AddProducts` metoda przyjmuje typy dopuszczające wartości null dla pola wartość null bazy danych, po prostu użyj typu dopuszczającego wartość null i ustaw dla niego wartość `Nothing` w przypadku, gdy zostanie pominięty danych wejściowych użytkownika.</span><span class="sxs-lookup"><span data-stu-id="a00e2-266">Since the `AddProducts` method accepts nullable types for the nullable database fields, simply use a nullable type and set its value to `Nothing` in the case where user input is omitted.</span></span>


[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample8.vb)]

<span data-ttu-id="a00e2-267">Z `Inserting` program obsługi zdarzeń jest zakończone, nowe rekordy można dodać do `Products` tabeli bazy danych za pośrednictwem widoku GridView s stopki wiersza.</span><span class="sxs-lookup"><span data-stu-id="a00e2-267">With the `Inserting` event handler completed, new records can be added to the `Products` database table via the GridView s footer row.</span></span> <span data-ttu-id="a00e2-268">Przejdź dalej i spróbuj dodać kilka nowych produktów.</span><span class="sxs-lookup"><span data-stu-id="a00e2-268">Go ahead and try adding several new products.</span></span>

## <a name="enhancing-and-customizing-the-add-operation"></a><span data-ttu-id="a00e2-269">Rozszerzanie i dostosowywanie operacji dodawania</span><span class="sxs-lookup"><span data-stu-id="a00e2-269">Enhancing and Customizing the Add Operation</span></span>

<span data-ttu-id="a00e2-270">Obecnie w kliknięcie przycisku Dodaj dodaje nowego rekordu do tabeli bazy danych, ale nie zapewnia dowolny rodzaj wizualne czy rekord został pomyślnie dodany.</span><span class="sxs-lookup"><span data-stu-id="a00e2-270">Currently, clicking the Add button adds a new record to the database table but does not provide any sort of visual feedback that the record has successfully been added.</span></span> <span data-ttu-id="a00e2-271">W idealnym przypadku Web etykiety formantu lub po stronie klienta alertu okno może poinformować użytkownika o ich wstawiania została ukończona pomyślnie.</span><span class="sxs-lookup"><span data-stu-id="a00e2-271">Ideally, a Label Web control or client-side alert box would inform the user that their insert has completed with success.</span></span> <span data-ttu-id="a00e2-272">I pozostaw to wykonywania dla czytnika.</span><span class="sxs-lookup"><span data-stu-id="a00e2-272">I leave this as an exercise for the reader.</span></span>

<span data-ttu-id="a00e2-273">GridView używane w tym samouczku nie ma zastosowania do listy produktów dowolnej kolejności sortowania ani pozwala użytkownikom końcowym posortuj dane.</span><span class="sxs-lookup"><span data-stu-id="a00e2-273">The GridView used in this tutorial does not apply any sort order to the listed products, nor does it allow the end user to sort the data.</span></span> <span data-ttu-id="a00e2-274">W rezultacie rekordy są uporządkowane są one w bazie danych przez ich klucz podstawowy.</span><span class="sxs-lookup"><span data-stu-id="a00e2-274">Consequently, the records are ordered as they are in the database by their primary key field.</span></span> <span data-ttu-id="a00e2-275">Ponieważ każdego nowego rekordu ma `ProductID` wartość większą niż ostatni, każdym nowym produktem dodaje się go jest przyczepiana końcu elementu siatki.</span><span class="sxs-lookup"><span data-stu-id="a00e2-275">Since each new record has a `ProductID` value greater than the last one, every time a new product is added it is tacked on to the end of the grid.</span></span> <span data-ttu-id="a00e2-276">W związku z tym można automatycznie wysłać do użytkownika do ostatniej strony GridView po dodaniu nowego rekordu.</span><span class="sxs-lookup"><span data-stu-id="a00e2-276">Therefore, you may want to automatically send the user to the last page of the GridView after adding a new record.</span></span> <span data-ttu-id="a00e2-277">Można to osiągnąć, dodając następujący wiersz kodu po wywołaniu `ProductsDataSource.Insert()` w `RowCommand` obsługi zdarzeń, aby wskazać, że użytkownik potrzebuje do wysłania do ostatniej strony po powiązaniu danych widoku GridView:</span><span class="sxs-lookup"><span data-stu-id="a00e2-277">This can be accomplished by adding the following line of code after the call to `ProductsDataSource.Insert()` in the `RowCommand` event handler to indicate that the user needs to be sent to the last page after binding the data to the GridView:</span></span>


[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample9.vb)]

<span data-ttu-id="a00e2-278">`SendUserToLastPage`jest zmienną wartości logicznej na poziomie strony, która jest początkowo przypisana wartość `False`.</span><span class="sxs-lookup"><span data-stu-id="a00e2-278">`SendUserToLastPage` is a page-level Boolean variable that is initially assigned a value of `False`.</span></span> <span data-ttu-id="a00e2-279">W widoku GridView s `DataBound` program obsługi zdarzeń, jeśli `SendUserToLastPage` ma wartość false, `PageIndex` właściwości jest aktualizowana w celu wysyłania użytkownika do ostatniej strony.</span><span class="sxs-lookup"><span data-stu-id="a00e2-279">In the GridView s `DataBound` event handler, if `SendUserToLastPage` is false, the `PageIndex` property is updated to send the user to the last page.</span></span>


[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample10.vb)]

<span data-ttu-id="a00e2-280">Powód `PageIndex` właściwość jest ustawiona `DataBound` obsługi zdarzeń (w przeciwieństwie do `RowCommand` obsługi zdarzeń) jest, ponieważ podczas `RowCommand` obsługi zdarzenia generowane, firma Microsoft Przenieś jeszcze do dodawania nowego rekordu `Products` tabeli bazy danych.</span><span class="sxs-lookup"><span data-stu-id="a00e2-280">The reason the `PageIndex` property is set in the `DataBound` event handler (as opposed to the `RowCommand` event handler) is because when the `RowCommand` event handler fires we ve yet to add the new record to the `Products` database table.</span></span> <span data-ttu-id="a00e2-281">W związku z tym w `RowCommand` obsługi zdarzeń ostatniego indeksu strony (`PageCount - 1`) reprezentuje ostatni indeks strony *przed* dodano nowego produktu.</span><span class="sxs-lookup"><span data-stu-id="a00e2-281">Therefore, in the `RowCommand` event handler the last page index (`PageCount - 1`) represents the last page index *before* the new product has been added.</span></span> <span data-ttu-id="a00e2-282">W większości produktów dodawany ostatniego indeksu strony jest taka sama po dodaniu nowego produktu.</span><span class="sxs-lookup"><span data-stu-id="a00e2-282">For the majority of products being added, the last page index is the same after adding the new product.</span></span> <span data-ttu-id="a00e2-283">Gdy dodanego produktu powoduje ostatniego nowego indeksu strony, niepoprawnie aktualizacji, ale `PageIndex` w `RowCommand` obsługi zdarzeń, a następnie możemy spowoduje przekierowanie do drugiego do ostatniej strony (ostatni indeksu strony przed dodaniem nowego produktu) zamiast nowego ostatniej strony i ndex.</span><span class="sxs-lookup"><span data-stu-id="a00e2-283">But when the added product results in a new last page index, if we incorrectly update the `PageIndex` in the `RowCommand` event handler then we'll be taken to the second to last page (the last page index prior to adding the new product) as opposed to the new last page index.</span></span> <span data-ttu-id="a00e2-284">Ponieważ `DataBound` obsługi zdarzenia generowane po dodaniu nowego produktu i dane odbitych do siatki, ustawiając `PageIndex` właściwości wiemy, możemy re poprawne ostatniego indeksu strony pobierania.</span><span class="sxs-lookup"><span data-stu-id="a00e2-284">Since the `DataBound` event handler fires after the new product has been added and the data rebound to the grid, by setting the `PageIndex` property there we know we re getting the correct last page index.</span></span>

<span data-ttu-id="a00e2-285">Na koniec widoku GridView używane w tym samouczku jest dość szeroka, ze względu na liczbę pól, które należy zebrać dodawania nowego produktu.</span><span class="sxs-lookup"><span data-stu-id="a00e2-285">Finally, the GridView used in this tutorial is quite wide due to the number of fields that must be collected for adding a new product.</span></span> <span data-ttu-id="a00e2-286">Ze względu na to szerokość może być preferowany układ pionowy s widoku DetailsView.</span><span class="sxs-lookup"><span data-stu-id="a00e2-286">Due to this width, a DetailsView s vertical layout might be preferred.</span></span> <span data-ttu-id="a00e2-287">GridView s całkowita szerokość może zostać zmniejszona zbierając mniej danych wejściowych.</span><span class="sxs-lookup"><span data-stu-id="a00e2-287">The GridView s overall width could be reduced by collecting fewer inputs.</span></span> <span data-ttu-id="a00e2-288">Możliwe, że firma Microsoft ADAM potrzeba t gromadzenia `UnitsOnOrder`, `UnitsInStock`, i `ReorderLevel` pól podczas dodawania nowego produktu, w tym przypadku te pola można usunąć z widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="a00e2-288">Perhaps we don t need to collect the `UnitsOnOrder`, `UnitsInStock`, and `ReorderLevel` fields when adding a new product, in which case these fields could be removed from the GridView.</span></span>

<span data-ttu-id="a00e2-289">Aby dostosować zebranych danych, możemy użyć jednej z dwóch metod:</span><span class="sxs-lookup"><span data-stu-id="a00e2-289">To adjust the data collected, we can use one of two approaches:</span></span>

- <span data-ttu-id="a00e2-290">Nadal używać `AddProduct` metodę, która oczekuje wartości dla `UnitsOnOrder`, `UnitsInStock`, i `ReorderLevel` pól.</span><span class="sxs-lookup"><span data-stu-id="a00e2-290">Continue to use the `AddProduct` method that expects values for the `UnitsOnOrder`, `UnitsInStock`, and `ReorderLevel` fields.</span></span> <span data-ttu-id="a00e2-291">W `Inserting` program obsługi zdarzeń, podaj stałe, domyślne wartości dla tych danych wejściowych, które zostały usunięte z Wstawianie interfejsu.</span><span class="sxs-lookup"><span data-stu-id="a00e2-291">In the `Inserting` event handler, provide hard-coded, default values to use for these inputs that have been removed from the inserting interface.</span></span>
- <span data-ttu-id="a00e2-292">Utwórz nowy przeciążenia `AddProduct` metody w `ProductsBLL` klasy, która nie akceptuje dane wejściowe dla `UnitsOnOrder`, `UnitsInStock`, i `ReorderLevel` pól.</span><span class="sxs-lookup"><span data-stu-id="a00e2-292">Create a new overload of the `AddProduct` method in the `ProductsBLL` class that does not accept inputs for the `UnitsOnOrder`, `UnitsInStock`, and `ReorderLevel` fields.</span></span> <span data-ttu-id="a00e2-293">Następnie na stronie ASP.NET skonfiguruj ObjectDataSource do używania tego nowego przeciążenia.</span><span class="sxs-lookup"><span data-stu-id="a00e2-293">Then, in the ASP.NET page, configure the ObjectDataSource to use this new overload.</span></span>

<span data-ttu-id="a00e2-294">Jedną z opcji będzie działać równie również.</span><span class="sxs-lookup"><span data-stu-id="a00e2-294">Either option will work equally as well.</span></span> <span data-ttu-id="a00e2-295">W przeszłości samouczki użyliśmy tę druga opcję tworzenia wielu przeciążeń dla `ProductsBLL` klasy s `UpdateProduct` metody.</span><span class="sxs-lookup"><span data-stu-id="a00e2-295">In past tutorials we used the latter option, creating multiple overloads for the `ProductsBLL` class s `UpdateProduct` method.</span></span>

## <a name="summary"></a><span data-ttu-id="a00e2-296">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="a00e2-296">Summary</span></span>

<span data-ttu-id="a00e2-297">Widoku GridView nie ma wbudowane funkcje Wstawianie znalezionych w widoku DetailsView i FormView, ale z bitowego nakładu Wstawianie interfejs mogą być dodawane do stopki wiersza.</span><span class="sxs-lookup"><span data-stu-id="a00e2-297">The GridView lacks the built-in inserting capabilities found in the DetailsView and FormView, but with a bit of effort an inserting interface can be added to the footer row.</span></span> <span data-ttu-id="a00e2-298">W celu wyświetlenia stopki wiersza w widoku GridView wystarczy ustawić jej `ShowFooter` właściwości `True`.</span><span class="sxs-lookup"><span data-stu-id="a00e2-298">To display the footer row in a GridView simply set its `ShowFooter` property to `True`.</span></span> <span data-ttu-id="a00e2-299">Zawartości wiersza stopki można dostosować dla każdego pola konwertując pole na pole TemplateField i dodawanie Wstawianie interfejsu do `FooterTemplate`.</span><span class="sxs-lookup"><span data-stu-id="a00e2-299">The footer row content can be customized for each field by converting the field to a TemplateField and adding the inserting interface to the `FooterTemplate`.</span></span> <span data-ttu-id="a00e2-300">Jak widzieliśmy w tym samouczku `FooterTemplate` może zawierać przycisków, pól tekstowych DropDownLists, pola wyboru, kontrolki źródła danych do zapełniania opartych na danych formantów sieci Web (na przykład DropDownLists) i formanty walidacji.</span><span class="sxs-lookup"><span data-stu-id="a00e2-300">As we saw in this tutorial, the `FooterTemplate` can contain Buttons, TextBoxes, DropDownLists, CheckBoxes, data source controls for populating data-driven Web controls (such as DropDownLists), and validation controls.</span></span> <span data-ttu-id="a00e2-301">Wraz z służy do zbierania danych wejściowych użytkownika s wymagany jest przycisk Dodaj, LinkButton lub ImageButton.</span><span class="sxs-lookup"><span data-stu-id="a00e2-301">Along with controls for collecting the user s input, an Add Button, LinkButton, or ImageButton is needed.</span></span>

<span data-ttu-id="a00e2-302">Po kliknięciu przycisku Dodaj, ObjectDataSource s `Insert()` metoda wywoływana w celu uruchomienia Wstawianie przepływu pracy.</span><span class="sxs-lookup"><span data-stu-id="a00e2-302">When the Add button is clicked, the ObjectDataSource s `Insert()` method is invoked to start the inserting workflow.</span></span> <span data-ttu-id="a00e2-303">ObjectDataSource zostanie następnie wywołaj metodę insert skonfigurowany ( `ProductsBLL` klasy s `AddProduct` metody, w tym samouczku).</span><span class="sxs-lookup"><span data-stu-id="a00e2-303">The ObjectDataSource will then call the configured insert method (the `ProductsBLL` class s `AddProduct` method, in this tutorial).</span></span> <span data-ttu-id="a00e2-304">Firma Microsoft należy skopiować wartości z s GridView Wstawianie interfejsu s ObjectDataSource `InsertParameters` kolekcji przed wywoływana metoda insert.</span><span class="sxs-lookup"><span data-stu-id="a00e2-304">We must copy the values from the GridView s inserting interface to the ObjectDataSource s `InsertParameters` collection prior to the insert method being invoked.</span></span> <span data-ttu-id="a00e2-305">Można to zrobić przez odwołanie programowane wstawianie formantów sieci Web interfejsu w elemencie ObjectDataSource s `Inserting` program obsługi zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="a00e2-305">This can be accomplished by programmatically referencing the inserting interface Web controls in the ObjectDataSource s `Inserting` event handler.</span></span>

<span data-ttu-id="a00e2-306">W tym samouczku wykonuje naszych przyjrzeć techniki wzmocnienia wygląd s widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="a00e2-306">This tutorial completes our look at techniques for enhancing the GridView s appearance.</span></span> <span data-ttu-id="a00e2-307">Następnego zestawu samouczki zbada, jak pracować z danych binarnych, takich jak obrazów, plików PDF, dokumentów programu Word i tak dalej i dane formantów sieci Web.</span><span class="sxs-lookup"><span data-stu-id="a00e2-307">The next set of tutorials will examine how to work with binary data such as images, PDFs, Word documents, and so on and the data Web controls.</span></span>

<span data-ttu-id="a00e2-308">Programowanie przyjemność!</span><span class="sxs-lookup"><span data-stu-id="a00e2-308">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="a00e2-309">Informacje o autorze</span><span class="sxs-lookup"><span data-stu-id="a00e2-309">About the Author</span></span>

<span data-ttu-id="a00e2-310">[Scott Bento](http://www.4guysfromrolla.com/ScottMitchell.shtml), autora siedmiu książek ASP/ASP.NET i twórcę z [4GuysFromRolla.com](http://www.4guysfromrolla.com), pracuje z technologii Microsoft Web od 1998.</span><span class="sxs-lookup"><span data-stu-id="a00e2-310">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="a00e2-311">Scott działa jako niezależnego konsultanta trainer i składnika zapisywania.</span><span class="sxs-lookup"><span data-stu-id="a00e2-311">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="a00e2-312">Jest jego najnowszej książki [ *Sams nauczyć się ASP.NET 2.0 w ciągu 24 godzin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="a00e2-312">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="a00e2-313">Piotr można uzyskać pod adresem [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) lub za pośrednictwem jego blog, który znajduje się w temacie [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="a00e2-313">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="a00e2-314">Specjalne podziękowania dla</span><span class="sxs-lookup"><span data-stu-id="a00e2-314">Special Thanks To</span></span>

<span data-ttu-id="a00e2-315">Ten samouczek serii zostało sprawdzone przez wiele recenzentów przydatne.</span><span class="sxs-lookup"><span data-stu-id="a00e2-315">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="a00e2-316">Recenzenta realizacji w tym samouczku został Bernadette Leigh.</span><span class="sxs-lookup"><span data-stu-id="a00e2-316">Lead reviewer for this tutorial was Bernadette Leigh.</span></span> <span data-ttu-id="a00e2-317">Zainteresowani recenzowania Moje nadchodzących artykuły MSDN?</span><span class="sxs-lookup"><span data-stu-id="a00e2-317">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="a00e2-318">Jeśli tak, Porzuć mnie linii w [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="a00e2-318">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

>[!div class="step-by-step"]
[<span data-ttu-id="a00e2-319">Poprzednie</span><span class="sxs-lookup"><span data-stu-id="a00e2-319">Previous</span></span>](adding-a-gridview-column-of-checkboxes-vb.md)
