---
uid: web-forms/overview/data-access/accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-vb
title: Wykonywanie zapytania na danych z formantem SqlDataSource (VB) | Dokumentacja firmy Microsoft
author: rick-anderson
description: W poprzednim samouczki użyliśmy kontrolki ObjectDataSource pełni Rozdziel warstwę prezentacji z warstwy dostępu do danych. Począwszy od tej instruktora...
ms.author: aspnetcontent
manager: wpickett
ms.date: 02/20/2007
ms.topic: article
ms.assetid: b12f752d-3502-40a4-b695-fc7b7d08cfd3
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-vb
msc.type: authoredcontent
ms.openlocfilehash: 6f886ca85a2a4dea5daeff109370bedc1a3f7265
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/06/2018
ms.locfileid: "30876569"
---
<a name="querying-data-with-the-sqldatasource-control-vb"></a><span data-ttu-id="0744f-104">Wykonywanie zapytania na danych z formantem SqlDataSource (VB)</span><span class="sxs-lookup"><span data-stu-id="0744f-104">Querying Data with the SqlDataSource Control (VB)</span></span>
====================
<span data-ttu-id="0744f-105">przez [Bento Scott](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="0744f-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="0744f-106">[Pobierz przykładową aplikację](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_47_VB.exe) lub [pobierania plików PDF](querying-data-with-the-sqldatasource-control-vb/_static/datatutorial47vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="0744f-106">[Download Sample App](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_47_VB.exe) or [Download PDF](querying-data-with-the-sqldatasource-control-vb/_static/datatutorial47vb1.pdf)</span></span>

> <span data-ttu-id="0744f-107">W poprzednim samouczki użyliśmy kontrolki ObjectDataSource pełni Rozdziel warstwę prezentacji z warstwy dostępu do danych.</span><span class="sxs-lookup"><span data-stu-id="0744f-107">In the preceding tutorials we used the ObjectDataSource control to fully separate the presentation layer from the Data Access layer.</span></span> <span data-ttu-id="0744f-108">Począwszy od tego samouczka, możemy Dowiedz się, jak kontrolka SqlDataSource może służyć do prostych aplikacji, które nie wymagają strict separacji prezentacji i dostęp do danych.</span><span class="sxs-lookup"><span data-stu-id="0744f-108">Starting with this tutorial, we learn how the SqlDataSource control can be used for simple applications that do not require such a strict separation of presentation and data access.</span></span>


## <a name="introduction"></a><span data-ttu-id="0744f-109">Wprowadzenie</span><span class="sxs-lookup"><span data-stu-id="0744f-109">Introduction</span></span>

<span data-ttu-id="0744f-110">Wszystkie samouczków możemy stawienia zbadać wykonanej do tej pory zostały użyte to architektura warstwowe składające się z prezentacji, logiki biznesowej i warstwy dostępu do danych.</span><span class="sxs-lookup"><span data-stu-id="0744f-110">All of the tutorials we ve examined so far have used a tiered architecture consisting of presentation, Business Logic, and Data Access layers.</span></span> <span data-ttu-id="0744f-111">Warstwa dostępu do danych (DAL) został, co w pierwszym samouczku ([tworzenie Warstwa dostępu do danych](../introduction/creating-a-data-access-layer-vb.md)) i warstwy logiki biznesowej w ciągu sekundy ([Tworzenie warstwy logiki biznesowej](../introduction/creating-a-business-logic-layer-vb.md)).</span><span class="sxs-lookup"><span data-stu-id="0744f-111">The Data Access Layer (DAL) was crafted in the first tutorial ([Creating a Data Access Layer](../introduction/creating-a-data-access-layer-vb.md)) and the Business Logic Layer in the second ([Creating a Business Logic Layer](../introduction/creating-a-business-logic-layer-vb.md)).</span></span> <span data-ttu-id="0744f-112">Począwszy od [wyświetlanie danych z ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-vb.md) samouczka widzieliśmy sposób użycia nowej kontrolki ObjectDataSource ASP.NET 2.0 s deklaratywnie interfejsu z architekturą z warstwy prezentacji.</span><span class="sxs-lookup"><span data-stu-id="0744f-112">Starting with the [Displaying Data With the ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-vb.md) tutorial, we saw how to use ASP.NET 2.0 s new ObjectDataSource control to declaratively interface with the architecture from the presentation layer.</span></span>

<span data-ttu-id="0744f-113">Podczas wszystkich samouczków wykonanej do tej pory używano architektury do pracy z danymi, istnieje również możliwość dostępu, wstawiania, aktualizowania i usuwania bazy danych bezpośrednio ze strony programu ASP.NET, pomijanie architektury.</span><span class="sxs-lookup"><span data-stu-id="0744f-113">While all of the tutorials so far have used the architecture to work with data, it is also possible to access, insert, update, and delete database data directly from an ASP.NET page, bypassing the architecture.</span></span> <span data-ttu-id="0744f-114">Dzięki temu umieszczenie zapytań określonej bazy danych i logiki biznesowej bezpośrednio na stronie sieci web.</span><span class="sxs-lookup"><span data-stu-id="0744f-114">Doing so places the specific database queries and business logic directly in the web page.</span></span> <span data-ttu-id="0744f-115">Wystarczająco dużych lub złożonych aplikacji projektowanie, wdrażanie i przy użyciu architektury warstwowych ma zasadnicze znaczenie dla sukcesu, aktualizacji i łatwości konserwacji aplikacji.</span><span class="sxs-lookup"><span data-stu-id="0744f-115">For sufficiently large or complex applications, designing, implementing, and using a tiered architecture is vitally important for the success, updatability, and maintainability of the application.</span></span> <span data-ttu-id="0744f-116">Tworzenie niezawodna architektura, jednak może być konieczne podczas tworzenia niezwykle proste, jednorazowe aplikacji.</span><span class="sxs-lookup"><span data-stu-id="0744f-116">Developing a robust architecture, however, may be unnecessary when creating exceedingly simple, one-off applications.</span></span>

<span data-ttu-id="0744f-117">ASP.NET 2.0 zapewnia pięć wbudowanych danych źródłowych kontrolek [SqlDataSource](https://msdn.microsoft.com/library/dz12d98w%28vs.80%29.aspx), [AccessDataSource](https://msdn.microsoft.com/library/8e5545e1.aspx), [ObjectDataSource](https://msdn.microsoft.com/library/9a4kyhcx.aspx), [XmlDataSource](https://msdn.microsoft.com/library/e8d8587a%28en-US,VS.80%29.aspx), i [SiteMapDataSource](https://msdn.microsoft.com/library/5ex9t96x%28en-US,VS.80%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="0744f-117">ASP.NET 2.0 provides five built-in data source controls [SqlDataSource](https://msdn.microsoft.com/library/dz12d98w%28vs.80%29.aspx), [AccessDataSource](https://msdn.microsoft.com/library/8e5545e1.aspx), [ObjectDataSource](https://msdn.microsoft.com/library/9a4kyhcx.aspx), [XmlDataSource](https://msdn.microsoft.com/library/e8d8587a%28en-US,VS.80%29.aspx), and [SiteMapDataSource](https://msdn.microsoft.com/library/5ex9t96x%28en-US,VS.80%29.aspx).</span></span> <span data-ttu-id="0744f-118">SqlDataSource może służyć do dostępu i modyfikowania dane bezpośrednio z relacyjnej bazy danych, w tym programu Microsoft SQL Server, programu Microsoft Access, Oracle, MySQL i inne.</span><span class="sxs-lookup"><span data-stu-id="0744f-118">The SqlDataSource can be used to access and modify data directly from a relational database, including Microsoft SQL Server, Microsoft Access, Oracle, MySQL, and others.</span></span> <span data-ttu-id="0744f-119">W tym samouczku i dalej trzech zajmiemy się, jak pracować z formantem SqlDataSource, eksploracji, jak wykonać zapytanie i filtrowanie danych bazy danych, a także sposób użycia SqlDataSource do wstawiania, aktualizowania i usuwania danych.</span><span class="sxs-lookup"><span data-stu-id="0744f-119">In this tutorial and the next three, we'll examine how to work with the SqlDataSource control, exploring how to query and filter database data, as well as how to use the SqlDataSource to insert, update, and delete data.</span></span>


![ASP.NET 2.0 Includes Five Built-In Data Source Controls](querying-data-with-the-sqldatasource-control-vb/_static/image1.gif)

<span data-ttu-id="0744f-121">**Rysunek 1**: program ASP.NET 2.0 zawiera pięć kontrolki źródła danych wbudowane</span><span class="sxs-lookup"><span data-stu-id="0744f-121">**Figure 1**: ASP.NET 2.0 Includes Five Built-In Data Source Controls</span></span>


## <a name="comparing-the-objectdatasource-and-sqldatasource"></a><span data-ttu-id="0744f-122">Porównanie SqlDataSource i ObjectDataSource</span><span class="sxs-lookup"><span data-stu-id="0744f-122">Comparing the ObjectDataSource and SqlDataSource</span></span>

<span data-ttu-id="0744f-123">Koncepcyjnie kontrolki ObjectDataSource i SqlDataSource są po prostu serwery proxy danych.</span><span class="sxs-lookup"><span data-stu-id="0744f-123">Conceptually, both the ObjectDataSource and SqlDataSource controls are simply proxies to data.</span></span> <span data-ttu-id="0744f-124">Zgodnie z opisem w [wyświetlanie danych z ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-vb.md) samouczka ObjectDataSource ma właściwości, które wskazują typ obiektu, który zawiera dane i metody do wywołania, aby wybrać, wstawiania, aktualizowania i usuwania danych z podstawowego typu obiektu.</span><span class="sxs-lookup"><span data-stu-id="0744f-124">As discussed in the [Displaying Data With the ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-vb.md) tutorial, the ObjectDataSource has properties that indicate the object type that provides the data and the methods to invoke to select, insert, update, and delete data from the underlying object type.</span></span> <span data-ttu-id="0744f-125">Po skonfigurowaniu właściwości s ObjectDataSource danych formantu sieci Web, takich jak GridView, widoku DetailsView lub DataList może być powiązana z formantu przy użyciu ObjectDataSource s `Select()`, `Insert()`, `Delete()`, i `Update()` metody interakcje z podstawową architekturę.</span><span class="sxs-lookup"><span data-stu-id="0744f-125">Once the ObjectDataSource s properties have been configured, a data Web control such as a GridView, DetailsView, or DataList can be bound to the control, using the ObjectDataSource s `Select()`, `Insert()`, `Delete()`, and `Update()` methods to interact with the underlying architecture.</span></span>

<span data-ttu-id="0744f-126">SqlDataSource zapewnia te same funkcje, ale działa względem relacyjnej bazy danych, a nie biblioteką obiektów.</span><span class="sxs-lookup"><span data-stu-id="0744f-126">The SqlDataSource provides the same functionality, but operates against a relational database rather than an object library.</span></span> <span data-ttu-id="0744f-127">SqlDataSource firma Microsoft, należy określić parametry połączenia bazy danych i zapytania SQL ad hoc lub przechowywanych procedur w celu wykonania do wstawiania, aktualizacji, usuwanie i pobierania danych.</span><span class="sxs-lookup"><span data-stu-id="0744f-127">With the SqlDataSource, we must specify the database connection string and the ad-hoc SQL queries or stored procedures to execute to insert, update, delete, and retrieve data.</span></span> <span data-ttu-id="0744f-128">SqlDataSource s `Select()`, `Insert()`, `Update()`, i `Delete()` metod, gdy została wywołana, połączenia z określoną bazą danych i odpowiednie zapytanie SQL.</span><span class="sxs-lookup"><span data-stu-id="0744f-128">The SqlDataSource s `Select()`, `Insert()`, `Update()`, and `Delete()` methods, when invoked, connect to the specified database and issue the appropriate SQL query.</span></span> <span data-ttu-id="0744f-129">Jak na poniższym diagramie przedstawiono, te metody wykonywania pracy grunt, połączenia z bazą danych, zapytania i zwraca wyniki.</span><span class="sxs-lookup"><span data-stu-id="0744f-129">As the following diagram illustrates, the these methods do the grunt work of connecting to a database, issuing a query, and returning the results.</span></span>


![SqlDataSource służy jako serwer Proxy do bazy danych](querying-data-with-the-sqldatasource-control-vb/_static/image2.gif)

<span data-ttu-id="0744f-131">**Rysunek 2**: SqlDataSource służy jako serwer Proxy do bazy danych</span><span class="sxs-lookup"><span data-stu-id="0744f-131">**Figure 2**: The SqlDataSource Serves as a Proxy to the Database</span></span>


> [!NOTE]
> <span data-ttu-id="0744f-132">W tym samouczku firma Microsoft będzie skupić się na pobieranie danych z bazy danych.</span><span class="sxs-lookup"><span data-stu-id="0744f-132">In this tutorial we'll focus on retrieving data from the database.</span></span> <span data-ttu-id="0744f-133">W [Wstawianie, aktualizowanie i usuwania danych z formantem SqlDataSource](inserting-updating-and-deleting-data-with-the-sqldatasource-vb.md) samouczka zajmiemy się tym, jak skonfigurować SqlDataSource do obsługi Wstawianie, aktualizowanie i usuwanie.</span><span class="sxs-lookup"><span data-stu-id="0744f-133">In the [Inserting, Updating, and Deleteing Data with the SqlDataSource Control](inserting-updating-and-deleting-data-with-the-sqldatasource-vb.md) tutorial, we'll see how to configure the SqlDataSource to support inserting, updating, and deleting.</span></span>


## <a name="the-sqldatasource-and-accessdatasource-controls"></a><span data-ttu-id="0744f-134">SqlDataSource i AccessDataSource formantów</span><span class="sxs-lookup"><span data-stu-id="0744f-134">The SqlDataSource and AccessDataSource Controls</span></span>

<span data-ttu-id="0744f-135">Oprócz kontroli SqlDataSource ASP.NET 2.0 obejmuje również kontrolkę AccessDataSource.</span><span class="sxs-lookup"><span data-stu-id="0744f-135">In addition to the SqlDataSource control, ASP.NET 2.0 also includes an AccessDataSource control.</span></span> <span data-ttu-id="0744f-136">Te dwie inne formanty prowadzić wielu deweloperów jesteś nowym użytkownikiem programu ASP.NET 2.0 podejrzewać, że kontrolka AccessDataSource jest przeznaczona do pracy wyłącznie z programu Microsoft Access za pomocą formantu SqlDataSource zaprojektowane do pracy wyłącznie z programu Microsoft SQL Server.</span><span class="sxs-lookup"><span data-stu-id="0744f-136">These two different controls lead many developers new to ASP.NET 2.0 to suspect that the AccessDataSource control is designed to work exclusively with Microsoft Access with the SqlDataSource control designed to work exclusively with Microsoft SQL Server.</span></span> <span data-ttu-id="0744f-137">Gdy w elemencie AccessDataSource jest przeznaczona do pracy z programu Microsoft Access, kontroli SqlDataSource współpracuje z *żadnych* relacyjnej bazy danych, który jest możliwy za pośrednictwem platformy .NET.</span><span class="sxs-lookup"><span data-stu-id="0744f-137">While the AccessDataSource is designed to work specifically with Microsoft Access, the SqlDataSource control works with *any* relational database that can be accessed through .NET.</span></span> <span data-ttu-id="0744f-138">W tym wszelkie OLE DB lub ODBC-CLS magazyny danych, takich jak Microsoft SQL Server, programu Microsoft Access, Oracle, Informix, MySQL i PostgreSQL, wśród wielu innych.</span><span class="sxs-lookup"><span data-stu-id="0744f-138">This includes any OleDb- or ODBC-compliant data stores, such as Microsoft SQL Server, Microsoft Access, Oracle, Informix, MySQL, and PostgreSQL, among many others.</span></span>

<span data-ttu-id="0744f-139">Wyłącznie różnica między formantami AccessDataSource i SqlDataSource jest, jak określono informacje o połączeniu.</span><span class="sxs-lookup"><span data-stu-id="0744f-139">The sole difference between the AccessDataSource and SqlDataSource controls is how the database connection information is specified.</span></span> <span data-ttu-id="0744f-140">Kontrolka AccessDataSource wymaga tylko ścieżka do pliku bazy danych programu Access.</span><span class="sxs-lookup"><span data-stu-id="0744f-140">The AccessDataSource control needs just the file path to the Access database file.</span></span> <span data-ttu-id="0744f-141">SqlDataSource, z drugiej strony, wymaga parametrów połączenia ukończone.</span><span class="sxs-lookup"><span data-stu-id="0744f-141">The SqlDataSource, on the other hand, requires a complete connection string.</span></span>

## <a name="step-1-creating-the-sqldatasource-web-pages"></a><span data-ttu-id="0744f-142">Krok 1: Tworzenie stron sieci Web w źródle SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="0744f-142">Step 1: Creating the SqlDataSource Web Pages</span></span>

<span data-ttu-id="0744f-143">Zanim Rozpoczniemy eksploracji sposób pracy bezpośrednio z bazy danych za pomocą kontroli SqlDataSource, chętnie s najpierw Poświęć chwilę, aby utworzyć w naszym projekt witryny sieci Web, które będą potrzebne dla tego samouczka i dalej trzy stron ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="0744f-143">Before we start exploring how to work directly with database data using the SqlDataSource control, let s first take a moment to create the ASP.NET pages in our website project that we'll need for this tutorial and the next three.</span></span> <span data-ttu-id="0744f-144">Rozpocznij od dodania nowy folder o nazwie `SqlDataSource`.</span><span class="sxs-lookup"><span data-stu-id="0744f-144">Start by adding a new folder named `SqlDataSource`.</span></span> <span data-ttu-id="0744f-145">Następnie dodaj do tego folderu, upewniając się skojarzyć każdą stronę z następujących stron ASP.NET `Site.master` strony głównej:</span><span class="sxs-lookup"><span data-stu-id="0744f-145">Next, add the following ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `Querying.aspx`
- `ParameterizedQueries.aspx`
- `InsertUpdateDelete.aspx`
- `OptimisticConcurrency.aspx`


![Dodawanie stron ASP.NET samouczki dotyczące SqlDataSource](querying-data-with-the-sqldatasource-control-vb/_static/image3.gif)

<span data-ttu-id="0744f-147">**Rysunek 3**: Dodawanie stron ASP.NET samouczki dotyczące SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="0744f-147">**Figure 3**: Add the ASP.NET Pages for the SqlDataSource-Related Tutorials</span></span>


<span data-ttu-id="0744f-148">Podobnie jak w innych folderach `Default.aspx` w `SqlDataSource` folderu spowoduje wyświetlenie listy samouczków w sekcji.</span><span class="sxs-lookup"><span data-stu-id="0744f-148">Like in the other folders, `Default.aspx` in the `SqlDataSource` folder will list the tutorials in its section.</span></span> <span data-ttu-id="0744f-149">Odwołania, który `SectionLevelTutorialListing.ascx` kontrola użytkownika zapewnia tę funkcję.</span><span class="sxs-lookup"><span data-stu-id="0744f-149">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="0744f-150">W związku z tym Dodaj formant użytkownika `Default.aspx` przeciągając je z Eksploratora rozwiązań na stronę s widoku Projekt.</span><span class="sxs-lookup"><span data-stu-id="0744f-150">Therefore, add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page s Design view.</span></span>


<span data-ttu-id="0744f-151">[![Dodaj kontrolkę użytkownika SectionLevelTutorialListing.ascx do Default.aspx](querying-data-with-the-sqldatasource-control-vb/_static/image5.gif)](querying-data-with-the-sqldatasource-control-vb/_static/image4.gif)</span><span class="sxs-lookup"><span data-stu-id="0744f-151">[![Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](querying-data-with-the-sqldatasource-control-vb/_static/image5.gif)](querying-data-with-the-sqldatasource-control-vb/_static/image4.gif)</span></span>

<span data-ttu-id="0744f-152">**Rysunek 4**: Dodaj `SectionLevelTutorialListing.ascx` formantu użytkownika `Default.aspx` ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](querying-data-with-the-sqldatasource-control-vb/_static/image6.gif))</span><span class="sxs-lookup"><span data-stu-id="0744f-152">**Figure 4**: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](querying-data-with-the-sqldatasource-control-vb/_static/image6.gif))</span></span>


<span data-ttu-id="0744f-153">Na koniec Dodaj następujące cztery strony jako wpisów `Web.sitemap` pliku.</span><span class="sxs-lookup"><span data-stu-id="0744f-153">Lastly, add these four pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="0744f-154">W szczególności, Dodaj następujący kod po przyciski niestandardowe Dodawanie DataList i elementu powtarzanego `<siteMapNode>`:</span><span class="sxs-lookup"><span data-stu-id="0744f-154">Specifically, add the following markup after the Adding Custom Buttons to the DataList and Repeater `<siteMapNode>`:</span></span>


[!code-sql[Main](querying-data-with-the-sqldatasource-control-vb/samples/sample1.sql)]

<span data-ttu-id="0744f-155">Po zaktualizowaniu `Web.sitemap`, Poświęć chwilę, aby wyświetlić witrynę sieci Web samouczki, za pośrednictwem przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="0744f-155">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="0744f-156">Menu po lewej stronie zawiera teraz elementy edytowanie, wstawianie i usuwanie samouczki.</span><span class="sxs-lookup"><span data-stu-id="0744f-156">The menu on the left now includes items for the editing, inserting, and deleting tutorials.</span></span>


![Mapy witryny zawiera teraz wpisy samouczki SqlDataSource](querying-data-with-the-sqldatasource-control-vb/_static/image7.gif)

<span data-ttu-id="0744f-158">**Rysunek 5**: mapy witryny zawiera teraz wpisy samouczki SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="0744f-158">**Figure 5**: The Site Map Now Includes Entries for the SqlDataSource Tutorials</span></span>


## <a name="step-2-adding-and-configuring-the-sqldatasource-control"></a><span data-ttu-id="0744f-159">Krok 2: Dodawanie i konfigurowanie sterowania SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="0744f-159">Step 2: Adding and Configuring the SqlDataSource Control</span></span>

<span data-ttu-id="0744f-160">Uruchamianie przez otwarcie `Querying.aspx` strony `SqlDataSource` folder i Przełącz do widoku projektu.</span><span class="sxs-lookup"><span data-stu-id="0744f-160">Start by opening the `Querying.aspx` page in the `SqlDataSource` folder and switch to Design view.</span></span> <span data-ttu-id="0744f-161">Przeciągnij formant SqlDataSource z przybornika do projektanta i zestaw jej `ID` do `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="0744f-161">Drag a SqlDataSource control from the Toolbox onto the Designer and set its `ID` to `ProductsDataSource`.</span></span> <span data-ttu-id="0744f-162">Podobnie jak w elemencie ObjectDataSource, SqlDataSource nie generuje żadnego wyniku renderowanych i dlatego jest wyświetlany jako szary prostokąt na powierzchni projektu.</span><span class="sxs-lookup"><span data-stu-id="0744f-162">As with the ObjectDataSource, the SqlDataSource does not produce any rendered output and therefore appears as a gray box on the design surface.</span></span> <span data-ttu-id="0744f-163">Aby skonfigurować SqlDataSource, kliknij łącze Konfigurowanie źródła danych z tagów inteligentnych s SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="0744f-163">To configure the SqlDataSource, click on the Configure Data Source link from the SqlDataSource s smart tag.</span></span>


![Polecenie skonfigurować łącze źródła danych z tagów inteligentnych s SqlDataSource](querying-data-with-the-sqldatasource-control-vb/_static/image8.gif)

<span data-ttu-id="0744f-165">**Rysunek 6**: polecenie skonfigurować łącze źródła danych z tagów inteligentnych s SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="0744f-165">**Figure 6**: Click on the Configure Data Source Link from the SqlDataSource s Smart Tag</span></span>


<span data-ttu-id="0744f-166">Spowoduje to wyświetlenie kreatora skonfiguruj źródło danych SqlDataSource kontroli s.</span><span class="sxs-lookup"><span data-stu-id="0744f-166">This brings up the SqlDataSource control s Configure Data Source wizard.</span></span> <span data-ttu-id="0744f-167">Podczas działania kreatora s różnią się od kontrolki ObjectDataSource s, jej celem jest taki sam, aby zawierają szczegółowe informacje na temat pobierania, wstawiania, aktualizowania i usuwania danych za pośrednictwem źródła danych.</span><span class="sxs-lookup"><span data-stu-id="0744f-167">While the wizard s steps differ from the ObjectDataSource control s, the end goal is the same to provide the details on how to retrieve, insert, update, and delete data through the data source.</span></span> <span data-ttu-id="0744f-168">Dla SqlDataSource wymaga określenia podstawowej bazy danych do użycia i udostępnianie ad hoc instrukcji SQL lub procedur składowanych.</span><span class="sxs-lookup"><span data-stu-id="0744f-168">For the SqlDataSource this entails specifying the underlying database to use and providing the ad-hoc SQL statements or stored procedures.</span></span>

<span data-ttu-id="0744f-169">Pierwszym krokiem Kreator wyświetli monit nam dla bazy danych.</span><span class="sxs-lookup"><span data-stu-id="0744f-169">The first wizard step prompts us for the database.</span></span> <span data-ttu-id="0744f-170">Listy rozwijanej obejmuje tych baz danych w sieci web s aplikacji `App_Data` folderu oraz te, które zostały dodane do węzła połączenia danych w Eksploratorze serwera.</span><span class="sxs-lookup"><span data-stu-id="0744f-170">The drop-down list includes those databases found in the web application s `App_Data` folder and those that have been added to the Data Connections node in the Server Explorer.</span></span> <span data-ttu-id="0744f-171">Od nas kolejnych już dodany ciąg połączenia dla `NORTHWIND.MDF` bazy danych w `App_Data` folderu do naszej projektu s `Web.config` pliku, z listy rozwijanej zawiera odwołanie do tego ciągu połączenia `NORTHWINDConnectionString`.</span><span class="sxs-lookup"><span data-stu-id="0744f-171">Since we ve already added a connection string for the `NORTHWIND.MDF` database in the `App_Data` folder to our project s `Web.config` file, the drop-down list includes a reference to that connection string, `NORTHWINDConnectionString`.</span></span> <span data-ttu-id="0744f-172">Wybierz ten element z listy rozwijanej, a następnie kliknij przycisk Dalej.</span><span class="sxs-lookup"><span data-stu-id="0744f-172">Choose this item from the drop-down list and click Next.</span></span>


![Z listy rozwijanej wybierz NORTHWINDConnectionString](querying-data-with-the-sqldatasource-control-vb/_static/image9.gif)

<span data-ttu-id="0744f-174">**Rysunek 7**: Wybierz `NORTHWINDConnectionString` z listy rozwijanej</span><span class="sxs-lookup"><span data-stu-id="0744f-174">**Figure 7**: Choose the `NORTHWINDConnectionString` from the Drop-Down List</span></span>


<span data-ttu-id="0744f-175">Po wybraniu bazy danych, Kreator zapyta, zapytania do zwrócenia danych.</span><span class="sxs-lookup"><span data-stu-id="0744f-175">After choosing the database, the wizard asks for the query to return data.</span></span> <span data-ttu-id="0744f-176">Firma Microsoft można określić kolumn w tabeli lub widoku, aby zwrócić lub można wprowadzić niestandardową instrukcję SQL lub określić procedury składowanej.</span><span class="sxs-lookup"><span data-stu-id="0744f-176">We can either specify the columns of a table or view to return or can enter a custom SQL statement or specify a stored procedure.</span></span> <span data-ttu-id="0744f-177">Można przełączać się między ten wybór za pośrednictwem Określ niestandardową instrukcję SQL lub procedur składowanych i określ kolumny z tabeli lub wyświetlanie przycisków radiowych.</span><span class="sxs-lookup"><span data-stu-id="0744f-177">You can toggle between this choice through the Specify a custom SQL statement or stored procedure and Specify columns from a table or view radio buttons.</span></span>

> [!NOTE]
> <span data-ttu-id="0744f-178">W tym przykładzie pierwsze umożliwiają używanie Określ kolumn z tabeli lub widoku opcji s.</span><span class="sxs-lookup"><span data-stu-id="0744f-178">For this first example, let s use the Specify columns from a table or view option.</span></span> <span data-ttu-id="0744f-179">Firma Microsoft będzie wróć do kreatora w dalszej części tego samouczka i Eksploruj Określ niestandardową instrukcję SQL lub procedurę składowaną opcji.</span><span class="sxs-lookup"><span data-stu-id="0744f-179">We'll return to the wizard later in this tutorial and explore the Specify a custom SQL statement or stored procedure option.</span></span>


<span data-ttu-id="0744f-180">Rysunek nr 8 przedstawia konfiguracji ekranu instrukcji Select w przypadku wybrania Określ kolumny z tabeli lub widoku przycisku radiowego.</span><span class="sxs-lookup"><span data-stu-id="0744f-180">Figure 8 shows the Configure the Select Statement screen when the Specify columns from a table or view radio button is selected.</span></span> <span data-ttu-id="0744f-181">Listy rozwijanej zawiera zestaw tabel i widoków w bazie danych Northwind z wybranej tabeli lub kolumny w widoku s wyświetlane na poniższej liście wyboru.</span><span class="sxs-lookup"><span data-stu-id="0744f-181">The drop-down list contains the set of tables and views in the Northwind database, with the selected table or view s columns displayed in the checkbox list below.</span></span> <span data-ttu-id="0744f-182">W tym przykładzie zwraca let s `ProductID`, `ProductName`, i `UnitPrice` kolumny z `Products` tabeli.</span><span class="sxs-lookup"><span data-stu-id="0744f-182">For this example, let s return the `ProductID`, `ProductName`, and `UnitPrice` columns from the `Products` table.</span></span> <span data-ttu-id="0744f-183">Jak rysunek nr 8 przedstawia po tych wyborów kreator przedstawia wynikowa instrukcja SQL `SELECT [ProductID], [ProductName], [UnitPrice] FROM [Products]`.</span><span class="sxs-lookup"><span data-stu-id="0744f-183">As Figure 8 shows, after making these selections the wizard shows the resulting SQL statement `SELECT [ProductID], [ProductName], [UnitPrice] FROM [Products]`.</span></span>


![Zwróć dane z tabeli Produkty](querying-data-with-the-sqldatasource-control-vb/_static/image10.gif)

<span data-ttu-id="0744f-185">**Rysunek 8**: Przywróć dane z `Products` tabeli</span><span class="sxs-lookup"><span data-stu-id="0744f-185">**Figure 8**: Return Data from the `Products` Table</span></span>


<span data-ttu-id="0744f-186">Po skonfigurowaniu kreatora, aby zwrócić `ProductID`, `ProductName`, i `UnitPrice` kolumny z `Products` tabeli, kliknij przycisk Dalej.</span><span class="sxs-lookup"><span data-stu-id="0744f-186">Once you have configured the wizard to return the `ProductID`, `ProductName`, and `UnitPrice` columns from the `Products` table, click the Next button.</span></span> <span data-ttu-id="0744f-187">Ten ekran końcowy zapewnia możliwość sprawdzenia wyników kwerendy skonfigurowane z poprzedniego kroku.</span><span class="sxs-lookup"><span data-stu-id="0744f-187">This final screen provides an opportunity to examine the results of the query configured from the previous step.</span></span> <span data-ttu-id="0744f-188">Kliknięcie przycisku Test zapytanie wykonuje skonfigurowanego `SELECT` instrukcji i wyświetla wyniki w siatce.</span><span class="sxs-lookup"><span data-stu-id="0744f-188">Clicking the Test Query button executes the configured `SELECT` statement and displays the results in a grid.</span></span>


![Kliknij przycisk zapytanie testu, aby przejrzeć zapytanie SELECT](querying-data-with-the-sqldatasource-control-vb/_static/image11.gif)

<span data-ttu-id="0744f-190">**Rysunek 9**: kliknij przycisk Testuj zapytania do przeglądu Twojej `SELECT` zapytania</span><span class="sxs-lookup"><span data-stu-id="0744f-190">**Figure 9**: Click the Test Query Button to Review Your `SELECT` Query</span></span>


<span data-ttu-id="0744f-191">Aby zakończyć pracę kreatora, kliknij przycisk Zakończ.</span><span class="sxs-lookup"><span data-stu-id="0744f-191">To complete the wizard, click Finish.</span></span>

<span data-ttu-id="0744f-192">Jak z elementu ObjectDataSource, Kreator s SqlDataSource jedynie przypisuje wartości do właściwości formantu s, czyli [ `ConnectionString` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.connectionstring.aspx) i [ `SelectCommand` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.selectcommand.aspx) właściwości.</span><span class="sxs-lookup"><span data-stu-id="0744f-192">Like with the ObjectDataSource, the SqlDataSource s wizard merely assigns values to the control s properties, namely the [`ConnectionString`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.connectionstring.aspx) and [`SelectCommand`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.selectcommand.aspx) properties.</span></span> <span data-ttu-id="0744f-193">Po zakończeniu pracy kreatora, Twoje SqlDataSource kontroli s deklaratywne znaczników powinien wyglądać podobny do następującego:</span><span class="sxs-lookup"><span data-stu-id="0744f-193">After completing the wizard, your SqlDataSource control s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](querying-data-with-the-sqldatasource-control-vb/samples/sample2.aspx)]

<span data-ttu-id="0744f-194">`ConnectionString` Właściwość zawiera informacje na temat połączenia z bazą danych.</span><span class="sxs-lookup"><span data-stu-id="0744f-194">The `ConnectionString` property provides information on how to connect to the database.</span></span> <span data-ttu-id="0744f-195">Tej właściwości można przypisać wartość ciągu pełnej, stałe połączenie lub może wskazywać na parametry połączenia w `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="0744f-195">This property can be assigned a complete, hard-coded connection string value or can point to a connection string in `Web.config`.</span></span> <span data-ttu-id="0744f-196">Aby odwołać się do wartości ciągu połączenia w pliku Web.config, należy użyć składni `<%$ expressionPrefix:expressionValue %>`.</span><span class="sxs-lookup"><span data-stu-id="0744f-196">To reference a connection string value in Web.config, use the syntax `<%$ expressionPrefix:expressionValue %>`.</span></span> <span data-ttu-id="0744f-197">Zazwyczaj *expressionPrefix* jest ConnectionStrings i *expressionValue* jest nazwą ciągu połączenia w `Web.config` [ `<connectionStrings>` sekcji](https://msdn.microsoft.com/library/bf7sd233.aspx).</span><span class="sxs-lookup"><span data-stu-id="0744f-197">Typically, *expressionPrefix* is ConnectionStrings and *expressionValue* is the name of the connect string in the `Web.config` [`<connectionStrings>` section](https://msdn.microsoft.com/library/bf7sd233.aspx).</span></span> <span data-ttu-id="0744f-198">Jednak składnia może służyć do odwołania `<appSettings>` elementy lub zawartość z plików zasobów.</span><span class="sxs-lookup"><span data-stu-id="0744f-198">However, the syntax can be used to reference `<appSettings>` elements or content from resource files.</span></span> <span data-ttu-id="0744f-199">Zobacz [omówienie wyrażenia ASP.NET](https://msdn.microsoft.com/library/d5bd1tad.aspx) Aby uzyskać więcej informacji na temat tej składni.</span><span class="sxs-lookup"><span data-stu-id="0744f-199">See [ASP.NET Expressions Overview](https://msdn.microsoft.com/library/d5bd1tad.aspx) for more on this syntax.</span></span>

<span data-ttu-id="0744f-200">`SelectCommand` Właściwość określa ad hoc instrukcji SQL lub procedurę składowaną można wykonać, aby zwrócić dane.</span><span class="sxs-lookup"><span data-stu-id="0744f-200">The `SelectCommand` property specifies the ad-hoc SQL statement or stored procedure to execute to return the data.</span></span>

## <a name="step-3-adding-a-data-web-control-and-binding-it-to-the-sqldatasource"></a><span data-ttu-id="0744f-201">Krok 3: Dodawanie formantu danych sieci Web i powiązania jej z SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="0744f-201">Step 3: Adding a Data Web Control and Binding it to the SqlDataSource</span></span>

<span data-ttu-id="0744f-202">Po skonfigurowaniu SqlDataSource może być powiązana z danymi formantu sieci Web, takich jak widok GridView lub widoku DetailsView.</span><span class="sxs-lookup"><span data-stu-id="0744f-202">Once the SqlDataSource has been configured, it can be bound to a data Web control, such as a GridView or DetailsView.</span></span> <span data-ttu-id="0744f-203">W tym samouczku pozwolić, aby wyświetlić dane w widoku GridView s.</span><span class="sxs-lookup"><span data-stu-id="0744f-203">For this tutorial, let s display the data in a GridView.</span></span> <span data-ttu-id="0744f-204">Z przybornika, przeciągnij element GridView strony, który należy powiązać `ProductsDataSource` SqlDataSource, wybierając źródło danych z listy rozwijanej w tagu s widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="0744f-204">From the Toolbox, drag a GridView onto the page and bind it to the `ProductsDataSource` SqlDataSource by choosing the data source from the drop-down list in the GridView s smart tag.</span></span>


<span data-ttu-id="0744f-205">[![Dodaj element GridView i powiąż go do kontroli SqlDataSource](querying-data-with-the-sqldatasource-control-vb/_static/image13.gif)](querying-data-with-the-sqldatasource-control-vb/_static/image12.gif)</span><span class="sxs-lookup"><span data-stu-id="0744f-205">[![Add a GridView and Bind it to the SqlDataSource Control](querying-data-with-the-sqldatasource-control-vb/_static/image13.gif)](querying-data-with-the-sqldatasource-control-vb/_static/image12.gif)</span></span>

<span data-ttu-id="0744f-206">**Na rysunku nr 10**: Dodaj element GridView i powiąż go do kontroli SqlDataSource ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](querying-data-with-the-sqldatasource-control-vb/_static/image14.gif))</span><span class="sxs-lookup"><span data-stu-id="0744f-206">**Figure 10**: Add a GridView and Bind it to the SqlDataSource Control ([Click to view full-size image](querying-data-with-the-sqldatasource-control-vb/_static/image14.gif))</span></span>


<span data-ttu-id="0744f-207">Po wybraniu z listy rozwijanej w tagu s GridView kontroli SqlDataSource był Visual Studio spowoduje automatyczne dodanie elementu BoundField lub CheckBoxField do widoku GridView dla każdej kolumny zwracane przez formant źródła danych.</span><span class="sxs-lookup"><span data-stu-id="0744f-207">Once you ve selected the SqlDataSource control from the drop-down list in the GridView s smart tag, Visual Studio will automatically add a BoundField or CheckBoxField to the GridView for each of the columns returned by the data source control.</span></span> <span data-ttu-id="0744f-208">Ponieważ SqlDataSource zwraca trzy kolumny w bazie danych `ProductID`, `ProductName`, i `UnitPrice` istnieją trzy pola w widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="0744f-208">Since the SqlDataSource returns three database columns `ProductID`, `ProductName`, and `UnitPrice` there are three fields in the GridView.</span></span>

<span data-ttu-id="0744f-209">Poświęć chwilę, aby skonfigurować s GridView trzech BoundFields.</span><span class="sxs-lookup"><span data-stu-id="0744f-209">Take a moment to configure the GridView s three BoundFields.</span></span> <span data-ttu-id="0744f-210">Zmień `ProductName` pola s `HeaderText` dla właściwości Nazwa produktu i `UnitPrice` pola s ceny.</span><span class="sxs-lookup"><span data-stu-id="0744f-210">Change the `ProductName` field s `HeaderText` property to Product Name and the `UnitPrice` field s to Price.</span></span> <span data-ttu-id="0744f-211">Również sformatować `UnitPrice` pole jako walutę.</span><span class="sxs-lookup"><span data-stu-id="0744f-211">Also format the `UnitPrice` field as a currency.</span></span> <span data-ttu-id="0744f-212">Po wprowadzeniu tych zmian, deklaratywne GridView znaczników w s powinien wyglądać podobnie do poniższej:</span><span class="sxs-lookup"><span data-stu-id="0744f-212">After making these modifications, your GridView s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](querying-data-with-the-sqldatasource-control-vb/samples/sample3.aspx)]

<span data-ttu-id="0744f-213">Odwiedź stronę tej strony za pośrednictwem przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="0744f-213">Visit this page through a browser.</span></span> <span data-ttu-id="0744f-214">Jak pokazano na rysunku nr 11, widoku GridView wymieniono każdego produktu s `ProductID`, `ProductName`, i `UnitPrice` wartości.</span><span class="sxs-lookup"><span data-stu-id="0744f-214">As Figure 11 shows, the GridView lists each product s `ProductID`, `ProductName`, and `UnitPrice` values.</span></span>


<span data-ttu-id="0744f-215">[![Wyświetla widoku GridView każdego produktu s ProductID ProductName i UnitPrice wartości](querying-data-with-the-sqldatasource-control-vb/_static/image16.gif)](querying-data-with-the-sqldatasource-control-vb/_static/image15.gif)</span><span class="sxs-lookup"><span data-stu-id="0744f-215">[![The GridView Displays Each Product s ProductID, ProductName, and UnitPrice Values](querying-data-with-the-sqldatasource-control-vb/_static/image16.gif)](querying-data-with-the-sqldatasource-control-vb/_static/image15.gif)</span></span>

<span data-ttu-id="0744f-216">**Rysunek 11**: s GridView Wyświetla każdego produktu `ProductID`, `ProductName`, i `UnitPrice` wartości ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](querying-data-with-the-sqldatasource-control-vb/_static/image17.gif))</span><span class="sxs-lookup"><span data-stu-id="0744f-216">**Figure 11**: The GridView Displays Each Product s `ProductID`, `ProductName`, and `UnitPrice` Values ([Click to view full-size image](querying-data-with-the-sqldatasource-control-vb/_static/image17.gif))</span></span>


<span data-ttu-id="0744f-217">W przypadku odwiedzenia strony widoku GridView wywołuje formantu źródła danych s `Select()` metody.</span><span class="sxs-lookup"><span data-stu-id="0744f-217">When the page is visited the GridView invokes its data source control s `Select()` method.</span></span> <span data-ttu-id="0744f-218">Gdy firma Microsoft używa kontrolki ObjectDataSource, to `ProductsBLL` klasy s `GetProducts()` metody.</span><span class="sxs-lookup"><span data-stu-id="0744f-218">When we were using the ObjectDataSource control, this called the `ProductsBLL` class s `GetProducts()` method.</span></span> <span data-ttu-id="0744f-219">Z SqlDataSource, jednak `Select()` metody nawiąże połączenie z określoną bazą danych i problemy `SelectCommand` (`SELECT [ProductID], [ProductName], [UnitPrice] FROM [Products]`, w tym przykładzie).</span><span class="sxs-lookup"><span data-stu-id="0744f-219">With the SqlDataSource, however, the `Select()` method establishes a connection to the specified database and issues the `SelectCommand` (`SELECT [ProductID], [ProductName], [UnitPrice] FROM [Products]`, in this example).</span></span> <span data-ttu-id="0744f-220">SqlDataSource zwraca jego wyniki, które następnie wylicza widoku GridView, tworzenie wiersza w widoku GridView dla każdego rekordu bazy danych zwrócił.</span><span class="sxs-lookup"><span data-stu-id="0744f-220">The SqlDataSource returns its results which the GridView then enumerates, creating a row in the GridView for each database record returned.</span></span>

## <a name="the-built-in-data-web-control-features-and-the-sqldatasource-control"></a><span data-ttu-id="0744f-221">Funkcje kontroli danych wbudowanych sieci Web i kontroli SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="0744f-221">The Built-In Data Web Control Features and the SqlDataSource Control</span></span>

<span data-ttu-id="0744f-222">Ogólnie, funkcje wbudowane w danych Web formanty stronicowania, sortowanie, edycję, usuwanie, wstawiania i tak dalej są specyficzne dla formantu danych w sieci Web i nie są zależne od formantu źródła danych, które są używane.</span><span class="sxs-lookup"><span data-stu-id="0744f-222">In general, the features inherent to the data Web controls paging, sorting, editing, deleting, inserting, and so on are specific to the data Web control and are not dependent on the data source control used.</span></span> <span data-ttu-id="0744f-223">Oznacza to wbudowanych stronicowania, sortowanie, edytowanie i usuwanie czy jest on powiązany z ObjectDataSource lub SqlDataSource może korzystać z widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="0744f-223">That is, the GridView can utilize its built-in paging, sorting, editing, and deleting whether it is bound to an ObjectDataSource or a SqlDataSource.</span></span> <span data-ttu-id="0744f-224">Jednak niektóre dane funkcje kontroli sieci Web jest wielkość liter, do kontroli źródła danych, które są używane lub w konfiguracji kontroli s źródła danych.</span><span class="sxs-lookup"><span data-stu-id="0744f-224">However, certain data Web control features are sensitive to the data source control being used or to the data source control s configuration.</span></span>

<span data-ttu-id="0744f-225">Na przykład w [wydajnie stronicowania za pośrednictwem dużych ilości danych](../paging-and-sorting/efficiently-paging-through-large-amounts-of-data-vb.md) samouczku omówiono, jak to zrobić, domyślnie logikę stronicowania danych sieci Web kontrolki naively zwraca *wszystkie* rekordy z podstawową źródła danych, a następnie wyświetla tylko odpowiednie podzestaw indeks bieżącej strony i liczbie rekordów wyświetlanych na każdej stronie.</span><span class="sxs-lookup"><span data-stu-id="0744f-225">For example, in the [Efficiently Paging Through Large Amounts of Data](../paging-and-sorting/efficiently-paging-through-large-amounts-of-data-vb.md) tutorial we discussed how, by default, the paging logic for the data Web controls naively returns *all* records from the underlying data source and then displays only the appropriate subset of records given the current page index and the number of records to display per page.</span></span> <span data-ttu-id="0744f-226">Ten model jest bardzo mało wydajne, gdy stronicowania za pośrednictwem wystarczająco dużych zestawów wyników.</span><span class="sxs-lookup"><span data-stu-id="0744f-226">This model is highly inefficient when paging through sufficiently large result sets.</span></span> <span data-ttu-id="0744f-227">Na szczęście ObjectDataSource można skonfigurować do obsługi stronicowania niestandardowego, która zwraca dokładne podzbiór rekordów do wyświetlenia.</span><span class="sxs-lookup"><span data-stu-id="0744f-227">Fortunately, the ObjectDataSource can be configured to support custom paging, which returns only the precise subset of records to display.</span></span> <span data-ttu-id="0744f-228">SqlDataSource formantu, jednak nie ma właściwości Implementowanie stronicowania niestandardowego.</span><span class="sxs-lookup"><span data-stu-id="0744f-228">The SqlDataSource control, however, lacks the properties for implementing custom paging.</span></span>

<span data-ttu-id="0744f-229">Inny subtlety stronicowania i sortowania wynika z SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="0744f-229">Another subtlety with paging and sorting arises with the SqlDataSource.</span></span> <span data-ttu-id="0744f-230">Domyślnie dane zwrócone z elementu SqlDataSource można stronicowanej lub sortowane w widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="0744f-230">By default, the data returned from a SqlDataSource can be paged or sorted through the GridView.</span></span> <span data-ttu-id="0744f-231">Aby to wykazać, sprawdź opcje włączyć stronicowanie i Włącz sortowania w widoku GridView s tagu w `Querying.aspx` i sprawdź, czy działa zgodnie z oczekiwaniami.</span><span class="sxs-lookup"><span data-stu-id="0744f-231">To demonstrate this, check the Enable Paging and Enable Sorting options in the GridView s smart tag in `Querying.aspx` and verify that this works as expected.</span></span>

<span data-ttu-id="0744f-232">Sortowanie i stronicowanie działa, ponieważ SqlDataSource pobiera danych w bazie danych do typowaniem luźnym zestawu danych.</span><span class="sxs-lookup"><span data-stu-id="0744f-232">Sorting and paging works because the SqlDataSource retrieves the database data into a loosely-typed DataSet.</span></span> <span data-ttu-id="0744f-233">Całkowita liczba rekordów zwróconych przez kwerendę ważnym aspektem do implementowania stronicowania można ustalić z zestawu danych.</span><span class="sxs-lookup"><span data-stu-id="0744f-233">The total number of records returned by the query an essential aspect to implementing paging can be ascertained from the DataSet.</span></span> <span data-ttu-id="0744f-234">Ponadto można sortować wyniki s zestawu danych za pośrednictwem widoku danych.</span><span class="sxs-lookup"><span data-stu-id="0744f-234">Additionally, the DataSet s results can be sorted through a DataView.</span></span> <span data-ttu-id="0744f-235">Te możliwości są automatycznie używane przez SqlDataSource podczas żądania GridView stronicowanej lub posortowane dane.</span><span class="sxs-lookup"><span data-stu-id="0744f-235">These capabilities are automatically used by the SqlDataSource when the GridView requests paged or sorted data.</span></span>

<span data-ttu-id="0744f-236">SqlDataSource można skonfigurować do zwracania DataReader zamiast zestawu danych, zmieniając jej [ `DataSourceMode` właściwości](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.datasourcemode.aspx) z `DataSet` (ustawienie domyślne) do `DataReader`.</span><span class="sxs-lookup"><span data-stu-id="0744f-236">The SqlDataSource can be configured to return a DataReader instead of a DataSet by changing its [`DataSourceMode` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.datasourcemode.aspx) from `DataSet` (the default) to `DataReader`.</span></span> <span data-ttu-id="0744f-237">Może być preferowane przy użyciu elementu DataReader w sytuacjach podczas przekazywania wyników s SqlDataSource do istniejącego kodu, która oczekuje elementu DataReader.</span><span class="sxs-lookup"><span data-stu-id="0744f-237">Using a DataReader might be preferred in situations when passing the SqlDataSource s results to existing code that expects a DataReader.</span></span> <span data-ttu-id="0744f-238">Ponadto ponieważ DataReaders obiektów znacznie prostsze niż zestawów danych, oferują lepszą wydajność.</span><span class="sxs-lookup"><span data-stu-id="0744f-238">Furthermore, since DataReaders are considerably simpler objects than DataSets, they offer better performance.</span></span> <span data-ttu-id="0744f-239">Jeśli wprowadzisz tej zmiany, jednak kontroli danych w sieci Web nie można sortować ani strony, ponieważ SqlDataSource nie można ustalić liczbę rekordów są zwracane przez zapytanie, ani nie elementu DataReader oferuje wszystkie techniki sortowanie zwróconych danych.</span><span class="sxs-lookup"><span data-stu-id="0744f-239">If you make this change, however, the data Web control can neither sort nor page since the SqlDataSource cannot ascertain how many records are returned by the query, nor does the DataReader offer any techniques for sorting the returned data.</span></span>

## <a name="step-4-using-a-custom-sql-statement-or-stored-procedure"></a><span data-ttu-id="0744f-240">Krok 4: Używanie instrukcji SQL niestandardowe lub procedury składowanej</span><span class="sxs-lookup"><span data-stu-id="0744f-240">Step 4: Using a Custom SQL Statement or Stored Procedure</span></span>

<span data-ttu-id="0744f-241">Podczas konfigurowania kontroli SqlDataSource, zapytanie zwraca dane można określić w jednym z dwóch metod jako niestandardową instrukcję SQL lub procedurę składowaną lub kolumny z istniejącej tabeli lub widoku.</span><span class="sxs-lookup"><span data-stu-id="0744f-241">When configuring the SqlDataSource control, the query used to return data can be specified in one of two approaches as a custom SQL statement or stored procedure, or as columns from an existing table or view.</span></span> <span data-ttu-id="0744f-242">W kroku 2, możemy się zbadana wybranie kolumn z `Products` tabeli.</span><span class="sxs-lookup"><span data-stu-id="0744f-242">In Step 2 we examined selecting columns from the `Products` table.</span></span> <span data-ttu-id="0744f-243">Let s przyjrzeć się przy użyciu niestandardowych instrukcji SQL.</span><span class="sxs-lookup"><span data-stu-id="0744f-243">Let s look at using a custom SQL statement.</span></span>

<span data-ttu-id="0744f-244">Dodaj inny formant widoku GridView `Querying.aspx` strony i wybrać opcję utworzenia nowego źródła danych z listy rozwijanej w tagu.</span><span class="sxs-lookup"><span data-stu-id="0744f-244">Add another GridView control to the `Querying.aspx` page and choose to create a new data source from the drop-down list in the smart tag.</span></span> <span data-ttu-id="0744f-245">Następnie wskazać, że dane będą pobrania z bazy danych to spowoduje utworzenie nowej kontrolki SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="0744f-245">Next, indicate that the data will be pulled from a database this will create a new SqlDataSource control.</span></span> <span data-ttu-id="0744f-246">Nazwa kontrolki `ProductsWithCategoryInfoDataSource`.</span><span class="sxs-lookup"><span data-stu-id="0744f-246">Name the control `ProductsWithCategoryInfoDataSource`.</span></span>


![Tworzenie formantu SqlDataSource o nazwie ProductsWithCategoryInfoDataSource](querying-data-with-the-sqldatasource-control-vb/_static/image18.gif)

<span data-ttu-id="0744f-248">**Rysunek 12**: Tworzenie formantu SqlDataSource o nazwie `ProductsWithCategoryInfoDataSource`</span><span class="sxs-lookup"><span data-stu-id="0744f-248">**Figure 12**: Create a New SqlDataSource Control Named `ProductsWithCategoryInfoDataSource`</span></span>


<span data-ttu-id="0744f-249">Następnym ekranie zapyta firmie Microsoft w celu określenia bazy danych.</span><span class="sxs-lookup"><span data-stu-id="0744f-249">The next screen asks us to specify the database.</span></span> <span data-ttu-id="0744f-250">Wybierz jak robiliśmy wstecz na rysunku 7 `NORTHWINDConnectionString` z listy rozwijanej liście i kliknij przycisk Dalej.</span><span class="sxs-lookup"><span data-stu-id="0744f-250">As we did back in Figure 7, select the `NORTHWINDConnectionString` from the drop-down list and click Next.</span></span> <span data-ttu-id="0744f-251">W konfiguracji ekranu instrukcji Select wybierz Określ niestandardową instrukcję SQL lub procedurę składowaną przycisku radiowego, a następnie kliknij przycisk Dalej.</span><span class="sxs-lookup"><span data-stu-id="0744f-251">In the Configure the Select Statement screen, choose the Specify a custom SQL statement or stored procedure radio button and click Next.</span></span> <span data-ttu-id="0744f-252">Pojawi się ekran zdefiniować instrukcje niestandardowe lub procedury składowane, który oferuje zakładki SELECT, INSERT, UPDATE i DELETE.</span><span class="sxs-lookup"><span data-stu-id="0744f-252">This will bring up the Define Custom Statements or Stored Procedures screen, which offers tabs labeled SELECT, UPDATE, INSERT, and DELETE.</span></span> <span data-ttu-id="0744f-253">Na każdej karcie można wprowadzić niestandardową instrukcję SQL w pole tekstowe lub wybierz procedurę składowaną z listy rozwijanej.</span><span class="sxs-lookup"><span data-stu-id="0744f-253">In each tab you can enter a custom SQL statement into the textbox or choose a stored procedure from the drop-down list.</span></span> <span data-ttu-id="0744f-254">W tym samouczku przedstawiono wprowadzanie niestandardową instrukcję SQL; Następny samouczek zawiera przykład, w którym korzysta z procedury składowanej.</span><span class="sxs-lookup"><span data-stu-id="0744f-254">In this tutorial we will look at entering a custom SQL statement; the next tutorial includes an example that uses a stored procedure.</span></span>


![Wprowadź instrukcję SQL niestandardowych lub wybierz procedurę składowaną](querying-data-with-the-sqldatasource-control-vb/_static/image19.gif)

<span data-ttu-id="0744f-256">**Rysunek 13**: wprowadź instrukcję SQL niestandardowych lub wybierz procedurę składowaną</span><span class="sxs-lookup"><span data-stu-id="0744f-256">**Figure 13**: Enter a Custom SQL Statement or Pick a Stored Procedure</span></span>


<span data-ttu-id="0744f-257">Niestandardową instrukcję SQL można wprowadzić ręcznie do kontrolki textbox lub być skonstruowany w postaci graficznej przez kliknięcie przycisku konstruktora zapytań.</span><span class="sxs-lookup"><span data-stu-id="0744f-257">The custom SQL statement can be entered by hand into the textbox or can be constructed graphically by clicking the Query Builder button.</span></span> <span data-ttu-id="0744f-258">Konstruktor kwerend lub pole tekstowe, użyj następującego zapytania, aby powrócić `ProductID` i `ProductName` pola z `Products` tabeli, używając `JOIN` można pobrać produktu s `CategoryName` z `Categories` tabeli:</span><span class="sxs-lookup"><span data-stu-id="0744f-258">From either the Query Builder or the textbox, use the following query to return the `ProductID` and `ProductName` fields from the `Products` table using a `JOIN` to retrieve the product s `CategoryName` from the `Categories` table:</span></span>


[!code-sql[Main](querying-data-with-the-sqldatasource-control-vb/samples/sample4.sql)]


![Graficznie tworzenia zapytania za pomocą konstruktora zapytań](querying-data-with-the-sqldatasource-control-vb/_static/image20.gif)

<span data-ttu-id="0744f-260">**Rysunek 14**: można skonstruować graficznie zapytania przy użyciu konstruktora zapytań</span><span class="sxs-lookup"><span data-stu-id="0744f-260">**Figure 14**: You can Graphically Construct the Query Using the Query Builder</span></span>


<span data-ttu-id="0744f-261">Po określeniu zapytanie, kliknij przycisk Dalej, aby przejść do ekranu zapytania testu.</span><span class="sxs-lookup"><span data-stu-id="0744f-261">After specifying the query, click Next to proceed to the Test Query screen.</span></span> <span data-ttu-id="0744f-262">Kliknij przycisk Zakończ, aby zakończyć pracę kreatora SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="0744f-262">Click Finish to complete the SqlDataSource wizard.</span></span>

<span data-ttu-id="0744f-263">Po zakończeniu działania kreatora widoku GridView będzie mieć trzy BoundFields dodane do niego wyświetlanie `ProductID`, `ProductName`, i `CategoryName` kolumny zwróconych przez kwerendę i spowodować, że następujące deklaratywne znaczników:</span><span class="sxs-lookup"><span data-stu-id="0744f-263">After completing the wizard, the GridView will have three BoundFields added to it displaying the `ProductID`, `ProductName`, and `CategoryName` columns returned from the query and resulting in the following declarative markup:</span></span>


[!code-aspx[Main](querying-data-with-the-sqldatasource-control-vb/samples/sample5.aspx)]


<span data-ttu-id="0744f-264">[![Każdy identyfikator produktu s Nazwa kategorii nazwę i skojarzone pokazuje widoku GridView](querying-data-with-the-sqldatasource-control-vb/_static/image22.gif)](querying-data-with-the-sqldatasource-control-vb/_static/image21.gif)</span><span class="sxs-lookup"><span data-stu-id="0744f-264">[![The GridView Shows Each Product s ID, Name, and Associated Category Name](querying-data-with-the-sqldatasource-control-vb/_static/image22.gif)](querying-data-with-the-sqldatasource-control-vb/_static/image21.gif)</span></span>

<span data-ttu-id="0744f-265">**Rysunek 15**: identyfikator s GridView przedstawia każdego produktu, nazwa i nazwa kategorii skojarzona ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](querying-data-with-the-sqldatasource-control-vb/_static/image23.gif))</span><span class="sxs-lookup"><span data-stu-id="0744f-265">**Figure 15**: The GridView Shows Each Product s ID, Name, and Associated Category Name ([Click to view full-size image](querying-data-with-the-sqldatasource-control-vb/_static/image23.gif))</span></span>


## <a name="summary"></a><span data-ttu-id="0744f-266">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="0744f-266">Summary</span></span>

<span data-ttu-id="0744f-267">W tym samouczku widzieliśmy jak wykonywać zapytania i wyświetlać dane za pomocą kontroli SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="0744f-267">In this tutorial we saw how to query and display data using the SqlDataSource control.</span></span> <span data-ttu-id="0744f-268">Podobnie jak ObjectDataSource SqlDataSource służy jako serwer proxy, zapewniając deklaratywne podejście do uzyskiwania dostępu do danych.</span><span class="sxs-lookup"><span data-stu-id="0744f-268">Like the ObjectDataSource, the SqlDataSource serves as a proxy, providing a declarative approach to accessing data.</span></span> <span data-ttu-id="0744f-269">Określ właściwości bazy danych, aby nawiązać połączenie i SQL `SELECT` kwerendy można wykonać; można można określić za pomocą okna właściwości lub za pomocą Kreatora konfigurowania źródła danych.</span><span class="sxs-lookup"><span data-stu-id="0744f-269">Its properties specify the database to connect to and the SQL `SELECT` query to execute; they can be specified through the Properties window or by using the Configure DataSource wizard.</span></span>

<span data-ttu-id="0744f-270">`SELECT` Przykłady zapytania możemy się zbadana w tym samouczku zwrócone wszystkie rekordy z określonego zapytania.</span><span class="sxs-lookup"><span data-stu-id="0744f-270">The `SELECT` query examples we examined in this tutorial returned all of the records from the specified query.</span></span> <span data-ttu-id="0744f-271">Formant SqlDataSource, jednak mogą obejmować `WHERE` klauzuli z parametrami, których wartości są przypisane programistycznie lub są automatycznie pobierane z określonego źródła.</span><span class="sxs-lookup"><span data-stu-id="0744f-271">The SqlDataSource control, however, can include a `WHERE` clause with parameters whose values are assigned programmatically or are automatically pulled from a specified source.</span></span> <span data-ttu-id="0744f-272">Zajmiemy się sposobu tworzenia i używania sparametryzowanych zapytań w następnym samouczku!</span><span class="sxs-lookup"><span data-stu-id="0744f-272">We'll examine how to create and use parameterized queries in the next tutorial!</span></span>

<span data-ttu-id="0744f-273">Programowanie przyjemność!</span><span class="sxs-lookup"><span data-stu-id="0744f-273">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="0744f-274">Dalsze informacje</span><span class="sxs-lookup"><span data-stu-id="0744f-274">Further Reading</span></span>

<span data-ttu-id="0744f-275">Więcej informacji dotyczących tematów omówionych w tym samouczku można znaleźć w następujących zasobach:</span><span class="sxs-lookup"><span data-stu-id="0744f-275">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="0744f-276">Uzyskiwanie dostępu do danych relacyjnych baz danych</span><span class="sxs-lookup"><span data-stu-id="0744f-276">Accessing Relational Database Data</span></span>](http://aspnet.4guysfromrolla.com/articles/022206-1.aspx)
- [<span data-ttu-id="0744f-277">Informacje o formancie SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="0744f-277">SqlDataSource Control Overview</span></span>](https://msdn.microsoft.com/library/dz12d98w.aspx)
- [<span data-ttu-id="0744f-278">Samouczki platformy ASP.NET — Szybki Start: SqlDataSource formantu</span><span class="sxs-lookup"><span data-stu-id="0744f-278">ASP.NET Quickstart Tutorials: The SqlDataSource Control</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/data/sqldatasource.aspx)
- [<span data-ttu-id="0744f-279">Pliku Web.config `<connectionStrings>` — Element</span><span class="sxs-lookup"><span data-stu-id="0744f-279">The Web.config `<connectionStrings>` Element</span></span>](https://msdn.microsoft.com/library/bf7sd233.aspx)
- [<span data-ttu-id="0744f-280">Odwołanie do ciągu połączenia bazy danych</span><span class="sxs-lookup"><span data-stu-id="0744f-280">Database Connection String Reference</span></span>](http://www.connectionstrings.com/)

## <a name="about-the-author"></a><span data-ttu-id="0744f-281">Informacje o autorze</span><span class="sxs-lookup"><span data-stu-id="0744f-281">About the Author</span></span>

<span data-ttu-id="0744f-282">[Scott Bento](http://www.4guysfromrolla.com/ScottMitchell.shtml), autora siedmiu książek ASP/ASP.NET i twórcę z [4GuysFromRolla.com](http://www.4guysfromrolla.com), pracuje z technologii Microsoft Web od 1998.</span><span class="sxs-lookup"><span data-stu-id="0744f-282">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="0744f-283">Scott działa jako niezależnego konsultanta trainer i składnika zapisywania.</span><span class="sxs-lookup"><span data-stu-id="0744f-283">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="0744f-284">Jest jego najnowszej książki [ *Sams nauczyć się ASP.NET 2.0 w ciągu 24 godzin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="0744f-284">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="0744f-285">Piotr można uzyskać pod adresem [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) lub za pośrednictwem jego blog, który znajduje się w temacie [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="0744f-285">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="0744f-286">Specjalne podziękowania dla</span><span class="sxs-lookup"><span data-stu-id="0744f-286">Special Thanks To</span></span>

<span data-ttu-id="0744f-287">Ten samouczek serii zostało sprawdzone przez wiele recenzentów przydatne.</span><span class="sxs-lookup"><span data-stu-id="0744f-287">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="0744f-288">Prowadzić osób dokonujących przeglądu, w tym samouczku zostały Susan Connery Bernadette Leigh i Suru Dominika.</span><span class="sxs-lookup"><span data-stu-id="0744f-288">Lead reviewers for this tutorial were Susan Connery, Bernadette Leigh, and David Suru.</span></span> <span data-ttu-id="0744f-289">Zainteresowani recenzowania Moje nadchodzących artykuły MSDN?</span><span class="sxs-lookup"><span data-stu-id="0744f-289">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="0744f-290">Jeśli tak, Porzuć mnie linii w [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="0744f-290">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="0744f-291">[Poprzednie](implementing-optimistic-concurrency-with-the-sqldatasource-cs.md)
> [dalej](using-parameterized-queries-with-the-sqldatasource-vb.md)</span><span class="sxs-lookup"><span data-stu-id="0744f-291">[Previous](implementing-optimistic-concurrency-with-the-sqldatasource-cs.md)
[Next](using-parameterized-queries-with-the-sqldatasource-vb.md)</span></span>
