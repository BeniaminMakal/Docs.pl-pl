---
uid: aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/the-fix-it-sample-application
title: 'Dodatek: Poprawkę go aplikacji przykładowej (Tworzenie aplikacji w chmurze rzeczywistych z platformy Azure) | Dokumentacja firmy Microsoft'
author: MikeWasson
description: Kompilowanie rzeczywistych World aplikacje w chmurze z Azure Książka elektroniczna jest oparta na prezentacji opracowane przez Scott Guthrie. Wyjaśniono 13 wzorców i rozwiązań, które może on...
ms.author: aspnetcontent
manager: wpickett
ms.date: 06/12/2014
ms.topic: article
ms.assetid: 1bc333c5-f096-4ea7-b170-779accc21c1a
ms.technology: ''
ms.prod: .net-framework
msc.legacyurl: /aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/the-fix-it-sample-application
msc.type: authoredcontent
ms.openlocfilehash: 9a1fa36b34c4783b101bb27bc6931241e9251e10
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/06/2018
ms.locfileid: "30876478"
---
<a name="appendix-the-fix-it-sample-application-building-real-world-cloud-apps-with-azure"></a><span data-ttu-id="c8a92-104">Dodatek: Poprawkę go aplikacji przykładowej (Tworzenie aplikacji w chmurze rzeczywistych z platformy Azure)</span><span class="sxs-lookup"><span data-stu-id="c8a92-104">Appendix: The Fix It Sample Application (Building Real-World Cloud Apps with Azure)</span></span>
====================
<span data-ttu-id="c8a92-105">przez [Wasson Jan](https://github.com/MikeWasson), [Rick Anderson](https://github.com/Rick-Anderson), [Dykstra niestandardowy](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="c8a92-105">by [Mike Wasson](https://github.com/MikeWasson), [Rick Anderson](https://github.com/Rick-Anderson), [Tom Dykstra](https://github.com/tdykstra)</span></span>

[<span data-ttu-id="c8a92-106">Pobierz napraw go projektu</span><span class="sxs-lookup"><span data-stu-id="c8a92-106">Download The Fix It Project</span></span>](http://code.msdn.microsoft.com/Fix-It-app-for-Building-cdd80df4)

> <span data-ttu-id="c8a92-107">**Tworzenia rzeczywistych aplikacji w chmurze platformy Azure** Książka elektroniczna opiera się na prezentacji opracowane przez Scott Guthrie.</span><span class="sxs-lookup"><span data-stu-id="c8a92-107">The **Building Real World Cloud Apps with Azure** e-book is based on a presentation developed by Scott Guthrie.</span></span> <span data-ttu-id="c8a92-108">Wyjaśniono 13 wzorców i wskazówki, które mogą pomóc Ci się pomyślnie, tworzenie aplikacji sieci web dla chmury.</span><span class="sxs-lookup"><span data-stu-id="c8a92-108">It explains 13 patterns and practices that can help you be successful developing web apps for the cloud.</span></span> <span data-ttu-id="c8a92-109">Informacje o Książka elektroniczna, zobacz [pierwszy rozdział](introduction.md).</span><span class="sxs-lookup"><span data-stu-id="c8a92-109">For information about the e-book, see [the first chapter](introduction.md).</span></span>


<span data-ttu-id="c8a92-110">Ten dodatek do tworzenia rzeczywistych aplikacji w chmurze z Azure e-book zawiera następujące sekcje, które zapewniają dodatkowe informacje na temat poprawka przykładowej aplikacji, którą można pobrać:</span><span class="sxs-lookup"><span data-stu-id="c8a92-110">This appendix to the Building Real World Cloud Apps with Azure e-book contains the following sections that provide additional information about the Fix It sample application that you can download:</span></span>

- [<span data-ttu-id="c8a92-111">Znane problemy</span><span class="sxs-lookup"><span data-stu-id="c8a92-111">Known issues</span></span>](#knownissues)
- [<span data-ttu-id="c8a92-112">Najlepsze praktyki</span><span class="sxs-lookup"><span data-stu-id="c8a92-112">Best practices</span></span>](#bestpractices)
- [<span data-ttu-id="c8a92-113">Jak uruchomić aplikację w programie Visual Studio na komputerze lokalnym</span><span class="sxs-lookup"><span data-stu-id="c8a92-113">How to run the app from Visual Studio on your local computer</span></span>](#run-in-vs)
- [<span data-ttu-id="c8a92-114">Sposób wdrażania podstawowej aplikacji do aplikacji sieci Web usługi aplikacji Azure za pomocą skryptów środowiska Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="c8a92-114">How to deploy the base app to Azure App Service Web Apps by using the Windows PowerShell scripts</span></span>](#deploybase)
- [<span data-ttu-id="c8a92-115">Rozwiązywanie problemów w skryptach środowiska Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="c8a92-115">Troubleshooting the Windows PowerShell scripts</span></span>](#troubleshooting)
- [<span data-ttu-id="c8a92-116">Jak wdrożyć aplikację z kolejką przetwarzania do aplikacji sieci Web usługi aplikacji Azure i usługi w chmurze platformy Azure</span><span class="sxs-lookup"><span data-stu-id="c8a92-116">How to deploy the app with queue processing to Azure App Service Web Apps and an Azure Cloud Service</span></span>](#deployqueues)

<a id="knownissues"></a>
## <a name="known-issues"></a><span data-ttu-id="c8a92-117">Znane problemy</span><span class="sxs-lookup"><span data-stu-id="c8a92-117">Known issues</span></span>

<span data-ttu-id="c8a92-118">Aby zilustrować ułatwianiu niektóre wzorce przedstawionych w tym Książka elektroniczna opracowany z aplikacji Usuń.</span><span class="sxs-lookup"><span data-stu-id="c8a92-118">The Fix It app was originally developed in order to illustrate as simply as possible some of the patterns presented in this e-book.</span></span> <span data-ttu-id="c8a92-119">Jednak ponieważ Książka elektroniczna o tworzeniu aplikacji rzeczywistych, możemy poddane kodu napraw przeglądu i proces testowania, podobnie jak co możemy sposób jak wydanego oprogramowania.</span><span class="sxs-lookup"><span data-stu-id="c8a92-119">However, since the e-book is about building real-world apps, we subjected the Fix It code to a review and testing process similar to what we'd do for released software.</span></span> <span data-ttu-id="c8a92-120">Znaleziono wiele problemów, a tak jak w przypadku dowolnej aplikacji rzeczywistych niektóre z nich usunięto i niektóre z nich, możemy odłożone do nowszej wersji.</span><span class="sxs-lookup"><span data-stu-id="c8a92-120">We found a number of issues, and as with any real-world application, some of them we fixed and some of them we deferred to a later release.</span></span>

<span data-ttu-id="c8a92-121">Poniżej opisano problemy, które powinny być kierowane w aplikacji produkcyjnej, ale w jednym z powodów lub innego zdecydowaliśmy się nie na adres w wersji początkowej poprawka przykładowej aplikacji.</span><span class="sxs-lookup"><span data-stu-id="c8a92-121">The following list includes issues that should be addressed in a production application, but for one reason or another we decided not to address in the initial release of the Fix It sample application.</span></span>

### <a name="security"></a><span data-ttu-id="c8a92-122">Zabezpieczenia</span><span class="sxs-lookup"><span data-stu-id="c8a92-122">Security</span></span>

- <span data-ttu-id="c8a92-123">Upewnij się, że nie można przypisać zadania do właściciela nie istnieje.</span><span class="sxs-lookup"><span data-stu-id="c8a92-123">Ensure that you can't assign a task to a non-existent owner.</span></span>
- <span data-ttu-id="c8a92-124">Upewnij się, że można tylko przeglądać i modyfikować zadania utworzone lub są przypisane do Ciebie.</span><span class="sxs-lookup"><span data-stu-id="c8a92-124">Ensure that you can only view and modify tasks that you created or are assigned to you.</span></span>
- <span data-ttu-id="c8a92-125">Stron logowania i plików cookie uwierzytelniania jest używany protokół HTTPS.</span><span class="sxs-lookup"><span data-stu-id="c8a92-125">Use HTTPS for sign-in pages and authentication cookies.</span></span>
- <span data-ttu-id="c8a92-126">Określ limit czasu plików cookie uwierzytelniania.</span><span class="sxs-lookup"><span data-stu-id="c8a92-126">Specify a time limit for authentication cookies.</span></span>

### <a name="input-validation"></a><span data-ttu-id="c8a92-127">Sprawdzania poprawności danych wejściowych</span><span class="sxs-lookup"><span data-stu-id="c8a92-127">Input validation</span></span>

<span data-ttu-id="c8a92-128">Ogólnie rzecz biorąc, sposób jak aplikacji produkcyjnej więcej wejściowych niż aplikacji Usuń sprawdzania poprawności.</span><span class="sxs-lookup"><span data-stu-id="c8a92-128">In general, a production app would do more input validation than the Fix It app.</span></span> <span data-ttu-id="c8a92-129">Przykładowo rozmiar obrazu / dozwoloną dla przekazywania powinna być ograniczona rozmiar pliku obrazu.</span><span class="sxs-lookup"><span data-stu-id="c8a92-129">For example, the image size / image file size allowed for upload should be limited.</span></span>

### <a name="administrator-functionality"></a><span data-ttu-id="c8a92-130">Administrator funkcji</span><span class="sxs-lookup"><span data-stu-id="c8a92-130">Administrator functionality</span></span>

<span data-ttu-id="c8a92-131">Administrator powinien móc zmienić własności na istniejące zadania.</span><span class="sxs-lookup"><span data-stu-id="c8a92-131">An administrator should be able to change ownership on existing tasks.</span></span> <span data-ttu-id="c8a92-132">Na przykład twórca zadania mogą pozostać firmy, pozostawiając nikt z urzędem, aby zachować zadanie, jeśli nie włączono dostępu administracyjnego.</span><span class="sxs-lookup"><span data-stu-id="c8a92-132">For example, the creator of a task might leave the company, leaving no one with authority to maintain the task unless administrative access is enabled.</span></span>

### <a name="queue-message-processing"></a><span data-ttu-id="c8a92-133">Przetwarzanie komunikatów z kolejki</span><span class="sxs-lookup"><span data-stu-id="c8a92-133">Queue message processing</span></span>

<span data-ttu-id="c8a92-134">Komunikat z kolejki przetwarzania w aplikacji Usuń został opracowany jako proste w celu zilustrowania wzorzec skoncentrowane kolejki pracy z minimalną ilością kodu.</span><span class="sxs-lookup"><span data-stu-id="c8a92-134">Queue message processing in the Fix It app was designed to be simple in order to illustrate the queue-centric work pattern with a minimum amount of code.</span></span> <span data-ttu-id="c8a92-135">Ten prosty kod nie są odpowiednie dla aplikacji rzeczywistej produkcji.</span><span class="sxs-lookup"><span data-stu-id="c8a92-135">This simple code would not be adequate for an actual production application.</span></span>

- <span data-ttu-id="c8a92-136">Kod nie gwarantuje co najwyżej raz przetwarzania każdego komunikatu w kolejce.</span><span class="sxs-lookup"><span data-stu-id="c8a92-136">The code does not guarantee that each queue message will be processed at most once.</span></span> <span data-ttu-id="c8a92-137">Gdy pojawi się komunikat z kolejki, istnieje limit czasu, w którym jest niewidoczny dla innych odbiorników kolejki wiadomości.</span><span class="sxs-lookup"><span data-stu-id="c8a92-137">When you get a message from the queue, there is a timeout period, during which the message is invisible to other queue listeners.</span></span> <span data-ttu-id="c8a92-138">Limit czasu wygaśnięcia przed usunięciem komunikatu, komunikat staje się widoczna ponownie.</span><span class="sxs-lookup"><span data-stu-id="c8a92-138">If the timeout expires before the message is deleted, the message becomes visible again.</span></span> <span data-ttu-id="c8a92-139">W związku z tym jeśli wystąpienie roli procesu roboczego zużywa dużo czasu przetwarzania komunikatu, prawdopodobnie teoretycznie dla tego samego komunikatu na przetworzenie dwa razy, co zduplikowane zadania w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="c8a92-139">Therefore, if a worker role instance spends a long time processing a message, it is theoretically possible for the same message to get processed twice, resulting in a duplicate task in the database.</span></span> <span data-ttu-id="c8a92-140">Aby uzyskać więcej informacji na temat tego problemu, zobacz [przy użyciu kolejki magazynu Azure](https://msdn.microsoft.com/library/ff803365.aspx#sec7).</span><span class="sxs-lookup"><span data-stu-id="c8a92-140">For more information about this issue, see [Using Azure Storage Queues](https://msdn.microsoft.com/library/ff803365.aspx#sec7).</span></span>
- <span data-ttu-id="c8a92-141">Logika sondowania kolejki może być bardziej ekonomiczne rozwiązanie przez przetwarzanie wsadowe pobieranie wiadomości.</span><span class="sxs-lookup"><span data-stu-id="c8a92-141">The queue polling logic could be more cost-effective, by batching message retrieval.</span></span> <span data-ttu-id="c8a92-142">Za każdym razem, gdy jest wywoływana [CloudQueue.GetMessageAsync](https://msdn.microsoft.com/library/microsoft.windowsazure.storage.queue.cloudqueue.getmessageasync.aspx), brak kosztów transakcji.</span><span class="sxs-lookup"><span data-stu-id="c8a92-142">Every time you call [CloudQueue.GetMessageAsync](https://msdn.microsoft.com/library/microsoft.windowsazure.storage.queue.cloudqueue.getmessageasync.aspx), there is a transaction cost.</span></span> <span data-ttu-id="c8a92-143">Zamiast tego można wywołać [CloudQueue.GetMessagesAsync](https://msdn.microsoft.com/library/microsoft.windowsazure.storage.queue.cloudqueue.getmessagesasync.aspx) (należy zwrócić uwagę na liczbę mnogą "), która pobiera wiele komunikatów w ramach jednej transakcji.</span><span class="sxs-lookup"><span data-stu-id="c8a92-143">Instead, you can call [CloudQueue.GetMessagesAsync](https://msdn.microsoft.com/library/microsoft.windowsazure.storage.queue.cloudqueue.getmessagesasync.aspx) (note the plural 's'), which gets multiple messages in a single transaction.</span></span> <span data-ttu-id="c8a92-144">Koszty transakcji dla kolejek magazynu Azure są bardzo niskie, więc nie jest znaczny, w większości przypadków wpływ na koszty.</span><span class="sxs-lookup"><span data-stu-id="c8a92-144">The transaction costs for Azure Storage Queues are very low, so the impact on costs is not substantial in most scenarios.</span></span>
- <span data-ttu-id="c8a92-145">Ścisłej pętli w kodzie przetwarzania komunikatów kolejki powoduje, że koligacji procesora CPU, który nie korzysta z maszyn wirtualnych w wielordzeniowych wydajnie.</span><span class="sxs-lookup"><span data-stu-id="c8a92-145">The tight loop in the queue message-processing code causes CPU affinity, which does not utilize multi-core VMs efficiently.</span></span> <span data-ttu-id="c8a92-146">Lepszego projektowania użyje równoległość zadań, aby równolegle wielu zadań asynchronicznych.</span><span class="sxs-lookup"><span data-stu-id="c8a92-146">A better design would use task parallelism to run several async tasks in parallel.</span></span>
- <span data-ttu-id="c8a92-147">Przetwarzanie komunikatów w kolejce ma tylko podstawowe wyjątków.</span><span class="sxs-lookup"><span data-stu-id="c8a92-147">Queue message-processing has only rudimentary exception handling.</span></span> <span data-ttu-id="c8a92-148">Na przykład kod nie obsługuje [zanieczyszczonych komunikatów](https://msdn.microsoft.com/library/ms789028.aspx).</span><span class="sxs-lookup"><span data-stu-id="c8a92-148">For example, the code doesn't handle [poison messages](https://msdn.microsoft.com/library/ms789028.aspx).</span></span> <span data-ttu-id="c8a92-149">(Podczas przetwarzania komunikatu powoduje zgłoszenie wyjątku, trzeba błąd i usuwanie wiadomości, lub roli proces roboczy spróbuje ponownie przetworzyć, i pętli będzie nieskończoność.)</span><span class="sxs-lookup"><span data-stu-id="c8a92-149">(When message processing causes an exception, you have to log the error and delete the message, or the worker role will try to process it again, and the loop will continue indefinitely.)</span></span>

### <a name="sql-queries-are-unbounded"></a><span data-ttu-id="c8a92-150">Zapytania SQL są niepowiązanego</span><span class="sxs-lookup"><span data-stu-id="c8a92-150">SQL queries are unbounded</span></span>

<span data-ttu-id="c8a92-151">Poprawka kodu bieżącej umieszcza limitu na liczbę wierszy, które mogą zwracać zapytania dla indeksu strony.</span><span class="sxs-lookup"><span data-stu-id="c8a92-151">Current Fix It code places no limit on how many rows the queries for Index pages might return.</span></span> <span data-ttu-id="c8a92-152">W przypadku dużej liczby zadań jest wprowadzany do bazy danych, rozmiaru list Odebrano może spowodować problemy z wydajnością.</span><span class="sxs-lookup"><span data-stu-id="c8a92-152">If a large volume of tasks is entered into the database, the size of the resulting lists received could cause performance issues.</span></span> <span data-ttu-id="c8a92-153">To rozwiązanie do implementowania stronicowania.</span><span class="sxs-lookup"><span data-stu-id="c8a92-153">The solution is to implement paging.</span></span> <span data-ttu-id="c8a92-154">Na przykład zobacz [sortowanie, filtrowanie i stronicowania Entity Framework w aplikacji platformy ASP.NET MVC](../../../../mvc/overview/getting-started/getting-started-with-ef-using-mvc/sorting-filtering-and-paging-with-the-entity-framework-in-an-asp-net-mvc-application.md).</span><span class="sxs-lookup"><span data-stu-id="c8a92-154">For an example, see [Sorting, Filtering, and Paging with the Entity Framework in an ASP.NET MVC Application](../../../../mvc/overview/getting-started/getting-started-with-ef-using-mvc/sorting-filtering-and-paging-with-the-entity-framework-in-an-asp-net-mvc-application.md).</span></span>

### <a name="view-models-recommended"></a><span data-ttu-id="c8a92-155">Wyświetlanie modeli zalecane</span><span class="sxs-lookup"><span data-stu-id="c8a92-155">View models recommended</span></span>

<span data-ttu-id="c8a92-156">Aplikacja napraw używa klasy jednostki FixItTask do przekazywania informacji między kontrolerem a widokiem.</span><span class="sxs-lookup"><span data-stu-id="c8a92-156">The Fix It app uses the FixItTask entity class to pass information between the controller and the view.</span></span> <span data-ttu-id="c8a92-157">Najlepszym rozwiązaniem jest używanie modeli widoku.</span><span class="sxs-lookup"><span data-stu-id="c8a92-157">A best practice is to use view models.</span></span> <span data-ttu-id="c8a92-158">Model domeny (np. Klasa jednostki FixItTask) jest zaprojektowana dla potrzebna trwałości danych, gdy model widoku mogą służyć do prezentacji danych.</span><span class="sxs-lookup"><span data-stu-id="c8a92-158">The domain model (e.g., the FixItTask entity class) is designed around what is needed for data persistence, while a view model can be designed for data presentation.</span></span> <span data-ttu-id="c8a92-159">Aby uzyskać więcej informacji, zobacz [12 ASP.NET MVC: najlepsze rozwiązania](http://codeclimber.net.nz/archive/2009/10/27/12-asp.net-mvc-best-practices.aspx).</span><span class="sxs-lookup"><span data-stu-id="c8a92-159">For more information, see [12 ASP.NET MVC Best Practices](http://codeclimber.net.nz/archive/2009/10/27/12-asp.net-mvc-best-practices.aspx).</span></span>

### <a name="secure-image-blob-recommended"></a><span data-ttu-id="c8a92-160">Obiekt blob obrazu bezpiecznego zalecane</span><span class="sxs-lookup"><span data-stu-id="c8a92-160">Secure image blob recommended</span></span>

<span data-ttu-id="c8a92-161">Poprawka przechowywanych w aplikacji przekazany jako public, obrazy, co oznacza, że każda osoba, która znajdzie adres URL dostępu obrazów.</span><span class="sxs-lookup"><span data-stu-id="c8a92-161">The Fix It app stores uploaded images as public, meaning that anyone who finds the URL can access the images.</span></span> <span data-ttu-id="c8a92-162">Obrazy można zabezpieczone zamiast publicznego.</span><span class="sxs-lookup"><span data-stu-id="c8a92-162">The images could be secured instead of public.</span></span>

### <a name="no-powershell-automation-scripts-for-queues"></a><span data-ttu-id="c8a92-163">Nie skryptów automatyzacji programu PowerShell dla kolejek</span><span class="sxs-lookup"><span data-stu-id="c8a92-163">No PowerShell automation scripts for queues</span></span>

<span data-ttu-id="c8a92-164">Przykładowe skrypty automatyzacji środowiska PowerShell zostały napisane tylko dla wersja podstawowa, usuń go całkowicie w aplikacji sieci Web usługi aplikacji Azure.</span><span class="sxs-lookup"><span data-stu-id="c8a92-164">Sample PowerShell automation scripts were written only for the base version of Fix It that runs entirely in Azure App Service Web Apps.</span></span> <span data-ttu-id="c8a92-165">Nie podaliśmy skryptów do instalowania i wdrażania aplikacji sieci web oraz usługi w chmurze środowiska wymaganej do przetwarzania kolejki.</span><span class="sxs-lookup"><span data-stu-id="c8a92-165">We haven't provided scripts for setting up and deploying to the web app plus Cloud Service environment required for queue processing.</span></span>

### <a name="special-handling-for-html-codes-in-user-input"></a><span data-ttu-id="c8a92-166">Obsługa specjalnej kodów HTML w danych wejściowych użytkownika</span><span class="sxs-lookup"><span data-stu-id="c8a92-166">Special handling for HTML codes in user input</span></span>

<span data-ttu-id="c8a92-167">ASP.NET jest automatycznie zapobiega wiele sposobów, w których złośliwych użytkowników może podejmować atakami skryptów między witrynami, wprowadzając skrypt w polach tekstowych wejściowych użytkownika.</span><span class="sxs-lookup"><span data-stu-id="c8a92-167">ASP.NET automatically prevents many ways in which malicious users might attempt cross-site scripting attacks by entering script in user input text boxes.</span></span> <span data-ttu-id="c8a92-168">I MVC `DisplayFor` pomocnika używany do wyświetlania zadań tytuły i uwagi dotyczące automatycznie koduje HTML wartości, które wysyła do przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="c8a92-168">And the MVC `DisplayFor` helper used to display task titles and notes automatically HTML-encodes values that it sends to the browser.</span></span> <span data-ttu-id="c8a92-169">Jednak w aplikacji produkcyjnej warto zastosować dodatkowe środki.</span><span class="sxs-lookup"><span data-stu-id="c8a92-169">But in a production app you might want to take additional measures.</span></span> <span data-ttu-id="c8a92-170">Aby uzyskać więcej informacji, zobacz [żądania weryfikacji w programie ASP.NET](https://msdn.microsoft.com/library/hh882339.aspx).</span><span class="sxs-lookup"><span data-stu-id="c8a92-170">For more information, see [Request Validation in ASP.NET](https://msdn.microsoft.com/library/hh882339.aspx).</span></span>

<a id="bestpractices"></a>
## <a name="best-practices"></a><span data-ttu-id="c8a92-171">Najlepsze praktyki</span><span class="sxs-lookup"><span data-stu-id="c8a92-171">Best practices</span></span>

<span data-ttu-id="c8a92-172">Poniżej przedstawiono niektóre problemy, które zostały usunięte po odnalezione Przegląd kodu i testowania z oryginalną wersją aplikacji rozwiązać.</span><span class="sxs-lookup"><span data-stu-id="c8a92-172">Following are some issues that were fixed after being discovered in code review and testing of the original version of the Fix It app.</span></span> <span data-ttu-id="c8a92-173">Niektóre zostały spowodowane przez koder oryginalnej, nie wiedziały określonego najlepszych praktyk, niektóre po prostu ponieważ kod został napisany szybko i nie był przeznaczony dla oprogramowania.</span><span class="sxs-lookup"><span data-stu-id="c8a92-173">Some were caused by the original coder not being aware of a particular best practice, some simply because the code was written quickly and wasn't intended for released software.</span></span> <span data-ttu-id="c8a92-174">Firma Microsoft jest lista problemy, w tym miejscu, w przypadku braku coś, co opisano w tym przeglądzie i testowania, które mogą być przydatne do innych użytkowników, którzy są również tworzenie aplikacji sieci web.</span><span class="sxs-lookup"><span data-stu-id="c8a92-174">We're listing the issues here in case there's something we learned from this review and testing that might be helpful to others who are also developing web apps.</span></span>

### <a name="dispose-the-database-repository"></a><span data-ttu-id="c8a92-175">Usuwanie bazy danych repozytorium</span><span class="sxs-lookup"><span data-stu-id="c8a92-175">Dispose the database repository</span></span>

<span data-ttu-id="c8a92-176">`FixItTaskRepository` Klasy musi dysponować programu Entity Framework `DbContext` wystąpienia.</span><span class="sxs-lookup"><span data-stu-id="c8a92-176">The `FixItTaskRepository` class must dispose the Entity Framework `DbContext` instance.</span></span> <span data-ttu-id="c8a92-177">Robiliśmy to zaimplementowanie `IDisposable` w `FixItTaskRepository` klasy:</span><span class="sxs-lookup"><span data-stu-id="c8a92-177">We did this by implementing `IDisposable` in the `FixItTaskRepository` class:</span></span>

[!code-csharp[Main](the-fix-it-sample-application/samples/sample1.cs)]

<span data-ttu-id="c8a92-178">Należy pamiętać, że automatycznie zlikwiduje AutoFac `FixItTaskRepository` wystąpienie, dlatego nie należy go jawnie usunąć.</span><span class="sxs-lookup"><span data-stu-id="c8a92-178">Note that AutoFac will automatically dispose the `FixItTaskRepository` instance, so we don't need to explicitly dispose it.</span></span>

<span data-ttu-id="c8a92-179">Innym rozwiązaniem jest, aby usunąć `DbContext` zmiennej członkowskiej z `FixItTaskRepository`i zamiast tego utworzyć lokalnego `DbContext` zmiennej w ramach każdej metody repozytorium wewnątrz `using` instrukcji.</span><span class="sxs-lookup"><span data-stu-id="c8a92-179">Another option is to remove the `DbContext` member variable from `FixItTaskRepository`, and instead create a local `DbContext` variable within each repository method, inside a `using` statement.</span></span> <span data-ttu-id="c8a92-180">Na przykład:</span><span class="sxs-lookup"><span data-stu-id="c8a92-180">For example:</span></span>

[!code-csharp[Main](the-fix-it-sample-application/samples/sample2.cs)]

### <a name="register-singletons-as-such-with-di"></a><span data-ttu-id="c8a92-181">Zarejestruj pojedynczych wystąpień w związku z Podpisane</span><span class="sxs-lookup"><span data-stu-id="c8a92-181">Register singletons as such with DI</span></span>

<span data-ttu-id="c8a92-182">Ponieważ tylko jedno wystąpienie `PhotoService` klasy i `Logger` klasy jest potrzebna, te klasy powinny być [zarejestrowany jako pojedynczego wystąpienia iniekcji zależności](https://code.google.com/p/autofac/wiki/InstanceScope) w *DependenciesConfig.cs*:</span><span class="sxs-lookup"><span data-stu-id="c8a92-182">Since only one instance of the `PhotoService` class and `Logger` class is needed, these classes should be [registered as single instances for dependency injection](https://code.google.com/p/autofac/wiki/InstanceScope) in *DependenciesConfig.cs*:</span></span>

[!code-csharp[Main](the-fix-it-sample-application/samples/sample3.cs?highlight=1,3)]

### <a name="security-dont-show-error-details-to-users"></a><span data-ttu-id="c8a92-183">Zabezpieczenia: Nie pokazuj szczegóły błędu dla użytkowników</span><span class="sxs-lookup"><span data-stu-id="c8a92-183">Security: Don't show error details to users</span></span>

<span data-ttu-id="c8a92-184">Oryginalny poprawka aplikacji strona ogólny błąd i nie zostały tylko let wszystkie wyjątki bąbelków do interfejsu użytkownika, więc niektóre wyjątki, takie jak błędów połączenia bazy danych może spowodować ślad stosu pełne, będzie wyświetlany w przeglądarce.</span><span class="sxs-lookup"><span data-stu-id="c8a92-184">The original Fix It app didn't have a generic error page and just let all exceptions bubble up to the UI, so some exceptions such as database connection errors could result in a full stack trace being displayed to the browser.</span></span> <span data-ttu-id="c8a92-185">Szczegółowe informacje o błędzie czasami mogą ułatwić atakami złośliwych użytkowników.</span><span class="sxs-lookup"><span data-stu-id="c8a92-185">Detailed error information can sometimes facilitate attacks by malicious users.</span></span> <span data-ttu-id="c8a92-186">Rozwiązanie jest dziennika szczegóły wyjątku i wyświetlić stronę błędu dla użytkownika, który nie zawiera szczegóły błędu.</span><span class="sxs-lookup"><span data-stu-id="c8a92-186">The solution is to log the exception details and display an error page to the user that doesn't include error details.</span></span> <span data-ttu-id="c8a92-187">Już logowania aplikacji Usuń, a aby wyświetlić stronę błędu, dodaliśmy `<customErrors mode=On>` w pliku Web.config.</span><span class="sxs-lookup"><span data-stu-id="c8a92-187">The Fix It app was already logging, and in order to display an error page, we added `<customErrors mode=On>` in the Web.config file.</span></span>

[!code-xml[Main](the-fix-it-sample-application/samples/sample4.xml?highlight=2)]

<span data-ttu-id="c8a92-188">Domyślnie powoduje to *Views\Shared\Error.cshtml* ma być wyświetlany dla błędów.</span><span class="sxs-lookup"><span data-stu-id="c8a92-188">By default this causes *Views\Shared\Error.cshtml* to be displayed for errors.</span></span> <span data-ttu-id="c8a92-189">Można dostosować *Error.cshtml* lub utworzyć własne widoku strony błędów i dodanie `defaultRedirect` atrybutu.</span><span class="sxs-lookup"><span data-stu-id="c8a92-189">You can customize *Error.cshtml* or create your own error page view and add a `defaultRedirect` attribute.</span></span> <span data-ttu-id="c8a92-190">Można również określić inny błąd strony dla określonych błędów.</span><span class="sxs-lookup"><span data-stu-id="c8a92-190">You can also specify different error pages for specific errors.</span></span>

### <a name="security-only-allow-a-task-to-be-edited-by-its-creator"></a><span data-ttu-id="c8a92-191">Zabezpieczenia: Zezwalaj tylko zadania, które ma być edytowany przez twórcy</span><span class="sxs-lookup"><span data-stu-id="c8a92-191">Security: only allow a task to be edited by its creator</span></span>

<span data-ttu-id="c8a92-192">Strona indeksu pulpit nawigacyjny zawiera tylko zadania utworzone przez zalogowanego użytkownika, ale złośliwy użytkownik może utworzyć adres URL z Identyfikatorem zadania przez innego użytkownika.</span><span class="sxs-lookup"><span data-stu-id="c8a92-192">The Dashboard Index page only shows tasks created by the logged-on user, but a malicious user could create a URL with an ID to another user's task.</span></span> <span data-ttu-id="c8a92-193">Dodano kod w *DashboardController.cs* do zwrócenia 404 w takiej sytuacji:</span><span class="sxs-lookup"><span data-stu-id="c8a92-193">We added code in *DashboardController.cs* to return a 404 in that case:</span></span>

[!code-csharp[Main](the-fix-it-sample-application/samples/sample5.cs?highlight=9-14,24-29)]

### <a name="dont-swallow-exceptions"></a><span data-ttu-id="c8a92-194">Nie swallow wyjątków</span><span class="sxs-lookup"><span data-stu-id="c8a92-194">Don't swallow exceptions</span></span>

<span data-ttu-id="c8a92-195">Oryginalna poprawka aplikacji tylko zwróciła wartość null po zalogowaniu wyjątek, który jest wynikiem kwerendy SQL:</span><span class="sxs-lookup"><span data-stu-id="c8a92-195">The original Fix It app just returned null after logging an exception that resulted from a SQL query:</span></span>

[!code-csharp[Main](the-fix-it-sample-application/samples/sample6.cs?highlight=4)]

<span data-ttu-id="c8a92-196">Może to być wyświetlany dla użytkownika tak, jakby zapytanie zostało ukończone pomyślnie, ale po prostu nie zwróciła żadnych wierszy.</span><span class="sxs-lookup"><span data-stu-id="c8a92-196">This would make it look to the user as if the query succeeded but just didn't return any rows.</span></span> <span data-ttu-id="c8a92-197">Rozwiązanie to ponowne zgłoszenie wyjątku po przechwytywanie i rejestrowanie:</span><span class="sxs-lookup"><span data-stu-id="c8a92-197">Solution is to re-throw the exception after catching and logging:</span></span>

[!code-csharp[Main](the-fix-it-sample-application/samples/sample7.cs)]

### <a name="catch-all-exceptions-in-worker-roles"></a><span data-ttu-id="c8a92-198">Przechwytywanie wszystkich wyjątków w roli proces roboczy</span><span class="sxs-lookup"><span data-stu-id="c8a92-198">Catch all exceptions in worker roles</span></span>

<span data-ttu-id="c8a92-199">Wszelkie nieobsługiwanych wyjątków w roli procesu roboczego spowoduje, że maszyna wirtualna zostanie poddanych recyklingowi, więc ma być zawijany wszystko, co zrobić w bloku try-catch i obsługiwać wszystkie wyjątki.</span><span class="sxs-lookup"><span data-stu-id="c8a92-199">Any unhandled exceptions in a worker role will cause the VM to be recycled, so you want to wrap everything you do in a try-catch block and handle all exceptions.</span></span>

### <a name="specify-length-for-string-properties-in-entity-classes"></a><span data-ttu-id="c8a92-200">Określ długość ciągu właściwości klas jednostki</span><span class="sxs-lookup"><span data-stu-id="c8a92-200">Specify length for string properties in entity classes</span></span>

<span data-ttu-id="c8a92-201">Aby wyświetlić kod proste, z oryginalną wersją aplikacji Usuń nie określ długość pola jednostki FixItTask, a w związku z tym zostały zdefiniowane jako varchar(max) w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="c8a92-201">In order to display simple code, the original version of the Fix It app didn't specify lengths for the fields of the FixItTask entity, and as a result they were defined as varchar(max) in the database.</span></span> <span data-ttu-id="c8a92-202">W związku z tym interfejsu użytkownika będzie akceptować prawie każdego ilość danych wejściowych.</span><span class="sxs-lookup"><span data-stu-id="c8a92-202">As a result, the UI would accept almost any amount of input.</span></span> <span data-ttu-id="c8a92-203">Określanie limity zestawów długości, które mają zastosowanie zarówno do użytkownika danych wejściowych w strony sieci web i rozmiar kolumny w bazie danych:</span><span class="sxs-lookup"><span data-stu-id="c8a92-203">Specifying lengths sets limits that apply both to user input in the web page and column size in the database:</span></span>

[!code-csharp[Main](the-fix-it-sample-application/samples/sample8.cs?highlight=4,7,10,12,14)]

### <a name="mark-private-members-as-readonly-when-they-arent-expected-to-change"></a><span data-ttu-id="c8a92-204">Oznacz prywatne elementy członkowskie jako tylko do odczytu, gdy nie są one oczekiwane zmiany</span><span class="sxs-lookup"><span data-stu-id="c8a92-204">Mark private members as readonly when they aren't expected to change</span></span>

<span data-ttu-id="c8a92-205">Na przykład w `DashboardController` wystąpienia klasy `FixItTaskRepository` zostanie utworzona i nie jest oczekiwany można zmienić, więc go jako zdefiniowanego [tylko do odczytu](https://msdn.microsoft.com/library/acdd6hb7.aspx).</span><span class="sxs-lookup"><span data-stu-id="c8a92-205">For example, in the `DashboardController` class an instance of `FixItTaskRepository` is created and isn't expected to change, so we defined it as [readonly](https://msdn.microsoft.com/library/acdd6hb7.aspx).</span></span>

[!code-csharp[Main](the-fix-it-sample-application/samples/sample9.cs?highlight=3)]

### <a name="use-listany-instead-of-listcount-gt-0"></a><span data-ttu-id="c8a92-206">Użyj listy. Any() zamiast listy. Funkcji Count() &gt; 0</span><span class="sxs-lookup"><span data-stu-id="c8a92-206">Use list.Any() instead of list.Count() &gt; 0</span></span>

<span data-ttu-id="c8a92-207">Jeśli użytkownik Cię interesuje czy jeden lub więcej elementów na liście dopasowania określone kryteria, użyj [żadnych](https://msdn.microsoft.com/library/bb534972.aspx) metody, ponieważ zwraca ono jak kryteria dopasowywania element zostanie znaleziony, podczas gdy `Count` iteracyjne ma zawsze — metoda do każdego elementu.</span><span class="sxs-lookup"><span data-stu-id="c8a92-207">If you all you care about is whether one or more items in a list fit the specified criteria, use the [Any](https://msdn.microsoft.com/library/bb534972.aspx) method, because it returns as soon as an item fitting the criteria is found, whereas the `Count` method always has to iterate through every item.</span></span> <span data-ttu-id="c8a92-208">Pulpit nawigacyjny *Index.cshtml* pliku była pierwotnie ten kod:</span><span class="sxs-lookup"><span data-stu-id="c8a92-208">The Dashboard *Index.cshtml* file originally had this code:</span></span>

[!code-cshtml[Main](the-fix-it-sample-application/samples/sample10.cshtml)]

<span data-ttu-id="c8a92-209">Możemy zmienić do poniższego:</span><span class="sxs-lookup"><span data-stu-id="c8a92-209">We changed it to this:</span></span>

[!code-cshtml[Main](the-fix-it-sample-application/samples/sample11.cshtml?highlight=1)]

### <a name="generate-urls-in-mvc-views-using-mvc-helpers"></a><span data-ttu-id="c8a92-210">Generowania adresów URL w widoków MVC za pomocą pomocników MVC</span><span class="sxs-lookup"><span data-stu-id="c8a92-210">Generate URLs in MVC views using MVC helpers</span></span>

<span data-ttu-id="c8a92-211">Dla **napraw go utworzyć** przycisk na stronie głównej poprawka aplikacji twardych kodowanego element zakotwiczenia:</span><span class="sxs-lookup"><span data-stu-id="c8a92-211">For the **Create a Fix It** button on the home page, the Fix It app hard coded an anchor element:</span></span>

[!code-cshtml[Main](the-fix-it-sample-application/samples/sample12.cshtml)]

<span data-ttu-id="c8a92-212">Dla łącza widoku/akcji, takich jak to jest lepiej jest użyć [Url.Action](https://msdn.microsoft.com/library/system.web.mvc.urlhelper.action.aspx) pomocnika kodu HTML, na przykład:</span><span class="sxs-lookup"><span data-stu-id="c8a92-212">For View/Action links like this it's better to use the [Url.Action](https://msdn.microsoft.com/library/system.web.mvc.urlhelper.action.aspx) HTML helper, for example:</span></span>

[!code-cshtml[Main](the-fix-it-sample-application/samples/sample13.cshtml)]

### <a name="use-taskdelay-instead-of-threadsleep-in-worker-role"></a><span data-ttu-id="c8a92-213">Użyj Task.Delay zamiast Thread.Sleep w roli procesu roboczego</span><span class="sxs-lookup"><span data-stu-id="c8a92-213">Use Task.Delay instead of Thread.Sleep in worker role</span></span>

<span data-ttu-id="c8a92-214">Nowy projekt szablonu umieszcza `Thread.Sleep` w próbce kod roli proces roboczy, ale powoduje wątku w stan uśpienia może spowodować puli wątków uruchomić dodatkowe wątki niepotrzebne.</span><span class="sxs-lookup"><span data-stu-id="c8a92-214">The new-project template puts `Thread.Sleep` in the sample code for a worker role, but causing the thread to sleep can cause the thread pool to spawn additional unnecessary threads.</span></span> <span data-ttu-id="c8a92-215">Można uniknąć który za pomocą [Task.Delay](https://msdn.microsoft.com/library/hh139096.aspx) zamiast tego.</span><span class="sxs-lookup"><span data-stu-id="c8a92-215">You can avoid that by using [Task.Delay](https://msdn.microsoft.com/library/hh139096.aspx) instead.</span></span>

[!code-csharp[Main](the-fix-it-sample-application/samples/sample14.cs?highlight=11)]

### <a name="avoid-async-void"></a><span data-ttu-id="c8a92-216">Unikaj async void</span><span class="sxs-lookup"><span data-stu-id="c8a92-216">Avoid async void</span></span>

<span data-ttu-id="c8a92-217">W przypadku metoda asynchroniczna nie musi zwracać wartości, zwraca `Task` typu zamiast `void`.</span><span class="sxs-lookup"><span data-stu-id="c8a92-217">If an async method doesn't need to return a value, return a `Task` type rather than `void`.</span></span>

<span data-ttu-id="c8a92-218">W tym przykładzie pochodzi z `FixItQueueManager` klasy:</span><span class="sxs-lookup"><span data-stu-id="c8a92-218">This example is from the `FixItQueueManager` class:</span></span> 

[!code-csharp[Main](the-fix-it-sample-application/samples/sample15.cs)]

<span data-ttu-id="c8a92-219">Należy używać `async void` tylko dla programów obsługi zdarzeń najwyższego poziomu.</span><span class="sxs-lookup"><span data-stu-id="c8a92-219">You should use `async void` only for top-level event handlers.</span></span> <span data-ttu-id="c8a92-220">W przypadku definiowania metodę jako `async void`, obiekt wywołujący nie **await** metody lub przechwycić wszelkie wyjątki, metoda wygeneruje.</span><span class="sxs-lookup"><span data-stu-id="c8a92-220">If you define a method as `async void`, the caller cannot **await** the method or catch any exceptions the method throws.</span></span> <span data-ttu-id="c8a92-221">Aby uzyskać więcej informacji, zobacz [programowania asynchronicznych — najlepsze praktyki](https://msdn.microsoft.com/magazine/jj991977.aspx).</span><span class="sxs-lookup"><span data-stu-id="c8a92-221">For more information, see [Best Practices in Asynchronous Programming](https://msdn.microsoft.com/magazine/jj991977.aspx).</span></span> 

### <a name="use-a-cancellation-token-to-break-from-worker-role-loop"></a><span data-ttu-id="c8a92-222">Użyj token anulowania, aby przerwać pętlę roli procesu roboczego</span><span class="sxs-lookup"><span data-stu-id="c8a92-222">Use a cancellation token to break from worker role loop</span></span>

<span data-ttu-id="c8a92-223">Zazwyczaj **Uruchom** metody w roli procesu roboczego zawiera Pętla nieskończona.</span><span class="sxs-lookup"><span data-stu-id="c8a92-223">Typically, the **Run** method on a worker role contains an infinite loop.</span></span> <span data-ttu-id="c8a92-224">Gdy rola proces roboczy jest zatrzymywana, [RoleEntryPoint.OnStop](https://msdn.microsoft.com/library/windowsazure/microsoft.windowsazure.serviceruntime.roleentrypoint.onstop.aspx) metoda jest wywoływana.</span><span class="sxs-lookup"><span data-stu-id="c8a92-224">When the worker role is stopping, the [RoleEntryPoint.OnStop](https://msdn.microsoft.com/library/windowsazure/microsoft.windowsazure.serviceruntime.roleentrypoint.onstop.aspx) method is called.</span></span> <span data-ttu-id="c8a92-225">Należy użyć tej metody do anulowania pracy, która jest wykonywana wewnątrz **Uruchom** metody i wyjścia bezpiecznie zamknąć.</span><span class="sxs-lookup"><span data-stu-id="c8a92-225">You should use this method to cancel the work that is being done inside the **Run** method and exit gracefully.</span></span> <span data-ttu-id="c8a92-226">W przeciwnym razie proces mogą być zakończone w trakcie wykonywania operacji.</span><span class="sxs-lookup"><span data-stu-id="c8a92-226">Otherwise, the process might be terminated in the middle of an operation.</span></span>

### <a name="opt-out-of-automatic-mime-sniffing-procedure"></a><span data-ttu-id="c8a92-227">Opcja rezygnacji z procedury automatyczne wykrywanie MIME</span><span class="sxs-lookup"><span data-stu-id="c8a92-227">Opt out of Automatic MIME Sniffing Procedure</span></span>

<span data-ttu-id="c8a92-228">W niektórych przypadkach program Internet Explorer raporty typ MIME jest inny niż typ określony przez serwer sieci web.</span><span class="sxs-lookup"><span data-stu-id="c8a92-228">In some cases, Internet Explorer reports a MIME type different than the type specified by the web server.</span></span> <span data-ttu-id="c8a92-229">Na przykład jeśli program Internet Explorer znajdzie HTML zawartości w pliku oferowane przez nagłówka odpowiedzi HTTP Content-Type: zwykły tekst, program Internet Explorer określa, czy zawartość ma być renderowany jako HTML.</span><span class="sxs-lookup"><span data-stu-id="c8a92-229">For instance, if Internet Explorer finds HTML content in a file delivered with the HTTP response header Content-Type: text/plain, Internet Explorer determines that the content should be rendered as HTML.</span></span> <span data-ttu-id="c8a92-230">Niestety ta "— Wykrywanie MIME" również może prowadzić do problemów z zabezpieczeniami dla serwerów obsługujących niezaufaną zawartość.</span><span class="sxs-lookup"><span data-stu-id="c8a92-230">Unfortunately, this "MIME-sniffing" can also lead to security problems for servers hosting untrusted content.</span></span> <span data-ttu-id="c8a92-231">Zwalczania ten problem, programu Internet Explorer 8 ma wprowadzono wiele zmian kodu określenie typu MIME i umożliwia deweloperom aplikacji [zrezygnować z wykrywanie MIME](https://blogs.msdn.com/b/ie/archive/2008/07/02/ie8-security-part-v-comprehensive-protection.aspx).</span><span class="sxs-lookup"><span data-stu-id="c8a92-231">To combat this problem, Internet Explorer 8 has made a number of changes to MIME-type determination code and allows application developers to [opt out of MIME-sniffing](https://blogs.msdn.com/b/ie/archive/2008/07/02/ie8-security-part-v-comprehensive-protection.aspx).</span></span> <span data-ttu-id="c8a92-232">Następujący kod został dodany do *Web.config* pliku.</span><span class="sxs-lookup"><span data-stu-id="c8a92-232">The following code was added to the *Web.config* file.</span></span>

[!code-xml[Main](the-fix-it-sample-application/samples/sample16.xml?highlight=2-7)]

### <a name="enable-bundling-and-minification"></a><span data-ttu-id="c8a92-233">Włącz tworzenie pakietów i minimalizowanie</span><span class="sxs-lookup"><span data-stu-id="c8a92-233">Enable bundling and minification</span></span>

<span data-ttu-id="c8a92-234">Gdy program Visual Studio tworzy nowy projekt sieci web, tworzenie pakietów i minimalizowanie pliki JavaScript nie jest włączona domyślnie.</span><span class="sxs-lookup"><span data-stu-id="c8a92-234">When Visual Studio creates a new web project, bundling and minification of JavaScript files is not enabled by default.</span></span> <span data-ttu-id="c8a92-235">Dodaliśmy wiersza kodu w BundleConfig.cs:</span><span class="sxs-lookup"><span data-stu-id="c8a92-235">We added a line of code in BundleConfig.cs:</span></span>

[!code-csharp[Main](the-fix-it-sample-application/samples/sample17.cs?highlight=9)]

### <a name="set-an-expiration-time-out-for-authentication-cookies"></a><span data-ttu-id="c8a92-236">Ustawianie limitu czasu wygaśnięcia uwierzytelniania plików cookie</span><span class="sxs-lookup"><span data-stu-id="c8a92-236">Set an expiration time-out for authentication cookies</span></span>

<span data-ttu-id="c8a92-237">Domyślnie pliki cookie uwierzytelniania wygaśnie po upływie dwóch tygodni.</span><span class="sxs-lookup"><span data-stu-id="c8a92-237">By default, authentication cookies expire in two weeks.</span></span> <span data-ttu-id="c8a92-238">Krótszy czas jest bardziej bezpieczne.</span><span class="sxs-lookup"><span data-stu-id="c8a92-238">A shorter time is more secure.</span></span> <span data-ttu-id="c8a92-239">Możesz zmienić to ustawienie w *StartupAuth.cs*:</span><span class="sxs-lookup"><span data-stu-id="c8a92-239">You can change this setting in *StartupAuth.cs*:</span></span>

[!code-csharp[Main](the-fix-it-sample-application/samples/sample18.cs?highlight=4-5)]

<a id="run-in-vs"></a>
## <a name="how-to-run-the-app-from-visual-studio-on-your-local-computer"></a><span data-ttu-id="c8a92-240">Jak uruchomić aplikację w programie Visual Studio na komputerze lokalnym</span><span class="sxs-lookup"><span data-stu-id="c8a92-240">How to run the app from Visual Studio on your local computer</span></span>

<span data-ttu-id="c8a92-241">Istnieją dwa sposoby uruchamiania aplikacji napraw:</span><span class="sxs-lookup"><span data-stu-id="c8a92-241">There are two ways to run the Fix It app:</span></span>

- <span data-ttu-id="c8a92-242">Uruchom podstawowej aplikacji, który zapisuje nowe zadania bezpośrednio do bazy danych SQL.</span><span class="sxs-lookup"><span data-stu-id="c8a92-242">Run the base application that writes new tasks directly to the SQL database.</span></span>
- <span data-ttu-id="c8a92-243">Uruchom aplikację przy użyciu kolejki i usługi wewnętrznej bazy danych do utworzenia zadania.</span><span class="sxs-lookup"><span data-stu-id="c8a92-243">Run the application using a queue plus a backend service to create tasks.</span></span> <span data-ttu-id="c8a92-244">Wzorzec kolejki opisanej w rozdziale [skoncentrowane kolejki wzorzec pracy](queue-centric-work-pattern.md).</span><span class="sxs-lookup"><span data-stu-id="c8a92-244">The queue pattern is described in the chapter [Queue-Centric Work Pattern](queue-centric-work-pattern.md).</span></span>

<a id="runbase"></a>
### <a name="run-the-base-application"></a><span data-ttu-id="c8a92-245">Uruchom podstawowej aplikacji</span><span class="sxs-lookup"><span data-stu-id="c8a92-245">Run the base application</span></span>

1. <span data-ttu-id="c8a92-246">Zainstaluj [Visual Studio 2013 lub Visual Studio Express 2013 for Web](https://www.visualstudio.com/downloads).</span><span class="sxs-lookup"><span data-stu-id="c8a92-246">Install [Visual Studio 2013 or Visual Studio 2013 Express for Web](https://www.visualstudio.com/downloads).</span></span>
2. <span data-ttu-id="c8a92-247">Zainstaluj [Azure SDK dla platformy .NET dla programu Visual Studio 2013.](https://go.microsoft.com/fwlink/p/?linkid=323510&amp;clcid=0x409)</span><span class="sxs-lookup"><span data-stu-id="c8a92-247">Install the [Azure SDK for .NET for Visual Studio 2013.](https://go.microsoft.com/fwlink/p/?linkid=323510&amp;clcid=0x409)</span></span>
3. <span data-ttu-id="c8a92-248">Pobierz plik zip z [galerii kodu MSDN](https://code.msdn.microsoft.com/Fix-It-app-for-Building-cdd80df4).</span><span class="sxs-lookup"><span data-stu-id="c8a92-248">Download the .zip file from the [MSDN Code Gallery](https://code.msdn.microsoft.com/Fix-It-app-for-Building-cdd80df4).</span></span>
4. <span data-ttu-id="c8a92-249">W Eksploratorze plików kliknij prawym przyciskiem myszy plik zip i kliknij polecenie Właściwości, a następnie w oknie dialogowym właściwości kliknij przycisk Odblokuj.</span><span class="sxs-lookup"><span data-stu-id="c8a92-249">In File Explorer, right-click the .zip file and click Properties, then in the Properties window click Unblock.</span></span>
5. <span data-ttu-id="c8a92-250">Rozpakuj plik.</span><span class="sxs-lookup"><span data-stu-id="c8a92-250">Unzip the file.</span></span>
6. <span data-ttu-id="c8a92-251">Kliknij dwukrotnie plik .sln, aby uruchomić program Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="c8a92-251">Double-click the .sln file to launch Visual Studio.</span></span>
7. <span data-ttu-id="c8a92-252">W menu Narzędzia kliknij pozycję Menedżer pakietów biblioteki, a następnie Konsola Menedżera pakietów.</span><span class="sxs-lookup"><span data-stu-id="c8a92-252">From the Tools menu, click Library Package Manager, then Package Manager Console.</span></span>
8. <span data-ttu-id="c8a92-253">W konsoli Menedżera pakietów (PMC), kliknij przycisk Przywróć.</span><span class="sxs-lookup"><span data-stu-id="c8a92-253">In the Package Manager Console (PMC), click Restore.</span></span>
9. <span data-ttu-id="c8a92-254">Zamknij program Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="c8a92-254">Exit Visual Studio.</span></span>
10. <span data-ttu-id="c8a92-255">Uruchom [emulatora magazynu Azure](https://msdn.microsoft.com/library/windowsazure/hh403989.aspx).</span><span class="sxs-lookup"><span data-stu-id="c8a92-255">Start the [Azure storage emulator](https://msdn.microsoft.com/library/windowsazure/hh403989.aspx).</span></span>
11. <span data-ttu-id="c8a92-256">Uruchom ponownie program Visual Studio, otwierając plik rozwiązania zamknięte w poprzednim kroku.</span><span class="sxs-lookup"><span data-stu-id="c8a92-256">Restart Visual Studio, opening the solution file you closed in the previous step.</span></span>
12. <span data-ttu-id="c8a92-257">Upewnij się, że projekt automatyczne jest ustawiony jako projekt startowy, a następnie naciśnij klawisze CTRL + F5, aby uruchomić projekt.</span><span class="sxs-lookup"><span data-stu-id="c8a92-257">Make sure the FixIt project is set as the startup project, and then press CTRL+F5 to run the project.</span></span>

<a id="queueslocal"></a>
### <a name="run-the-application-with-queue-processing"></a><span data-ttu-id="c8a92-258">Uruchom aplikację z kolejki przetwarzania</span><span class="sxs-lookup"><span data-stu-id="c8a92-258">Run the application with queue processing</span></span>

1. <span data-ttu-id="c8a92-259">Postępuj zgodnie z instrukcjami dla [Uruchom podstawowej aplikacji](#runbase), a następnie zamknij przeglądarkę i zamknij program Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="c8a92-259">Follow the directions for [Run the base application](#runbase), and then close the browser and close Visual Studio.</span></span>
2. <span data-ttu-id="c8a92-260">Uruchom program Visual Studio z uprawnieniami administratora.</span><span class="sxs-lookup"><span data-stu-id="c8a92-260">Start Visual Studio with administrator privileges.</span></span> <span data-ttu-id="c8a92-261">(Należy używać emulatora obliczeń platformy Azure, i który wymaga uprawnień administratora).</span><span class="sxs-lookup"><span data-stu-id="c8a92-261">(You'll be using the Azure compute emulator, and that requires administrator privileges.)</span></span>
3. <span data-ttu-id="c8a92-262">W aplikacji *Web.config* w pliku *MyFixIt* projekt (projekt sieci web), zmień wartość `appSettings/UseQueues` na wartość "true":</span><span class="sxs-lookup"><span data-stu-id="c8a92-262">In the application *Web.config* file in the *MyFixIt* project (the web project), change the value of `appSettings/UseQueues` to "true":</span></span> 

    [!code-console[Main](the-fix-it-sample-application/samples/sample19.cmd?highlight=3)]
4. <span data-ttu-id="c8a92-263">Jeśli [emulatora magazynu Azure](https://msdn.microsoft.com/library/windowsazure/hh403989.aspx) nie jest nadal uruchomiona, uruchom go ponownie.</span><span class="sxs-lookup"><span data-stu-id="c8a92-263">If the [Azure storage emulator](https://msdn.microsoft.com/library/windowsazure/hh403989.aspx) isn't still running, start it again.</span></span>
5. <span data-ttu-id="c8a92-264">Automatyczne projektu sieci web i projektu MyFixItCloudService być uruchomione jednocześnie.</span><span class="sxs-lookup"><span data-stu-id="c8a92-264">Run the FixIt web project and the MyFixItCloudService project simultaneously.</span></span>

    <span data-ttu-id="c8a92-265">Za pomocą programu Visual Studio 2013:</span><span class="sxs-lookup"><span data-stu-id="c8a92-265">Using Visual Studio 2013:</span></span>

   1. <span data-ttu-id="c8a92-266">Naciśnij klawisz F5, aby uruchomić projekt automatyczne rozwiązywanie problemu.</span><span class="sxs-lookup"><span data-stu-id="c8a92-266">Press F5 to run the FixIt project.</span></span>
   2. <span data-ttu-id="c8a92-267">W **Eksploratora rozwiązań**, kliknij prawym przyciskiem myszy projekt MyFixItCloudService, a następnie kliknij przycisk **debugowania** -- **uruchomić nowe wystąpienie**.</span><span class="sxs-lookup"><span data-stu-id="c8a92-267">In **Solution Explorer**, right-click the MyFixItCloudService project, and then click **Debug** -- **Start New Instance**.</span></span>

      <span data-ttu-id="c8a92-268">Za pomocą programu Visual Studio Express 2013 for Web:</span><span class="sxs-lookup"><span data-stu-id="c8a92-268">Using Visual Studio 2013 Express for Web:</span></span>

   3. <span data-ttu-id="c8a92-269">W Eksploratorze rozwiązań kliknij prawym przyciskiem myszy rozwiązanie automatyczne, a następnie wybierz **właściwości**.</span><span class="sxs-lookup"><span data-stu-id="c8a92-269">In Solution Explorer, right-click the FixIt solution and select **Properties**.</span></span>
   4. <span data-ttu-id="c8a92-270">Wybierz **wiele projektów startowych**...</span><span class="sxs-lookup"><span data-stu-id="c8a92-270">Select **Multiple Startup Projects**..</span></span>
   5. <span data-ttu-id="c8a92-271">W **akcji** wybierz z listy rozwijanej w obszarze MyFixIt i MyFixItCloudService, **Start**.</span><span class="sxs-lookup"><span data-stu-id="c8a92-271">In the **Action** dropdown list under MyFixIt and MyFixItCloudService, select **Start**.</span></span>
   6. <span data-ttu-id="c8a92-272">Kliknij przycisk **OK**.</span><span class="sxs-lookup"><span data-stu-id="c8a92-272">Click **OK**.</span></span>
   7. <span data-ttu-id="c8a92-273">Naciśnij klawisz F5, aby uruchomić oba projekty.</span><span class="sxs-lookup"><span data-stu-id="c8a92-273">Press F5 to run both projects.</span></span>

      <span data-ttu-id="c8a92-274">Po uruchomieniu MyFixItCloudService projektu programu Visual Studio rozpoczyna emulatora obliczeń platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="c8a92-274">When you run the MyFixItCloudService project, Visual Studio starts the Azure compute emulator.</span></span> <span data-ttu-id="c8a92-275">W zależności od konfiguracji zapory konieczne może być Zezwalaj emulatora przez zaporę.</span><span class="sxs-lookup"><span data-stu-id="c8a92-275">Depending on your firewall configuration, you might need to allow the emulator through the firewall.</span></span>

<a id="deploybase"></a>
## <a name="how-to-deploy-the-base-app-to-azure-app-service-web-apps-by-using-the-windows-powershell-scripts"></a><span data-ttu-id="c8a92-276">Sposób wdrażania podstawowej aplikacji do aplikacji sieci Web usługi aplikacji Azure za pomocą skryptów środowiska Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="c8a92-276">How to deploy the base app to Azure App Service Web Apps by using the Windows PowerShell scripts</span></span>

<span data-ttu-id="c8a92-277">Aby zilustrować [zautomatyzować wszystko](automate-everything.md) wzorcu aplikacji Usuń jest dostarczany z skrypty, które konfigurowania środowiska na platformie Azure i wdrażanie projektu do nowego środowiska.</span><span class="sxs-lookup"><span data-stu-id="c8a92-277">To illustrate the [Automate Everything](automate-everything.md) pattern, the Fix It app is supplied with scripts that set up an environment in Azure and deploy the project to the new environment.</span></span> <span data-ttu-id="c8a92-278">Poniższe instrukcje wyjaśniają sposób użycia skryptów.</span><span class="sxs-lookup"><span data-stu-id="c8a92-278">The following instructions explain how to use the scripts.</span></span>

<span data-ttu-id="c8a92-279">Jeśli chcesz uruchomić na platformie Azure, bez korzystania z kolejek, a zostały wprowadzone zmiany, aby uruchomić lokalnie z kolejkami, upewnij się, że wartość UseQueues appSetting ponownie na wartość false przed wykonaniem poniższych instrukcji.</span><span class="sxs-lookup"><span data-stu-id="c8a92-279">If you want to run in Azure without using queues, and you made the changes to run locally with queues, make sure you set the UseQueues appSetting value back to false before proceeding with the following instructions.</span></span>

<span data-ttu-id="c8a92-280">W poniższych instrukcjach przyjęto zostały już pobrane i uruchamianie rozwiązania rozwiązać lokalnie, i czy masz Azure konta lub posiadania subskrypcji platformy Azure, które są autoryzowane do zarządzania.</span><span class="sxs-lookup"><span data-stu-id="c8a92-280">These instructions assume you have already downloaded and run the Fix It solution locally, and that you have an Azure account or have an Azure subscription that you are authorized to manage.</span></span>

1. <span data-ttu-id="c8a92-281">Zainstaluj **programu Azure PowerShell** konsoli.</span><span class="sxs-lookup"><span data-stu-id="c8a92-281">Install the **Azure PowerShell** console.</span></span> <span data-ttu-id="c8a92-282">Aby uzyskać instrukcje, zobacz [jak instalowanie i konfigurowanie programu Azure PowerShell](https://docs.microsoft.com/powershell/azure/overview?view=azurermps-4.3.1).</span><span class="sxs-lookup"><span data-stu-id="c8a92-282">For instructions, see [How to install and configure Azure PowerShell](https://docs.microsoft.com/powershell/azure/overview?view=azurermps-4.3.1).</span></span>

    <span data-ttu-id="c8a92-283">Ta konsola dostosowane jest skonfigurowane do pracy z subskrypcją platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="c8a92-283">This customized console is configured to work with your Azure subscription.</span></span> <span data-ttu-id="c8a92-284">Zainstalowano modułu platformy Azure w *Program Files* katalogu i jest importowany automatycznie w każdej za pomocą konsoli programu Azure PowerShell.</span><span class="sxs-lookup"><span data-stu-id="c8a92-284">The Azure module is installed in the *Program Files* directory and is automatically imported on every use of the Azure PowerShell console.</span></span>

    <span data-ttu-id="c8a92-285">Jeśli wolisz pracować w programie inny host, na przykład programu Windows PowerShell ISE, należy użyć [Import-Module](https://go.microsoft.com/fwlink/?LinkID=141553) polecenia cmdlet, aby zaimportować moduł Azure lub użyj polecenia w Azure module do wyzwalania automatycznego importowania modułu.</span><span class="sxs-lookup"><span data-stu-id="c8a92-285">If you prefer to work in a different host program, such as Windows PowerShell ISE, be sure to use the [Import-Module](https://go.microsoft.com/fwlink/?LinkID=141553) cmdlet to import the Azure module or use a command in the Azure module to trigger automatic importing of the module.</span></span>
2. <span data-ttu-id="c8a92-286">Uruchom program Azure PowerShell z **Uruchom jako administrator** opcji.</span><span class="sxs-lookup"><span data-stu-id="c8a92-286">Start Azure PowerShell with the **Run as administrator** option.</span></span>
3. <span data-ttu-id="c8a92-287">Uruchom [Set-ExecutionPolicy](https://go.microsoft.com/fwlink/p/?linkid=293941) polecenia cmdlet, aby ustawić zasady wykonywania programu Azure PowerShell `RemoteSigned`.</span><span class="sxs-lookup"><span data-stu-id="c8a92-287">Run the [Set-ExecutionPolicy](https://go.microsoft.com/fwlink/p/?linkid=293941) cmdlet to set the Azure PowerShell execution policy to `RemoteSigned`.</span></span> <span data-ttu-id="c8a92-288">Wprowadź **Y** (tak) w przypadku aby dokonać zmiany zasad.</span><span class="sxs-lookup"><span data-stu-id="c8a92-288">Enter **Y** (for Yes) to complete the policy change.</span></span>

    [!code-console[Main](the-fix-it-sample-application/samples/sample20.cmd)]

    <span data-ttu-id="c8a92-289">To ustawienie umożliwia uruchamianie skryptów lokalnych, które nie są podpisane cyfrowo.</span><span class="sxs-lookup"><span data-stu-id="c8a92-289">This setting enables you to run local scripts that aren't digitally signed.</span></span> <span data-ttu-id="c8a92-290">(Możesz także ustawić zasady wykonywania `Unrestricted`, który będzie, eliminując konieczność stosowania krok Odblokuj później, ale nie jest to zalecane ze względów bezpieczeństwa.)</span><span class="sxs-lookup"><span data-stu-id="c8a92-290">(You can also set the execution policy to `Unrestricted`, which would eliminate the need for the unblock step later, but this is not recommended for security reasons.)</span></span>
4. <span data-ttu-id="c8a92-291">Uruchom `Add-AzureAccount` polecenia cmdlet, aby skonfigurować programu PowerShell przy użyciu poświadczeń dla konta.</span><span class="sxs-lookup"><span data-stu-id="c8a92-291">Run the `Add-AzureAccount` cmdlet to set up PowerShell with credentials for your account.</span></span>

    [!code-console[Main](the-fix-it-sample-application/samples/sample21.cmd)]

    <span data-ttu-id="c8a92-292">Te poświadczenia wygaśnie po upływie pewnego czasu i ponownie uruchom `Add-AzureAccount` polecenia cmdlet.</span><span class="sxs-lookup"><span data-stu-id="c8a92-292">These credentials expire after a period of time and you have to re-run the `Add-AzureAccount` cmdlet.</span></span> <span data-ttu-id="c8a92-293">Jak Książka elektroniczna jest zapisywana, limit czasu wygaśnięcia poświadczeń wynosi 12 godzin.</span><span class="sxs-lookup"><span data-stu-id="c8a92-293">As this e-book is being written, the time limit before credentials expire is 12 hours.</span></span>
5. <span data-ttu-id="c8a92-294">Jeśli masz wiele subskrypcji, należy użyć polecenia cmdlet AzureSubscription wybierz, aby określić subskrypcję, którą chcesz utworzyć w środowisku testowym.</span><span class="sxs-lookup"><span data-stu-id="c8a92-294">If you have multiple subscriptions, use the Select-AzureSubscription cmdlet to specify the subscription you want to create the test environment in.</span></span>
6. <span data-ttu-id="c8a92-295">Zaimportuj certyfikat zarządzania dla tej samej subskrypcji platformy Azure przy użyciu `Get-AzurePublishSettingsFile` i `Import-AzurePublishSettingsFile` polecenia cmdlet.</span><span class="sxs-lookup"><span data-stu-id="c8a92-295">Import a management certificate for the same Azure subscription by using the `Get-AzurePublishSettingsFile` and `Import-AzurePublishSettingsFile` cmdlets.</span></span> <span data-ttu-id="c8a92-296">Pierwsza z tych poleceń cmdlet pobiera plik certyfikatu, a w drugim Określ lokalizację tego pliku w celu zaimportowania.</span><span class="sxs-lookup"><span data-stu-id="c8a92-296">The first of these cmdlets downloads a certificate file, and in the second one you specify the location of that file in order to import it.</span></span> > [!IMPORTANT]
   > <span data-ttu-id="c8a92-297">Zachować pobrany plik w bezpiecznym miejscu, lub usuń go, gdy wszystko będzie gotowe, ponieważ zawiera on certyfikat, który może służyć do zarządzania usługami Azure.</span><span class="sxs-lookup"><span data-stu-id="c8a92-297">Keep the downloaded file in a safe location or delete it when you're done with it, because it contains a certificate that can be used to manage your Azure services.</span></span>

    [!code-console[Main](the-fix-it-sample-application/samples/sample22.cmd)]

    <span data-ttu-id="c8a92-298">Ten certyfikat jest używany dla wywołania interfejsu API REST, który wykryje adresu IP na komputerze deweloperskim, aby ustawić regułę zapory na serwerze bazy danych SQL.</span><span class="sxs-lookup"><span data-stu-id="c8a92-298">The certificate is used for a REST API call that detects the development machine's IP address in order to set a firewall rule on the SQL Database server.</span></span>
7. <span data-ttu-id="c8a92-299">Uruchom [lokalizacją zestawu](https://go.microsoft.com/fwlink/p/?linkid=293912) polecenia cmdlet (aliasy `cd`, `chdir`, i `sl`) przejdź do katalogu zawierającego skryptów.</span><span class="sxs-lookup"><span data-stu-id="c8a92-299">Run the [Set-Location](https://go.microsoft.com/fwlink/p/?linkid=293912) cmdlet (aliases are `cd`, `chdir`, and `sl`) to navigate to the directory that contains the scripts.</span></span> <span data-ttu-id="c8a92-300">(Znajdują w *automatyzacji* folderu w folderze rozwiązania poprawka.) Jeśli którakolwiek z nazwy katalogów zawiera spacje, umieść ścieżki w cudzysłowy.</span><span class="sxs-lookup"><span data-stu-id="c8a92-300">(They're located in the *Automation* folder in the Fix It solution folder.) Put the path in quotes if any of the directory names contain spaces.</span></span> <span data-ttu-id="c8a92-301">Na przykład, aby przejść do `c:\Sample Apps\FixIt\Automation` katalogu można wprowadzić następujące polecenie:</span><span class="sxs-lookup"><span data-stu-id="c8a92-301">For example, to navigate to the `c:\Sample Apps\FixIt\Automation` directory you could enter the following command:</span></span>

    [!code-console[Main](the-fix-it-sample-application/samples/sample23.cmd)]
8. <span data-ttu-id="c8a92-302">Aby zezwolić na uruchamianie tych skryptów środowiska Windows PowerShell, użyj [odblokowanie pliku](https://go.microsoft.com/fwlink/p/?linkid=294021) polecenia cmdlet.</span><span class="sxs-lookup"><span data-stu-id="c8a92-302">To allow Windows PowerShell to run these scripts, use the [Unblock-File](https://go.microsoft.com/fwlink/p/?linkid=294021) cmdlet.</span></span> <span data-ttu-id="c8a92-303">(Skrypty są blokowane, ponieważ zostały one pobrane z Internetu.)</span><span class="sxs-lookup"><span data-stu-id="c8a92-303">(The scripts are blocked because they were downloaded from the Internet.)</span></span>

    > [!WARNING]
    > <span data-ttu-id="c8a92-304">Zabezpieczenia — przed uruchomieniem `Unblock-File` na dowolny skrypt lub plik wykonywalny, otwórz plik w programie Notatnik, sprawdź poleceń i sprawdź, czy nie zawierają złośliwego kodu.</span><span class="sxs-lookup"><span data-stu-id="c8a92-304">Security - Before running `Unblock-File` on any script or executable file, open the file in Notepad, examine the commands, and verify that they do not contain any malicious code.</span></span>

    <span data-ttu-id="c8a92-305">Na przykład następujące polecenie uruchamia `Unblock-File` polecenia cmdlet na wszystkie skrypty w bieżącym katalogu.</span><span class="sxs-lookup"><span data-stu-id="c8a92-305">For example, the following command runs the `Unblock-File` cmdlet on all scripts in the current directory.</span></span>

    [!code-console[Main](the-fix-it-sample-application/samples/sample24.cmd)]
9. <span data-ttu-id="c8a92-306">Do utworzenia aplikacji sieci web dla podstawy (kolejek przetwarzania) Napraw aplikację, uruchom skrypt tworzenia środowiska.</span><span class="sxs-lookup"><span data-stu-id="c8a92-306">To create the web app for the base (no queues processing) Fix It app, run the environment creation script.</span></span>

    <span data-ttu-id="c8a92-307">Wymagane `Name` parametr określa nazwę bazy danych, a także jest używane dla konta magazynu, która tworzy skrypt.</span><span class="sxs-lookup"><span data-stu-id="c8a92-307">The required `Name` parameter specifies the name of the database and is also used for the storage account that the script creates.</span></span> <span data-ttu-id="c8a92-308">Nazwa musi być globalnie unikatowa w domenie azurewebsites.net.</span><span class="sxs-lookup"><span data-stu-id="c8a92-308">The name must be globally unique within the azurewebsites.net domain.</span></span> <span data-ttu-id="c8a92-309">Jeśli określono nazwę, która nie jest unikatowa, takich jak automatyczne lub testu (lub nawet tak jak w przykładzie, fixitdemo) `New-AzureWebsite` polecenie cmdlet nie powiedzie się z powodu błędu wewnętrznego, który zgłasza konflikt.</span><span class="sxs-lookup"><span data-stu-id="c8a92-309">If you specify a name that is not unique, like Fixit or Test (or even as in the example, fixitdemo), the `New-AzureWebsite` cmdlet fails with an Internal Error that reports a conflict.</span></span> <span data-ttu-id="c8a92-310">Skrypt konwertuje nazwę napisany małymi literami, zgodnie z wymaganiami nazwę dla aplikacji sieci web, konta magazynu i bazy danych.</span><span class="sxs-lookup"><span data-stu-id="c8a92-310">The script converts the name to all lower-case to comply with name requirements for web apps, storage accounts, and databases.</span></span>

    <span data-ttu-id="c8a92-311">Wymagane `SqlDatabasePassword` parametr określa hasło dla konta administratora, które zostaną utworzone dla bazy danych SQL.</span><span class="sxs-lookup"><span data-stu-id="c8a92-311">The required `SqlDatabasePassword` parameter specifies the password for the admin account that will be created for SQL Database.</span></span> <span data-ttu-id="c8a92-312">Hasło nie zawiera specjalne znaki XML (&amp; &lt; &gt; ;).</span><span class="sxs-lookup"><span data-stu-id="c8a92-312">Don't include special XML characters in the password (&amp; &lt; &gt; ;).</span></span> <span data-ttu-id="c8a92-313">Jest to ograniczenie sposób skrypty napisanych nie ograniczenia Azure.</span><span class="sxs-lookup"><span data-stu-id="c8a92-313">This is a limitation of the way the scripts were written, not a limitation of Azure.</span></span>

    <span data-ttu-id="c8a92-314">Jeśli chcesz utworzyć aplikację sieci web o nazwie "fixitdemo" i użyj hasła administratora serwera SQL "Passw0rd1", można na przykład, wprowadź następujące polecenie:</span><span class="sxs-lookup"><span data-stu-id="c8a92-314">For example, if you want to create a web app named "fixitdemo" and use a SQL Server administrator password of "Passw0rd1", you could enter the following command:</span></span>

    [!code-console[Main](the-fix-it-sample-application/samples/sample25.cmd)]

    <span data-ttu-id="c8a92-315">Nazwa musi być unikatowa w domenie azurewebsites.net, a hasło musi spełniać wymagania bazy danych SQL dla złożoności hasła.</span><span class="sxs-lookup"><span data-stu-id="c8a92-315">The name must be unique in the azurewebsites.net domain, and the password must meet SQL Database requirements for password complexity.</span></span> <span data-ttu-id="c8a92-316">(Przykład Passw0rd1 spełnia wymagań).</span><span class="sxs-lookup"><span data-stu-id="c8a92-316">(The example Passw0rd1 does meet the requirements.)</span></span>

    <span data-ttu-id="c8a92-317">Należy pamiętać, że polecenie rozpoczyna się od ". \".</span><span class="sxs-lookup"><span data-stu-id="c8a92-317">Note that the command begins with ".\".</span></span> <span data-ttu-id="c8a92-318">Aby zapobiec złośliwego wykonywania skryptów, programu Windows PowerShell wymaga podać w pełni kwalifikowana ścieżka do pliku skryptu w przypadku uruchamiania skryptu.</span><span class="sxs-lookup"><span data-stu-id="c8a92-318">To help prevent malicious execution of scripts, Windows PowerShell requires that you provide the fully qualified path to the script file when you run a script.</span></span> <span data-ttu-id="c8a92-319">Można użyć pojedynczego znaku kropki wskazuje bieżący katalog (".\") lub podaj pełną ścieżkę, takich jak:</span><span class="sxs-lookup"><span data-stu-id="c8a92-319">You can use a dot to indicate the current directory (".\") or provide the fully qualified path, such as:</span></span>

    [!code-console[Main](the-fix-it-sample-application/samples/sample26.cmd)]

    <span data-ttu-id="c8a92-320">Aby uzyskać więcej informacji na temat skryptu, użyj `Get-Help` polecenia cmdlet.</span><span class="sxs-lookup"><span data-stu-id="c8a92-320">For more information about the script, use the `Get-Help` cmdlet.</span></span>

    [!code-console[Main](the-fix-it-sample-application/samples/sample27.cmd)]

    <span data-ttu-id="c8a92-321">Można użyć `Detailed`, `Full`, `Parameters`, i `Examples` parametry polecenia cmdlet Get-Help, aby filtrować pomocy, która jest zwracana.</span><span class="sxs-lookup"><span data-stu-id="c8a92-321">You can use the `Detailed`, `Full`, `Parameters`, and `Examples` parameters of the Get-Help cmdlet to filter the help that is returned.</span></span>

    <span data-ttu-id="c8a92-322">Jeśli skrypt zakończy się niepowodzeniem lub generuje błędy, takie jak "AzureWebsite nowy: wywołanie AzureSubscription zestawu i wybierz AzureSubscription najpierw" nie została ukończona konfiguracji programu Azure PowerShell.</span><span class="sxs-lookup"><span data-stu-id="c8a92-322">If the script fails or generates errors, such as "New-AzureWebsite : Call Set-AzureSubscription and Select-AzureSubscription first," you might not have completed the configuration of Azure PowerShell.</span></span>

    <span data-ttu-id="c8a92-323">Po zakończeniu działania skryptu, aby wyświetlić zasoby, które zostały utworzone, jak pokazano w można użyć portalu zarządzania Azure [zautomatyzować wszystko](automate-everything.md) działu.</span><span class="sxs-lookup"><span data-stu-id="c8a92-323">After the script finishes, you can use the Azure Management Portal to see the resources that were created, as shown in the [Automate Everything](automate-everything.md) chapter.</span></span>
10. <span data-ttu-id="c8a92-324">Aby wdrożyć projekt automatyczne nowego środowiska platformy Azure, użyj *AzureWebsite.ps1* skryptu.</span><span class="sxs-lookup"><span data-stu-id="c8a92-324">To deploy the FixIt project to the new Azure environment, use the *AzureWebsite.ps1* script.</span></span> <span data-ttu-id="c8a92-325">Na przykład:</span><span class="sxs-lookup"><span data-stu-id="c8a92-325">For example:</span></span>

    [!code-console[Main](the-fix-it-sample-application/samples/sample28.cmd)]

    <span data-ttu-id="c8a92-326">Po zakończeniu wdrażania przeglądarce zostanie otwarty z napraw go, działające na platformie Azure.</span><span class="sxs-lookup"><span data-stu-id="c8a92-326">When deployment is done, the browser opens with Fix It running in Azure.</span></span>

<a id="troubleshooting"></a>
## <a name="troubleshooting-the-windows-powershell-scripts"></a><span data-ttu-id="c8a92-327">Rozwiązywanie problemów w skryptach środowiska Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="c8a92-327">Troubleshooting the Windows PowerShell scripts</span></span>

<span data-ttu-id="c8a92-328">Typowe błędy podczas uruchamiania tych skryptów są powiązane uprawnienia.</span><span class="sxs-lookup"><span data-stu-id="c8a92-328">The most common errors encountered when running these scripts are related to permissions.</span></span> <span data-ttu-id="c8a92-329">Upewnij się, że `Add-AzureAccount` i `Import-AzurePublishSettingsFile` zostały pomyślnie i używać tej samej subskrypcji platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="c8a92-329">Make sure that `Add-AzureAccount` and `Import-AzurePublishSettingsFile` were successful and that you used them for the same Azure subscription.</span></span> <span data-ttu-id="c8a92-330">Nawet jeśli `Add-AzureAccount` został pomyślnie trzeba będzie uruchomić go ponownie.</span><span class="sxs-lookup"><span data-stu-id="c8a92-330">Even if `Add-AzureAccount` was successful you might have to run it again.</span></span> <span data-ttu-id="c8a92-331">Uprawnienia dodane przez `Add-AzureAccount` wygaśnie w ciągu 12 godzin.</span><span class="sxs-lookup"><span data-stu-id="c8a92-331">The permissions added by `Add-AzureAccount` expire in 12 hours.</span></span>

### <a name="object-reference-not-set-to-an-instance-of-an-object"></a><span data-ttu-id="c8a92-332">Odwołanie do obiektu nie jest ustawione na wystąpienie obiektu.</span><span class="sxs-lookup"><span data-stu-id="c8a92-332">Object reference not set to an instance of an object.</span></span>

<span data-ttu-id="c8a92-333">Jeśli skrypt zwraca błędy, takie jak "Odwołanie do obiektu nie jest ustawione na wystąpienie obiektu" co oznacza, że programu Windows PowerShell nie można odnaleźć obiektu do procesu (jest to wyjątek odwołania zerowego), uruchom `Add-AzureAccount` polecenia cmdlet i spróbuj ponownie skrypt.</span><span class="sxs-lookup"><span data-stu-id="c8a92-333">If the script returns errors, such as "Object reference not set to an instance of an object," which means that Windows PowerShell can't find an object to process (this is a null reference exception), run the `Add-AzureAccount` cmdlet and try the script again.</span></span>

[!code-console[Main](the-fix-it-sample-application/samples/sample29.cmd)]

### <a name="internalerror-the-server-encountered-an-internal-error"></a><span data-ttu-id="c8a92-334">InternalError: Serwer napotkał błąd wewnętrzny.</span><span class="sxs-lookup"><span data-stu-id="c8a92-334">InternalError: The server encountered an internal error.</span></span>

<span data-ttu-id="c8a92-335">`New-AzureWebsite` Polecenie cmdlet zwraca błąd, gdy nazwa nie jest unikatowa w domenie azurewebsites.net.</span><span class="sxs-lookup"><span data-stu-id="c8a92-335">The `New-AzureWebsite` cmdlet returns an internal error when the name is not unique in the azurewebsites.net domain.</span></span> <span data-ttu-id="c8a92-336">Aby rozwiązać problem, użyj innej wartości dla nazwy, która jest parametr Name *AzureWebsiteEnv.ps1 nowy*.</span><span class="sxs-lookup"><span data-stu-id="c8a92-336">To resolve the error, use a different value for the name, which is in the Name parameter of *New-AzureWebsiteEnv.ps1*.</span></span>

[!code-console[Main](the-fix-it-sample-application/samples/sample30.cmd)]

### <a name="restarting-the-script"></a><span data-ttu-id="c8a92-337">Ponowne uruchomienie skryptu</span><span class="sxs-lookup"><span data-stu-id="c8a92-337">Restarting the script</span></span>

<span data-ttu-id="c8a92-338">Jeśli zachodzi potrzeba ponownego uruchomienia *AzureWebsiteEnv.ps1 nowy* skryptu ponieważ nie powiodło się przed wydrukowaniem go komunikat "Skryptu została zakończona", może chcesz usunąć zasoby, które zatrzymana skryptu przed go utworzyć.</span><span class="sxs-lookup"><span data-stu-id="c8a92-338">If you need to restart the *New-AzureWebsiteEnv.ps1* script because it failed before it printed the "Script is complete" message, you might want to delete resources that the script created before it stopped.</span></span> <span data-ttu-id="c8a92-339">Na przykład jeśli skrypt jest już utworzony ContosoFixItDemo aplikacji sieci web i ponownie uruchomić skrypt o tej samej nazwie, skrypt zakończy się niepowodzeniem, ponieważ nazwa jest używana.</span><span class="sxs-lookup"><span data-stu-id="c8a92-339">For example, if the script already created the ContosoFixItDemo web app and you run the script again with the same name, the script will fail because the name is in use.</span></span>

<span data-ttu-id="c8a92-340">Aby określić zasoby skryptu utworzonego przed został przerwany, użyj następujących poleceń cmdlet:</span><span class="sxs-lookup"><span data-stu-id="c8a92-340">To determine which resources the script created before it stopped, use the following cmdlets:</span></span>

- `Get-AzureWebsite`
- `Get-AzureSqlDatabaseServer`
- <span data-ttu-id="c8a92-341">`Get-AzureSqlDatabase`: Aby uruchomić to polecenie cmdlet, należy przekazać nazwę serwera bazy danych, aby `Get-AzureSqlDatabase`:</span><span class="sxs-lookup"><span data-stu-id="c8a92-341">`Get-AzureSqlDatabase`: To run this cmdlet, pipe the database server name to `Get-AzureSqlDatabase`:</span></span>  
    `Get-AzureSqlDatabaseServer | Get-AzureSqlDatabase.`

<span data-ttu-id="c8a92-342">Aby usunąć te zasoby, użyj następujących poleceń.</span><span class="sxs-lookup"><span data-stu-id="c8a92-342">To delete these resources, use the following commands.</span></span> <span data-ttu-id="c8a92-343">Pamiętaj, że po usunięciu serwera bazy danych zostanie automatycznie usunięcia skojarzone z serwerem bazy danych.</span><span class="sxs-lookup"><span data-stu-id="c8a92-343">Note that if you delete the database server, you automatically delete the databases associated with the server.</span></span>

- `Get-AzureWebsite -Name <WebsiteName> | Remove-AzureWebsite`
- `Get-AzureSqlDatabase -Name <DatabaseName> -ServerName <DatabaseServerName> | Remove-SqlAzureDatabase`
- `Get-AzureSqlDatabaseServer | Remove-AzureSqlDatabaseServer`

<a id="deployqueues"></a>
## <a name="how-to-deploy-the-app-with-queue-processing-to-azure-app-service-web-apps-and-an-azure-cloud-service"></a><span data-ttu-id="c8a92-344">Jak wdrożyć aplikację z kolejką przetwarzania do aplikacji sieci Web usługi aplikacji Azure i usługi w chmurze platformy Azure</span><span class="sxs-lookup"><span data-stu-id="c8a92-344">How to deploy the app with queue processing to Azure App Service Web Apps and an Azure Cloud Service</span></span>

<span data-ttu-id="c8a92-345">Aby włączyć kolejek, wprowadź następujące zmiany w pliku MyFixIt\Web.config.</span><span class="sxs-lookup"><span data-stu-id="c8a92-345">To enable queues, make the following change in the MyFixIt\Web.config file.</span></span> <span data-ttu-id="c8a92-346">W obszarze `appSettings`, zmień wartość `UseQueues` na wartość "true":</span><span class="sxs-lookup"><span data-stu-id="c8a92-346">Under `appSettings`, change the value of `UseQueues` to "true":</span></span> 

[!code-xml[Main](the-fix-it-sample-application/samples/sample31.xml)]

<span data-ttu-id="c8a92-347">Następnie wdrażanie aplikacji MVC dla aplikacji sieci web w usłudze Azure App Service, zgodnie z opisem [wcześniejszych](#deploybase).</span><span class="sxs-lookup"><span data-stu-id="c8a92-347">Then deploy the MVC application to an web app in Azure App Service, as described [earlier](#deploybase).</span></span>

<span data-ttu-id="c8a92-348">Następnie należy utworzyć nową usługę w chmurze Azure.</span><span class="sxs-lookup"><span data-stu-id="c8a92-348">Next, create a new Azure cloud service.</span></span> <span data-ttu-id="c8a92-349">Skrypty dołączony aplikacji Usuń nie tworzenia lub wdrażania usługi w chmurze, to trzeba używać portalu Azure.</span><span class="sxs-lookup"><span data-stu-id="c8a92-349">The scripts included with the Fix It app do not create or deploy the cloud service, so you must use Azure portal for this.</span></span> <span data-ttu-id="c8a92-350">W portalu kliknij **nowy** -- **obliczeniowe** — **usługi w chmurze** -- **szybkie tworzenie**, a następnie wprowadź adres URL i lokalizację centrum danych.</span><span class="sxs-lookup"><span data-stu-id="c8a92-350">In the portal, click **New** -- **Compute** – **Cloud Service** -- **Quick Create**, and then enter a URL and a data center location.</span></span> <span data-ttu-id="c8a92-351">Użyj tego samego centrum danych, której została wdrożona aplikacja sieci web.</span><span class="sxs-lookup"><span data-stu-id="c8a92-351">Use the same data center where you deployed the web app.</span></span>

![](the-fix-it-sample-application/_static/image1.png)

<span data-ttu-id="c8a92-352">Przed wdrożeniem usługi w chmurze, musisz zaktualizować niektóre pliki konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="c8a92-352">Before you can deploy the cloud service, you need to update some of the configuration files.</span></span>

<span data-ttu-id="c8a92-353">W MyFixIt.WorkerRoler\app.config w obszarze `connectionStrings`, zastąp wartość `appdb` ciągu połączenia za pomocą rzeczywistych parametrów połączenia z bazą danych SQL.</span><span class="sxs-lookup"><span data-stu-id="c8a92-353">In MyFixIt.WorkerRoler\app.config, under `connectionStrings`, replace the value of the `appdb` connection string with the actual connection string for the SQL Database.</span></span> <span data-ttu-id="c8a92-354">Parametry połączenia można pobrać z portalu.</span><span class="sxs-lookup"><span data-stu-id="c8a92-354">You can get the connection string from the portal.</span></span> <span data-ttu-id="c8a92-355">W portalu kliknij **baz danych SQL** - **appdb** - **parametry połączenia bazy danych SQL widoku ADO .net, PHP, ODBC i JDBC**.</span><span class="sxs-lookup"><span data-stu-id="c8a92-355">In the portal, click **SQL Databases** - **appdb** - **View SQL Database connection strings for ADO .Net, ODBC, PHP, and JDBC**.</span></span> <span data-ttu-id="c8a92-356">Skopiuj parametry połączenia ADO.NET i Wklej wartości w pliku app.config.</span><span class="sxs-lookup"><span data-stu-id="c8a92-356">Copy the ADO.NET connection string and paste the value into the app.config file.</span></span> <span data-ttu-id="c8a92-357">Zastąp "{Twojej\_hasło\_tutaj}" z hasła bazy danych.</span><span class="sxs-lookup"><span data-stu-id="c8a92-357">Replace "{your\_password\_here}" with your database password.</span></span> <span data-ttu-id="c8a92-358">(Zakładając, że skrypty są używane do wdrażania aplikacji MVC, określić hasło w `SqlDatabasePassword` skryptu parametru.)</span><span class="sxs-lookup"><span data-stu-id="c8a92-358">(Assuming you used the scripts to deploy the MVC app, you specified the database password in the `SqlDatabasePassword` script parameter.)</span></span>

<span data-ttu-id="c8a92-359">Wynik powinien wyglądać następująco:</span><span class="sxs-lookup"><span data-stu-id="c8a92-359">The result should look like the following:</span></span>

[!code-xml[Main](the-fix-it-sample-application/samples/sample32.xml)]

<span data-ttu-id="c8a92-360">W tym samym pliku MyFixIt.WorkerRoler\app.config w obszarze `appSettings`, Zastąp dwóch wartości symbolu zastępczego dla konta magazynu platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="c8a92-360">In the same MyFixIt.WorkerRoler\app.config file, under `appSettings`, replace the two placeholder values for the Azure storage account.</span></span>

[!code-xml[Main](the-fix-it-sample-application/samples/sample33.xml?highlight=2-3)]

<span data-ttu-id="c8a92-361">Klucz dostępu można pobrać z portalu.</span><span class="sxs-lookup"><span data-stu-id="c8a92-361">You can get the access key from the portal.</span></span> <span data-ttu-id="c8a92-362">Zobacz [jak zarządzać kontami magazynu](https://docs.microsoft.com/azure/storage/common/storage-create-storage-account).</span><span class="sxs-lookup"><span data-stu-id="c8a92-362">See [How To Manage Storage Accounts](https://docs.microsoft.com/azure/storage/common/storage-create-storage-account).</span></span>

<span data-ttu-id="c8a92-363">W MyFixItCloudService\ServiceConfiguration.Cloud.cscfg Zastąp tego samego dwóch wartości zastępcze dla konta magazynu platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="c8a92-363">In MyFixItCloudService\ServiceConfiguration.Cloud.cscfg, replace the same two placeholders values for the Azure storage account.</span></span>

[!code-xml[Main](the-fix-it-sample-application/samples/sample34.xml?highlight=3)]

<span data-ttu-id="c8a92-364">Teraz można przystąpić do wdrażania usługi w chmurze.</span><span class="sxs-lookup"><span data-stu-id="c8a92-364">Now you are ready to deploy the cloud service.</span></span> <span data-ttu-id="c8a92-365">W zapoznać się z rozwiązania, kliknij prawym przyciskiem myszy projekt MyFixItCloudService, a następnie wybierz **publikowania**.</span><span class="sxs-lookup"><span data-stu-id="c8a92-365">In Solution Explore, right-click the MyFixItCloudService project and select **Publish**.</span></span> <span data-ttu-id="c8a92-366">Aby uzyskać więcej informacji, zobacz "[wdrażanie aplikacji w usłudze Azure](https://www.windowsazure.com/develop/net/tutorials/multi-tier-web-site/2-download-and-run/#deployAz)", która znajduje się w części 2 [w tym samouczku](https://code.msdn.microsoft.com/Windows-Azure-Multi-Tier-eadceb36).</span><span class="sxs-lookup"><span data-stu-id="c8a92-366">For more information, see "[Deploy the Application to Azure](https://www.windowsazure.com/develop/net/tutorials/multi-tier-web-site/2-download-and-run/#deployAz)", which is in part 2 of [this tutorial](https://code.msdn.microsoft.com/Windows-Azure-Multi-Tier-eadceb36).</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="c8a92-367">Poprzednie</span><span class="sxs-lookup"><span data-stu-id="c8a92-367">Previous</span></span>](more-patterns-and-guidance.md)
