---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/debugging-stored-procedures-vb
title: "Debugowanie procedur składowanych (VB) | Dokumentacja firmy Microsoft"
author: rick-anderson
description: "Wersje Visual Studio Professional i Team System umożliwiają Ustaw punkty przerwania i Wkrocz do procedury składowane w programie SQL Server, co debugowania przechowywane..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 08/03/2007
ms.topic: article
ms.assetid: 9ed8ccb5-5f31-4eb4-976d-cabf4b45ca09
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/debugging-stored-procedures-vb
msc.type: authoredcontent
ms.openlocfilehash: e74d368b1f9eec2177a528a6b09c599d6a307b74
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 11/10/2017
---
<a name="debugging-stored-procedures-vb"></a><span data-ttu-id="8548d-103">Debugowanie procedur składowanych (VB)</span><span class="sxs-lookup"><span data-stu-id="8548d-103">Debugging Stored Procedures (VB)</span></span>
====================
<span data-ttu-id="8548d-104">przez [Bento Scott](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="8548d-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="8548d-105">[Pobierz kod](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_74_VB.zip) lub [pobierania plików PDF](debugging-stored-procedures-vb/_static/datatutorial74vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="8548d-105">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_74_VB.zip) or [Download PDF](debugging-stored-procedures-vb/_static/datatutorial74vb1.pdf)</span></span>

> <span data-ttu-id="8548d-106">Wersje Visual Studio Professional i Team System umożliwiają Ustaw punkty przerwania i Wkrocz do procedury składowane w programie SQL Server, co debugowanie procedur składowanych, wystarczy debugowanie kodu aplikacji.</span><span class="sxs-lookup"><span data-stu-id="8548d-106">Visual Studio Professional and Team System editions allow you to set breakpoints and step in to stored procedures within SQL Server, making debugging stored procedures as easy as debugging application code.</span></span> <span data-ttu-id="8548d-107">W tym samouczku przedstawiono debugowania bezpośredniego bazy danych oraz procedur składowanych debugowania aplikacji.</span><span class="sxs-lookup"><span data-stu-id="8548d-107">This tutorial demonstrates direct database debugging and application debugging of stored procedures.</span></span>


## <a name="introduction"></a><span data-ttu-id="8548d-108">Wprowadzenie</span><span class="sxs-lookup"><span data-stu-id="8548d-108">Introduction</span></span>

<span data-ttu-id="8548d-109">Program Visual Studio udostępnia bogate środowisko debugowania.</span><span class="sxs-lookup"><span data-stu-id="8548d-109">Visual Studio provides a rich debugging experience.</span></span> <span data-ttu-id="8548d-110">Z kilku naciśnięć klawiszy lub kliknięcia myszy go s można używać punktów przerwania, aby zatrzymać wykonanie programu i sprawdź jej stan i kontroli przepływu.</span><span class="sxs-lookup"><span data-stu-id="8548d-110">With a few keystrokes or clicks of the mouse, it s possible to use breakpoints to stop execution of a program and examine its state and control flow.</span></span> <span data-ttu-id="8548d-111">Wraz z debugowanie kodu aplikacji, program Visual Studio oferuje obsługę debugowania procedur składowanych z programu SQL Server.</span><span class="sxs-lookup"><span data-stu-id="8548d-111">Along with debugging application code, Visual Studio offers support for debugging stored procedures from within SQL Server.</span></span> <span data-ttu-id="8548d-112">Podobnie można ustawić punktów przerwania w kodzie ASP.NET klasę kodu lub klasy warstwy logiki biznesowej, zbyt one można umieścić w ramach procedur składowanych.</span><span class="sxs-lookup"><span data-stu-id="8548d-112">Just like breakpoints can be set within the code of an ASP.NET code-behind class or Business Logic Layer class, so too can they be placed within stored procedures.</span></span>

<span data-ttu-id="8548d-113">W tym samouczku przedstawiono Wkraczanie do procedur składowanych z Eksploratora serwera w programie Visual Studio oraz jak można ustawić punktów przerwania, które są osiągane, gdy procedura składowana jest wywoływana z działającej aplikacji ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="8548d-113">In this tutorial we will look at stepping into stored procedures from the Server Explorer within Visual Studio as well as how to set breakpoints that are hit when the stored procedure is called from the running ASP.NET application.</span></span>

> [!NOTE]
> <span data-ttu-id="8548d-114">Niestety procedur składowanych tylko można przeprowadził w i debugować przez wersje Professional i systemy zespołu programu Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="8548d-114">Unfortunately, stored procedures can only be stepped into and debugged through the Professional and Team Systems versions of Visual Studio.</span></span> <span data-ttu-id="8548d-115">Jeśli używasz wersji standard programu Visual Studio lub Visual Web Developer to Zapraszamy odczytu wzdłuż możemy przeprowadzenie czynności niezbędnych do debugowania procedur składowanych, ale nie można replikować następujące kroki na komputerze.</span><span class="sxs-lookup"><span data-stu-id="8548d-115">If you are using Visual Web Developer or the standard version of Visual Studio, you are welcome to read along as we walk through the steps necessary to debug stored procedures, but you will not be able to replicate these steps on your machine.</span></span>


## <a name="sql-server-debugging-concepts"></a><span data-ttu-id="8548d-116">Pojęcia debugowanie serwera SQL</span><span class="sxs-lookup"><span data-stu-id="8548d-116">SQL Server Debugging Concepts</span></span>

<span data-ttu-id="8548d-117">Microsoft SQL Server 2005 zaprojektowano tak, aby zapewnić integrację z [środowiska uruchomieniowego języka wspólnego (CLR)](https://msdn.microsoft.com/en-us/netframework/aa497266.aspx), który jest używany przez wszystkie zestawy .NET środowiska uruchomieniowego.</span><span class="sxs-lookup"><span data-stu-id="8548d-117">Microsoft SQL Server 2005 was designed to provide integration with the [Common Language Runtime (CLR)](https://msdn.microsoft.com/en-us/netframework/aa497266.aspx), which is the runtime used by all .NET assemblies.</span></span> <span data-ttu-id="8548d-118">W związku z tym SQL Server 2005 obsługuje obiektów zarządzanych bazy danych.</span><span class="sxs-lookup"><span data-stu-id="8548d-118">Consequently, SQL Server 2005 supports managed database objects.</span></span> <span data-ttu-id="8548d-119">Oznacza to, że można tworzyć obiektów bazy danych, takich jak procedury składowane i funkcje zdefiniowane przez użytkownika (UDF) jako metody w klasie Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="8548d-119">That is, you can create database objects like stored procedures and User-Defined Functions (UDFs) as methods in a Visual Basic class.</span></span> <span data-ttu-id="8548d-120">Dzięki temu te procedury składowane i funkcje UDF mogą korzystać z funkcji w programie .NET Framework i z klas niestandardowych.</span><span class="sxs-lookup"><span data-stu-id="8548d-120">This enables these stored procedures and UDFs to utilize functionality in the .NET Framework and from your own custom classes.</span></span> <span data-ttu-id="8548d-121">Oczywiście SQL Server 2005 także zapewnia obsługę T-SQL obiektów bazy danych.</span><span class="sxs-lookup"><span data-stu-id="8548d-121">Of course, SQL Server 2005 also provides support for T-SQL database objects.</span></span>

<span data-ttu-id="8548d-122">SQL Server 2005 oferuje obsługę debugowania dla T-SQL i obiekty zarządzane bazy danych.</span><span class="sxs-lookup"><span data-stu-id="8548d-122">SQL Server 2005 offers debugging support for both T-SQL and managed database objects.</span></span> <span data-ttu-id="8548d-123">Jednak te obiekty może być debugowany tylko przez wersje programu Visual Studio 2005 Professional i systemy zespołu.</span><span class="sxs-lookup"><span data-stu-id="8548d-123">However, these objects can only be debugged through Visual Studio 2005 Professional and Team Systems editions.</span></span> <span data-ttu-id="8548d-124">W tym samouczku omówione obiektów bazy danych w usłudze debugowania T-SQL.</span><span class="sxs-lookup"><span data-stu-id="8548d-124">In this tutorial we will examine debugging T-SQL database objects.</span></span> <span data-ttu-id="8548d-125">Samouczek kolejnych analizuje debugowanie zarządzane obiekty.</span><span class="sxs-lookup"><span data-stu-id="8548d-125">The subsequent tutorial looks at debugging managed database objects.</span></span>

<span data-ttu-id="8548d-126">[Omówienie T-SQL i CLR debugowania w programie SQL Server 2005](https://blogs.msdn.com/sqlclr/archive/2006/06/29/651644.aspx) wpis w blogu z [integracji środowiska CLR programu SQL Server 2005 team](https://blogs.msdn.com/sqlclr/default.aspx) wyróżnia trzy sposoby debugowania obiektów programu SQL Server 2005 z programu Visual Studio:</span><span class="sxs-lookup"><span data-stu-id="8548d-126">The [Overview of T-SQL and CLR Debugging in SQL Server 2005](https://blogs.msdn.com/sqlclr/archive/2006/06/29/651644.aspx) blog entry from the [SQL Server 2005 CLR Integration team](https://blogs.msdn.com/sqlclr/default.aspx) highlights the three ways to debug SQL Server 2005 objects from Visual Studio:</span></span>

- <span data-ttu-id="8548d-127">**Bezpośrednie debugowania bazy danych (DDD)** — z Eksploratora serwera, firma Microsoft może wkroczyć do obiektu do bazy danych T-SQL, takich jak procedury składowane i funkcje UDF.</span><span class="sxs-lookup"><span data-stu-id="8548d-127">**Direct Database Debugging (DDD)** - from Server Explorer we can step into any T-SQL database object, such as stored procedures and UDFs.</span></span> <span data-ttu-id="8548d-128">Omówione DDD w kroku 1.</span><span class="sxs-lookup"><span data-stu-id="8548d-128">We will examine DDD in Step 1.</span></span>
- <span data-ttu-id="8548d-129">**Debugowanie aplikacji** -możemy ustawić punkty przerwania w ramach obiektu bazy danych, a następnie uruchom naszej aplikacji ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="8548d-129">**Application Debugging** - we can set breakpoints within a database object and then run our ASP.NET application.</span></span> <span data-ttu-id="8548d-130">Kiedy obiekt bazy danych jest wykonywane, punkt przerwania zostanie uruchomiona, a kontroli do debugera.</span><span class="sxs-lookup"><span data-stu-id="8548d-130">When the database object is executed, the breakpoint will be hit and control turned over to the debugger.</span></span> <span data-ttu-id="8548d-131">Należy pamiętać, że z debugowaniem aplikacji firma Microsoft nie można wykonać kroku do obiektu bazy danych z kodu aplikacji.</span><span class="sxs-lookup"><span data-stu-id="8548d-131">Note that with application debugging we cannot step into a database object from application code.</span></span> <span data-ttu-id="8548d-132">Firma Microsoft musi jawnie ustaw punkty przerwania w tych procedur składowanych lub funkcji UDF gdy chcemy debugera, aby zatrzymać.</span><span class="sxs-lookup"><span data-stu-id="8548d-132">We must explicitly set breakpoints in those stored procedures or UDFs where we want the debugger to stop.</span></span> <span data-ttu-id="8548d-133">Debugowanie aplikacji jest zbadać uruchamianie w kroku 2.</span><span class="sxs-lookup"><span data-stu-id="8548d-133">Application debugging is examined starting in Step 2.</span></span>
- <span data-ttu-id="8548d-134">**Debugowanie z projektu programu SQL Server** — wersje programu Visual Studio Professional i systemy zespołu zawierać typu Projekt serwera SQL, który jest najczęściej używany do tworzenia obiektów zarządzanych bazy danych.</span><span class="sxs-lookup"><span data-stu-id="8548d-134">**Debugging from a SQL Server Project** - Visual Studio Professional and Team Systems editions include a SQL Server Project type that is commonly used to create managed database objects.</span></span> <span data-ttu-id="8548d-135">Omówione zostaną przy użyciu programu SQL Server — projekty i debugowanie ich zawartość w następnym samouczku.</span><span class="sxs-lookup"><span data-stu-id="8548d-135">We will examine using SQL Server Projects and debugging their contents in the next tutorial.</span></span>

<span data-ttu-id="8548d-136">Visual Studio można debugować procedury przechowywane w lokalnych i zdalnych wystąpieniach programu SQL Server.</span><span class="sxs-lookup"><span data-stu-id="8548d-136">Visual Studio can debug stored procedures on local and remote SQL Server instances.</span></span> <span data-ttu-id="8548d-137">Lokalne wystąpienie programu SQL Server to taki, który jest zainstalowany na tym samym komputerze co program Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="8548d-137">A local SQL Server instance is one that is installed on the same machine as Visual Studio.</span></span> <span data-ttu-id="8548d-138">Jeśli bazy danych SQL Server, którego używasz, nie znajduje się na komputerze deweloperskim, następnie uważa się wystąpienia zdalnego.</span><span class="sxs-lookup"><span data-stu-id="8548d-138">If the SQL Server database you are using is not located on your development machine, then it is considered a remote instance.</span></span> <span data-ttu-id="8548d-139">Te samouczki możemy korzystają lokalnego wystąpienia programu SQL Server.</span><span class="sxs-lookup"><span data-stu-id="8548d-139">For these tutorials we have been using local SQL Server instances.</span></span> <span data-ttu-id="8548d-140">Debugowanie procedur składowanych na zdalnym wystąpieniu programu SQL server wymaga większej liczby kroków konfiguracji niż podczas debugowania procedur przechowywanych w lokalnym wystąpieniu.</span><span class="sxs-lookup"><span data-stu-id="8548d-140">Debugging stored procedures on a remote SQL server instance requires more configuration steps than when debugging stored procedures on a local instance.</span></span>

<span data-ttu-id="8548d-141">Jeśli korzystasz z lokalnego wystąpienia programu SQL Server, można uruchomić z kroku 1 i skorzystać z tego samouczka na końcu.</span><span class="sxs-lookup"><span data-stu-id="8548d-141">If you are using a local SQL Server instance, you can start with Step 1 and work through this tutorial to the end.</span></span> <span data-ttu-id="8548d-142">Jeśli używasz zdalnego wystąpienia programu SQL Server, jednak użytkownik będzie upewnij się, że podczas debugowania, możesz pierwszy potrzebę są rejestrowane na komputerze deweloperskim przy użyciu konta użytkownika systemu Windows ma logowania programu SQL Server w wystąpieniu zdalnym.</span><span class="sxs-lookup"><span data-stu-id="8548d-142">If you are using a remote SQL Server instance, however, you will first need to ensure that when debugging you are logged to your development machine with a Windows user account that has a SQL Server login on the remote instance.</span></span> <span data-ttu-id="8548d-143">Moveover, zarówno w przypadku tej nazwy logowania bazy danych, jak i nazwy logowania bazy danych używane do łączenia z bazą danych z działającej aplikacji ASP.NET muszą być elementami członkowskimi `sysadmin` roli.</span><span class="sxs-lookup"><span data-stu-id="8548d-143">Moveover, both this database login and the database login used to connect to the database from the running ASP.NET application must be members of the `sysadmin` role.</span></span> <span data-ttu-id="8548d-144">Zobacz debugowania T-SQL obiektów bazy danych w sekcji wystąpień zdalnego na końcu tego samouczka, aby uzyskać więcej informacji na temat konfigurowania programu Visual Studio i SQL Server do debugowania zdalnego wystąpienia.</span><span class="sxs-lookup"><span data-stu-id="8548d-144">See the Debugging T-SQL Database Objects on Remote Instances section at the end of this tutorial for more information on configuring Visual Studio and SQL Server to debug a remote instance.</span></span>

<span data-ttu-id="8548d-145">Na koniec Dowiedz się, że debugowanie obsługę obiektów bazy danych T-SQL nie jest jako funkcja sformatowanego jako debugowania obsługę aplikacji .NET.</span><span class="sxs-lookup"><span data-stu-id="8548d-145">Finally, understand that debugging support for T-SQL database objects is not as feature rich as debugging support for .NET applications.</span></span> <span data-ttu-id="8548d-146">Na przykład warunków punktu przerwania i filtry nie są obsługiwane, tylko podzbiór debugowania systemu windows są dostępne, nie można użyć Edytuj i Kontynuuj, w oknie bezpośrednim jest renderowany bezużyteczne itd.</span><span class="sxs-lookup"><span data-stu-id="8548d-146">For example, breakpoint conditions and filters are not supported, only a subset of the debugging windows are available, you cannot use Edit and Continue, the Immediate window is rendered useless, and so forth.</span></span> <span data-ttu-id="8548d-147">Zobacz [mają zastosowanie ograniczenia dotyczące poleceń debugera i funkcji](https://msdn.microsoft.com/en-us/library/ms165035(VS.80).aspx) Aby uzyskać więcej informacji.</span><span class="sxs-lookup"><span data-stu-id="8548d-147">See [Limitations on Debugger Commands and Features](https://msdn.microsoft.com/en-us/library/ms165035(VS.80).aspx) for more information.</span></span>

## <a name="step-1-directly-stepping-into-a-stored-procedure"></a><span data-ttu-id="8548d-148">Krok 1: Bezpośrednio Wkraczanie do procedury składowanej</span><span class="sxs-lookup"><span data-stu-id="8548d-148">Step 1: Directly Stepping Into a Stored Procedure</span></span>

<span data-ttu-id="8548d-149">Visual Studio ułatwia bezpośrednio debugowania obiektu bazy danych.</span><span class="sxs-lookup"><span data-stu-id="8548d-149">Visual Studio makes it easy to directly debug a database object.</span></span> <span data-ttu-id="8548d-150">Let s, zobacz, jak korzystać z funkcji bezpośredniego debugowania bazy danych (DDD) Aby wkraczać do `Products_SelectByCategoryID` procedury przechowywanej w bazie danych Northwind.</span><span class="sxs-lookup"><span data-stu-id="8548d-150">Let s look at how to use the Direct Database Debugging (DDD) feature to step into the `Products_SelectByCategoryID` stored procedure in the Northwind database.</span></span> <span data-ttu-id="8548d-151">Jak jego nazwa wskazuje, `Products_SelectByCategoryID` zwraca informacje o produkcie dla określonej kategorii; został utworzony w [za pomocą istniejących procedur składowanych s wpisane DataSet TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) samouczka.</span><span class="sxs-lookup"><span data-stu-id="8548d-151">As its name implies, `Products_SelectByCategoryID` returns product information for a particular category; it was created in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial.</span></span> <span data-ttu-id="8548d-152">Uruchom, przechodząc do Eksploratora serwera, a następnie rozwiń węzeł bazy danych Northwind.</span><span class="sxs-lookup"><span data-stu-id="8548d-152">Start by going to the Server Explorer and expand the Northwind database node.</span></span> <span data-ttu-id="8548d-153">Następnie należy przejść do folderu procedur składowanych, kliknij prawym przyciskiem myszy `Products_SelectByCategoryID` procedury składowanej i wybierz opcję krok do procedury składowanej z menu kontekstowego.</span><span class="sxs-lookup"><span data-stu-id="8548d-153">Next, drill down into the Stored Procedures folder, right-click on the `Products_SelectByCategoryID` stored procedure, and choose the Step Into Stored Procedure option from the context menu.</span></span> <span data-ttu-id="8548d-154">Spowoduje to uruchomienie debugera.</span><span class="sxs-lookup"><span data-stu-id="8548d-154">This will start the debugger.</span></span>

<span data-ttu-id="8548d-155">Ponieważ `Products_SelectByCategoryID` oczekuje procedury składowanej `@CategoryID` parametru wejściowego, firma Microsoft jest proszony o podanie wartości.</span><span class="sxs-lookup"><span data-stu-id="8548d-155">Since the `Products_SelectByCategoryID` stored procedure expects a `@CategoryID` input parameter, we are asked to provide this value.</span></span> <span data-ttu-id="8548d-156">Wprowadź wartość 1, która zwraca informacje o napoje.</span><span class="sxs-lookup"><span data-stu-id="8548d-156">Enter 1, which will return information about the beverages.</span></span>


![Użyj wartości 1 dla @CategoryID parametru](debugging-stored-procedures-vb/_static/image1.png)

<span data-ttu-id="8548d-158">**Rysunek 1**: Użyj wartości 1 dla `@CategoryID` parametru</span><span class="sxs-lookup"><span data-stu-id="8548d-158">**Figure 1**: Use the Value 1 for the `@CategoryID` Parameter</span></span>


<span data-ttu-id="8548d-159">Po dostarczeniu wartość `@CategoryID` parametru procedury składowanej jest wykonywana.</span><span class="sxs-lookup"><span data-stu-id="8548d-159">After supplying the value for the `@CategoryID` parameter, the stored procedure is executed.</span></span> <span data-ttu-id="8548d-160">Zamiast uruchamiania do zakończenia, jednak debuger zatrzymuje wykonanie w pierwszej instrukcji.</span><span class="sxs-lookup"><span data-stu-id="8548d-160">Rather than running to completion, though, the debugger halts execution on the first statement.</span></span> <span data-ttu-id="8548d-161">Należy pamiętać, żółta strzałka na marginesie i wskazujący bieżącą lokalizację w procedurze składowanej.</span><span class="sxs-lookup"><span data-stu-id="8548d-161">Note the yellow arrow in the margin, indicating the current location in the stored procedure.</span></span> <span data-ttu-id="8548d-162">Można wyświetlać i edytować wartości parametrów za pomocą okna czujki lub umieszczając kursor myszy nad nazwę parametru w procedurze składowanej.</span><span class="sxs-lookup"><span data-stu-id="8548d-162">You can view and edit parameter values through the Watch window or by hovering over the parameter name in the stored procedure.</span></span>


<span data-ttu-id="8548d-163">[![Debuger został zatrzymany na pierwszej instrukcji procedury składowanej](debugging-stored-procedures-vb/_static/image3.png)](debugging-stored-procedures-vb/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="8548d-163">[![The Debugger has Halted on the First Statement of the Stored Procedure](debugging-stored-procedures-vb/_static/image3.png)](debugging-stored-procedures-vb/_static/image2.png)</span></span>

<span data-ttu-id="8548d-164">**Rysunek 2**: debuger został zatrzymany na pierwszej instrukcji procedury składowanej ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](debugging-stored-procedures-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="8548d-164">**Figure 2**: The Debugger has Halted on the First Statement of the Stored Procedure ([Click to view full-size image](debugging-stored-procedures-vb/_static/image4.png))</span></span>


<span data-ttu-id="8548d-165">Do wykonania kroków opisanych jednej instrukcji procedury składowanej w czasie, kliknij przycisk Step Over w pasku narzędzi lub naciśnij klawisz F10.</span><span class="sxs-lookup"><span data-stu-id="8548d-165">To step through the stored procedure one statement at a time, click the Step Over button in the Toolbar or hit the F10 key.</span></span> <span data-ttu-id="8548d-166">`Products_SelectByCategoryID` Procedury składowanej zawiera jeden `SELECT` instrukcji, więc naciśnięcie klawisza F10 będzie Przekrocz nad jednej instrukcji i zakończyć wykonywania procedury składowanej.</span><span class="sxs-lookup"><span data-stu-id="8548d-166">The `Products_SelectByCategoryID` stored procedure contains a single `SELECT` statement, so hitting F10 will step over the single statement and complete the execution of the stored procedure.</span></span> <span data-ttu-id="8548d-167">Po zakończeniu procedury składowanej, dane wyjściowe będą wyświetlane w oknie danych wyjściowych i spowoduje przerwanie w debugerze.</span><span class="sxs-lookup"><span data-stu-id="8548d-167">After the stored procedure has completed, its output will appear in the Output window and the debugger will terminate.</span></span>

> [!NOTE]
> <span data-ttu-id="8548d-168">Debugowania T-SQL występuje na poziomie instrukcji; Nie można wykonać kroku do `SELECT` instrukcji.</span><span class="sxs-lookup"><span data-stu-id="8548d-168">T-SQL debugging occurs at the statement level; you cannot step into a `SELECT` statement.</span></span>


## <a name="step-2-configuring-the-website-for-application-debugging"></a><span data-ttu-id="8548d-169">Krok 2: Konfigurowanie witryny sieci Web do debugowania aplikacji</span><span class="sxs-lookup"><span data-stu-id="8548d-169">Step 2: Configuring the Website for Application Debugging</span></span>

<span data-ttu-id="8548d-170">Podczas debugowania procedury składowanej bezpośrednio z poziomu Eksploratora serwera jest przydatne, w wielu scenariuszach NAS interesuje więcej debugowania procedury składowanej, gdy jest wywoływana z naszej aplikacji ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="8548d-170">While debugging a stored procedure directly from the Server Explorer is handy, in many scenarios we are more interested in debugging the stored procedure when it is called from our ASP.NET application.</span></span> <span data-ttu-id="8548d-171">Możemy dodać punkty przerwania do procedury składowanej z poziomu programu Visual Studio, a następnie Rozpocznij debugowanie aplikacji ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="8548d-171">We can add breakpoints to a stored procedure from within Visual Studio and then start debugging the ASP.NET application.</span></span> <span data-ttu-id="8548d-172">Po wywołaniu procedury składowanej z punktów przerwania z aplikacji, wykonanie spowoduje zatrzymanie na punkt przerwania i firma Microsoft wyświetlenie i zmianę wartości parametru procedury składowanej s i kroków opisanych w jego instrukcje, tak jak opisano w kroku 1.</span><span class="sxs-lookup"><span data-stu-id="8548d-172">When a stored procedure with breakpoints is invoked from the application, execution will halt at the breakpoint and we can view and change the stored procedure s parameter values and step through its statements, just like we did in Step 1.</span></span>

<span data-ttu-id="8548d-173">Przed możemy rozpocząć debugowanie procedury składowane wywoływane z aplikacji, należy poinstruować aplikacja sieci web ASP.NET w celu zintegrowania z debugera programu SQL Server.</span><span class="sxs-lookup"><span data-stu-id="8548d-173">Before we can start debugging stored procedures called from the application, we need to instruct the ASP.NET web application to integrate with the SQL Server debugger.</span></span> <span data-ttu-id="8548d-174">Uruchomić, klikając prawym przyciskiem myszy nazwę witryny sieci Web w Eksploratorze rozwiązań (`ASPNET_Data_Tutorial_74_VB`).</span><span class="sxs-lookup"><span data-stu-id="8548d-174">Start by right-clicking on the website name in the Solution Explorer (`ASPNET_Data_Tutorial_74_VB`).</span></span> <span data-ttu-id="8548d-175">Wybierz opcję strony właściwości z menu kontekstowego wybierz pozycję Opcje uruchamiania po lewej stronie i zaznacz pole wyboru programu SQL Server, w sekcji debugery (patrz rysunek 3).</span><span class="sxs-lookup"><span data-stu-id="8548d-175">Choose the Property Pages option from the context menu, select the Start Options item on the left, and check the SQL Server checkbox in the Debuggers section (see Figure 3).</span></span>


<span data-ttu-id="8548d-176">[![Zaznacz pole wyboru serwera SQL na stronach właściwości s aplikacji](debugging-stored-procedures-vb/_static/image6.png)](debugging-stored-procedures-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="8548d-176">[![Check the SQL Server Checkbox in the Application s Property Pages](debugging-stored-procedures-vb/_static/image6.png)](debugging-stored-procedures-vb/_static/image5.png)</span></span>

<span data-ttu-id="8548d-177">**Rysunek 3**: pole wyboru programu SQL Server w aplikacji s strony właściwości ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](debugging-stored-procedures-vb/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="8548d-177">**Figure 3**: Check the SQL Server Checkbox in the Application s Property Pages ([Click to view full-size image](debugging-stored-procedures-vb/_static/image7.png))</span></span>


<span data-ttu-id="8548d-178">Ponadto należy zaktualizować parametry połączenia bazy danych używane przez aplikację tak, czy buforowanie połączeń jest wyłączona.</span><span class="sxs-lookup"><span data-stu-id="8548d-178">Additionally, we need to update the database connection string used by the application so that connection pooling is disabled.</span></span> <span data-ttu-id="8548d-179">Zamknięcie połączenia z bazą danych odpowiadającego `SqlConnection` obiekt znajduje się w puli dostępnych połączeń.</span><span class="sxs-lookup"><span data-stu-id="8548d-179">When a connection to a database is closed, the corresponding `SqlConnection` object is placed in a pool of available connections.</span></span> <span data-ttu-id="8548d-180">Podczas nawiązywania połączenia z bazą danych, obiektu dostępne połączenia mogą być pobierane z tej puli zamiast konieczności tworzenia i nawiązania nowego połączenia.</span><span class="sxs-lookup"><span data-stu-id="8548d-180">When establishing a connection to a database, an available connection object can be retrieved from this pool rather than having to create and establish a new connection.</span></span> <span data-ttu-id="8548d-181">To buforowanie obiektów połączenia jest zwiększenie wydajności i jest domyślnie włączona.</span><span class="sxs-lookup"><span data-stu-id="8548d-181">This pooling of connection objects is a performance enhancement and is enabled by default.</span></span> <span data-ttu-id="8548d-182">Jednak w przypadku debugowania chcemy wyłączyć buforowanie połączeń, ponieważ debugowania infrastruktury jest nie poprawnie została przywrócona podczas pracy z połączenia, która została wykonana z puli.</span><span class="sxs-lookup"><span data-stu-id="8548d-182">However, when debugging we want to turn off connection pooling because the debugging infrastructure is not correctly reestablished when working with a connection that was taken from the pool.</span></span>

<span data-ttu-id="8548d-183">Aby Buforowanie wyłączone połączeń, należy zaktualizować `NORTHWNDConnectionString` w `Web.config` co zawierają one ustawienia `Pooling=false` .</span><span class="sxs-lookup"><span data-stu-id="8548d-183">To disabled connection pooling, update the `NORTHWNDConnectionString` in `Web.config` so that it includes the setting `Pooling=false` .</span></span>


[!code-xml[Main](debugging-stored-procedures-vb/samples/sample1.xml)]

> [!NOTE]
> <span data-ttu-id="8548d-184">Po zakończeniu debugowania programu SQL Server za pośrednictwem aplikacji ASP.NET należy przywrócić puli połączeń przez usunięcie `Pooling` ustawienie z ciągu połączenia (lub przez ustawienie jej na `Pooling=true` ).</span><span class="sxs-lookup"><span data-stu-id="8548d-184">Once you have finished debugging SQL Server through the ASP.NET application be sure to reinstate connection pooling by removing the `Pooling` setting from the connection string (or by setting it to `Pooling=true` ).</span></span>


<span data-ttu-id="8548d-185">W tym momencie umożliwia Visual Studio, aby debugować obiektów bazy danych programu SQL Server, gdy została wywołana przy użyciu aplikacji sieci web skonfigurowano aplikacji ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="8548d-185">At this point the ASP.NET application has been configured to allow Visual Studio to debug SQL Server database objects when invoked through the web application.</span></span> <span data-ttu-id="8548d-186">Wszystkie punkty, które pozostaje teraz jest dodanie punktu przerwania do procedury składowanej i Rozpocznij debugowanie!</span><span class="sxs-lookup"><span data-stu-id="8548d-186">All that remains now is to add a breakpoint to a stored procedure and start debugging!</span></span>

## <a name="step-3-adding-a-breakpoint-and-debugging"></a><span data-ttu-id="8548d-187">Krok 3: Dodawanie punktu przerwania i debugowania</span><span class="sxs-lookup"><span data-stu-id="8548d-187">Step 3: Adding a Breakpoint and Debugging</span></span>

<span data-ttu-id="8548d-188">Otwórz `Products_SelectByCategoryID` procedury składowanej i ustaw punkt przerwania na początku `SELECT` instrukcji, klikając na marginesie w odpowiednim miejscu lub umieszczając kursor na początku `SELECT` instrukcji i naciśnięcie klawisza F9.</span><span class="sxs-lookup"><span data-stu-id="8548d-188">Open the `Products_SelectByCategoryID` stored procedure and set a breakpoint at the start of the `SELECT` statement by clicking in the margin at the appropriate place or by placing your cursor at the start of the `SELECT` statement and hitting F9.</span></span> <span data-ttu-id="8548d-189">Jak pokazano na rysunku 4, punkt przerwania jest wyświetlany jako czerwone kółko na marginesie.</span><span class="sxs-lookup"><span data-stu-id="8548d-189">As Figure 4 illustrates, the breakpoint appears as a red circle in the margin.</span></span>


<span data-ttu-id="8548d-190">[![Ustaw punkt przerwania w Products_SelectByCategoryID procedury składowanej](debugging-stored-procedures-vb/_static/image9.png)](debugging-stored-procedures-vb/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="8548d-190">[![Set a Breakpoint in the Products_SelectByCategoryID Stored Procedure](debugging-stored-procedures-vb/_static/image9.png)](debugging-stored-procedures-vb/_static/image8.png)</span></span>

<span data-ttu-id="8548d-191">**Rysunek 4**: Ustaw punkt przerwania `Products_SelectByCategoryID` procedury składowanej ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](debugging-stored-procedures-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="8548d-191">**Figure 4**: Set a Breakpoint in the `Products_SelectByCategoryID` Stored Procedure ([Click to view full-size image](debugging-stored-procedures-vb/_static/image10.png))</span></span>


<span data-ttu-id="8548d-192">Aby dla obiektu bazy danych SQL do debugowania za pośrednictwem aplikacji klienckiej konieczne jest skonfigurowania bazy danych do obsługi debugowania aplikacji.</span><span class="sxs-lookup"><span data-stu-id="8548d-192">In order for a SQL database object to be debugged through a client application, it is imperative that the database be configured to support application debugging.</span></span> <span data-ttu-id="8548d-193">Jeśli najpierw ustawić punkt przerwania, powinien automatycznie włączyć to ustawienie, ale zaleca się dokładnie.</span><span class="sxs-lookup"><span data-stu-id="8548d-193">When you first set a breakpoint, this setting should automatically be switched on, but it is prudent to double-check.</span></span> <span data-ttu-id="8548d-194">Kliknij prawym przyciskiem myszy `NORTHWND.MDF` węzła w Eksploratorze serwera.</span><span class="sxs-lookup"><span data-stu-id="8548d-194">Right-click on the `NORTHWND.MDF` node in the Server Explorer.</span></span> <span data-ttu-id="8548d-195">Menu kontekstowe powinna zawierać zaznaczony element menu o nazwie debugowania aplikacji.</span><span class="sxs-lookup"><span data-stu-id="8548d-195">The context menu should include a checked menu item named Application Debugging .</span></span>


![Upewnij się, że jest włączona opcja debugowania aplikacji](debugging-stored-procedures-vb/_static/image11.png)

<span data-ttu-id="8548d-197">**Rysunek 5**: Upewnij się, że jest włączona opcja debugowania aplikacji</span><span class="sxs-lookup"><span data-stu-id="8548d-197">**Figure 5**: Ensure that the Application Debugging Option is Enabled</span></span>


<span data-ttu-id="8548d-198">Ustaw punkt przerwania i włączyć opcję debugowania aplikacji firma Microsoft przystąpić do debugowania procedury składowanej przy wywołaniach z aplikacji ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="8548d-198">With the breakpoint set and the Application Debugging option enabled, we are ready to debug the stored procedure when called from the ASP.NET application.</span></span> <span data-ttu-id="8548d-199">Uruchom debuger, przechodząc do menu Debugowanie i wybieranie Rozpocznij debugowanie przez naciskać klawisz F5 lub przez kliknięcie przycisku zielonego odtwarzania ikonę na pasku narzędzi.</span><span class="sxs-lookup"><span data-stu-id="8548d-199">Start the debugger by going to the Debug menu and choosing Start Debugging, by hitting F5, or by clicking the green play icon in the Toolbar.</span></span> <span data-ttu-id="8548d-200">To uruchomienia debugera i uruchomić witryny sieci Web.</span><span class="sxs-lookup"><span data-stu-id="8548d-200">This will start the debugger and launch the website.</span></span>

<span data-ttu-id="8548d-201">`Products_SelectByCategoryID` Procedura składowana została utworzona w [za pomocą istniejących procedur składowanych s wpisane DataSet TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) samouczka.</span><span class="sxs-lookup"><span data-stu-id="8548d-201">The `Products_SelectByCategoryID` stored procedure was created in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial.</span></span> <span data-ttu-id="8548d-202">Odpowiedniej strony sieci web (`~/AdvancedDAL/ExistingSprocs.aspx`) zawiera element GridView wyświetlający wyników zwróconych przez tę procedurę składowaną.</span><span class="sxs-lookup"><span data-stu-id="8548d-202">Its corresponding web page (`~/AdvancedDAL/ExistingSprocs.aspx`) contains a GridView that displays the results returned by this stored procedure.</span></span> <span data-ttu-id="8548d-203">Odwiedź stronę tej strony za pomocą przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="8548d-203">Visit this page through the browser.</span></span> <span data-ttu-id="8548d-204">Na stronie punkt przerwania w osiągnięciu `Products_SelectByCategoryID` procedury składowanej zostanie uruchomiona i kontroli zwróciła dla programu Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="8548d-204">Upon reaching the page, the breakpoint in the `Products_SelectByCategoryID` stored procedure will be hit and control returned to Visual Studio.</span></span> <span data-ttu-id="8548d-205">Podobnie jak w kroku 1 można krok za pomocą procedury składowanej s instrukcje i widoku i modyfikować wartości parametrów.</span><span class="sxs-lookup"><span data-stu-id="8548d-205">Just like in Step 1, you can step through the stored procedure s statements and view and modify the parameter values.</span></span>


<span data-ttu-id="8548d-206">[![Na stronie ExistingSprocs.aspx początkowo wyświetlane napoje](debugging-stored-procedures-vb/_static/image13.png)](debugging-stored-procedures-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="8548d-206">[![The ExistingSprocs.aspx Page Initially Displays the Beverages](debugging-stored-procedures-vb/_static/image13.png)](debugging-stored-procedures-vb/_static/image12.png)</span></span>

<span data-ttu-id="8548d-207">**Rysunek 6**: `ExistingSprocs.aspx` początkowo zostanie wyświetlona strona napoje ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](debugging-stored-procedures-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="8548d-207">**Figure 6**: The `ExistingSprocs.aspx` Page Initially Displays the Beverages ([Click to view full-size image](debugging-stored-procedures-vb/_static/image14.png))</span></span>


<span data-ttu-id="8548d-208">[![S procedury składowanej punkt przerwania został osiągnięty](debugging-stored-procedures-vb/_static/image16.png)](debugging-stored-procedures-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="8548d-208">[![The Stored Procedure s Breakpoint has been Reached](debugging-stored-procedures-vb/_static/image16.png)](debugging-stored-procedures-vb/_static/image15.png)</span></span>

<span data-ttu-id="8548d-209">**Rysunek 7**: s procedury składowanej punkt przerwania został osiągnięty ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](debugging-stored-procedures-vb/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="8548d-209">**Figure 7**: The Stored Procedure s Breakpoint has been Reached ([Click to view full-size image](debugging-stored-procedures-vb/_static/image17.png))</span></span>


<span data-ttu-id="8548d-210">Okno czujki w przedstawiono na rysunku nr 7, wartość `@CategoryID` parametru to 1.</span><span class="sxs-lookup"><span data-stu-id="8548d-210">As the Watch window in Figure 7 shows, the value of the `@CategoryID` parameter is 1.</span></span> <span data-ttu-id="8548d-211">Jest to spowodowane `ExistingSprocs.aspx` początkowo zostanie wyświetlona strona produktów w należące do tej kategorii, który ma `CategoryID` wartość 1.</span><span class="sxs-lookup"><span data-stu-id="8548d-211">This is because the `ExistingSprocs.aspx` page initially displays products in the beverages category, which has a `CategoryID` value of 1.</span></span> <span data-ttu-id="8548d-212">Wybierz inną kategorię z listy rozwijanej.</span><span class="sxs-lookup"><span data-stu-id="8548d-212">Choose a different category from the drop-down list.</span></span> <span data-ttu-id="8548d-213">To powoduje odświeżenie strony, a następnie ponownie wykonuje `Products_SelectByCategoryID` procedury składowanej.</span><span class="sxs-lookup"><span data-stu-id="8548d-213">Doing so causes a postback and re-executes the `Products_SelectByCategoryID` stored procedure.</span></span> <span data-ttu-id="8548d-214">Punkt przerwania zostaje trafiony ponownie, ale tym razem `@CategoryID` wartość parametru s odzwierciedla element wybranej listy rozwijanej s `CategoryID`.</span><span class="sxs-lookup"><span data-stu-id="8548d-214">The breakpoint is hit again, but this time the `@CategoryID` parameter s value reflects the selected drop-down list item s `CategoryID`.</span></span>


<span data-ttu-id="8548d-215">[![Wybierz inną kategorię z listy rozwijanej](debugging-stored-procedures-vb/_static/image19.png)](debugging-stored-procedures-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="8548d-215">[![Choose a Different Category from the Drop-Down List](debugging-stored-procedures-vb/_static/image19.png)](debugging-stored-procedures-vb/_static/image18.png)</span></span>

<span data-ttu-id="8548d-216">**Rysunek 8**: Wybierz inną kategorię z listy rozwijanej ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](debugging-stored-procedures-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="8548d-216">**Figure 8**: Choose a Different Category from the Drop-Down List ([Click to view full-size image](debugging-stored-procedures-vb/_static/image20.png))</span></span>


<span data-ttu-id="8548d-217">[![@CategoryID Parametr odzwierciedla wybór kategorii na stronie sieci Web](debugging-stored-procedures-vb/_static/image22.png)](debugging-stored-procedures-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="8548d-217">[![The @CategoryID Parameter Reflects the Category Selected from the Web Page](debugging-stored-procedures-vb/_static/image22.png)](debugging-stored-procedures-vb/_static/image21.png)</span></span>

<span data-ttu-id="8548d-218">**Rysunek 9**: `@CategoryID` parametru odzwierciedla wybrać kategorię ze strony sieci Web ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](debugging-stored-procedures-vb/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="8548d-218">**Figure 9**: The `@CategoryID` Parameter Reflects the Category Selected from the Web Page ([Click to view full-size image](debugging-stored-procedures-vb/_static/image23.png))</span></span>


> [!NOTE]
> <span data-ttu-id="8548d-219">Jeśli punkt przerwania w `Products_SelectByCategoryID` procedury składowanej nie zostaje trafiony podczas odwiedzania `ExistingSprocs.aspx` upewnij się, że pole wyboru programu SQL Server została sprawdzona w sekcji debugery s stronę właściwości aplikacji ASP.NET, czy buforowanie połączeń został wyłączone i włączenie bazy danych s opcji debugowania aplikacji.</span><span class="sxs-lookup"><span data-stu-id="8548d-219">If the breakpoint in the `Products_SelectByCategoryID` stored procedure is not hit when visiting the `ExistingSprocs.aspx` page, make sure that the SQL Server checkbox has been checked in the Debuggers section of the ASP.NET application s Properties Page, that connection pooling has been disabled, and that the database s Application Debugging option is enabled.</span></span> <span data-ttu-id="8548d-220">Jeśli środowisko odzyskiwania nadal występują problemy, uruchom ponownie program Visual Studio i spróbuj ponownie.</span><span class="sxs-lookup"><span data-stu-id="8548d-220">If you re still having problems, restart Visual Studio and try again.</span></span>


## <a name="debugging-t-sql-database-objects-on-remote-instances"></a><span data-ttu-id="8548d-221">T-SQL bazy danych obiektów w wystąpieniach zdalnego debugowania</span><span class="sxs-lookup"><span data-stu-id="8548d-221">Debugging T-SQL Database Objects on Remote Instances</span></span>

<span data-ttu-id="8548d-222">Debugowanie obiektów bazy danych za pomocą programu Visual Studio jest bardzo prosta, gdy wystąpienie bazy danych programu SQL Server znajduje się w tym samym komputerze co program Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="8548d-222">Debugging database objects through Visual Studio is fairly straightforward when the SQL Server database instance is on the same machine as Visual Studio.</span></span> <span data-ttu-id="8548d-223">Jednak jeśli program SQL Server i Visual Studio znajdują się na różnych komputerach dokładne konfiguracyjnych jest wymagane do pobrania wszystko działa prawidłowo.</span><span class="sxs-lookup"><span data-stu-id="8548d-223">However, if SQL Server and Visual Studio reside on different machines then some careful configuration is required to get everything working properly.</span></span> <span data-ttu-id="8548d-224">Istnieją dwa podstawowych zadań, które firma Microsoft muszą stawiać czoła:</span><span class="sxs-lookup"><span data-stu-id="8548d-224">There are two core tasks we are faced with:</span></span>

- <span data-ttu-id="8548d-225">Upewnij się, że nazwa logowania używana do łączenia z bazą danych za pomocą ADO.NET należy do `sysadmin` roli.</span><span class="sxs-lookup"><span data-stu-id="8548d-225">Ensure that the login used to connect to the database via ADO.NET belongs to the `sysadmin` role.</span></span>
- <span data-ttu-id="8548d-226">Upewnij się, że konto użytkownika systemu Windows, które są używane przez program Visual Studio na komputerze deweloperskim jest prawidłowe konto logowania programu SQL Server, który należy do `sysadmin` roli.</span><span class="sxs-lookup"><span data-stu-id="8548d-226">Ensure that the Windows user account used by Visual Studio on the development machine is a valid SQL Server login account that belongs to the `sysadmin` role.</span></span>

<span data-ttu-id="8548d-227">Pierwszym krokiem jest stosunkowo proste.</span><span class="sxs-lookup"><span data-stu-id="8548d-227">The first step is relatively straightforward.</span></span> <span data-ttu-id="8548d-228">Ustalenie konto użytkownika używane do połączenia z bazą danych z aplikacji ASP.NET, a następnie, z programu SQL Server Management Studio, dodaj to konto logowania do `sysadmin` roli.</span><span class="sxs-lookup"><span data-stu-id="8548d-228">First, identify the user account used to connect to the database from the ASP.NET application and then, from SQL Server Management Studio, add that login account to the `sysadmin` role.</span></span>

<span data-ttu-id="8548d-229">Drugie zadanie wymaga, aby konto użytkownika systemu Windows, którego używasz do debugowania aplikacji prawidłową nazwą logowania na zdalnej bazy danych.</span><span class="sxs-lookup"><span data-stu-id="8548d-229">The second task requires that the Windows user account you use to debug the application be a valid login on the remote database.</span></span> <span data-ttu-id="8548d-230">Jednak prawdopodobnie po zalogowaniu do stacji roboczej z konta systemu Windows nie jest prawidłową nazwą logowania na serwerze SQL.</span><span class="sxs-lookup"><span data-stu-id="8548d-230">However, chances are the Windows account you logged on to your workstation with is not a valid login on SQL Server.</span></span> <span data-ttu-id="8548d-231">Zamiast dodawać konta określonego logowania do programu SQL Server, lepszym rozwiązaniem byłoby wyznaczyć niektóre konta użytkownika systemu Windows jako konto debugowania programu SQL Server.</span><span class="sxs-lookup"><span data-stu-id="8548d-231">Rather than adding your particular login account to SQL Server, a better choice would be to designate some Windows user account as the SQL Server debugging account.</span></span> <span data-ttu-id="8548d-232">Następnie Aby debugować obiektów bazy danych, zdalnego wystąpienia programu SQL Server, należy uruchomić program Visual Studio przy użyciu tego konta s poświadczenia logowania systemu Windows.</span><span class="sxs-lookup"><span data-stu-id="8548d-232">Then, to debug the database objects of a remote SQL Server instance, you would run Visual Studio using that Windows login account s credentials.</span></span>

<span data-ttu-id="8548d-233">Przykład powinny pomóc w wyjaśnienia rzeczy.</span><span class="sxs-lookup"><span data-stu-id="8548d-233">An example should help clarify things.</span></span> <span data-ttu-id="8548d-234">Załóżmy, że istnieje konto systemu Windows o nazwie `SQLDebug` w domenie systemu Windows.</span><span class="sxs-lookup"><span data-stu-id="8548d-234">Imagine that there is a Windows account named `SQLDebug` within the Windows domain.</span></span> <span data-ttu-id="8548d-235">To konto będzie należy dodać do zdalnego wystąpienia programu SQL Server jako prawidłową nazwą logowania i jako element członkowski `sysadmin` roli.</span><span class="sxs-lookup"><span data-stu-id="8548d-235">This account would need to be added to the remote SQL Server instance as a valid login and as a member of the `sysadmin` role.</span></span> <span data-ttu-id="8548d-236">Następnie do debugowania zdalnego wystąpienia programu SQL Server w programie Visual Studio, czy należy uruchomić program Visual Studio jako `SQLDebug` użytkownika.</span><span class="sxs-lookup"><span data-stu-id="8548d-236">Then, to debug the remote SQL Server instance from Visual Studio, we would need to run Visual Studio as the `SQLDebug` user.</span></span> <span data-ttu-id="8548d-237">Można to zrobić przez wylogowanie naszych stacji roboczej, logować się ponownie jako `SQLDebug`, a następnie uruchamiania programu Visual Studio, ale prostsze będzie zalogować się do naszej stacji roboczej przy użyciu własnej poświadczeń, a następnie użyć `runas.exe` można uruchomić programu Visual Studio jako `SQLDebug` użytkownika.</span><span class="sxs-lookup"><span data-stu-id="8548d-237">This could be done by logging out of our workstation, logging back in as `SQLDebug`, and then launching Visual Studio, but a simpler approach would be to login to our workstation using our own credentials and then use `runas.exe` to launch Visual Studio as the `SQLDebug` user.</span></span> <span data-ttu-id="8548d-238">`runas.exe`Umożliwia określonej aplikacji ma być wykonywana w ramach podszywając innego konta użytkownika.</span><span class="sxs-lookup"><span data-stu-id="8548d-238">`runas.exe` allows a particular application to be executed under the guise of a different user account.</span></span> <span data-ttu-id="8548d-239">Aby uruchomić program Visual Studio jako `SQLDebug`, można wprowadzić następującą instrukcję w wierszu polecenia:</span><span class="sxs-lookup"><span data-stu-id="8548d-239">To launch Visual Studio as `SQLDebug`, you could enter the following statement at the command line:</span></span>


[!code-console[Main](debugging-stored-procedures-vb/samples/sample2.cmd)]

<span data-ttu-id="8548d-240">Aby uzyskać bardziej szczegółowy opis w tym procesie, zobacz [Vaughn R. łączy](http://betav.com/BLOG/billva/) s *Hitchhiker s Przewodnik po Visual Studio i SQL Server Edition siódmego* oraz [jak: Ustawianie uprawnień serwera SQL debugowanie](https://msdn.microsoft.com/en-us/library/w1bhybwz(VS.80).aspx).</span><span class="sxs-lookup"><span data-stu-id="8548d-240">For a more detailed explanation on this process, see [William R. Vaughn](http://betav.com/BLOG/billva/) s *Hitchhiker s Guide to Visual Studio and SQL Server, Seventh Edition* as well as [How To: Set SQL Server Permissions for Debugging](https://msdn.microsoft.com/en-us/library/w1bhybwz(VS.80).aspx).</span></span>

> [!NOTE]
> <span data-ttu-id="8548d-241">Jeśli na komputerze deweloperskim działa dodatku Service Pack 2 dla systemu Windows XP należy skonfigurować zaporę połączenia internetowego w celu zezwolenia na debugowanie zdalne.</span><span class="sxs-lookup"><span data-stu-id="8548d-241">If your development machine is running Windows XP Service Pack 2 you will need to configure the Internet Connection Firewall to allow remote debugging.</span></span> <span data-ttu-id="8548d-242">[Jak do: Włączanie debugowania programu SQL Server 2005](https://msdn.microsoft.com/en-us/library/s0fk6z6e(VS.80).aspx) zawiera informacje dotyczące artykułu, ten proces obejmuje dwa kroki: () na komputerze hosta programu Visual Studio, należy dodać `Devenv.exe` do listy wyjątków i otwórz port TCP 135; oraz (b) na komputerze zdalnym (SQL), należy otworzyć TCP 135 portu, a następnie dodaj `sqlservr.exe` do listy wyjątków.</span><span class="sxs-lookup"><span data-stu-id="8548d-242">[The How To: Enable SQL Server 2005 Debugging](https://msdn.microsoft.com/en-us/library/s0fk6z6e(VS.80).aspx) article notes that this involves two steps: (a) On the Visual Studio host machine, you must add `Devenv.exe` to the Exceptions list and open the TCP 135 port; and (b) On the remote (SQL) machine, you must open the TCP 135 port and add `sqlservr.exe` to the Exceptions list.</span></span> <span data-ttu-id="8548d-243">Jeśli zasady domeny wymaga komunikacji sieciowej można zrobić za pomocą protokołu IPSec, należy otworzyć porty UDP 4500 i UDP 500.</span><span class="sxs-lookup"><span data-stu-id="8548d-243">If your domain policy requires network communication to be done through IPSec, you must open the UDP 4500 and UDP 500 ports.</span></span>


## <a name="summary"></a><span data-ttu-id="8548d-244">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="8548d-244">Summary</span></span>

<span data-ttu-id="8548d-245">Oprócz zapewnienia obsługę debugowania dla kodu aplikacji platformy .NET, program Visual Studio oferuje szeroką gamę opcji debugowania dla programu SQL Server 2005.</span><span class="sxs-lookup"><span data-stu-id="8548d-245">In addition to providing debugging support for .NET application code, Visual Studio also provides a variety of debugging options for SQL Server 2005.</span></span> <span data-ttu-id="8548d-246">W tym samouczku analizujemy dwa z tych opcji: bezpośrednie debugowania bazy danych i debugowania aplikacji.</span><span class="sxs-lookup"><span data-stu-id="8548d-246">In this tutorial we looked at two of those options: Direct Database Debugging and application debugging.</span></span> <span data-ttu-id="8548d-247">Bezpośrednio debugowania T-SQL obiektu bazy danych, zlokalizuj obiektu za pomocą Eksploratora serwera, a następnie kliknij prawym przyciskiem myszy na nim i wybierz polecenie Step Into.</span><span class="sxs-lookup"><span data-stu-id="8548d-247">To directly debug a T-SQL database object, locate the object through the Server Explorer then right-click on it and choose Step Into.</span></span> <span data-ttu-id="8548d-248">Uruchomienie debugera i zatrzymuje na pierwszą instrukcją w obiekcie bazy danych, w takim przypadku można kroków opisanych w instrukcji s obiektów i widoku i modyfikować wartości parametrów.</span><span class="sxs-lookup"><span data-stu-id="8548d-248">This starts the debugger and halts on the first statement in the database object, at which point you can step through the object s statements and view and modify parameter values.</span></span> <span data-ttu-id="8548d-249">W kroku 1 użyliśmy tej metody, aby wkraczać do `Products_SelectByCategoryID` procedury składowanej.</span><span class="sxs-lookup"><span data-stu-id="8548d-249">In Step 1 we used this approach to step into the `Products_SelectByCategoryID` stored procedure.</span></span>

<span data-ttu-id="8548d-250">Debugowanie aplikacji umożliwia punktów przerwania, aby ustawić bezpośrednio w obiektach bazy danych.</span><span class="sxs-lookup"><span data-stu-id="8548d-250">Application debugging allows breakpoints to be set directly within the database objects.</span></span> <span data-ttu-id="8548d-251">Po wywołaniu obiektu bazy danych z punktów przerwania z aplikacji klienta (np. aplikacji sieci web ASP.NET), program zostaje zatrzymana, ponieważ debuger przejmuje.</span><span class="sxs-lookup"><span data-stu-id="8548d-251">When a database object with breakpoints is invoked from a client application (such as an ASP.NET web application), the program halts as the debugger takes over.</span></span> <span data-ttu-id="8548d-252">Debugowanie aplikacji jest przydatne, ponieważ więcej wyraźnie pokazuje, jakie działania aplikacji powoduje, że obiekt określoną bazę danych do wywołania.</span><span class="sxs-lookup"><span data-stu-id="8548d-252">Application debugging is useful because it more clearly shows what application action causes a particular database object to be invoked.</span></span> <span data-ttu-id="8548d-253">Jednak wymaga nieco większej konfiguracji i instalacji niż bezpośrednie debugowania bazy danych.</span><span class="sxs-lookup"><span data-stu-id="8548d-253">However, it requires a bit more configuration and setup than Direct Database Debugging.</span></span>

<span data-ttu-id="8548d-254">Obiekty bazy danych również można debugować za pośrednictwem projektów serwera SQL.</span><span class="sxs-lookup"><span data-stu-id="8548d-254">Database objects can also be debugged through SQL Server Projects.</span></span> <span data-ttu-id="8548d-255">Firma Microsoft będzie wyglądać na przy użyciu programu SQL Server — projekty i jak ich używać do tworzenia i debugowania zarządzane obiekty bazy danych w następnym samouczku.</span><span class="sxs-lookup"><span data-stu-id="8548d-255">We will look at using SQL Server Projects and how to use them to create and debug managed database objects in the next tutorial.</span></span>

<span data-ttu-id="8548d-256">Programowanie przyjemność!</span><span class="sxs-lookup"><span data-stu-id="8548d-256">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="8548d-257">Informacje o autorze</span><span class="sxs-lookup"><span data-stu-id="8548d-257">About the Author</span></span>

<span data-ttu-id="8548d-258">[Scott Bento](http://www.4guysfromrolla.com/ScottMitchell.shtml), autora siedmiu książek ASP/ASP.NET i twórcę z [4GuysFromRolla.com](http://www.4guysfromrolla.com), pracuje z technologii Microsoft Web od 1998.</span><span class="sxs-lookup"><span data-stu-id="8548d-258">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="8548d-259">Scott działa jako niezależnego konsultanta trainer i składnika zapisywania.</span><span class="sxs-lookup"><span data-stu-id="8548d-259">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="8548d-260">Jest jego najnowszej książki [ *Sams nauczyć się ASP.NET 2.0 w ciągu 24 godzin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="8548d-260">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="8548d-261">Piotr można uzyskać pod adresem [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) lub za pośrednictwem jego blog, który znajduje się w temacie [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="8548d-261">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="8548d-262">[Poprzednie](protecting-connection-strings-and-other-configuration-information-vb.md)
[dalej](creating-stored-procedures-and-user-defined-functions-with-managed-code-vb.md)</span><span class="sxs-lookup"><span data-stu-id="8548d-262">[Previous](protecting-connection-strings-and-other-configuration-information-vb.md)
[Next](creating-stored-procedures-and-user-defined-functions-with-managed-code-vb.md)</span></span>
