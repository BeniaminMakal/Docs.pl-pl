---
uid: web-pages/overview/data/5-working-with-data
title: Wprowadzenie do pracy z bazą danych w sieci Web ASP.NET stron witryny (Razor) | Dokumentacja firmy Microsoft
author: tfitzmac
description: W tym rozdziale opisano, jak uzyskać dostęp do danych z bazy danych i wyświetlić je za pomocą stron sieci Web programu ASP.NET.
ms.author: aspnetcontent
manager: wpickett
ms.date: 02/18/2014
ms.topic: article
ms.assetid: 673d502f-2c16-4a6f-bb63-dbfd9a77ef47
ms.technology: dotnet-webpages
ms.prod: .net-framework
msc.legacyurl: /web-pages/overview/data/5-working-with-data
msc.type: authoredcontent
ms.openlocfilehash: 563074cf3e60717c2e6c336a2c282b4203f73b8b
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/06/2018
---
<a name="introduction-to-working-with-a-database-in-aspnet-web-pages-razor-sites"></a><span data-ttu-id="a3db4-103">Wprowadzenie do pracy z bazą danych w sieci Web ASP.NET stron witryny (Razor)</span><span class="sxs-lookup"><span data-stu-id="a3db4-103">Introduction to Working with a Database in ASP.NET Web Pages (Razor) Sites</span></span>
====================
<span data-ttu-id="a3db4-104">przez [FitzMacken niestandardowy](https://github.com/tfitzmac)</span><span class="sxs-lookup"><span data-stu-id="a3db4-104">by [Tom FitzMacken](https://github.com/tfitzmac)</span></span>

> <span data-ttu-id="a3db4-105">W tym artykule opisano, jak za pomocą narzędzi Microsoft WebMatrix tworzenia bazy danych w witrynie sieci Web platformy ASP.NET Web Pages (Razor) oraz sposobu tworzenia stron, które pozwalają na wyświetlanie, dodawanie, edytowanie i usuwanie danych.</span><span class="sxs-lookup"><span data-stu-id="a3db4-105">This article describes how to use Microsoft WebMatrix tools to create a database in an ASP.NET Web Pages (Razor) website, and how to create pages that let you display, add, edit, and delete data.</span></span>
> 
> <span data-ttu-id="a3db4-106">**Zawartość:**</span><span class="sxs-lookup"><span data-stu-id="a3db4-106">**What you'll learn:**</span></span> 
> 
> - <span data-ttu-id="a3db4-107">Jak utworzyć bazę danych.</span><span class="sxs-lookup"><span data-stu-id="a3db4-107">How to create a database.</span></span>
> - <span data-ttu-id="a3db4-108">Sposób nawiązywania połączenia z bazą danych.</span><span class="sxs-lookup"><span data-stu-id="a3db4-108">How to connect to a database.</span></span>
> - <span data-ttu-id="a3db4-109">Jak wyświetlać dane na stronie sieci web.</span><span class="sxs-lookup"><span data-stu-id="a3db4-109">How to display data in a web page.</span></span>
> - <span data-ttu-id="a3db4-110">Jak wstawianie, aktualizowanie i usuwanie rekordów bazy danych.</span><span class="sxs-lookup"><span data-stu-id="a3db4-110">How to insert, update, and delete database records.</span></span>
> 
> <span data-ttu-id="a3db4-111">Poniżej przedstawiono funkcje wprowadzone w artykule:</span><span class="sxs-lookup"><span data-stu-id="a3db4-111">These are the features introduced in the article:</span></span>
> 
> - <span data-ttu-id="a3db4-112">Praca z bazy danych programu Microsoft SQL Server Compact Edition.</span><span class="sxs-lookup"><span data-stu-id="a3db4-112">Working with a Microsoft SQL Server Compact Edition database.</span></span>
> - <span data-ttu-id="a3db4-113">Praca z zapytania SQL.</span><span class="sxs-lookup"><span data-stu-id="a3db4-113">Working with SQL queries.</span></span>
> - <span data-ttu-id="a3db4-114">`Database` Klasy.</span><span class="sxs-lookup"><span data-stu-id="a3db4-114">The `Database` class.</span></span>
>   
> 
> ## <a name="software-versions-used-in-the-tutorial"></a><span data-ttu-id="a3db4-115">Używane w samouczku wersje oprogramowania</span><span class="sxs-lookup"><span data-stu-id="a3db4-115">Software versions used in the tutorial</span></span>
> 
> 
> - <span data-ttu-id="a3db4-116">ASP.NET Web Pages (Razor) 2</span><span class="sxs-lookup"><span data-stu-id="a3db4-116">ASP.NET Web Pages (Razor) 2</span></span>
> - <span data-ttu-id="a3db4-117">WebMatrix 2</span><span class="sxs-lookup"><span data-stu-id="a3db4-117">WebMatrix 2</span></span>
>   
> 
> <span data-ttu-id="a3db4-118">W tym samouczku współdziała również z 3 programu WebMatrix.</span><span class="sxs-lookup"><span data-stu-id="a3db4-118">This tutorial also works with WebMatrix 3.</span></span> <span data-ttu-id="a3db4-119">Możesz użyć 3 stron sieci Web ASP.NET i Visual Studio 2013 (lub programu Visual Studio Express 2013 for Web); jednak interfejsu użytkownika będą inne.</span><span class="sxs-lookup"><span data-stu-id="a3db4-119">You can use ASP.NET Web Pages 3 and Visual Studio 2013 (or Visual Studio Express 2013 for Web); however, the user interface will be different.</span></span>


## <a name="introduction-to-databases"></a><span data-ttu-id="a3db4-120">Wprowadzenie do bazy danych</span><span class="sxs-lookup"><span data-stu-id="a3db4-120">Introduction to Databases</span></span>

<span data-ttu-id="a3db4-121">Wyobraź sobie książki adresowej typowych.</span><span class="sxs-lookup"><span data-stu-id="a3db4-121">Imagine a typical address book.</span></span> <span data-ttu-id="a3db4-122">Dla każdego wpisu w książce adresowej (to znaczy, że dla każdej osoby) ma kilka rodzajów informacji, takich jak imię, nazwisko, adres, adres e-mail i numer telefonu.</span><span class="sxs-lookup"><span data-stu-id="a3db4-122">For each entry in the address book (that is, for each person) you have several pieces of information such as first name, last name, address, email address, and phone number.</span></span>

<span data-ttu-id="a3db4-123">Typowy sposób dane obrazu takie jest jako tabelę z wierszy i kolumn.</span><span class="sxs-lookup"><span data-stu-id="a3db4-123">A typical way to picture data like this is as a table with rows and columns.</span></span> <span data-ttu-id="a3db4-124">Każdy wiersz w terminologii baz danych jest często określany jako rekord.</span><span class="sxs-lookup"><span data-stu-id="a3db4-124">In database terms, each row is often referred to as a record.</span></span> <span data-ttu-id="a3db4-125">Każda kolumna (czasem określana jako pola) zawiera wartość dla każdego typu danych: imię, nazwa ostatniego i tak dalej.</span><span class="sxs-lookup"><span data-stu-id="a3db4-125">Each column (sometimes referred to as fields) contains a value for each type of data: first name, last name, and so on.</span></span>

| <span data-ttu-id="a3db4-126">**ID**</span><span class="sxs-lookup"><span data-stu-id="a3db4-126">**ID**</span></span> | <span data-ttu-id="a3db4-127">**Imię**</span><span class="sxs-lookup"><span data-stu-id="a3db4-127">**FirstName**</span></span> | <span data-ttu-id="a3db4-128">**Nazwisko**</span><span class="sxs-lookup"><span data-stu-id="a3db4-128">**LastName**</span></span> | <span data-ttu-id="a3db4-129">**Adres**</span><span class="sxs-lookup"><span data-stu-id="a3db4-129">**Address**</span></span> | <span data-ttu-id="a3db4-130">**Poczta e-mail**</span><span class="sxs-lookup"><span data-stu-id="a3db4-130">**Email**</span></span> | <span data-ttu-id="a3db4-131">**Telefon**</span><span class="sxs-lookup"><span data-stu-id="a3db4-131">**Phone**</span></span> |
| --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="a3db4-132">1</span><span class="sxs-lookup"><span data-stu-id="a3db4-132">1</span></span> | <span data-ttu-id="a3db4-133">Jim</span><span class="sxs-lookup"><span data-stu-id="a3db4-133">Jim</span></span> | <span data-ttu-id="a3db4-134">Abrus</span><span class="sxs-lookup"><span data-stu-id="a3db4-134">Abrus</span></span> | <span data-ttu-id="a3db4-135">210 100th St SE Orcas WA 98031</span><span class="sxs-lookup"><span data-stu-id="a3db4-135">210 100th St SE Orcas WA 98031</span></span> | jim@contoso.com | <span data-ttu-id="a3db4-136">555 0100</span><span class="sxs-lookup"><span data-stu-id="a3db4-136">555 0100</span></span> |
| <span data-ttu-id="a3db4-137">2</span><span class="sxs-lookup"><span data-stu-id="a3db4-137">2</span></span> | <span data-ttu-id="a3db4-138">Jakub</span><span class="sxs-lookup"><span data-stu-id="a3db4-138">Terry</span></span> | <span data-ttu-id="a3db4-139">Adams</span><span class="sxs-lookup"><span data-stu-id="a3db4-139">Adams</span></span> | <span data-ttu-id="a3db4-140">1234 Main St. Seattle WA 99011</span><span class="sxs-lookup"><span data-stu-id="a3db4-140">1234 Main St. Seattle WA 99011</span></span> | terry@cohowinery.com | <span data-ttu-id="a3db4-141">555 0101</span><span class="sxs-lookup"><span data-stu-id="a3db4-141">555 0101</span></span> |

<span data-ttu-id="a3db4-142">Dla większości tabel bazy danych Tabela musi mieć kolumnę, która zawiera unikatowy identyfikator, takich jak numer klienta, numer konta itp. Jest to nazywane tabeli *klucz podstawowy*, i używa ich do identyfikacji każdego wiersza w tabeli.</span><span class="sxs-lookup"><span data-stu-id="a3db4-142">For most database tables, the table has to have a column that contains a unique identifier, like a customer number, account number, etc. This is known as the table's *primary key*, and you use it to identify each row in the table.</span></span> <span data-ttu-id="a3db4-143">W tym przykładzie w kolumnie identyfikator jest kluczem podstawowym w książce adresowej.</span><span class="sxs-lookup"><span data-stu-id="a3db4-143">In the example, the ID column is the primary key for the address book.</span></span>

<span data-ttu-id="a3db4-144">Z tym podstawową wiedzę na temat baz danych, możesz dowiedzieć się, jak utworzyć prosty bazy danych i wykonywanie operacji takich jak dodawanie, modyfikowanie i usuwanie danych.</span><span class="sxs-lookup"><span data-stu-id="a3db4-144">With this basic understanding of databases, you're ready to learn how to create a simple database and perform operations such as adding, modifying, and deleting data.</span></span>

> [!TIP] 
> 
> <span data-ttu-id="a3db4-145">**Relacyjnych baz danych**</span><span class="sxs-lookup"><span data-stu-id="a3db4-145">**Relational Databases**</span></span>
> 
> <span data-ttu-id="a3db4-146">Dane można przechowywać w wiele sposobów, łącznie z plików tekstowych i arkuszy kalkulacyjnych.</span><span class="sxs-lookup"><span data-stu-id="a3db4-146">You can store data in lots of ways, including text files and spreadsheets.</span></span> <span data-ttu-id="a3db4-147">Na potrzeby większości firm jednak dane są przechowywane w relacyjnej bazie danych.</span><span class="sxs-lookup"><span data-stu-id="a3db4-147">For most business uses, though, data is stored in a relational database.</span></span>
> 
> <span data-ttu-id="a3db4-148">W tym artykule nie bardzo głęboko przejdź do bazy danych.</span><span class="sxs-lookup"><span data-stu-id="a3db4-148">This article doesn't go very deeply into databases.</span></span> <span data-ttu-id="a3db4-149">Jednak użytkownik może być bardzo przydatne do zrozumienia nieco o nich.</span><span class="sxs-lookup"><span data-stu-id="a3db4-149">However, you might find it useful to understand a little about them.</span></span> <span data-ttu-id="a3db4-150">Relacyjnej bazy danych informacje są logicznie podzielone na osobne tabele.</span><span class="sxs-lookup"><span data-stu-id="a3db4-150">In a relational database, information is logically divided into separate tables.</span></span> <span data-ttu-id="a3db4-151">Na przykład bazy danych dla Szkoła może zawierać oddzielnych tabelach dla uczniów lub studentów i ofert klasy.</span><span class="sxs-lookup"><span data-stu-id="a3db4-151">For example, a database for a school might contain separate tables for students and for class offerings.</span></span> <span data-ttu-id="a3db4-152">Bazy danych oprogramowania (takich jak SQL Server) obsługuje zaawansowane polecenia, które pozwalają dynamicznie ustanawiania relacji między tabelami.</span><span class="sxs-lookup"><span data-stu-id="a3db4-152">The database software (such as SQL Server) supports powerful commands that let you dynamically establish relationships between the tables.</span></span> <span data-ttu-id="a3db4-153">Na przykład służy relacyjnej bazy danych do ustanawiania relacji logiczne między studenci i grupy, aby utworzyć harmonogram.</span><span class="sxs-lookup"><span data-stu-id="a3db4-153">For example, you can use the relational database to establish a logical relationship between students and classes in order to create a schedule.</span></span> <span data-ttu-id="a3db4-154">Przechowywanie danych w oddzielnych tabelach zmniejsza się złożoność struktury tabeli i ogranicza potrzebę nadmiarowego dane są przechowywane w tabelach.</span><span class="sxs-lookup"><span data-stu-id="a3db4-154">Storing data in separate tables reduces the complexity of the table structure and reduces the need to keep redundant data in tables.</span></span>


## <a name="creating-a-database"></a><span data-ttu-id="a3db4-155">Tworzenie bazy danych</span><span class="sxs-lookup"><span data-stu-id="a3db4-155">Creating a Database</span></span>

<span data-ttu-id="a3db4-156">Ta procedura przedstawia sposób tworzenia bazy danych o nazwie SmallBakery za pomocą narzędzia projekt bazy danych programu SQL Server Compact, które znajduje się w programie WebMatrix.</span><span class="sxs-lookup"><span data-stu-id="a3db4-156">This procedure shows you how to create a database named SmallBakery by using the SQL Server Compact Database design tool that's included in WebMatrix.</span></span> <span data-ttu-id="a3db4-157">Można utworzyć bazy danych przy użyciu kodu, ale jest bardziej typowego do tworzenia bazy danych i tabele bazy danych przy użyciu narzędzia projektowania, takiego jak program WebMatrix.</span><span class="sxs-lookup"><span data-stu-id="a3db4-157">Although you can create a database using code, it's more typical to create the database and database tables using a design tool like WebMatrix.</span></span>

1. <span data-ttu-id="a3db4-158">Uruchom program WebMatrix, a na stronie Szybki Start kliknij **szablonu z witryny**.</span><span class="sxs-lookup"><span data-stu-id="a3db4-158">Start WebMatrix, and on the Quick Start page, click **Site From Template**.</span></span>
2. <span data-ttu-id="a3db4-159">Wybierz **pusta witryna**, a następnie w **nazwa witryny** polu wprowadź "SmallBakery", a następnie kliknij przycisk **OK**.</span><span class="sxs-lookup"><span data-stu-id="a3db4-159">Select **Empty Site**, and in the **Site Name** box enter "SmallBakery" and then click **OK**.</span></span> <span data-ttu-id="a3db4-160">Ta witryna jest utworzone i wyświetlane w programie WebMatrix.</span><span class="sxs-lookup"><span data-stu-id="a3db4-160">The site is created and displayed in WebMatrix.</span></span>
3. <span data-ttu-id="a3db4-161">W okienku po lewej stronie kliknij **baz danych** obszaru roboczego.</span><span class="sxs-lookup"><span data-stu-id="a3db4-161">In the left pane, click the **Databases** workspace.</span></span>
4. <span data-ttu-id="a3db4-162">Na wstążce kliknij **nową bazę danych**.</span><span class="sxs-lookup"><span data-stu-id="a3db4-162">In the ribbon, click **New Database**.</span></span> <span data-ttu-id="a3db4-163">Pusta baza danych została utworzona z taką samą nazwę jak witryny.</span><span class="sxs-lookup"><span data-stu-id="a3db4-163">An empty database is created with the same name as your site.</span></span>
5. <span data-ttu-id="a3db4-164">W okienku po lewej stronie rozwiń **SmallBakery.sdf** węzeł, a następnie kliknij przycisk **tabel**.</span><span class="sxs-lookup"><span data-stu-id="a3db4-164">In the left pane, expand the **SmallBakery.sdf** node and then click **Tables**.</span></span>
6. <span data-ttu-id="a3db4-165">Na wstążce kliknij **nową tabelę**.</span><span class="sxs-lookup"><span data-stu-id="a3db4-165">In the ribbon, click **New Table**.</span></span> <span data-ttu-id="a3db4-166">Program WebMatrix otwiera projektanta tabel.</span><span class="sxs-lookup"><span data-stu-id="a3db4-166">WebMatrix opens the table designer.</span></span>

    ![[Obraz]](5-working-with-data/_static/image1.jpg)
7. <span data-ttu-id="a3db4-168">Kliknij **nazwa** kolumny, a następnie wprowadź &quot;identyfikator&quot;.</span><span class="sxs-lookup"><span data-stu-id="a3db4-168">Click in the **Name** column and enter &quot;Id&quot;.</span></span>
8. <span data-ttu-id="a3db4-169">W **— typ danych** kolumny wybierz **int**.</span><span class="sxs-lookup"><span data-stu-id="a3db4-169">In the **Data Type** column, select **int**.</span></span>
9. <span data-ttu-id="a3db4-170">Ustaw **jest klucz podstawowy?** i **jest określenie?** opcji **tak**.</span><span class="sxs-lookup"><span data-stu-id="a3db4-170">Set the **Is Primary Key?** and **Is Identify?** options to **Yes**.</span></span>

    <span data-ttu-id="a3db4-171">Jak wynika z nazwy, **jest kluczem podstawowym** bazy danych informuje, że są to klucz podstawowy tabeli.</span><span class="sxs-lookup"><span data-stu-id="a3db4-171">As the name suggests, **Is Primary Key** tells the database that this will be the table's primary key.</span></span> <span data-ttu-id="a3db4-172">**Tożsamość jest** informuje bazy danych, aby automatycznie utworzyć identyfikator dla każdego nowego rekordu i przypisać kolejny numer sekwencyjny (rozpoczyna się od 1).</span><span class="sxs-lookup"><span data-stu-id="a3db4-172">**Is Identity** tells the database to automatically create an ID number for every new record and to assign it the next sequential number (starting at 1).</span></span>
10. <span data-ttu-id="a3db4-173">Kliknij w następnym wierszu.</span><span class="sxs-lookup"><span data-stu-id="a3db4-173">Click in the next row.</span></span> <span data-ttu-id="a3db4-174">Edytor nowych definicji kolumny.</span><span class="sxs-lookup"><span data-stu-id="a3db4-174">The editor starts a new column definition.</span></span>
11. <span data-ttu-id="a3db4-175">Wprowadź wartość nazwy &quot;nazwa&quot;.</span><span class="sxs-lookup"><span data-stu-id="a3db4-175">For the Name value, enter &quot;Name&quot;.</span></span>
12. <span data-ttu-id="a3db4-176">Aby uzyskać **— typ danych**, wybierz &quot;nvarchar&quot; i ustawianie długości do 50.</span><span class="sxs-lookup"><span data-stu-id="a3db4-176">For **Data Type**, choose &quot;nvarchar&quot; and set the length to 50.</span></span> <span data-ttu-id="a3db4-177">*Var* częścią `nvarchar` bazy danych informuje, że dane dla tej kolumny zostaną ciąg, którego rozmiar może się różnić od rekordu do rekordu.</span><span class="sxs-lookup"><span data-stu-id="a3db4-177">The *var* part of `nvarchar` tells the database that the data for this column will be a string whose size might vary from record to record.</span></span> <span data-ttu-id="a3db4-178">( *n* prefiksu reprezentuje *national*, wskazującą, czy pole może zawierać dane znaków reprezentuje wszystkie litery lub zapisywanie systemu &#8212; oznacza to, że pole zawiera dane Unicode.)</span><span class="sxs-lookup"><span data-stu-id="a3db4-178">(The *n* prefix represents *national*, indicating that the field can hold character data that represents any alphabet or writing system &#8212; that is, that the field holds Unicode data.)</span></span>
13. <span data-ttu-id="a3db4-179">Ustaw **Zezwalaj na wartości null** opcji w celu **nr**.</span><span class="sxs-lookup"><span data-stu-id="a3db4-179">Set the **Allow Nulls** option to **No**.</span></span> <span data-ttu-id="a3db4-180">To będzie wymuszać, który *nazwa* kolumna nie jest puste.</span><span class="sxs-lookup"><span data-stu-id="a3db4-180">This will enforce that the *Name* column is not left blank.</span></span>
14. <span data-ttu-id="a3db4-181">Za pomocą tego samego procesu, Utwórz kolumnę o nazwie *opis*.</span><span class="sxs-lookup"><span data-stu-id="a3db4-181">Using this same process, create a column named *Description*.</span></span> <span data-ttu-id="a3db4-182">Ustaw **— typ danych** "nvarchar" i 50 długość oraz zestaw **Zezwalaj na wartości null** o wartości false.</span><span class="sxs-lookup"><span data-stu-id="a3db4-182">Set **Data Type** to "nvarchar" and 50 for the length, and set **Allow Nulls** to false.</span></span>
15. <span data-ttu-id="a3db4-183">Utwórz kolumnę o nazwie *cen*.</span><span class="sxs-lookup"><span data-stu-id="a3db4-183">Create a column named *Price*.</span></span> <span data-ttu-id="a3db4-184">Ustaw **typu danych "pieniędzy"** i ustaw **Zezwalaj na wartości null** o wartości false.</span><span class="sxs-lookup"><span data-stu-id="a3db4-184">Set **Data Type to "money"** and set **Allow Nulls** to false.</span></span>
16. <span data-ttu-id="a3db4-185">W oknie dialogowym u góry nazwy tabeli &quot;produktu&quot;.</span><span class="sxs-lookup"><span data-stu-id="a3db4-185">In the box at the top, name the table &quot;Product&quot;.</span></span>

    <span data-ttu-id="a3db4-186">Gdy wszystko będzie gotowe, definicja będzie wyglądać następująco:</span><span class="sxs-lookup"><span data-stu-id="a3db4-186">When you're done, the definition will look like this:</span></span>

    ![[Obraz]](5-working-with-data/_static/image2.jpg)
17. <span data-ttu-id="a3db4-188">Naciśnij klawisze Ctrl + S, aby zapisać w tabeli.</span><span class="sxs-lookup"><span data-stu-id="a3db4-188">Press Ctrl+S to save the table.</span></span>

## <a name="adding-data-to-the-database"></a><span data-ttu-id="a3db4-189">Dodawanie danych do bazy danych</span><span class="sxs-lookup"><span data-stu-id="a3db4-189">Adding Data to the Database</span></span>

<span data-ttu-id="a3db4-190">Teraz można dodać przykładowych danych do bazy danych, które będą współpracować w dalszej części tego artykułu.</span><span class="sxs-lookup"><span data-stu-id="a3db4-190">Now you can add some sample data to your database that you'll work with later in the article.</span></span>

1. <span data-ttu-id="a3db4-191">W okienku po lewej stronie rozwiń **SmallBakery.sdf** węzeł, a następnie kliknij przycisk **tabel**.</span><span class="sxs-lookup"><span data-stu-id="a3db4-191">In the left pane, expand the **SmallBakery.sdf** node and then click **Tables**.</span></span>
2. <span data-ttu-id="a3db4-192">Kliknij prawym przyciskiem myszy tabelę produktu, a następnie kliknij przycisk **danych**.</span><span class="sxs-lookup"><span data-stu-id="a3db4-192">Right-click the Product table and then click **Data**.</span></span>
3. <span data-ttu-id="a3db4-193">W okienku edycji wprowadź następujące rekordy:</span><span class="sxs-lookup"><span data-stu-id="a3db4-193">In the edit pane, enter the following records:</span></span>

    | <span data-ttu-id="a3db4-194">**Nazwa**</span><span class="sxs-lookup"><span data-stu-id="a3db4-194">**Name**</span></span> | <span data-ttu-id="a3db4-195">**Opis**</span><span class="sxs-lookup"><span data-stu-id="a3db4-195">**Description**</span></span> | <span data-ttu-id="a3db4-196">**Ceny**</span><span class="sxs-lookup"><span data-stu-id="a3db4-196">**Price**</span></span> |
    | --- | --- | --- |
    | <span data-ttu-id="a3db4-197">Chleb</span><span class="sxs-lookup"><span data-stu-id="a3db4-197">Bread</span></span> | <span data-ttu-id="a3db4-198">Rozszerzania świeże każdego dnia.</span><span class="sxs-lookup"><span data-stu-id="a3db4-198">Baked fresh every day.</span></span> | <span data-ttu-id="a3db4-199">2.99</span><span class="sxs-lookup"><span data-stu-id="a3db4-199">2.99</span></span> |
    | <span data-ttu-id="a3db4-200">Shortcake truskawkowe</span><span class="sxs-lookup"><span data-stu-id="a3db4-200">Strawberry Shortcake</span></span> | <span data-ttu-id="a3db4-201">Wprowadzone w organicznym truskawki z naszych ogrodu.</span><span class="sxs-lookup"><span data-stu-id="a3db4-201">Made with organic strawberries from our garden.</span></span> | <span data-ttu-id="a3db4-202">9.99</span><span class="sxs-lookup"><span data-stu-id="a3db4-202">9.99</span></span> |
    | <span data-ttu-id="a3db4-203">Kołowy firmy Apple</span><span class="sxs-lookup"><span data-stu-id="a3db4-203">Apple Pie</span></span> | <span data-ttu-id="a3db4-204">Drugi tylko na Twój Tato koło.</span><span class="sxs-lookup"><span data-stu-id="a3db4-204">Second only to your mom's pie.</span></span> | <span data-ttu-id="a3db4-205">12.99</span><span class="sxs-lookup"><span data-stu-id="a3db4-205">12.99</span></span> |
    | <span data-ttu-id="a3db4-206">Orzech pekan kołowy</span><span class="sxs-lookup"><span data-stu-id="a3db4-206">Pecan Pie</span></span> | <span data-ttu-id="a3db4-207">Jeśli chcesz Orzeszki pekan jest dla Ciebie.</span><span class="sxs-lookup"><span data-stu-id="a3db4-207">If you like pecans, this is for you.</span></span> | <span data-ttu-id="a3db4-208">10.99</span><span class="sxs-lookup"><span data-stu-id="a3db4-208">10.99</span></span> |
    | <span data-ttu-id="a3db4-209">Kołowy cytrynowa</span><span class="sxs-lookup"><span data-stu-id="a3db4-209">Lemon Pie</span></span> | <span data-ttu-id="a3db4-210">Wykonane przy użyciu najlepszych cytryn na świecie.</span><span class="sxs-lookup"><span data-stu-id="a3db4-210">Made with the best lemons in the world.</span></span> | <span data-ttu-id="a3db4-211">11.99</span><span class="sxs-lookup"><span data-stu-id="a3db4-211">11.99</span></span> |
    | <span data-ttu-id="a3db4-212">Babeczki</span><span class="sxs-lookup"><span data-stu-id="a3db4-212">Cupcakes</span></span> | <span data-ttu-id="a3db4-213">Dziecko i kid w przypadku pokochają je.</span><span class="sxs-lookup"><span data-stu-id="a3db4-213">Your kids and the kid in you will love these.</span></span> | <span data-ttu-id="a3db4-214">7.99</span><span class="sxs-lookup"><span data-stu-id="a3db4-214">7.99</span></span> |

    <span data-ttu-id="a3db4-215">Należy pamiętać, że nie trzeba wprowadzać dla *identyfikator* kolumny.</span><span class="sxs-lookup"><span data-stu-id="a3db4-215">Remember that you don't have to enter anything for the *Id* column.</span></span> <span data-ttu-id="a3db4-216">Podczas tworzenia *identyfikator* zestawu kolumn, jego **tożsamości jest** właściwości na wartość true, co powoduje, że jej automatycznie wypełnić.</span><span class="sxs-lookup"><span data-stu-id="a3db4-216">When you created the *Id* column, you set its **Is Identity** property to true, which causes it to automatically be filled in.</span></span>

    <span data-ttu-id="a3db4-217">Po zakończeniu wprowadzania danych przez projektanta tabel będzie wyglądać następująco:</span><span class="sxs-lookup"><span data-stu-id="a3db4-217">When you're finished entering the data, the table designer will look like this:</span></span>

    ![[Obraz]](5-working-with-data/_static/image3.jpg)
4. <span data-ttu-id="a3db4-219">Zamknij kartę zawierającą danych w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="a3db4-219">Close the tab that contains the database data.</span></span>

## <a name="displaying-data-from-a-database"></a><span data-ttu-id="a3db4-220">Wyświetlanie danych z bazy danych</span><span class="sxs-lookup"><span data-stu-id="a3db4-220">Displaying Data from a Database</span></span>

<span data-ttu-id="a3db4-221">Po skonfigurowaniu bazy danych z danymi w nim, dane można wyświetlić strony sieci web ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="a3db4-221">Once you've got a database with data in it, you can display the data in an ASP.NET web page.</span></span> <span data-ttu-id="a3db4-222">Aby wybrać wiersze tabeli, aby wyświetlić, należy użyć instrukcji SQL, który jest polecenie, które są przekazywane do bazy danych.</span><span class="sxs-lookup"><span data-stu-id="a3db4-222">To select the table rows to display, you use a SQL statement, which is a command that you pass to the database.</span></span>

1. <span data-ttu-id="a3db4-223">W okienku po lewej stronie kliknij **pliki** obszaru roboczego.</span><span class="sxs-lookup"><span data-stu-id="a3db4-223">In the left pane, click the **Files** workspace.</span></span>
2. <span data-ttu-id="a3db4-224">W katalogu głównym witryny sieci Web, Utwórz nową stronę CSHTML o nazwie *ListProducts.cshtml*.</span><span class="sxs-lookup"><span data-stu-id="a3db4-224">In the root of the website, create a new CSHTML page named *ListProducts.cshtml*.</span></span>
3. <span data-ttu-id="a3db4-225">Zastąp istniejący kod znaczników następujące czynności:</span><span class="sxs-lookup"><span data-stu-id="a3db4-225">Replace the existing markup with the following:</span></span>

    [!code-cshtml[Main](5-working-with-data/samples/sample1.cshtml)]

    <span data-ttu-id="a3db4-226">W pierwszym bloku kodu, możesz otworzyć *SmallBakery.sdf* pliku (baza danych), który został utworzony wcześniej.</span><span class="sxs-lookup"><span data-stu-id="a3db4-226">In the first code block, you open the *SmallBakery.sdf* file (database) that you created earlier.</span></span> <span data-ttu-id="a3db4-227">`Database.Open` Metody, przy założeniu, że *sdf* plik znajduje się w witryny sieci Web *aplikacji\_danych* folderu.</span><span class="sxs-lookup"><span data-stu-id="a3db4-227">The `Database.Open` method assumes that the *.sdf* file is in your website's *App\_Data* folder.</span></span> <span data-ttu-id="a3db4-228">(Zwróć uwagę, że nie trzeba określać *sdf* rozszerzenia &#8212; w rzeczywistości, jeśli to zrobisz, `Open` — metoda nie będzie działać.)</span><span class="sxs-lookup"><span data-stu-id="a3db4-228">(Notice that you don't need to specify the *.sdf* extension &#8212; in fact, if you do, the `Open` method won't work.)</span></span>

    > [!NOTE]
    > <span data-ttu-id="a3db4-229">*Aplikacji\_danych* jest folderem specjalne w programie ASP.NET, który jest używany do przechowywania plików danych.</span><span class="sxs-lookup"><span data-stu-id="a3db4-229">The *App\_Data* folder is a special folder in ASP.NET that's used to store data files.</span></span> <span data-ttu-id="a3db4-230">Aby uzyskać więcej informacji, zobacz [połączenia z bazą danych](#SB_ConnectingToADatabase) dalszej części tego artykułu.</span><span class="sxs-lookup"><span data-stu-id="a3db4-230">For more information, see [Connecting to a Database](#SB_ConnectingToADatabase) later in this article.</span></span>

    <span data-ttu-id="a3db4-231">Następnie wprowadź żądanie przy użyciu następujących SQL w bazie danych `Select` instrukcji:</span><span class="sxs-lookup"><span data-stu-id="a3db4-231">You then make a request to query the database using the following SQL `Select` statement:</span></span>

    [!code-sql[Main](5-working-with-data/samples/sample2.sql)]

    <span data-ttu-id="a3db4-232">W instrukcji `Product` identyfikuje tabeli w zapytaniu.</span><span class="sxs-lookup"><span data-stu-id="a3db4-232">In the statement, `Product` identifies the table to query.</span></span> <span data-ttu-id="a3db4-233">`*` Znaku określa zapytanie powinno zwrócić wszystkie kolumny z tabeli.</span><span class="sxs-lookup"><span data-stu-id="a3db4-233">The `*` character specifies that the query should return all the columns from the table.</span></span> <span data-ttu-id="a3db4-234">(Możesz można również lista kolumn oddzielnie, oddzielonych przecinkami, jeśli chcesz wyświetlić tylko niektóre kolumny.) `Order By` Klauzuli wskazuje sposób sortowania danych &#8212; w takim przypadku przez *nazwa* kolumny.</span><span class="sxs-lookup"><span data-stu-id="a3db4-234">(You could also list columns individually, separated by commas, if you wanted to see only some of the columns.) The `Order By` clause indicates how the data should be sorted &#8212; in this case, by the *Name* column.</span></span> <span data-ttu-id="a3db4-235">Oznacza to, że dane są sortowane w kolejności alfabetycznej na podstawie wartości z *nazwa* kolumny dla każdego wiersza.</span><span class="sxs-lookup"><span data-stu-id="a3db4-235">This means that the data is sorted alphabetically based on the value of the *Name* column for each row.</span></span>

    <span data-ttu-id="a3db4-236">W treści strony znaczników tworzy tabelę HTML, który będzie używany do wyświetlania danych.</span><span class="sxs-lookup"><span data-stu-id="a3db4-236">In the body of the page, the markup creates an HTML table that will be used to display the data.</span></span> <span data-ttu-id="a3db4-237">Wewnątrz `<tbody>` elementu, użyj `foreach` pętli można indywidualnie uzyskać każdy wiersz danych zwracane przez zapytanie.</span><span class="sxs-lookup"><span data-stu-id="a3db4-237">Inside the `<tbody>` element, you use a `foreach` loop to individually get each data row that's returned by the query.</span></span> <span data-ttu-id="a3db4-238">Dla każdego wiersza danych można utworzyć wiersza tabeli HTML (`<tr>` elementu).</span><span class="sxs-lookup"><span data-stu-id="a3db4-238">For each data row, you create an HTML table row (`<tr>` element).</span></span> <span data-ttu-id="a3db4-239">Następnie utwórz komórek tabeli HTML (`<td>` elementy) dla każdej kolumny.</span><span class="sxs-lookup"><span data-stu-id="a3db4-239">Then you create HTML table cells (`<td>` elements) for each column.</span></span> <span data-ttu-id="a3db4-240">Zawsze można przejść przez pętlę, następnego wiersza dostępne z bazy danych jest w `row` zmiennej (należy wybrać tę opcję `foreach` instrukcji).</span><span class="sxs-lookup"><span data-stu-id="a3db4-240">Each time you go through the loop, the next available row from the database is in the `row` variable (you set this up in the `foreach` statement).</span></span> <span data-ttu-id="a3db4-241">Aby uzyskać pojedynczej kolumny z wiersza, można użyć `row.Name` lub `row.Description` lub nazwa jest się kolumny.</span><span class="sxs-lookup"><span data-stu-id="a3db4-241">To get an individual column from the row, you can use `row.Name` or `row.Description` or whatever the name is of the column you want.</span></span>
4. <span data-ttu-id="a3db4-242">Uruchom strony w przeglądarce.</span><span class="sxs-lookup"><span data-stu-id="a3db4-242">Run the page in a browser.</span></span> <span data-ttu-id="a3db4-243">(Upewnij się, że strona jest zaznaczona w **pliki** obszar roboczy przed jej uruchomieniem.) Strona wyświetlana jest lista podobne do poniższych:</span><span class="sxs-lookup"><span data-stu-id="a3db4-243">(Make sure the page is selected in the **Files** workspace before you run it.) The page displays a list like the following:</span></span>

    ![[Obraz]](5-working-with-data/_static/image4.jpg)

> [!TIP] 
> 
> <span data-ttu-id="a3db4-245">**Structured Query Language (SQL)**</span><span class="sxs-lookup"><span data-stu-id="a3db4-245">**Structured Query Language (SQL)**</span></span>
> 
> <span data-ttu-id="a3db4-246">SQL jest językiem, który jest używany w większości relacyjnych baz danych do zarządzania danymi w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="a3db4-246">SQL is a language that's used in most relational databases for managing data in a database.</span></span> <span data-ttu-id="a3db4-247">Obejmuje on poleceń, które umożliwiają pobieranie danych i zaktualizować go i umożliwiające tworzenie, modyfikowanie i zarządzanie tabel bazy danych.</span><span class="sxs-lookup"><span data-stu-id="a3db4-247">It includes commands that let you retrieve data and update it, and that let you create, modify, and manage database tables.</span></span> <span data-ttu-id="a3db4-248">SQL różni się od języka programowania (tak jak używasz programu WebMatrix) ponieważ z SQL, pomysł jest wiadomo bazy danych, co ma, czy jest zadanie bazy danych, aby dowiedzieć się, jak pobrać dane lub wykonać zadania.</span><span class="sxs-lookup"><span data-stu-id="a3db4-248">SQL is different than a programming language (like the one you're using in WebMatrix) because with SQL, the idea is that you tell the database what you want, and it's the database's job to figure out how to get the data or perform the task.</span></span> <span data-ttu-id="a3db4-249">Poniżej przedstawiono przykłady niektórych poleceń SQL i co zrobić:</span><span class="sxs-lookup"><span data-stu-id="a3db4-249">Here are examples of some SQL commands and what they do:</span></span>
> 
> `SELECT Id, Name, Price FROM Product WHERE Price > 10.00 ORDER BY Name`
> 
> <span data-ttu-id="a3db4-250">Pobiera to *identyfikator*, *nazwa*, i *cen* kolumn z rekordów *produktu* tabeli, jeśli wartość *cen* jest więcej niż 10 i zwraca wyniki w kolejności alfabetycznej na podstawie wartości z *nazwa* kolumny.</span><span class="sxs-lookup"><span data-stu-id="a3db4-250">This fetches the *Id*, *Name*, and *Price* columns from records in the *Product* table if the value of *Price* is more than 10, and returns the results in alphabetical order based on the values of the *Name* column.</span></span> <span data-ttu-id="a3db4-251">To polecenie zwróci zestaw wyników, który zawiera rekordy, które spełniają kryteria lub pusty zestaw, jeśli żadne rekordy nie odpowiadają.</span><span class="sxs-lookup"><span data-stu-id="a3db4-251">This command will return a result set that contains the records that meet the criteria, or an empty set if no records match.</span></span>
> 
> `INSERT INTO Product (Name, Description, Price) VALUES ("Croissant", "A flaky delight", 1.99)`
> 
> <span data-ttu-id="a3db4-252">Wstawia nowy rekord w *produktu* tabeli ustawienie *nazwa* kolumny &quot;Croissant&quot;, *opis* kolumny &quot; Niestabilnym radością&quot;i cenę 1.99.</span><span class="sxs-lookup"><span data-stu-id="a3db4-252">This inserts a new record into the *Product* table, setting the *Name* column to &quot;Croissant&quot;, the *Description* column to &quot;A flaky delight&quot;, and the price to 1.99.</span></span>
> 
> `DELETE FROM Product WHERE ExpirationDate < "01/01/2008"`
> 
> <span data-ttu-id="a3db4-253">To polecenie usuwa rekordy w *produktu* tabeli, którego kolumna Data wygaśnięcia jest wcześniejsza niż 1 stycznia 2008.</span><span class="sxs-lookup"><span data-stu-id="a3db4-253">This command deletes records in the *Product* table whose expiration date column is earlier than January 1, 2008.</span></span> <span data-ttu-id="a3db4-254">(Przy założeniu, że *produktu* Tabela oczywiście ma takie kolumny.) Tutaj podano datę w formacie MM/DD/RRRR, ale powinny być wprowadzane w formacie, który jest używany dla ustawień regionalnych użytkownika.</span><span class="sxs-lookup"><span data-stu-id="a3db4-254">(This assumes that the *Product* table has such a column, of course.) The date is entered here in MM/DD/YYYY format, but it should be entered in the format that's used for your locale.</span></span>
> 
> <span data-ttu-id="a3db4-255">`Insert Into` i `Delete` poleceń nie zwracać zestawów wyników.</span><span class="sxs-lookup"><span data-stu-id="a3db4-255">The `Insert Into` and `Delete` commands don't return result sets.</span></span> <span data-ttu-id="a3db4-256">Zamiast tego zwracają numer, informujący o tym, jak wiele rekordów wpłynęła na polecenie.</span><span class="sxs-lookup"><span data-stu-id="a3db4-256">Instead, they return a number that tells you how many records were affected by the command.</span></span>
> 
> <span data-ttu-id="a3db4-257">Dla niektórych z tych operacji (takich jak wstawianie i usuwanie rekordów) proces, który żąda operacji musi mieć odpowiednie uprawnienia w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="a3db4-257">For some of these operations (like inserting and deleting records), the process that's requesting the operation has to have appropriate permissions in the database.</span></span> <span data-ttu-id="a3db4-258">Jest to dlaczego dla baz danych produkcyjnych często konieczne podanie nazwy użytkownika i hasła podczas łączenia z bazą danych.</span><span class="sxs-lookup"><span data-stu-id="a3db4-258">This is why for production databases you often have to supply a username and password when you connect to the database.</span></span>
> 
> <span data-ttu-id="a3db4-259">Istnieje wielu poleceń SQL, ale wszystkie one wykonać wzorzec następująco.</span><span class="sxs-lookup"><span data-stu-id="a3db4-259">There are dozens of SQL commands, but they all follow a pattern like this.</span></span> <span data-ttu-id="a3db4-260">Poleceń SQL służy do tworzenia tabel bazy danych, liczbę rekordów w tabeli obliczyć ceny i wykonywać wiele kolejnych operacji.</span><span class="sxs-lookup"><span data-stu-id="a3db4-260">You can use SQL commands to create database tables, count the number of records in a table, calculate prices, and perform many more operations.</span></span>


## <a name="inserting-data-in-a-database"></a><span data-ttu-id="a3db4-261">Wstawianie danych w bazie danych</span><span class="sxs-lookup"><span data-stu-id="a3db4-261">Inserting Data in a Database</span></span>

<span data-ttu-id="a3db4-262">W tej sekcji przedstawiono sposób tworzenia strony, który pozwala użytkownikom na dodawanie nowego produktu do *produktu* tabeli bazy danych.</span><span class="sxs-lookup"><span data-stu-id="a3db4-262">This section shows how to create a page that lets users add a new product to the *Product* database table.</span></span> <span data-ttu-id="a3db4-263">Po wstawieniu nowego rekordu produktu na stronie są wyświetlane w tabeli zaktualizowane przy użyciu *ListProducts.cshtml* strony, który został utworzony w poprzedniej sekcji.</span><span class="sxs-lookup"><span data-stu-id="a3db4-263">After a new product record is inserted, the page displays the updated table using the *ListProducts.cshtml* page that you created in the previous section.</span></span>

<span data-ttu-id="a3db4-264">Strona zawiera weryfikacji, aby upewnić się, że danych wprowadzonych przez użytkownika jest prawidłowy dla bazy danych.</span><span class="sxs-lookup"><span data-stu-id="a3db4-264">The page includes validation to make sure that the data that the user enters is valid for the database.</span></span> <span data-ttu-id="a3db4-265">Na przykład kodu na stronie upewnia się, że wprowadzono wartość dla wszystkich wymaganych kolumn.</span><span class="sxs-lookup"><span data-stu-id="a3db4-265">For example, code in the page makes sure that a value has been entered for all required columns.</span></span>

1. <span data-ttu-id="a3db4-266">W witrynie sieci Web, Utwórz nowy plik CSHTML o nazwie *InsertProducts.cshtml*.</span><span class="sxs-lookup"><span data-stu-id="a3db4-266">In the website, create a new CSHTML file named *InsertProducts.cshtml*.</span></span>
2. <span data-ttu-id="a3db4-267">Zastąp istniejący kod znaczników następujące czynności:</span><span class="sxs-lookup"><span data-stu-id="a3db4-267">Replace the existing markup with the following:</span></span>

    [!code-cshtml[Main](5-working-with-data/samples/sample3.cshtml)]

    <span data-ttu-id="a3db4-268">Treść strony zawiera formularz HTML z trzy pola tekstowe, które pozwalają użytkownikom, wprowadź nazwę, opis i cenę.</span><span class="sxs-lookup"><span data-stu-id="a3db4-268">The body of the page contains an HTML form with three text boxes that let users enter a name, description, and price.</span></span> <span data-ttu-id="a3db4-269">Po kliknięciu **Wstaw** przycisku kod w górnej części strony otwiera połączenie *SmallBakery.sdf* bazy danych.</span><span class="sxs-lookup"><span data-stu-id="a3db4-269">When users click the **Insert** button, the code at the top of the page opens a connection to the *SmallBakery.sdf* database.</span></span> <span data-ttu-id="a3db4-270">Następnie Pobierz wartości, które użytkownik zostało przesłane za pomocą `Request` obiektu i przypisać te wartości do zmiennych lokalnych.</span><span class="sxs-lookup"><span data-stu-id="a3db4-270">You then get the values that the user has submitted by using the `Request` object and assign those values to local variables.</span></span>

    <span data-ttu-id="a3db4-271">Aby sprawdzić, czy użytkownik wprowadził wartość dla każdej kolumny wymagane, zarejestrować każdy `<input>` element, który chcesz zweryfikować:</span><span class="sxs-lookup"><span data-stu-id="a3db4-271">To validate that the user entered a value for each required column, you register each `<input>` element that you want to validate:</span></span>

    [!code-csharp[Main](5-working-with-data/samples/sample4.cs)]

    <span data-ttu-id="a3db4-272">`Validation` Pomocnika sprawdza, czy istnieje wartość we wszystkich polach, które zostały zarejestrowane.</span><span class="sxs-lookup"><span data-stu-id="a3db4-272">The `Validation` helper checks that there is a value in each of the fields that you've registered.</span></span> <span data-ttu-id="a3db4-273">Można sprawdzić, czy wszystkie pola przeszły sprawdzanie poprawności, sprawdzając `Validation.IsValid()`, która zwykle jest to ustalane przed przetworzyć informacji można uzyskać od użytkownika:</span><span class="sxs-lookup"><span data-stu-id="a3db4-273">You can test whether all the fields passed validation by checking `Validation.IsValid()`, which you typically do before you process the information you get from the user:</span></span>

    [!code-csharp[Main](5-working-with-data/samples/sample5.cs)]

    <span data-ttu-id="a3db4-274">( `&&` Oznacza, że operator AND — ten test jest *Jeśli jest to przesłanie formularza i wszystkich pól przeszły sprawdzanie poprawności*.)</span><span class="sxs-lookup"><span data-stu-id="a3db4-274">(The `&&` operator means AND — this test is *If this is a form submission AND all the fields have passed validation*.)</span></span>

    <span data-ttu-id="a3db4-275">Jeśli wszystkie kolumny zweryfikowana (żaden nie był pusty), przejdź dalej i tworzenia instrukcji SQL, aby wstawić dane, a następnie wykonaj, jak pokazano w następnym:</span><span class="sxs-lookup"><span data-stu-id="a3db4-275">If all the columns validated (none were empty), you go ahead and create a SQL statement to insert the data and then execute it as shown next:</span></span>

    [!code-csharp[Main](5-working-with-data/samples/sample6.cs)]

    <span data-ttu-id="a3db4-276">W przypadku wartości do wstawienia zawierają symbole zastępcze parametr (`@0`, `@1`, `@2`).</span><span class="sxs-lookup"><span data-stu-id="a3db4-276">For the values to insert, you include parameter placeholders (`@0`, `@1`, `@2`).</span></span>

    > [!NOTE]
    > <span data-ttu-id="a3db4-277">Ze względów bezpieczeństwa zawsze wartości przekazywane do instrukcji SQL przy użyciu parametrów, jak widać w poprzednim przykładzie.</span><span class="sxs-lookup"><span data-stu-id="a3db4-277">As a security precaution, always pass values to a SQL statement using parameters, as you see in the preceding example.</span></span> <span data-ttu-id="a3db4-278">Daje to możliwość sprawdzania poprawności danych użytkownika, a także pomaga zapewnić ochronę przed prób wysłania poleceń złośliwego do bazy danych (czasem określana jako ataki).</span><span class="sxs-lookup"><span data-stu-id="a3db4-278">This gives you a chance to validate the user's data, plus it helps protect against attempts to send malicious commands to your database (sometimes referred to as SQL injection attacks).</span></span>

    <span data-ttu-id="a3db4-279">Aby wykonać zapytanie, należy użyć tej instrukcji przekazanie do niego zmiennych, które zawierają wartości, aby zastąpić symbole zastępcze:</span><span class="sxs-lookup"><span data-stu-id="a3db4-279">To execute the query, you use this statement, passing to it the variables that contain the values to substitute for the placeholders:</span></span>

    [!code-csharp[Main](5-working-with-data/samples/sample7.cs)]

    <span data-ttu-id="a3db4-280">Po `Insert Into` instrukcji zostało wykonane, możesz wysłać do użytkownika do strony, która zawiera listę produktów, ten wiersz:</span><span class="sxs-lookup"><span data-stu-id="a3db4-280">After the `Insert Into` statement has executed, you send the user to the page that lists the products using this line:</span></span>

    [!code-javascript[Main](5-working-with-data/samples/sample8.js)]

    <span data-ttu-id="a3db4-281">Jeśli weryfikacja nie powiodła się, możesz pominąć insert.</span><span class="sxs-lookup"><span data-stu-id="a3db4-281">If validation didn't succeed, you skip the insert.</span></span> <span data-ttu-id="a3db4-282">Istnieją jednak pomocnika na stronie można wyświetlić komunikaty o skumulowany (jeśli istnieje):</span><span class="sxs-lookup"><span data-stu-id="a3db4-282">Instead, you have a helper in the page that can display the accumulated error messages (if any):</span></span>

    [!code-cshtml[Main](5-working-with-data/samples/sample9.cshtml)]

    <span data-ttu-id="a3db4-283">Powiadomienie, że bloku stylu w znaczniku zawiera definicję klasy CSS, o nazwie `.validation-summary-errors`.</span><span class="sxs-lookup"><span data-stu-id="a3db4-283">Notice that the style block in the markup includes a CSS class definition named `.validation-summary-errors`.</span></span> <span data-ttu-id="a3db4-284">Jest to nazwa klasy CSS, która jest używany domyślnie dla `<div>` element, który zawiera wszystkie błędy weryfikacji.</span><span class="sxs-lookup"><span data-stu-id="a3db4-284">This is the name of the CSS class that's used by default for the `<div>` element that contains any validation errors.</span></span> <span data-ttu-id="a3db4-285">W takim przypadku klasy CSS określa podsumowania błędy sprawdzania poprawności są wyświetlane na czerwono i pogrubioną, ale można zdefiniować `.validation-summary-errors` klasy do wyświetlenia formatowania chcesz.</span><span class="sxs-lookup"><span data-stu-id="a3db4-285">In this case, the CSS class specifies that validation summary errors are displayed in red and in bold, but you can define the `.validation-summary-errors` class to display any formatting you like.</span></span>

### <a name="testing-the-insert-page"></a><span data-ttu-id="a3db4-286">Testowanie strony wstawiania</span><span class="sxs-lookup"><span data-stu-id="a3db4-286">Testing the Insert Page</span></span>

1. <span data-ttu-id="a3db4-287">Wyświetl stronę w przeglądarce.</span><span class="sxs-lookup"><span data-stu-id="a3db4-287">View the page in a browser.</span></span> <span data-ttu-id="a3db4-288">Zostaje wyświetlona strona formularz, który jest podobny do tego, który jest wyświetlany na poniższej ilustracji.</span><span class="sxs-lookup"><span data-stu-id="a3db4-288">The page displays a form that's similar to the one that's shown in the following illustration.</span></span>

    ![[Obraz]](5-working-with-data/_static/image5.jpg)
2. <span data-ttu-id="a3db4-290">Wprowadź wartości dla wszystkich kolumn, ale upewnij się, że pozostanie *cen* puste kolumny.</span><span class="sxs-lookup"><span data-stu-id="a3db4-290">Enter values for all the columns, but make sure that you leave the *Price* column blank.</span></span>
3. <span data-ttu-id="a3db4-291">Kliknij przycisk **Wstaw**.</span><span class="sxs-lookup"><span data-stu-id="a3db4-291">Click **Insert**.</span></span> <span data-ttu-id="a3db4-292">Strona z komunikatem o błędzie, jak pokazano na poniższej ilustracji.</span><span class="sxs-lookup"><span data-stu-id="a3db4-292">The page displays an error message, as shown in the following illustration.</span></span> <span data-ttu-id="a3db4-293">(Nie rekordu jest tworzony).</span><span class="sxs-lookup"><span data-stu-id="a3db4-293">(No new record is created.)</span></span>

    ![[Obraz]](5-working-with-data/_static/image6.jpg)
4. <span data-ttu-id="a3db4-295">Całkowicie Wypełnij formularz, a następnie kliknij przycisk **Wstaw**.</span><span class="sxs-lookup"><span data-stu-id="a3db4-295">Fill the form out completely, and then click **Insert**.</span></span> <span data-ttu-id="a3db4-296">Teraz, *ListProducts.cshtml* strona jest wyświetlana i przedstawia nowego rekordu.</span><span class="sxs-lookup"><span data-stu-id="a3db4-296">This time, the *ListProducts.cshtml* page is displayed and shows the new record.</span></span>

## <a name="updating-data-in-a-database"></a><span data-ttu-id="a3db4-297">Aktualizowanie danych w bazie danych</span><span class="sxs-lookup"><span data-stu-id="a3db4-297">Updating Data in a Database</span></span>

<span data-ttu-id="a3db4-298">Po wprowadzeniu danych do tabeli, należy go zaktualizować.</span><span class="sxs-lookup"><span data-stu-id="a3db4-298">After data has been entered into a table, you might need to update it.</span></span> <span data-ttu-id="a3db4-299">Ta procedura pokazuje, jak utworzyć dwie strony, które są podobne do tych utworzone wcześniej wstawiania danych.</span><span class="sxs-lookup"><span data-stu-id="a3db4-299">This procedure shows you how to create two pages that are similar to the ones you created for data insertion earlier.</span></span> <span data-ttu-id="a3db4-300">Pierwsza strona przedstawia produkty i pozwala użytkownikom na wybranie jednej zmiany.</span><span class="sxs-lookup"><span data-stu-id="a3db4-300">The first page displays products and lets users select one to change.</span></span> <span data-ttu-id="a3db4-301">Druga strona umożliwia faktycznie dokonaj zmian i zapisz je.</span><span class="sxs-lookup"><span data-stu-id="a3db4-301">The second page lets the users actually make the edits and save them.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="a3db4-302">**Ważne** w środowisku produkcyjnym witryny sieci Web zwykle ograniczysz kto ma może wprowadzać zmiany w danych.</span><span class="sxs-lookup"><span data-stu-id="a3db4-302">**Important** In a production website, you typically restrict who's allowed to make changes to the data.</span></span> <span data-ttu-id="a3db4-303">Aby uzyskać informacje dotyczące sposobu konfigurowania członkostwa i sposobów autoryzacji użytkowników do wykonywania zadań w lokacji, zobacz [Dodawanie zabezpieczeń i członkostwo w witrynie stron sieci Web ASP.NET](https://go.microsoft.com/fwlink/?LinkId=202904).</span><span class="sxs-lookup"><span data-stu-id="a3db4-303">For information about how to set up membership and about ways to authorize users to perform tasks on the site, see [Adding Security and Membership to an ASP.NET Web Pages Site](https://go.microsoft.com/fwlink/?LinkId=202904).</span></span>


1. <span data-ttu-id="a3db4-304">W witrynie sieci Web, Utwórz nowy plik CSHTML o nazwie *EditProducts.cshtml*.</span><span class="sxs-lookup"><span data-stu-id="a3db4-304">In the website, create a new CSHTML file named *EditProducts.cshtml*.</span></span>
2. <span data-ttu-id="a3db4-305">Zastąp istniejące znacznika w pliku następujące czynności:</span><span class="sxs-lookup"><span data-stu-id="a3db4-305">Replace the existing markup in the file with the following:</span></span>

    [!code-cshtml[Main](5-working-with-data/samples/sample10.cshtml)]

    <span data-ttu-id="a3db4-306">Jedyną różnicą między tę stronę i *ListProducts.cshtml* strony z wcześniej jest że tabeli HTML na tej stronie zawiera dodatkowe kolumny, która wyświetla **Edytuj** łącza.</span><span class="sxs-lookup"><span data-stu-id="a3db4-306">The only difference between this page and the *ListProducts.cshtml* page from earlier is that the HTML table in this page includes an extra column that displays an **Edit** link.</span></span> <span data-ttu-id="a3db4-307">Po kliknięciu tego łącza spowoduje to przejście do *UpdateProducts.cshtml* strony (który utworzysz obok) którym można edytować wybranego rekordu.</span><span class="sxs-lookup"><span data-stu-id="a3db4-307">When you click this link, it takes you to the *UpdateProducts.cshtml* page (which you'll create next) where you can edit the selected record.</span></span>

    <span data-ttu-id="a3db4-308">Sprawdź kod, który tworzy **Edytuj** łącza:</span><span class="sxs-lookup"><span data-stu-id="a3db4-308">Look at the code that creates the **Edit** link:</span></span>

    [!code-cshtml[Main](5-working-with-data/samples/sample11.cshtml)]

    <span data-ttu-id="a3db4-309">Spowoduje to utworzenie kodu HTML `<a>` element którego `href` dynamicznie ustawiono atrybut.</span><span class="sxs-lookup"><span data-stu-id="a3db4-309">This creates an HTML `<a>` element whose `href` attribute is set dynamically.</span></span> <span data-ttu-id="a3db4-310">`href` Atrybut określa stronę do wyświetlenia, gdy użytkownik kliknie łącze.</span><span class="sxs-lookup"><span data-stu-id="a3db4-310">The `href` attribute specifies the page to display when the user clicks the link.</span></span> <span data-ttu-id="a3db4-311">Przekazuje również `Id` wartość bieżący wiersz do łącza.</span><span class="sxs-lookup"><span data-stu-id="a3db4-311">It also passes the `Id` value of the current row to the link.</span></span> <span data-ttu-id="a3db4-312">Po uruchomieniu na stronie, źródło strony może zawierać łącza, takich jak te:</span><span class="sxs-lookup"><span data-stu-id="a3db4-312">When the page runs, the page source might contain links like these:</span></span>

    [!code-html[Main](5-working-with-data/samples/sample12.html)]

    <span data-ttu-id="a3db4-313">Zwróć uwagę, że `href` atrybut ma ustawioną `UpdateProducts/n`, gdzie *n* jest liczbą produktu.</span><span class="sxs-lookup"><span data-stu-id="a3db4-313">Notice that the `href` attribute is set to `UpdateProducts/n`, where *n* is a product number.</span></span> <span data-ttu-id="a3db4-314">Po kliknięciu jednego z nich, wynikowy adres URL będzie wyglądać następująco:</span><span class="sxs-lookup"><span data-stu-id="a3db4-314">When a user clicks one of these links, the resulting URL will look something like this:</span></span>

    `http://localhost:18816/UpdateProducts/6`

    <span data-ttu-id="a3db4-315">Innymi słowy numer produktu można edytowane zostaną przekazane w adresie URL.</span><span class="sxs-lookup"><span data-stu-id="a3db4-315">In other words, the product number to be edited will be passed in the URL.</span></span>
3. <span data-ttu-id="a3db4-316">Wyświetl stronę w przeglądarce.</span><span class="sxs-lookup"><span data-stu-id="a3db4-316">View the page in a browser.</span></span> <span data-ttu-id="a3db4-317">Strona wyświetla dane w formacie następująco:</span><span class="sxs-lookup"><span data-stu-id="a3db4-317">The page displays the data in a format like this:</span></span>

    ![[Obraz]](5-working-with-data/_static/image7.jpg)

    <span data-ttu-id="a3db4-319">Następnie utworzysz strona, która umożliwia użytkownikom faktycznie zaktualizowanie danych.</span><span class="sxs-lookup"><span data-stu-id="a3db4-319">Next, you'll create the page that lets users actually update the data.</span></span> <span data-ttu-id="a3db4-320">Strona aktualizacji obejmuje weryfikację sprawdzania poprawności danych wprowadzonych przez użytkownika.</span><span class="sxs-lookup"><span data-stu-id="a3db4-320">The update page includes validation to validate the data that the user enters.</span></span> <span data-ttu-id="a3db4-321">Na przykład kodu na stronie upewnia się, że wprowadzono wartość dla wszystkich wymaganych kolumn.</span><span class="sxs-lookup"><span data-stu-id="a3db4-321">For example, code in the page makes sure that a value has been entered for all required columns.</span></span>
4. <span data-ttu-id="a3db4-322">W witrynie sieci Web, Utwórz nowy plik CSHTML o nazwie *UpdateProducts.cshtml*.</span><span class="sxs-lookup"><span data-stu-id="a3db4-322">In the website, create a new CSHTML file named *UpdateProducts.cshtml*.</span></span>
5. <span data-ttu-id="a3db4-323">Zamień istniejące znacznika w pliku poniżej.</span><span class="sxs-lookup"><span data-stu-id="a3db4-323">Replace the existing markup in the file with the following.</span></span>

    [!code-cshtml[Main](5-working-with-data/samples/sample13.cshtml)]

    <span data-ttu-id="a3db4-324">Ciała strony zawiera formularza HTML, którym jest wyświetlana produktu i gdzie użytkownicy mogą go edytować.</span><span class="sxs-lookup"><span data-stu-id="a3db4-324">The body of the page contains an HTML form where a product is displayed and where users can edit it.</span></span> <span data-ttu-id="a3db4-325">Aby uzyskać produktu do wyświetlenia, należy użyć tej instrukcji SQL:</span><span class="sxs-lookup"><span data-stu-id="a3db4-325">To get the product to display, you use this SQL statement:</span></span>

    [!code-sql[Main](5-working-with-data/samples/sample14.sql)]

    <span data-ttu-id="a3db4-326">To spowoduje zaznaczenie produktu o identyfikatorze pasuje do wartości, który jest przekazywany w `@0` parametru.</span><span class="sxs-lookup"><span data-stu-id="a3db4-326">This will select the product whose ID matches the value that's passed in the `@0` parameter.</span></span> <span data-ttu-id="a3db4-327">(Ponieważ *identyfikator* klucza podstawowego i dlatego musi być unikatowa, tylko jeden produkt rekordu kiedykolwiek można wybrać w ten sposób.) Można pobrać wartości Identyfikatora do przekazania do to `Select` instrukcji, możesz przeczytać wartość, która jest przekazywany do strony jako część adresu URL, używając następującej składni:</span><span class="sxs-lookup"><span data-stu-id="a3db4-327">(Because *Id* is the primary key and therefore must be unique, only one product record can ever be selected this way.) To get the ID value to pass to this `Select` statement, you can read the value that's passed to the page as part of the URL, using the following syntax:</span></span>

    [!code-csharp[Main](5-working-with-data/samples/sample15.cs)]

    <span data-ttu-id="a3db4-328">Faktycznie pobrać rekordu produktu, należy użyć `QuerySingle` metodę, która będzie zwracać tylko jeden rekord:</span><span class="sxs-lookup"><span data-stu-id="a3db4-328">To actually fetch the product record, you use the `QuerySingle` method, which will return just one record:</span></span>

    [!code-csharp[Main](5-working-with-data/samples/sample16.cs)]

    <span data-ttu-id="a3db4-329">Pojedynczy wiersz jest zwracana do `row` zmiennej.</span><span class="sxs-lookup"><span data-stu-id="a3db4-329">The single row is returned into the `row` variable.</span></span> <span data-ttu-id="a3db4-330">Można pobrać danych z każdej kolumny i przypisz je do zmiennych lokalnych w następujący sposób:</span><span class="sxs-lookup"><span data-stu-id="a3db4-330">You can get data out of each column and assign it to local variables like this:</span></span>

    [!code-csharp[Main](5-working-with-data/samples/sample17.cs)]

    <span data-ttu-id="a3db4-331">W znaczniku formularza, te wartości są wyświetlane automatycznie w poszczególnych polach przy użyciu osadzonego kodu podobne do poniższych:</span><span class="sxs-lookup"><span data-stu-id="a3db4-331">In the markup for the form, these values are displayed automatically in individual text boxes by using embedded code like the following:</span></span>

    [!code-html[Main](5-working-with-data/samples/sample18.html)]

    <span data-ttu-id="a3db4-332">Tej części kodu wyświetla rekord produktu do zaktualizowania.</span><span class="sxs-lookup"><span data-stu-id="a3db4-332">That part of the code displays the product record to be updated.</span></span> <span data-ttu-id="a3db4-333">Po wyświetleniu rekord użytkownik może edytować poszczególnych kolumn.</span><span class="sxs-lookup"><span data-stu-id="a3db4-333">Once the record has been displayed, the user can edit individual columns.</span></span>

    <span data-ttu-id="a3db4-334">Gdy użytkownik przesyła formularz, klikając **aktualizacji** przycisk kod w `if(IsPost)` blokowanie działa.</span><span class="sxs-lookup"><span data-stu-id="a3db4-334">When the user submits the form by clicking the **Update** button, the code in the `if(IsPost)` block runs.</span></span> <span data-ttu-id="a3db4-335">Pobiera to wartości użytkownika z `Request` obiektu, przechowuje wartości w zmiennych i sprawdza poprawność wypełnione każdej kolumny.</span><span class="sxs-lookup"><span data-stu-id="a3db4-335">This gets the user's values from the `Request` object, stores the values in variables, and validates that each column has been filled in.</span></span> <span data-ttu-id="a3db4-336">Jeśli weryfikacja zakończy się pomyślnie, kod powoduje utworzenie następujących instrukcji SQL Update:</span><span class="sxs-lookup"><span data-stu-id="a3db4-336">If validation passes, the code creates the following SQL Update statement:</span></span>

    [!code-sql[Main](5-working-with-data/samples/sample19.sql)]

    <span data-ttu-id="a3db4-337">W programie SQL `Update` instrukcji, określ każdej kolumny do zaktualizowania oraz ustawić ją na wartość.</span><span class="sxs-lookup"><span data-stu-id="a3db4-337">In a SQL `Update` statement, you specify each column to update and the value to set it to.</span></span> <span data-ttu-id="a3db4-338">W tym kodzie wartości są określone za pomocą parametru symbole zastępcze `@0`, `@1`, `@2`i tak dalej.</span><span class="sxs-lookup"><span data-stu-id="a3db4-338">In this code, the values are specified using the parameter placeholders `@0`, `@1`, `@2`, and so on.</span></span> <span data-ttu-id="a3db4-339">(Jak wspomniano wcześniej, zabezpieczeń, należy zawsze przekazać wartości do instrukcji SQL przy użyciu parametrów.)</span><span class="sxs-lookup"><span data-stu-id="a3db4-339">(As noted earlier, for security, you should always pass values to a SQL statement by using parameters.)</span></span>

    <span data-ttu-id="a3db4-340">Podczas wywoływania `db.Execute` metody, należy przekazać zmiennych, które zawierają wartości w kolejności odpowiadającej parametrów w instrukcji SQL:</span><span class="sxs-lookup"><span data-stu-id="a3db4-340">When you call the `db.Execute` method, you pass the variables that contain the values in the order that corresponds to the parameters in the SQL statement:</span></span>

    [!code-csharp[Main](5-working-with-data/samples/sample20.cs)]

    <span data-ttu-id="a3db4-341">Po `Update` instrukcji zostało wykonane, wywołanie następującej metody w celu przekieruje użytkownika z powrotem do edycji strony:</span><span class="sxs-lookup"><span data-stu-id="a3db4-341">After the `Update` statement has been executed, you call the following method in order to redirect the user back to the edit page:</span></span>

    [!code-cshtml[Main](5-working-with-data/samples/sample21.cshtml)]

    <span data-ttu-id="a3db4-342">Powoduje, że użytkownik widzi zaktualizowaną listę danych w bazie danych i edytować innego produktu.</span><span class="sxs-lookup"><span data-stu-id="a3db4-342">The effect is that the user sees an updated listing of the data in the database and can edit another product.</span></span>
6. <span data-ttu-id="a3db4-343">Zapisz stronę.</span><span class="sxs-lookup"><span data-stu-id="a3db4-343">Save the page.</span></span>
7. <span data-ttu-id="a3db4-344">Uruchom *EditProducts.cshtml* strony (nie stronę aktualizacji), a następnie kliknij przycisk **Edytuj** wybrać produkt do edycji.</span><span class="sxs-lookup"><span data-stu-id="a3db4-344">Run the *EditProducts.cshtml* page (not the update page) and then click **Edit** to select a product to edit.</span></span> <span data-ttu-id="a3db4-345">*UpdateProducts.cshtml* strony zostanie wyświetlone wybranego rekordu.</span><span class="sxs-lookup"><span data-stu-id="a3db4-345">The *UpdateProducts.cshtml* page is displayed, showing the record you selected.</span></span>

    ![[Obraz]](5-working-with-data/_static/image8.jpg)
8. <span data-ttu-id="a3db4-347">Zmiany, a następnie kliknij przycisk **aktualizacji**.</span><span class="sxs-lookup"><span data-stu-id="a3db4-347">Make a change and click **Update**.</span></span> <span data-ttu-id="a3db4-348">Na liście produktów jest ponownie wyświetlone zaktualizowanych danych.</span><span class="sxs-lookup"><span data-stu-id="a3db4-348">The products list is shown again with your updated data.</span></span>

## <a name="deleting-data-in-a-database"></a><span data-ttu-id="a3db4-349">Usuwanie danych z bazy danych</span><span class="sxs-lookup"><span data-stu-id="a3db4-349">Deleting Data in a Database</span></span>

<span data-ttu-id="a3db4-350">W tej sekcji przedstawiono sposób zezwolić użytkownikom na usuwanie produktu z *produktu* tabeli bazy danych.</span><span class="sxs-lookup"><span data-stu-id="a3db4-350">This section shows how to let users delete a product from the *Product* database table.</span></span> <span data-ttu-id="a3db4-351">Przykład zawiera dwie strony.</span><span class="sxs-lookup"><span data-stu-id="a3db4-351">The example consists of two pages.</span></span> <span data-ttu-id="a3db4-352">Na pierwszej stronie użytkowników wybierz rekordy do usunięcia.</span><span class="sxs-lookup"><span data-stu-id="a3db4-352">In the first page, users select a record to delete.</span></span> <span data-ttu-id="a3db4-353">Usunięcie rekordu jest następnie wyświetlane w drugiej stronie, które umożliwi upewnij się, czy chcą usunąć rekord.</span><span class="sxs-lookup"><span data-stu-id="a3db4-353">The record to be deleted is then displayed in a second page that lets them confirm that they want to delete the record.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="a3db4-354">**Ważne** w środowisku produkcyjnym witryny sieci Web zwykle ograniczysz kto ma może wprowadzać zmiany w danych.</span><span class="sxs-lookup"><span data-stu-id="a3db4-354">**Important** In a production website, you typically restrict who's allowed to make changes to the data.</span></span> <span data-ttu-id="a3db4-355">Aby uzyskać informacje dotyczące sposobu konfigurowania członkostwa i sposobów autoryzacji użytkowników do wykonywania zadań w lokacji, zobacz [Dodawanie zabezpieczeń i członkostwo w witrynie stron sieci Web ASP.NET](https://go.microsoft.com/fwlink/?LinkId=202904).</span><span class="sxs-lookup"><span data-stu-id="a3db4-355">For information about how to set up membership and about ways to authorize user to perform tasks on the site, see [Adding Security and Membership to an ASP.NET Web Pages Site](https://go.microsoft.com/fwlink/?LinkId=202904).</span></span>


1. <span data-ttu-id="a3db4-356">W witrynie sieci Web, Utwórz nowy plik CSHTML o nazwie *ListProductsForDelete.cshtml*.</span><span class="sxs-lookup"><span data-stu-id="a3db4-356">In the website, create a new CSHTML file named *ListProductsForDelete.cshtml*.</span></span>
2. <span data-ttu-id="a3db4-357">Zastąp istniejący kod znaczników następujące czynności:</span><span class="sxs-lookup"><span data-stu-id="a3db4-357">Replace the existing markup with the following:</span></span>

    [!code-cshtml[Main](5-working-with-data/samples/sample22.cshtml)]

    <span data-ttu-id="a3db4-358">Ta strona jest podobny do *EditProducts.cshtml* strony z wcześniej.</span><span class="sxs-lookup"><span data-stu-id="a3db4-358">This page is similar to the *EditProducts.cshtml* page from earlier.</span></span> <span data-ttu-id="a3db4-359">Jednak zamiast **Edytuj** łącze dla każdego produktu Wyświetla **usunąć** łącza.</span><span class="sxs-lookup"><span data-stu-id="a3db4-359">However, instead of displaying an **Edit** link for each product, it displays a **Delete** link.</span></span> <span data-ttu-id="a3db4-360">**Usunąć** link jest tworzony przy użyciu następującego kodu osadzone w znaczniku:</span><span class="sxs-lookup"><span data-stu-id="a3db4-360">The **Delete** link is created using the following embedded code in the markup:</span></span>

    [!code-cshtml[Main](5-working-with-data/samples/sample23.cshtml)]

    <span data-ttu-id="a3db4-361">Spowoduje to utworzenie adresu URL, który wygląda jak to, gdy użytkownik kliknie łącze:</span><span class="sxs-lookup"><span data-stu-id="a3db4-361">This creates a URL that looks like this when users click the link:</span></span>

    `http://<server>/DeleteProduct/4`

    <span data-ttu-id="a3db4-362">Adres URL wywołania stronę o nazwie *DeleteProduct.cshtml* (który utworzysz obok) i przekazuje jego identyfikator produktu do usunięcia (tutaj, 4).</span><span class="sxs-lookup"><span data-stu-id="a3db4-362">The URL calls a page named *DeleteProduct.cshtml* (which you'll create next) and passes it the ID of the product to delete (here, 4).</span></span>
3. <span data-ttu-id="a3db4-363">Zapisz plik, ale zostawić otwarty.</span><span class="sxs-lookup"><span data-stu-id="a3db4-363">Save the file, but leave it open.</span></span>
4. <span data-ttu-id="a3db4-364">Utwórz plik CHTML o nazwie *DeleteProduct.cshtml*.</span><span class="sxs-lookup"><span data-stu-id="a3db4-364">Create another CHTML file named *DeleteProduct.cshtml*.</span></span> <span data-ttu-id="a3db4-365">Zastąp istniejącą zawartość następujących czynności:</span><span class="sxs-lookup"><span data-stu-id="a3db4-365">Replace the existing content with the following:</span></span>

    [!code-cshtml[Main](5-working-with-data/samples/sample24.cshtml)]

    <span data-ttu-id="a3db4-366">Ta strona jest wywoływana przez *ListProductsForDelete.cshtml* i umożliwia użytkownikom, upewnij się, że chcą usunąć produkt.</span><span class="sxs-lookup"><span data-stu-id="a3db4-366">This page is called by *ListProductsForDelete.cshtml* and lets users confirm that they want to delete a product.</span></span> <span data-ttu-id="a3db4-367">Aby wyświetlić listę produktów, które mają zostać usunięte, można uzyskać Identyfikatora produktu do usunięcia z adresu URL przy użyciu następującego kodu:</span><span class="sxs-lookup"><span data-stu-id="a3db4-367">To list the product to be deleted, you get the ID of the product to delete from the URL using the following code:</span></span>

    [!code-csharp[Main](5-working-with-data/samples/sample25.cs)]

    <span data-ttu-id="a3db4-368">Strona następnie z monitem o kliknąć przycisk, aby usunąć rekord, faktycznie.</span><span class="sxs-lookup"><span data-stu-id="a3db4-368">The page then asks the user to click a button to actually delete the record.</span></span> <span data-ttu-id="a3db4-369">Jest to zabezpieczenie ważne: podczas wykonywania operacji poufnych w witrynie sieci Web, takich jak aktualizowania lub usuwania danych, należy zawsze wykonać te operacje przy użyciu operacji POST, nie operacji GET.</span><span class="sxs-lookup"><span data-stu-id="a3db4-369">This is an important security measure: when you perform sensitive operations in your website like updating or deleting data, these operations should always be done using a POST operation, not a GET operation.</span></span> <span data-ttu-id="a3db4-370">Jeśli witryna jest skonfigurowana tak, aby operację usuwania można wykonać przy użyciu operacji GET, każdy użytkownik może przekazać adres URL podobny `http://<server>/DeleteProduct/4` i cokolwiek chcą usuwania z bazy danych.</span><span class="sxs-lookup"><span data-stu-id="a3db4-370">If your site is set up so that a delete operation can be performed using a GET operation, anyone can pass a URL like `http://<server>/DeleteProduct/4` and delete anything they want from your database.</span></span> <span data-ttu-id="a3db4-371">Dodawanie potwierdzenie i kodowania strony, dzięki czemu usunięcia można wykonać tylko przy użyciu ogłoszenie (POST), możesz dodać miarę zabezpieczeń do swojej witryny.</span><span class="sxs-lookup"><span data-stu-id="a3db4-371">By adding the confirmation and coding the page so that the deletion can be performed only by using a POST, you add a measure of security to your site.</span></span>

    <span data-ttu-id="a3db4-372">Operacja usuwania rzeczywiste odbywa się przy użyciu następujący kod, który najpierw sprawdza, czy jest to operacja post i czy identyfikator nie jest pusty:</span><span class="sxs-lookup"><span data-stu-id="a3db4-372">The actual delete operation is performed using the following code, which first confirms that this is a post operation and that the ID isn't empty:</span></span>

    [!code-csharp[Main](5-working-with-data/samples/sample26.cs)]

    <span data-ttu-id="a3db4-373">Kod działa na instrukcję SQL, która usuwa określonego rekordu, a następnie przekierowuje użytkownika do strony listy.</span><span class="sxs-lookup"><span data-stu-id="a3db4-373">The code runs a SQL statement that deletes the specified record and then redirects the user back to the listing page.</span></span>
5. <span data-ttu-id="a3db4-374">Uruchom *ListProductsForDelete.cshtml* w przeglądarce.</span><span class="sxs-lookup"><span data-stu-id="a3db4-374">Run *ListProductsForDelete.cshtml* in a browser.</span></span>

    ![[Obraz]](5-working-with-data/_static/image9.jpg)
6. <span data-ttu-id="a3db4-376">Kliknij przycisk **usunąć** łącze do jednego z produktów.</span><span class="sxs-lookup"><span data-stu-id="a3db4-376">Click the **Delete** link for one of the products.</span></span> <span data-ttu-id="a3db4-377">*DeleteProduct.cshtml* zostanie wyświetlona strona, aby potwierdzić usunięcie tego rekordu.</span><span class="sxs-lookup"><span data-stu-id="a3db4-377">The *DeleteProduct.cshtml* page is displayed to confirm that you want to delete that record.</span></span>
7. <span data-ttu-id="a3db4-378">Kliknij przycisk **usunąć** przycisku.</span><span class="sxs-lookup"><span data-stu-id="a3db4-378">Click the **Delete** button.</span></span> <span data-ttu-id="a3db4-379">Rekord produkt zostanie usunięty i odświeżeniu strony z listą zaktualizowane produktu.</span><span class="sxs-lookup"><span data-stu-id="a3db4-379">The product record is deleted and the page is refreshed with an updated product listing.</span></span>

> [!TIP]
> 
> <a id="SB_ConnectingToADatabase"></a>
> ### <a name="connecting-to-a-database"></a><span data-ttu-id="a3db4-380">Połączenia z bazą danych</span><span class="sxs-lookup"><span data-stu-id="a3db4-380">Connecting to a Database</span></span>
> 
> <span data-ttu-id="a3db4-381">Można połączyć się z bazą danych na dwa sposoby.</span><span class="sxs-lookup"><span data-stu-id="a3db4-381">You can connect to a database in two ways.</span></span> <span data-ttu-id="a3db4-382">Pierwsza to użycie `Database.Open` — metoda i określ nazwę pliku bazy danych (mniej *sdf* rozszerzenia):</span><span class="sxs-lookup"><span data-stu-id="a3db4-382">The first is to use the `Database.Open` method and to specify the name of the database file (less the *.sdf* extension):</span></span>
> 
> `var db = Database.Open("SmallBakery");`
> 
> <span data-ttu-id="a3db4-383">`Open` Metody, przy założeniu, że. *sdf* plik znajduje się w witrynie sieci Web *aplikacji\_danych* folderu.</span><span class="sxs-lookup"><span data-stu-id="a3db4-383">The `Open` method assumes that the .*sdf* file is in the website's *App\_Data* folder.</span></span> <span data-ttu-id="a3db4-384">Ten folder jest zaprojektowany specjalnie z myślą przechowywania danych.</span><span class="sxs-lookup"><span data-stu-id="a3db4-384">This folder is designed specifically for holding data.</span></span> <span data-ttu-id="a3db4-385">Na przykład, że ma ona odpowiednie uprawnienia, aby umożliwić witryny sieci Web do odczytywania i zapisywania danych i ze względów bezpieczeństwa program WebMatrix nie zezwala na dostęp do plików z tego folderu.</span><span class="sxs-lookup"><span data-stu-id="a3db4-385">For example, it has appropriate permissions to allow the website to read and write data, and as a security measure, WebMatrix does not allow access to files from this folder.</span></span>
> 
> <span data-ttu-id="a3db4-386">Drugim sposobem jest używane są parametry połączenia.</span><span class="sxs-lookup"><span data-stu-id="a3db4-386">The second way is to use a connection string.</span></span> <span data-ttu-id="a3db4-387">Parametry połączenia zawierają informacje na temat nawiązywania połączenia z bazą danych.</span><span class="sxs-lookup"><span data-stu-id="a3db4-387">A connection string contains information about how to connect to a database.</span></span> <span data-ttu-id="a3db4-388">Mogą to być ścieżka pliku lub może obejmować nazwę bazy danych programu SQL Server na serwerze lokalnym lub zdalnym, oraz nazwę użytkownika i hasło, aby połączyć się z serwerem.</span><span class="sxs-lookup"><span data-stu-id="a3db4-388">This can include a file path, or it can include the name of a SQL Server database on a local or remote server, along with a user name and password to connect to that server.</span></span> <span data-ttu-id="a3db4-389">(Jeśli dane są przechowywane w centralnie zarządzanej wersji programu SQL Server, takich jak witryny dostawcy hostingu zawsze umożliwia ciąg połączenia Określ informacje o połączeniu.)</span><span class="sxs-lookup"><span data-stu-id="a3db4-389">(If you keep data in a centrally managed version of SQL Server, such as on a hosting provider's site, you always use a connection string to specify the database connection information.)</span></span>
> 
> <span data-ttu-id="a3db4-390">W programie WebMatrix, parametry połączenia są zwykle przechowywane w pliku XML o nazwie *Web.config*. Jak wskazuje nazwę, można użyć *Web.config* w katalogu głównym witryny sieci Web do przechowywania informacji o konfiguracji witryny, w tym wszelkie parametry połączenia, które mogą wymagać witryny.</span><span class="sxs-lookup"><span data-stu-id="a3db4-390">In WebMatrix, connection strings are usually stored in an XML file named *Web.config*. As the name implies, you can use a *Web.config* file in the root of your website to store the site's configuration information, including any connection strings that your site might require.</span></span> <span data-ttu-id="a3db4-391">Przykładem ciągu połączenia w *Web.config* pliku może wyglądać następująco:</span><span class="sxs-lookup"><span data-stu-id="a3db4-391">An example of a connection string in a *Web.config* file might look like the following:</span></span>
> 
> [!code-xml[Main](5-working-with-data/samples/sample27.xml)]
> 
> <span data-ttu-id="a3db4-392">W tym przykładzie wskazuje ciąg połączenia bazy danych w wystąpieniu programu SQL Server, który jest uruchomiony na innym serwerze (a nie lokalnie *sdf* pliku).</span><span class="sxs-lookup"><span data-stu-id="a3db4-392">In the example, the connection string points to a database in an instance of SQL Server that's running on a server somewhere (as opposed to a local *.sdf* file).</span></span> <span data-ttu-id="a3db4-393">Należy zastąpić odpowiednie nazwy dla `myServer` i `myDatabase`i określ wartości logowania programu SQL Server dla `username` i `password`.</span><span class="sxs-lookup"><span data-stu-id="a3db4-393">You would need to substitute the appropriate names for `myServer` and `myDatabase`, and specify SQL Server login values for `username` and `password`.</span></span> <span data-ttu-id="a3db4-394">(Wartości nazwy użytkownika i hasła nie są zawsze taki sam jako poświadczeń systemu Windows lub wartości, które Twój dostawca hostingu podane do logowania do swoich serwerów.</span><span class="sxs-lookup"><span data-stu-id="a3db4-394">(The username and password values are not necessarily the same as your Windows credentials or as the values that your hosting provider has given you for logging in to their servers.</span></span> <span data-ttu-id="a3db4-395">Skontaktuj się z administratorem, aby uzyskać dokładne wartości, które są potrzebne.)</span><span class="sxs-lookup"><span data-stu-id="a3db4-395">Check with the administrator for the exact values you need.)</span></span>
> 
> <span data-ttu-id="a3db4-396">`Database.Open` — Metoda jest elastyczny, ponieważ umożliwia ona przekazywania nazwy bazy danych *sdf* Nazwa ciągu połączenia, który jest przechowywany w pliku lub *Web.config* pliku.</span><span class="sxs-lookup"><span data-stu-id="a3db4-396">The `Database.Open` method is flexible, because it lets you pass either the name of a database *.sdf* file or the name of a connection string that's stored in the *Web.config* file.</span></span> <span data-ttu-id="a3db4-397">Poniższy przykład przedstawia sposób nawiązywania połączenia z bazą danych przy użyciu parametrów połączenia, przedstawiono w poprzednim przykładzie:</span><span class="sxs-lookup"><span data-stu-id="a3db4-397">The following example shows how to connect to the database using the connection string illustrated in the previous example:</span></span>
> 
> [!code-cshtml[Main](5-working-with-data/samples/sample28.cshtml)]
> 
> <span data-ttu-id="a3db4-398">Jak wspomniano, `Database.Open` metoda pozwala przekazać nazwę bazy danych lub ciąg połączenia i jego określenie, który ma zostać użyty.</span><span class="sxs-lookup"><span data-stu-id="a3db4-398">As noted, the `Database.Open` method lets you pass either a database name or a connection string, and it'll figure out which to use.</span></span> <span data-ttu-id="a3db4-399">Jest to bardzo przydatne podczas wdrażania (publikowanie) witryny sieci Web.</span><span class="sxs-lookup"><span data-stu-id="a3db4-399">This is very useful when you deploy (publish) your website.</span></span> <span data-ttu-id="a3db4-400">Można użyć *sdf* w pliku *aplikacji\_danych* folderu, gdy w przypadku tworzenia i testowania witryny.</span><span class="sxs-lookup"><span data-stu-id="a3db4-400">You can use an *.sdf* file in the *App\_Data* folder when you're developing and testing your site.</span></span> <span data-ttu-id="a3db4-401">Po przeniesieniu witryny na serwerze produkcyjnym, możesz użyć ciągu połączenia w *Web.config* pliku, który ma taką samą nazwę jak Twoje *sdf* plików, ale &#8212;wszystko to bez konieczności zmiany kodu.</span><span class="sxs-lookup"><span data-stu-id="a3db4-401">Then when you move your site to a production server, you can use a connection string in the *Web.config* file that has the same name as your *.sdf* file but that points to the hosting provider's database &#8212; all without having to change your code.</span></span>
> 
> <span data-ttu-id="a3db4-402">Ponadto jeśli chcesz pracować bezpośrednio z ciągu połączenia, można wywołać `Database.OpenConnectionString` — metoda i przekazać go parametrów zamiast nazwy tylko w rzeczywistych połączenia *Web.config* pliku.</span><span class="sxs-lookup"><span data-stu-id="a3db4-402">Finally, if you want to work directly with a connection string, you can call the `Database.OpenConnectionString` method and pass it the actual connection string instead of just the name of one in the *Web.config* file.</span></span> <span data-ttu-id="a3db4-403">Może to być przydatne w sytuacjach, w którym jakiegoś powodu nie mają dostępu do ciągu połączenia (lub wartości, takich jak *sdf* nazwa pliku) do momentu strony jest uruchomiona.</span><span class="sxs-lookup"><span data-stu-id="a3db4-403">This might be useful in situations where for some reason you don't have access to the connection string (or values in it, such as the *.sdf* file name) until the page is running.</span></span> <span data-ttu-id="a3db4-404">Jednak w przypadku większości scenariuszy należy użyć `Database.Open` zgodnie z opisem w tym artykule.</span><span class="sxs-lookup"><span data-stu-id="a3db4-404">However, for most scenarios, you can use `Database.Open` as described in this article.</span></span>


## <a name="additional-resources"></a><span data-ttu-id="a3db4-405">Dodatkowe zasoby</span><span class="sxs-lookup"><span data-stu-id="a3db4-405">Additional Resources</span></span>

- [<span data-ttu-id="a3db4-406">SQL Server Compact</span><span class="sxs-lookup"><span data-stu-id="a3db4-406">SQL Server Compact</span></span>](https://www.microsoft.com/sqlserver/2008/en/us/compact.aspx)
- [<span data-ttu-id="a3db4-407">Łączenie z serwerem SQL lub bazy danych MySQL w programie WebMatrix</span><span class="sxs-lookup"><span data-stu-id="a3db4-407">Connecting to a SQL Server or MySQL Database in WebMatrix</span></span>](https://go.microsoft.com/fwlink/?LinkId=208661)
- [<span data-ttu-id="a3db4-408">Weryfikacja danych wejściowych użytkownika w witrynach ASP.NET Web Pages</span><span class="sxs-lookup"><span data-stu-id="a3db4-408">Validating User Input in ASP.NET Web Pages Sites</span></span>](https://go.microsoft.com/fwlink/?LinkId=253002)
