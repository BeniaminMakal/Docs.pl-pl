---
uid: web-forms/overview/older-versions-security/admin/unlocking-and-approving-user-accounts-vb
title: Odblokowywanie i zatwierdzania konta użytkowników (VB) | Dokumentacja firmy Microsoft
author: rick-anderson
description: W tym samouczku przedstawiono sposób tworzenia strony sieci web, Administratorzy mogą skutecznie zarządzać zablokowane i zatwierdzone stanów użytkowników. Zostanie również wyświetlone nowych użytkowników o zatwierdzaniu...
ms.author: aspnetcontent
manager: wpickett
ms.date: 04/01/2008
ms.topic: article
ms.assetid: 041854a5-ea8c-4de0-82f1-121ba6cb2893
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/older-versions-security/admin/unlocking-and-approving-user-accounts-vb
msc.type: authoredcontent
ms.openlocfilehash: 977ed9d1e68e635eadd7aa8339670f5a5d209a7b
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/06/2018
---
<a name="unlocking-and-approving-user-accounts-vb"></a><span data-ttu-id="d8d2e-104">Odblokowywanie i zatwierdzania konta użytkowników (VB)</span><span class="sxs-lookup"><span data-stu-id="d8d2e-104">Unlocking and Approving User Accounts (VB)</span></span>
====================
<span data-ttu-id="d8d2e-105">przez [Bento Scott](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="d8d2e-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="d8d2e-106">[Pobierz kod](http://download.microsoft.com/download/6/0/e/60e1bd94-e5f9-4d5a-a079-f23c98f4f67d/VB.14.zip) lub [pobierania plików PDF](http://download.microsoft.com/download/6/0/e/60e1bd94-e5f9-4d5a-a079-f23c98f4f67d/aspnet_tutorial14_UnlockAndApprove_vb.pdf)</span><span class="sxs-lookup"><span data-stu-id="d8d2e-106">[Download Code](http://download.microsoft.com/download/6/0/e/60e1bd94-e5f9-4d5a-a079-f23c98f4f67d/VB.14.zip) or [Download PDF](http://download.microsoft.com/download/6/0/e/60e1bd94-e5f9-4d5a-a079-f23c98f4f67d/aspnet_tutorial14_UnlockAndApprove_vb.pdf)</span></span>

> <span data-ttu-id="d8d2e-107">W tym samouczku przedstawiono sposób tworzenia strony sieci web, Administratorzy mogą skutecznie zarządzać zablokowane i zatwierdzone stanów użytkowników.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-107">This tutorial shows how to build a web page for administrators to manage users' locked out and approved statuses.</span></span> <span data-ttu-id="d8d2e-108">Zostanie również wyświetlone zatwierdzaniu nowych użytkowników dopiero po sprawdzeniu swój adres e-mail.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-108">We will also see how to approve new users only after they have verified their email address.</span></span>


## <a name="introduction"></a><span data-ttu-id="d8d2e-109">Wprowadzenie</span><span class="sxs-lookup"><span data-stu-id="d8d2e-109">Introduction</span></span>

<span data-ttu-id="d8d2e-110">Wraz z nazwą użytkownika, hasło i adres e-mail, każde konto użytkownika ma dwa pola stanu, które wymuszają, czy użytkownik może zalogować się do witryny: zablokowane i zatwierdzone.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-110">Along with a username, password, and email, each user account has two status fields that dictate whether the user can log into the site: locked out and approved.</span></span> <span data-ttu-id="d8d2e-111">Użytkownik jest zablokowane automatycznie, jeśli zapewniają nieprawidłowe poświadczenia określoną liczbę razy w ciągu określonej liczby minut (domyślne ustawienia zablokowania użytkownika po 5 nieudanych prób logowania w ciągu 10 minut).</span><span class="sxs-lookup"><span data-stu-id="d8d2e-111">A user is automatically locked out if they provide invalid credentials a specified number of times within a specified number of minutes (the default settings lock a user out after 5 invalid login attempts within 10 minutes).</span></span> <span data-ttu-id="d8d2e-112">Zatwierdzone stanem jest to przydatne w scenariuszach, w której niektóre akcje, muszą orzeczona zanim nowy użytkownik będzie mógł zalogować się do witryny.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-112">The approved status is useful in scenarios where some action must transpire before a new user is able to log on to the site.</span></span> <span data-ttu-id="d8d2e-113">Na przykład użytkownik może być konieczne najpierw Zweryfikuj swój adres e-mail lub być zatwierdzone przez administratora, aby można było do logowania.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-113">For example, a user might need to first verify their email address or be approved by an administrator before being able to login.</span></span>

<span data-ttu-id="d8d2e-114">Ponieważ zablokowanym out lub niezatwierdzonych użytkownik nie może się zalogować, jest tylko naturalnego do zastanawiasz się, jak można zresetować te stany.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-114">Because a locked out or unapproved user cannot login, it's only natural to wonder how these statuses can be reset.</span></span> <span data-ttu-id="d8d2e-115">Program ASP.NET nie ma żadnych wbudowanych funkcji lub formantów sieci Web do zarządzania użytkowników zablokowane i częściowo zatwierdzone stany, ponieważ decyzje te muszą być obsługiwani na podstawie lokacji przez.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-115">ASP.NET does not include any built-in functionality or Web controls for managing users' locked out and approved statuses, in part because these decisions need to be handled on a site-by-site basis.</span></span> <span data-ttu-id="d8d2e-116">Niektóre witryny może automatycznie zatwierdzać wszystkie nowe konta użytkowników (domyślnie).</span><span class="sxs-lookup"><span data-stu-id="d8d2e-116">Some sites might automatically approve all new user accounts (the default behavior).</span></span> <span data-ttu-id="d8d2e-117">Inne poproś administratora o zatwierdzić nowych kont lub nie zatwierdzenia użytkowników, dopóki odwiedzeniu łącza wysyłane na adres e-mail podany podczas ich konta.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-117">Others have an administrator approve new accounts or do not approve users until they visit a link sent to the email address provided when they signed up.</span></span> <span data-ttu-id="d8d2e-118">Podobnie niektóre witryny może zablokować użytkowników, dopóki administrator resetuje stan, podczas gdy inne witryny wysłanie wiadomości e-mail do użytkownika zablokowane przy użyciu adresu URL, które mogą odwiedzać Aby odblokować konto.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-118">Likewise, some sites may lock out users until an administrator resets their status, while other sites send an email to the locked out user with a URL they can visit to unlock their account.</span></span>

<span data-ttu-id="d8d2e-119">W tym samouczku przedstawiono sposób tworzenia strony sieci web, Administratorzy mogą skutecznie zarządzać zablokowane i zatwierdzone stanów użytkowników.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-119">This tutorial shows how to build a web page for administrators to manage users' locked out and approved statuses.</span></span> <span data-ttu-id="d8d2e-120">Zostanie również wyświetlone zatwierdzaniu nowych użytkowników dopiero po sprawdzeniu swój adres e-mail.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-120">We will also see how to approve new users only after they have verified their email address.</span></span>

## <a name="step-1-managing-users-locked-out-and-approved-statuses"></a><span data-ttu-id="d8d2e-121">Krok 1: Zarządzanie użytkowników zablokowane i zatwierdzone stanów</span><span class="sxs-lookup"><span data-stu-id="d8d2e-121">Step 1: Managing Users' Locked Out and Approved Statuses</span></span>

<span data-ttu-id="d8d2e-122">W <a id="Tutorial12"> </a> [ *tworzenia interfejsu można wybrać jedno konto użytkownika z wielu* ](building-an-interface-to-select-one-user-account-from-many-vb.md) samouczek możemy skonstruowany strony, znajdującego się na każdym koncie użytkownika w stronicowanej, filtrowane widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-122">In the <a id="Tutorial12"></a>[*Building an Interface to Select One User Account from Many*](building-an-interface-to-select-one-user-account-from-many-vb.md) tutorial we constructed a page that listed each user account in a paged, filtered GridView.</span></span> <span data-ttu-id="d8d2e-123">Siatka wyświetla nazwę każdego użytkownika i poczty e-mail, ich stanów zatwierdzone i zablokowane, czy są one obecnie w trybie online i wszelkie komentarze dotyczące użytkownika.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-123">The grid lists each user's name and email, their approved and locked out statuses, whether they're currently online, and any comments about the user.</span></span> <span data-ttu-id="d8d2e-124">Aby zarządzać użytkowników zatwierdzona i zablokowane stany, firma Microsoft może wprowadzać ta Siatka można edytować.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-124">To manage users' approved and locked out statuses, we could make this grid editable.</span></span> <span data-ttu-id="d8d2e-125">Aby zmienić stan zatwierdzone przez użytkownika, administrator będzie w pierwszej kolejności zlokalizować konta użytkownika, a następnie edytuj odpowiedni wiersz widoku GridView, sprawdzanie lub usunięcie zaznaczenia pola wyboru zatwierdzone.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-125">To change a user's approved status, the administrator would first locate the user account and then edit the corresponding GridView row, checking or unchecking the approved checkbox.</span></span> <span data-ttu-id="d8d2e-126">Alternatywnie firma Microsoft może zarządzać stanów zatwierdzone i zablokowane, za pomocą osobnych stron ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-126">Alternatively, we could manage the approved and locked out statuses through a separate ASP.NET page.</span></span>

<span data-ttu-id="d8d2e-127">W tym samouczku można użyć dwóch stron ASP.NET: `ManageUsers.aspx` i `UserInformation.aspx`.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-127">For this tutorial let's use two ASP.NET pages: `ManageUsers.aspx` and `UserInformation.aspx`.</span></span> <span data-ttu-id="d8d2e-128">Pomysł, w tym miejscu jest to, że `ManageUsers.aspx` Wyświetla listę kont użytkowników w systemie, podczas gdy `UserInformation.aspx` umożliwia administratorowi Zarządzanie stanów zatwierdzone i zablokowane dla określonego użytkownika.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-128">The idea here is that `ManageUsers.aspx` lists the user accounts in the system, while `UserInformation.aspx` enables the administrator to manage the approved and locked out statuses for a specific user.</span></span> <span data-ttu-id="d8d2e-129">Naszym pierwszym działalnością of kolejności jest rozszerzyć w widoku GridView `ManageUsers.aspx` uwzględnienie pole hiperłącza HyperLinkField, która renderuje kolumną łącza.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-129">Our first order of business is to augment the GridView in `ManageUsers.aspx` to include a HyperLinkField, which renders as a column of links.</span></span> <span data-ttu-id="d8d2e-130">Chcemy każde łącze, aby wskazywał `UserInformation.aspx?user=UserName`, gdzie *UserName* jest nazwa użytkownika do edycji.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-130">We want each link to point to `UserInformation.aspx?user=UserName`, where *UserName* is the name of the user to edit.</span></span>

> [!NOTE]
> <span data-ttu-id="d8d2e-131">Jeśli pobrano kod <a id="Tutorial13"> </a> [ *odzyskiwanie i zmiana hasła* ](recovering-and-changing-passwords-vb.md) samouczka można zauważyć, że `ManageUsers.aspx` strona zawiera już zestaw " Zarządzanie"łącza i `UserInformation.aspx` strony udostępnia interfejs zmiany hasła wybranego użytkownika.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-131">If you downloaded the code for the <a id="Tutorial13"></a>[*Recovering and Changing Passwords*](recovering-and-changing-passwords-vb.md) tutorial you may have noticed that the `ManageUsers.aspx` page already contains a set of "Manage" links and the `UserInformation.aspx` page provides an interface for changing the selected user's password.</span></span> <span data-ttu-id="d8d2e-132">I zrezygnowała replikować te funkcje w kodzie skojarzone z tego samouczka, ponieważ ci poszło obejścia interfejs API członkostwa i operacyjnego bezpośrednio z bazą danych programu SQL Server, aby zmienić hasło użytkownika.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-132">I decided not to replicate that functionality in the code associated with this tutorial because it worked by circumventing the Membership API and operating directly with the SQL Server database to change a user's password.</span></span> <span data-ttu-id="d8d2e-133">W tym samouczku rozpoczyna się od podstaw z `UserInformation.aspx` strony.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-133">This tutorial starts from scratch with the `UserInformation.aspx` page.</span></span>


### <a name="adding-manage-links-to-theuseraccountsgridview"></a><span data-ttu-id="d8d2e-134">Dodawanie "Manage" łącza do`UserAccounts`widoku GridView</span><span class="sxs-lookup"><span data-stu-id="d8d2e-134">Adding "Manage" Links to the`UserAccounts`GridView</span></span>

<span data-ttu-id="d8d2e-135">Otwórz `ManageUsers.aspx` i dodać pole hiperłącza HyperLinkField do `UserAccounts` widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-135">Open the `ManageUsers.aspx` page and add a HyperLinkField to the `UserAccounts` GridView.</span></span> <span data-ttu-id="d8d2e-136">Ustaw pole hiperłącza HyperLinkField `Text` dla właściwości "Manage" i jego `DataNavigateUrlFields` i `DataNavigateUrlFormatString` właściwości `UserName` i "UserInformation.aspx?user={0}", odpowiednio.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-136">Set the HyperLinkField's `Text` property to "Manage" and its `DataNavigateUrlFields` and `DataNavigateUrlFormatString` properties to `UserName` and "UserInformation.aspx?user={0}", respectively.</span></span> <span data-ttu-id="d8d2e-137">Tych ustawień Skonfiguruj pole hiperłącza HyperLinkField w taki sposób, aby wyświetlić wszystkie hiperłącza tekst "Manage", ale przekazuje każde łącze w odpowiedniej *UserName* wartość na ciąg zapytania.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-137">These settings configure the HyperLinkField such that all of the hyperlinks display the text "Manage", but each link passes in the appropriate *UserName* value into the querystring.</span></span>

<span data-ttu-id="d8d2e-138">Po dodaniu pole hiperłącza HyperLinkField do widoku GridView, Poświęć chwilę, aby wyświetlić `ManageUsers.aspx` strony za pośrednictwem przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-138">After adding the HyperLinkField to the GridView, take a moment to view the `ManageUsers.aspx` page through a browser.</span></span> <span data-ttu-id="d8d2e-139">Jak pokazano na rysunku 1, każdego wiersza w widoku GridView teraz zawiera link "Zarządzaj".</span><span class="sxs-lookup"><span data-stu-id="d8d2e-139">As Figure 1 shows, each GridView row now includes a "Manage" link.</span></span> <span data-ttu-id="d8d2e-140">Wskazuje link "Zarządzaj" Bruce `UserInformation.aspx?user=Bruce`, podczas gdy wskazuje link "Zarządzaj" Dave `UserInformation.aspx?user=Dave`.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-140">The "Manage" link for Bruce points to `UserInformation.aspx?user=Bruce`, whereas the "Manage" link for Dave points to `UserInformation.aspx?user=Dave`.</span></span>


<span data-ttu-id="d8d2e-141">[![Dodaje pole hiperłącza HyperLinkField](unlocking-and-approving-user-accounts-vb/_static/image2.png)](unlocking-and-approving-user-accounts-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="d8d2e-141">[![The HyperLinkField Adds a](unlocking-and-approving-user-accounts-vb/_static/image2.png)](unlocking-and-approving-user-accounts-vb/_static/image1.png)</span></span>

<span data-ttu-id="d8d2e-142">**Rysunek 1**: pole hiperłącza HyperLinkField dodaje łącze "Manage", dla każdego konta użytkownika ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](unlocking-and-approving-user-accounts-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="d8d2e-142">**Figure 1**: The HyperLinkField Adds a "Manage" Link for Each User Account  ([Click to view full-size image](unlocking-and-approving-user-accounts-vb/_static/image3.png))</span></span>


<span data-ttu-id="d8d2e-143">Firma Microsoft utworzy interfejsu użytkownika i kodu dla `UserInformation.aspx` strony w momencie, ale najpierw umożliwia poproś o jak programowo zmienić użytkownika zablokowane i zatwierdzone stanów.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-143">We will create the user interface and code for the `UserInformation.aspx` page in a moment, but first let's talk about how to programmatically change a user's locked out and approved statuses.</span></span> <span data-ttu-id="d8d2e-144">[ `MembershipUser` Klasy](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx) ma [ `IsLockedOut` ](https://msdn.microsoft.com/library/system.web.security.membershipuser.islockedout.aspx) i [ `IsApproved` właściwości](https://msdn.microsoft.com/library/system.web.security.membershipuser.isapproved.aspx).</span><span class="sxs-lookup"><span data-stu-id="d8d2e-144">The [`MembershipUser` class](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx) has [`IsLockedOut`](https://msdn.microsoft.com/library/system.web.security.membershipuser.islockedout.aspx) and [`IsApproved` properties](https://msdn.microsoft.com/library/system.web.security.membershipuser.isapproved.aspx).</span></span> <span data-ttu-id="d8d2e-145">`IsLockedOut` Właściwość jest tylko do odczytu.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-145">The `IsLockedOut` property is read-only.</span></span> <span data-ttu-id="d8d2e-146">Nie istnieje mechanizm do programowego zablokowania użytkownika; Aby odblokować użytkownika, należy użyć `MembershipUser` klasy [ `UnlockUser` metody](https://msdn.microsoft.com/library/system.web.security.membershipuser.unlockuser.aspx).</span><span class="sxs-lookup"><span data-stu-id="d8d2e-146">There is no mechanism to programmatically lock out a user; to unlock a user, use the `MembershipUser` class's [`UnlockUser` method](https://msdn.microsoft.com/library/system.web.security.membershipuser.unlockuser.aspx).</span></span> <span data-ttu-id="d8d2e-147">`IsApproved` Właściwość jest do odczytu i zapisu.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-147">The `IsApproved` property is readable and writeable.</span></span> <span data-ttu-id="d8d2e-148">Aby zapisać zmiany w tej właściwości, należy wywołać `Membership` klasy [ `UpdateUser` metody](https://msdn.microsoft.com/library/system.web.security.membership.updateuser.aspx), przekazując zmodyfikowanych `MembershipUser` obiektu.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-148">To save any changes to this property, we need to call the `Membership` class's [`UpdateUser` method](https://msdn.microsoft.com/library/system.web.security.membership.updateuser.aspx), passing in the modified `MembershipUser` object.</span></span>

<span data-ttu-id="d8d2e-149">Ponieważ `IsApproved` właściwość do odczytu i zapisu, pole wyboru jest prawdopodobnie najlepsze elementu interfejsu użytkownika dotyczące konfigurowania tej właściwości.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-149">Because the `IsApproved` property is readable and writeable, a CheckBox control is probably the best user interface element for configuring this property.</span></span> <span data-ttu-id="d8d2e-150">Jednak pole wyboru nie będzie działać dla `IsLockedOut` właściwości, ponieważ administrator nie zablokowania użytkownika, użytkownik może tylko odblokowanie użytkownika.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-150">However, a CheckBox will not work for the `IsLockedOut` property because an administrator cannot lock out a user, she may only unlock a user.</span></span> <span data-ttu-id="d8d2e-151">Interfejs użytkownika odpowiedniego `IsLockedOut` właściwości jest przycisk, po kliknięciu odblokowuje konto użytkownika.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-151">A suitable user interface for the `IsLockedOut` property is a Button that, when clicked, unlocks the user account.</span></span> <span data-ttu-id="d8d2e-152">Ten przycisk powinien być włączony tylko, jeśli użytkownik jest zablokowany.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-152">This Button should only be enabled if the user is locked out.</span></span>

### <a name="creating-theuserinformationaspxpage"></a><span data-ttu-id="d8d2e-153">Tworzenie`UserInformation.aspx`strony</span><span class="sxs-lookup"><span data-stu-id="d8d2e-153">Creating the`UserInformation.aspx`Page</span></span>

<span data-ttu-id="d8d2e-154">Firma Microsoft są teraz gotowe do implementacji interfejsu użytkownika w `UserInformation.aspx`.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-154">We are now ready to implement the user interface in `UserInformation.aspx`.</span></span> <span data-ttu-id="d8d2e-155">Otwórz tę stronę i dodaj następujące formantów sieci Web:</span><span class="sxs-lookup"><span data-stu-id="d8d2e-155">Open this page and add the following Web controls:</span></span>

- <span data-ttu-id="d8d2e-156">Hiperłącze kontrolować, po kliknięciu zwraca administratorowi `ManageUsers.aspx` strony.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-156">A HyperLink control that, when clicked, returns the administrator to the `ManageUsers.aspx` page.</span></span>
- <span data-ttu-id="d8d2e-157">Kontrolka etykiety w sieci Web do wyświetlania nazwę wybranego użytkownika.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-157">A Label Web control for displaying the selected user's name.</span></span> <span data-ttu-id="d8d2e-158">Ustaw tę etykietę `ID` do `UserNameLabel` i wyczyszczenie właściwości Text.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-158">Set this Label's `ID` to `UserNameLabel` and clear out its Text property.</span></span>
- <span data-ttu-id="d8d2e-159">Formant wyboru o nazwie `IsApproved`.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-159">A CheckBox control named `IsApproved`.</span></span> <span data-ttu-id="d8d2e-160">Ustaw jego `AutoPostBack` właściwości `True`.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-160">Set its `AutoPostBack` property to `True`.</span></span>
- <span data-ttu-id="d8d2e-161">Etykieta do wyświetlania użytkownika obiektu ostatniego zablokowane Data.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-161">A Label control for displaying the user's last locked out date.</span></span> <span data-ttu-id="d8d2e-162">Nazwa tej etykiety `LastLockedOutDateLabel` i wyczyszczenie jego `Text` właściwości.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-162">Name this Label `LastLockedOutDateLabel` and clear out its `Text` property.</span></span>
- <span data-ttu-id="d8d2e-163">Przycisk odblokowanie użytkownika.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-163">A Button for unlocking the user.</span></span> <span data-ttu-id="d8d2e-164">Nazwa tego przycisku `UnlockUserButton` i ustawić jej `Text` dla właściwości "Odblokuj użytkownika".</span><span class="sxs-lookup"><span data-stu-id="d8d2e-164">Name this Button `UnlockUserButton` and set its `Text` property to "Unlock User".</span></span>
- <span data-ttu-id="d8d2e-165">Etykieta do wyświetlania komunikatów o stanie, takie jak "został zaktualizowany stan zatwierdzone użytkownika".</span><span class="sxs-lookup"><span data-stu-id="d8d2e-165">A Label control for displaying status messages, such as, "The user's approved status has been updated."</span></span> <span data-ttu-id="d8d2e-166">Nazwa tego formantu `StatusMessage`, wyczyść się jego `Text` właściwości i ustaw jego `CssClass` właściwości `Important`.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-166">Name this control `StatusMessage`, clear out its `Text` property, and set its `CssClass` property to `Important`.</span></span> <span data-ttu-id="d8d2e-167">( `Important` CSS klasa jest zdefiniowana w `Styles.css` pliku arkusza stylów; wyświetla odpowiedni tekst w dużych, red czcionki.)</span><span class="sxs-lookup"><span data-stu-id="d8d2e-167">(The `Important` CSS class is defined in the `Styles.css` stylesheet file; it displays the corresponding text in a large, red font.)</span></span>

<span data-ttu-id="d8d2e-168">Po dodaniu tych kontrolek, widok projektu w programie Visual Studio powinien wyglądać podobnie do ekranu zrzut na rysunku 2.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-168">After adding these controls, the Design view in Visual Studio should look similar to the screen shot in Figure 2.</span></span>


<span data-ttu-id="d8d2e-169">[![Tworzenie interfejsu użytkownika dla UserInformation.aspx](unlocking-and-approving-user-accounts-vb/_static/image5.png)](unlocking-and-approving-user-accounts-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="d8d2e-169">[![Create the User Interface for UserInformation.aspx](unlocking-and-approving-user-accounts-vb/_static/image5.png)](unlocking-and-approving-user-accounts-vb/_static/image4.png)</span></span>

<span data-ttu-id="d8d2e-170">**Rysunek 2**: Tworzenie interfejsu użytkownika dla `UserInformation.aspx` ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](unlocking-and-approving-user-accounts-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="d8d2e-170">**Figure 2**: Create the User Interface for `UserInformation.aspx` ([Click to view full-size image](unlocking-and-approving-user-accounts-vb/_static/image6.png))</span></span>


<span data-ttu-id="d8d2e-171">Pełne interfejsu użytkownika jest skonfigurowanie naszych następne zadanie `IsApproved` wyboru i inne formanty oparte na informacje wybranego użytkownika.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-171">With the user interface complete, our next task is to set the `IsApproved` CheckBox and other controls based on the selected user's information.</span></span> <span data-ttu-id="d8d2e-172">Tworzenie procedury obsługi zdarzeń dla strony `Load` zdarzeń i Dodaj następujący kod:</span><span class="sxs-lookup"><span data-stu-id="d8d2e-172">Create an event handler for the page's `Load` event and add the following code:</span></span>

[!code-vb[Main](unlocking-and-approving-user-accounts-vb/samples/sample1.vb)]

<span data-ttu-id="d8d2e-173">Powyższy kod rozpoczyna się przez zapewnienie, że jest to pierwsza wizyta strony i nie kolejnych ogłaszania zwrotnego.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-173">The above code starts by ensuring that this is the first visit to the page and not a subsequent postback.</span></span> <span data-ttu-id="d8d2e-174">Następnie odczytuje username przekazywane `user` pole querystring i pobiera informacje o tym koncie użytkownika za pośrednictwem `Membership.GetUser(username)` metody.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-174">It then reads the username passed through the `user` querystring field and retrieves information about that user account via the `Membership.GetUser(username)` method.</span></span> <span data-ttu-id="d8d2e-175">Jeśli username nie został dostarczony przez ciąg zapytania, lub jeśli nie można odnaleźć określonego użytkownika, administratora są wysyłane do `ManageUsers.aspx` strony.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-175">If no username was supplied through the querystring, or if the specified user could not be found, the administrator is sent back to the `ManageUsers.aspx` page.</span></span>

<span data-ttu-id="d8d2e-176">`MembershipUser` Obiektu `UserName` są następnie wyświetlane wartości `UserNameLabel` i `IsApproved` jest zaznaczone pole wyboru na podstawie `IsApproved` wartości właściwości.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-176">The `MembershipUser` object's `UserName` value is then displayed in the `UserNameLabel` and the `IsApproved` CheckBox is checked based on the `IsApproved` property value.</span></span>

<span data-ttu-id="d8d2e-177">`MembershipUser` Obiektu [ `LastLockoutDate` właściwości](https://msdn.microsoft.com/library/system.web.security.membershipuser.lastlockoutdate.aspx) zwraca `DateTime` wartość wskazującą, kiedy użytkownik został ostatnio zablokowane. Jeśli użytkownik nigdy nie zostało zablokowane, wartość zwracana jest zależna od dostawcy członkostwa.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-177">The `MembershipUser` object's [`LastLockoutDate` property](https://msdn.microsoft.com/library/system.web.security.membershipuser.lastlockoutdate.aspx) returns a `DateTime` value indicating when the user was last locked out. If the user has never been locked out, the value returned depends on the Membership provider.</span></span> <span data-ttu-id="d8d2e-178">Po utworzeniu nowego konta `SqlMembershipProvider` ustawia `aspnet_Membership` tabeli `LastLockoutDate` do `1754-01-01 12:00:00 AM`.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-178">When a new account is created, the `SqlMembershipProvider` sets the `aspnet_Membership` table's `LastLockoutDate` field to `1754-01-01 12:00:00 AM`.</span></span> <span data-ttu-id="d8d2e-179">Powyższy kod wyświetla pusty ciąg `LastLockoutDateLabel` Jeśli `LastLockoutDate` właściwość występuje przed rokiem 2000; w przeciwnym razie daty część `LastLockoutDate` właściwość jest wyświetlana w etykiecie.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-179">The above code displays an empty string in the `LastLockoutDateLabel` if the `LastLockoutDate` property occurs before year 2000; otherwise, the date portion of the `LastLockoutDate` property is displayed in the Label.</span></span> <span data-ttu-id="d8d2e-180">`UnlockUserButton`w `Enabled` właściwość jest ustawiona na użytkownika zablokowane w stanie, co oznacza, że tego przycisku zostanie tylko włączone, jeśli użytkownik jest zablokowany.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-180">The `UnlockUserButton`'s `Enabled` property is set to the user's locked out status, meaning that this Button will only be enabled if the user is locked out.</span></span>

<span data-ttu-id="d8d2e-181">Poświęć chwilę, aby przetestować `UserInformation.aspx` strony za pośrednictwem przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-181">Take a moment to test the `UserInformation.aspx` page through a browser.</span></span> <span data-ttu-id="d8d2e-182">Należy rozpocząć od `ManageUsers.aspx` i wybierz konto użytkownika do zarządzania.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-182">You will, of course, need to start at `ManageUsers.aspx` and select a user account to manage.</span></span> <span data-ttu-id="d8d2e-183">Po otrzymywanych `UserInformation.aspx`, należy pamiętać, że `IsApproved` tylko jest zaznaczone pole wyboru, jeśli użytkownik jest zatwierdzony.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-183">Upon arriving at `UserInformation.aspx`, note that the `IsApproved` CheckBox is only checked if the user is approved.</span></span> <span data-ttu-id="d8d2e-184">Jeśli użytkownik kiedykolwiek zostało zablokowane, wyświetlany jest ostatnią zablokowane daty.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-184">If the user has ever been locked out, their last locked out date is displayed.</span></span> <span data-ttu-id="d8d2e-185">Przycisk Odblokuj użytkownika jest włączona tylko wtedy, gdy użytkownik jest obecnie zablokowane. Zaznaczenie lub usunięcie zaznaczenia `IsApproved` wyboru lub przycisku odblokowanie użytkownika powoduje odświeżenie strony, ale nie modyfikacje są dokonywane na koncie użytkownika, ponieważ jeszcze mamy do tworzenie obsługi zdarzeń dla tych zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-185">The Unlock User button is enabled only if the user is currently locked out. Checking or unchecking the `IsApproved` CheckBox or clicking the Unlock User button causes a postback, but no modifications are made to the user account because we've yet to create event handlers for these events.</span></span>

<span data-ttu-id="d8d2e-186">Wróć do programu Visual Studio i utworzyć obsługi zdarzeń `IsApproved` składnika CheckBox `CheckedChanged` zdarzeń i `UnlockUser` przycisku `Click` zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-186">Return to Visual Studio and create event handlers for the `IsApproved` CheckBox's `CheckedChanged` event and the `UnlockUser` Button's `Click` event.</span></span> <span data-ttu-id="d8d2e-187">W `CheckedChanged` program obsługi zdarzeń, Ustaw użytkownika `IsApproved` właściwości `Checked` właściwości pola wyboru, a następnie zapisz zmiany za pomocą wywołania `Membership.UpdateUser`.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-187">In the `CheckedChanged` event handler, set the user's `IsApproved` property to the `Checked` property of the CheckBox and then save the changes via a call to `Membership.UpdateUser`.</span></span> <span data-ttu-id="d8d2e-188">W `Click` program obsługi zdarzeń, po prostu wywołanie `MembershipUser` obiektu `UnlockUser` metody.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-188">In the `Click` event handler, simply call the `MembershipUser` object's `UnlockUser` method.</span></span> <span data-ttu-id="d8d2e-189">W obu programów obsługi zdarzeń wyświetlony odpowiedni komunikat w `StatusMessage` etykiety.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-189">In both event handlers, display a suitable message in the `StatusMessage` Label.</span></span>

[!code-vb[Main](unlocking-and-approving-user-accounts-vb/samples/sample2.vb)]

### <a name="testing-theuserinformationaspxpage"></a><span data-ttu-id="d8d2e-190">Testowanie`UserInformation.aspx`strony</span><span class="sxs-lookup"><span data-stu-id="d8d2e-190">Testing the`UserInformation.aspx`Page</span></span>

<span data-ttu-id="d8d2e-191">Z tych obsługi zdarzeń w miejscu, należy ponownie strony i niezatwierdzonych przez użytkownika.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-191">With these event handlers in place, revisit the page and unapproved a user.</span></span> <span data-ttu-id="d8d2e-192">Jak pokazano na rysunku 3, powinny pojawić się krótkie komunikatów na stronie, co oznacza, że użytkownika `IsApproved` właściwość została pomyślnie zmodyfikowana.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-192">As Figure 3 shows, you should see a brief message on the page indicating that the user's `IsApproved` property was successfully modified.</span></span>


<span data-ttu-id="d8d2e-193">[![Krzysztof został niezatwierdzone](unlocking-and-approving-user-accounts-vb/_static/image8.png)](unlocking-and-approving-user-accounts-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="d8d2e-193">[![Chris has been Unapproved](unlocking-and-approving-user-accounts-vb/_static/image8.png)](unlocking-and-approving-user-accounts-vb/_static/image7.png)</span></span>

<span data-ttu-id="d8d2e-194">**Rysunek 3**: Krzysztof został niezatwierdzone ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](unlocking-and-approving-user-accounts-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="d8d2e-194">**Figure 3**: Chris has been Unapproved  ([Click to view full-size image](unlocking-and-approving-user-accounts-vb/_static/image9.png))</span></span>


<span data-ttu-id="d8d2e-195">Następnie, wyloguj się i spróbuj zalogować się jako użytkownik, którego konto zostało właśnie niezatwierdzonych.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-195">Next, logout and try to login as the user whose account was just unapproved.</span></span> <span data-ttu-id="d8d2e-196">Ponieważ użytkownik nie jest zatwierdzona, nie można zalogować.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-196">Because the user is not approved, they cannot login.</span></span> <span data-ttu-id="d8d2e-197">Domyślnie ten sam komunikat wyświetla formantu logowania, jeśli użytkownik nie może się zalogować, niezależnie od przyczyny.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-197">By default, the Login control displays the same message if the user cannot login, regardless of the reason.</span></span> <span data-ttu-id="d8d2e-198">Jednak <a id="Tutorial6"> </a> [ *weryfikowania użytkowników przed członkostwa użytkownika magazynu poświadczeń* ](../membership/validating-user-credentials-against-the-membership-user-store-vb.md) samouczek analizujemy udoskonalanie formantu logowania, aby wyświetlić bardziej odpowiednia wiadomość.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-198">But in the <a id="Tutorial6"></a>[*Validating User Credentials Against the Membership User Store*](../membership/validating-user-credentials-against-the-membership-user-store-vb.md) tutorial we looked at enhancing the Login control to display a more appropriate message.</span></span> <span data-ttu-id="d8d2e-199">Jak pokazano na rysunku 4, Krzysztof jest wyświetlany komunikat z informacjami o tym, że nie można zalogować się on, ponieważ jego konto nie jest jeszcze zatwierdzone.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-199">As Figure 4 shows, Chris is shown a message explaining that he cannot login because his account is not yet approved.</span></span>


<span data-ttu-id="d8d2e-200">[![Krzysztof nie ponieważ jego konto logowania jest niezatwierdzone](unlocking-and-approving-user-accounts-vb/_static/image11.png)](unlocking-and-approving-user-accounts-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="d8d2e-200">[![Chris Cannot Login Because His Account is Unapproved](unlocking-and-approving-user-accounts-vb/_static/image11.png)](unlocking-and-approving-user-accounts-vb/_static/image10.png)</span></span>

<span data-ttu-id="d8d2e-201">**Rysunek 4**: Krzysztof nie ponieważ jego konto logowania jest niezatwierdzone ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](unlocking-and-approving-user-accounts-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="d8d2e-201">**Figure 4**: Chris Cannot Login Because His Account is Unapproved  ([Click to view full-size image](unlocking-and-approving-user-accounts-vb/_static/image12.png))</span></span>


<span data-ttu-id="d8d2e-202">Aby przetestować funkcje zablokowane, spróbuj zalogować się jako użytkownik zatwierdzone, ale niepoprawne hasło.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-202">To test the locked out functionality, attempt to login as an approved user, but use an incorrect password.</span></span> <span data-ttu-id="d8d2e-203">Powtórz ten proces niezbędne liczbę razy, aż konto użytkownika zostało zablokowane. Kontrolka logowania Zaktualizowano również Pokaż niestandardowego komunikatu, jeśli próba logowania z blokady konta.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-203">Repeat this process the necessary number of times until the user's account has been locked out. The Login control was also updated to show a custom message if attempting to login from a locked out account.</span></span> <span data-ttu-id="d8d2e-204">Wiadomo, że po uruchomieniu następujący komunikat na stronie logowania wyświetlany zostało zablokowane konta: "Twoje konto zostało zablokowane z powodu zbyt wielu nieudanych prób logowania.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-204">You know that an account has been locked out once you start seeing the following message at the login page: "Your account has been locked out because of too many invalid login attempts.</span></span> <span data-ttu-id="d8d2e-205">Skontaktuj się z administratorem, aby odblokować konto."</span><span class="sxs-lookup"><span data-stu-id="d8d2e-205">Please contact the administrator to have your account unlocked."</span></span>

<span data-ttu-id="d8d2e-206">Wróć do `ManageUsers.aspx` i kliknij przycisk Zarządzaj link blokady użytkownika.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-206">Return to the `ManageUsers.aspx` page and click the Manage link for the locked out user.</span></span> <span data-ttu-id="d8d2e-207">Jak pokazano na rysunku nr 5, powinna zostać wyświetlona wartość w `LastLockedOutDateLabel` przycisku odblokowanie użytkownika powinno być włączone.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-207">As Figure 5 shows, you should see a value in the `LastLockedOutDateLabel` the Unlock User button should be enabled.</span></span> <span data-ttu-id="d8d2e-208">Kliknij przycisk odblokowanie użytkownika, aby odblokować konto użytkownika.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-208">Click the Unlock User button to unlock the user account.</span></span> <span data-ttu-id="d8d2e-209">Gdy użytkownik ma odblokowany, będą oni mogli zalogować się ponownie.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-209">Once you have unlocked the user, they will be able to login again.</span></span>


<span data-ttu-id="d8d2e-210">[![Dave została ograniczona do systemu](unlocking-and-approving-user-accounts-vb/_static/image14.png)](unlocking-and-approving-user-accounts-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="d8d2e-210">[![Dave Has Been Locked Out of the System](unlocking-and-approving-user-accounts-vb/_static/image14.png)](unlocking-and-approving-user-accounts-vb/_static/image13.png)</span></span>

<span data-ttu-id="d8d2e-211">**Rysunek 5**: Dave ma zostało zablokowane z systemu ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](unlocking-and-approving-user-accounts-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="d8d2e-211">**Figure 5**: Dave Has Been Locked Out of the System  ([Click to view full-size image](unlocking-and-approving-user-accounts-vb/_static/image15.png))</span></span>


## <a name="step-2-specifying-new-users-approved-status"></a><span data-ttu-id="d8d2e-212">Krok 2: Określenie nowych użytkowników zatwierdzone stanu</span><span class="sxs-lookup"><span data-stu-id="d8d2e-212">Step 2: Specifying New Users' Approved Status</span></span>

<span data-ttu-id="d8d2e-213">Zatwierdzone stanem jest to przydatne w scenariuszach, w którym ma niektóre akcje do wykonania, zanim nowy użytkownik będzie mógł zalogować się i uzyskiwać dostęp do funkcji specyficzne dla użytkownika witryny.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-213">The approved status is useful in scenarios where you want some action to be performed before a new user is able to login and access the user-specific features of the site.</span></span> <span data-ttu-id="d8d2e-214">Na przykład być może używasz prywatnej witryny sieci Web gdzie wszystkich stron, z wyjątkiem strony logowania i zapisywania są dostępne tylko dla użytkowników uwierzytelnionych.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-214">For example, you may be running a private website where all pages, except for the login and signup pages, are accessible only to authenticated users.</span></span> <span data-ttu-id="d8d2e-215">Ale co się stanie, jeśli obcej osoby osiągnie witryny sieci Web, znajduje stronę rejestracji i tworzy konto?</span><span class="sxs-lookup"><span data-stu-id="d8d2e-215">But what happens if a stranger reaches your website, finds the signup page, and creates an account?</span></span> <span data-ttu-id="d8d2e-216">Aby temu zapobiec, można przenieść strony rejestracji, aby `Administration` folderu i wymaga się, że administrator ręcznie tworzyć każdego konta.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-216">To prevent this from happening you could move the signup page to an `Administration` folder, and require that an administrator manually create each account.</span></span> <span data-ttu-id="d8d2e-217">Alternatywnie można pozwala nikomu rejestracji, ale uniemożliwiają dostęp do witryny, aż administrator zatwierdzi konta użytkownika.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-217">Alternatively, you could allow anyone to signup, but prohibit site access until an administrator approves the user account.</span></span>

<span data-ttu-id="d8d2e-218">Domyślnie w formancie CreateUserWizard zatwierdza nowe konta.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-218">By default, the CreateUserWizard control approves new accounts.</span></span> <span data-ttu-id="d8d2e-219">Można skonfigurować tego zachowania, za pomocą formantu [ `DisableCreatedUser` właściwości](https://msdn.microsoft.com/en-gb/library/system.web.ui.webcontrols.createuserwizard.disablecreateduser.aspx).</span><span class="sxs-lookup"><span data-stu-id="d8d2e-219">You can configure this behavior using the control's [`DisableCreatedUser` property](https://msdn.microsoft.com/en-gb/library/system.web.ui.webcontrols.createuserwizard.disablecreateduser.aspx).</span></span> <span data-ttu-id="d8d2e-220">Ta właściwość jest ustawiana `True` nie zatwierdzić nowych kont użytkowników.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-220">Set this property to `True` to not approve new user accounts.</span></span>

> [!NOTE]
> <span data-ttu-id="d8d2e-221">Domyślnie w formancie CreateUserWizard automatyczne logowanie na koncie użytkownika.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-221">By default the CreateUserWizard control automatically logs on the new user account.</span></span> <span data-ttu-id="d8d2e-222">To zachowanie jest zależna formantu [ `LoginCreatedUser` właściwości](https://msdn.microsoft.com/en-gb/library/system.web.ui.webcontrols.createuserwizard.logincreateduser.aspx).</span><span class="sxs-lookup"><span data-stu-id="d8d2e-222">This behavior is dictated by the control's [`LoginCreatedUser` property](https://msdn.microsoft.com/en-gb/library/system.web.ui.webcontrols.createuserwizard.logincreateduser.aspx).</span></span> <span data-ttu-id="d8d2e-223">Ponieważ użytkownicy niezatwierdzonych nie może zalogować się do witryny, gdy `DisableCreatedUser` jest `True` nowe konto użytkownika nie jest zalogowany do lokacji, niezależnie od wartości `LoginCreatedUser` właściwości.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-223">Because unapproved users cannot login to the site, when `DisableCreatedUser` is `True` the new user account is not logged into the site, regardless of the value of the `LoginCreatedUser` property.</span></span>


<span data-ttu-id="d8d2e-224">Programowo w przypadku tworzenia nowych kont użytkowników za pomocą `Membership.CreateUser` metody, aby utworzyć konto użytkownika niezatwierdzonych Użyj jednego z przeciążeń, które akceptują nowego użytkownika `IsApproved` wartości właściwości jako parametr wejściowy.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-224">If you are programmatically creating new user accounts via the `Membership.CreateUser` method, to create an unapproved user account use one of the overloads that accept the new user's `IsApproved` property value as an input parameter.</span></span>

## <a name="step-3-approving-users-by-verifying-their-email-address"></a><span data-ttu-id="d8d2e-225">Krok 3: Zatwierdzanie użytkowników, sprawdzając swój adres E-mail</span><span class="sxs-lookup"><span data-stu-id="d8d2e-225">Step 3: Approving Users By Verifying their Email Address</span></span>

<span data-ttu-id="d8d2e-226">Wiele witryn sieci Web, które obsługują kont użytkowników nie Akceptuj nowych użytkowników, dopóki ich weryfikacji adresu e-mail, który one dostarczane podczas rejestrowania.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-226">Many websites that support user accounts do not approve new users until they verify the email address they supplied when registering.</span></span> <span data-ttu-id="d8d2e-227">Ten proces sprawdzania poprawności jest najczęściej używany do oszustw robotów, nadawcy i innych ne'er-do-wells, ponieważ wymaga adresu e-mail unikatowy, zweryfikowane i dodaje dodatkowego kroku w procesie rejestracji.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-227">This verification process is commonly used to thwart bots, spammers, and other ne'er-do-wells as it requires a unique, verified email address and adds an extra step in the signup process.</span></span> <span data-ttu-id="d8d2e-228">Z tym modelem po zarejestrowaniu nowego użytkownika są one wysyłane wiadomości e-mail, który zawiera łącze do strony weryfikacji.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-228">With this model, when a new user signs up they are sent an email message that includes a link to a verification page.</span></span> <span data-ttu-id="d8d2e-229">Odwiedzając łącze użytkownika przebiegło, aby otrzymały one wiadomości e-mail i w związku z tym, że podany adres e-mail jest prawidłowa.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-229">By visiting the link the user has proven that they received the email and, therefore, that the email address provided is valid.</span></span> <span data-ttu-id="d8d2e-230">Na stronie weryfikacji jest odpowiedzialny za zatwierdzanie użytkownika.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-230">The verification page is responsible for approving the user.</span></span> <span data-ttu-id="d8d2e-231">Może to mieć miejsce automatycznie, a tym samym zatwierdzanie osiągnie tej strony, użytkownik lub tylko wtedy, gdy użytkownik udostępnia dodatkowe informacje, takie jak [CAPTCHA](http://en.wikipedia.org/wiki/Captcha).</span><span class="sxs-lookup"><span data-stu-id="d8d2e-231">This may happen automatically, thereby approving any user who reaches this page, or only after the user provides some additional information, such as a [CAPTCHA](http://en.wikipedia.org/wiki/Captcha).</span></span>

<span data-ttu-id="d8d2e-232">Aby uwzględnić ten przepływ pracy, należy najpierw zaktualizować strony tworzenia konta, tak aby nowi użytkownicy są niezatwierdzonych.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-232">To accommodate this workflow, we need to first update the account creation page so that new users are unapproved.</span></span> <span data-ttu-id="d8d2e-233">Otwórz `EnhancedCreateUserWizard.aspx` strony `Membership` folder i zestaw formancie CreateUserWizard `DisableCreatedUser` właściwości `True`.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-233">Open the `EnhancedCreateUserWizard.aspx` page in the `Membership` folder and set the CreateUserWizard control's `DisableCreatedUser` property to `True`.</span></span>

<span data-ttu-id="d8d2e-234">Następnie należy skonfigurować w formancie CreateUserWizard do wysyłania wiadomości e-mail do nowego użytkownika z instrukcjami zweryfikować swoje konto.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-234">Next, we need to configure the CreateUserWizard control to send an email to the new user with instructions on how to verify their account.</span></span> <span data-ttu-id="d8d2e-235">W szczególności firma Microsoft zawiera łącze w wiadomości e-mail, aby `Verification.aspx` strony (który mamy jeszcze do tworzenia), przekazując nowego użytkownika `UserId` za pośrednictwem ciąg zapytania.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-235">In particular, we will include a link in the email to the `Verification.aspx` page (which we've yet to create), passing in the new user's `UserId` through the querystring.</span></span> <span data-ttu-id="d8d2e-236">`Verification.aspx` Strony będzie wyszukać określonego użytkownika i oznacz je zatwierdzone.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-236">The `Verification.aspx` page will lookup the specified user and mark them approved.</span></span>

### <a name="sending-a-verification-email-to-new-users"></a><span data-ttu-id="d8d2e-237">Wysyłając wiadomość E-mail z weryfikacji do nowych użytkowników</span><span class="sxs-lookup"><span data-stu-id="d8d2e-237">Sending a Verification Email to New Users</span></span>

<span data-ttu-id="d8d2e-238">Aby wysłać wiadomość e-mail w formancie CreateUserWizard, skonfiguruj jego `MailDefinition` właściwości odpowiednio.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-238">To send an email from the CreateUserWizard control, configure its `MailDefinition` property appropriately.</span></span> <span data-ttu-id="d8d2e-239">Zgodnie z opisem w <a id="Tutorial13"> </a> [poprzedniego samouczek](recovering-and-changing-passwords-vb.md), dostępne kontrolki Element ChangePassword i PasswordRecovery [ `MailDefinition` właściwości](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.maildefinition.aspx) działający w taki sam sposób jak CreateUserWizard formantu.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-239">As discussed in the <a id="Tutorial13"></a>[previous tutorial](recovering-and-changing-passwords-vb.md), the ChangePassword and PasswordRecovery controls include a [`MailDefinition` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.maildefinition.aspx) that works in the same manner as the CreateUserWizard control's.</span></span>

> [!NOTE]
> <span data-ttu-id="d8d2e-240">Aby użyć `MailDefinition` opcje właściwości, należy określić dostarczanie poczty w `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-240">To use the `MailDefinition` property you need to specify mail delivery options in `Web.config`.</span></span> <span data-ttu-id="d8d2e-241">Aby uzyskać więcej informacji, zapoznaj się [wysyłania poczty E-mail w programie ASP.NET](http://aspnet.4guysfromrolla.com/articles/072606-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="d8d2e-241">For more information, refer to [Sending Email in ASP.NET](http://aspnet.4guysfromrolla.com/articles/072606-1.aspx).</span></span>


<span data-ttu-id="d8d2e-242">Rozpocznij od utworzenia nowego szablonu wiadomości e-mail o nazwie `CreateUserWizard.txt` w `EmailTemplates` folderu.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-242">Start by creating a new email template named `CreateUserWizard.txt` in the `EmailTemplates` folder.</span></span> <span data-ttu-id="d8d2e-243">Używany następujący tekst:</span><span class="sxs-lookup"><span data-stu-id="d8d2e-243">Use the following text for the template:</span></span>

[!code-aspx[Main](unlocking-and-approving-user-accounts-vb/samples/sample3.aspx)]

<span data-ttu-id="d8d2e-244">Ustaw `MailDefinition`w `BodyFileName` dla właściwości "~ / EmailTemplates/CreateUserWizard.txt" i jego `Subject` dla właściwości "Zapraszamy do witryny sieci Web!</span><span class="sxs-lookup"><span data-stu-id="d8d2e-244">Set the `MailDefinition`'s `BodyFileName` property to "~/EmailTemplates/CreateUserWizard.txt" and its `Subject` property to "Welcome to My Website!</span></span> <span data-ttu-id="d8d2e-245">Aktywuj konta."</span><span class="sxs-lookup"><span data-stu-id="d8d2e-245">Please activate your account."</span></span>

<span data-ttu-id="d8d2e-246">Należy pamiętać, że `CreateUserWizard.txt` szablon wiadomości e-mail zawiera `<%VerificationUrl%>` symbolu zastępczego.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-246">Note that the `CreateUserWizard.txt` email template includes a `<%VerificationUrl%>` placeholder.</span></span> <span data-ttu-id="d8d2e-247">Jest to, gdy adres URL `Verification.aspx` strony zostaną umieszczone.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-247">This is where the URL for the `Verification.aspx` page will be placed.</span></span> <span data-ttu-id="d8d2e-248">Automatycznie zastępuje CreateUserWizard `<%UserName%>` i `<%Password%>` symbole zastępcze z nazwy użytkownika i hasła, nowe konto, ale nie istnieje żadne wbudowane `<%VerificationUrl%>` symbolu zastępczego.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-248">The CreateUserWizard automatically replaces the `<%UserName%>` and `<%Password%>` placeholders with the new account's username and password, but there is no built-in `<%VerificationUrl%>` placeholder.</span></span> <span data-ttu-id="d8d2e-249">Należy ręcznie, zastąp ją odpowiednią weryfikacji adresu URL.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-249">We need to manually replace it with the appropriate verification URL.</span></span>

<span data-ttu-id="d8d2e-250">W tym celu należy utworzyć program obsługi zdarzeń dla CreateUserWizard [ `SendingMail` zdarzeń](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.sendingmail.aspx) i Dodaj następujący kod:</span><span class="sxs-lookup"><span data-stu-id="d8d2e-250">To accomplish this, create an event handler for the CreateUserWizard's [`SendingMail` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.sendingmail.aspx) and add the following code:</span></span>

[!code-vb[Main](unlocking-and-approving-user-accounts-vb/samples/sample4.vb)]

<span data-ttu-id="d8d2e-251">`SendingMail` Zdarzenia są generowane po `CreatedUser` zdarzeń, co oznacza, że w czasie, nowy użytkownik wykonuje powyższe procedury obsługi zdarzeń konto już istnieje.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-251">The `SendingMail` event fires after the `CreatedUser` event, meaning that by the time the above event handler executes the new user account has already been created.</span></span> <span data-ttu-id="d8d2e-252">Firma Microsoft mogą uzyskiwać dostęp do nowego użytkownika `UserId` wartość wywołując `Membership.GetUser` metody, przekazując `UserName` w formancie CreateUserWizard.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-252">We can access the new user's `UserId` value by calling the `Membership.GetUser` method, passing in the `UserName` entered into the CreateUserWizard control.</span></span> <span data-ttu-id="d8d2e-253">Następnie jest sformatowany adres URL weryfikacji.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-253">Next, the verification URL is formed.</span></span> <span data-ttu-id="d8d2e-254">Instrukcja `Request.Url.GetLeftPart(UriPartial.Authority)` zwraca `http://yourserver.com` część adresu URL; `Request.ApplicationPath` zwraca ścieżkę, gdzie aplikacja.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-254">The statement `Request.Url.GetLeftPart(UriPartial.Authority)` returns the `http://yourserver.com` portion of the URL; `Request.ApplicationPath` returns path where the application is rooted.</span></span> <span data-ttu-id="d8d2e-255">Weryfikacja adresu URL jest następnie zdefiniowany jako `Verification.aspx?ID=userId`.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-255">The verification URL is then defined as `Verification.aspx?ID=userId`.</span></span> <span data-ttu-id="d8d2e-256">Te dwa ciągi, które następnie są łączone do utworzenia pełny adres URL.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-256">These two strings are then concatenated to form the complete URL.</span></span> <span data-ttu-id="d8d2e-257">Na koniec treść wiadomości e-mail (`e.Message.Body`) zawiera wszystkie wystąpienia `<%VerificationUrl%>` zastąpione pełny adres URL.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-257">Finally, the email message body (`e.Message.Body`) has all occurrences of `<%VerificationUrl%>` replaced with the full URL.</span></span>

<span data-ttu-id="d8d2e-258">Net powoduje, że nowi użytkownicy są niezatwierdzonych, co oznacza, że nie można zalogować do witryny.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-258">The net effect is that new users are unapproved, meaning that they cannot log into the site.</span></span> <span data-ttu-id="d8d2e-259">Ponadto one są automatycznie wysyłane wiadomości e-mail z łączem do weryfikacji adresu URL (patrz rysunek 6).</span><span class="sxs-lookup"><span data-stu-id="d8d2e-259">Furthermore, they are automatically sent an email with a link to the verification URL (see Figure 6).</span></span>


<span data-ttu-id="d8d2e-260">[![Nowy użytkownik otrzymuje wiadomość E-mail zawierającą łącze do adresu URL weryfikacji](unlocking-and-approving-user-accounts-vb/_static/image17.png)](unlocking-and-approving-user-accounts-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="d8d2e-260">[![The New User Receives an Email with a Link to the Verification URL](unlocking-and-approving-user-accounts-vb/_static/image17.png)](unlocking-and-approving-user-accounts-vb/_static/image16.png)</span></span>

<span data-ttu-id="d8d2e-261">**Rysunek 6**: nowy użytkownik otrzymuje wiadomość E-mail zawierającą łącze do adresu URL weryfikacji ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](unlocking-and-approving-user-accounts-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="d8d2e-261">**Figure 6**: The New User Receives an Email with a Link to the Verification URL  ([Click to view full-size image](unlocking-and-approving-user-accounts-vb/_static/image18.png))</span></span>


> [!NOTE]
> <span data-ttu-id="d8d2e-262">Krok CreateUserWizard domyślne w formancie CreateUserWizard wyświetla komunikat informujący użytkownika swoje konto zostało utworzone i wyświetla przycisku Kontynuuj.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-262">The CreateUserWizard control's default CreateUserWizard step displays a message informing the user their account has been created and displays a Continue button.</span></span> <span data-ttu-id="d8d2e-263">Kliknięcie łącza przejście użytkownika na adres URL określony przez formant `ContinueDestinationPageUrl` właściwości.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-263">Clicking this takes the user to the URL specified by the control's `ContinueDestinationPageUrl` property.</span></span> <span data-ttu-id="d8d2e-264">CreateUserWizard w `EnhancedCreateUserWizard.aspx` jest skonfigurowany do wysyłania nowych użytkowników do `~/Membership/AdditionalUserInfo.aspx`, które monituje użytkownika o ich hometown, adres URL strony głównej i podpis.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-264">The CreateUserWizard in `EnhancedCreateUserWizard.aspx` is configured to send new users to the `~/Membership/AdditionalUserInfo.aspx`, which prompts the user for their hometown, homepage URL, and signature.</span></span> <span data-ttu-id="d8d2e-265">Ponieważ te informacje mogą być dodawane tylko przez zalogowanych użytkowników, warto zaktualizować tę właściwość, aby wysłać użytkowników z powrotem do strony głównej witryny (`~/Default.aspx`).</span><span class="sxs-lookup"><span data-stu-id="d8d2e-265">Because this information can only be added by logged on users, it makes sense to update this property to send users back to the site's homepage (`~/Default.aspx`).</span></span> <span data-ttu-id="d8d2e-266">Ponadto `EnhancedCreateUserWizard.aspx` strony lub krok CreateUserWizard powinien zostać rozszerzony, aby poinformować użytkownika, że zostały wysłane e-mail weryfikacji i nie będzie można aktywować swoje konto, aż do ich postępuj zgodnie z instrukcjami w wiadomości e-mail.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-266">Moreover, the `EnhancedCreateUserWizard.aspx` page or the CreateUserWizard step should be augmented to inform the user that they have been sent a verification email and their account won't be activated until they follow the instructions in this email.</span></span> <span data-ttu-id="d8d2e-267">Te modyfikacje wykonywania I pozostaw dla czytnika.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-267">I leave these modifications as an exercise for the reader.</span></span>


### <a name="creating-the-verification-page"></a><span data-ttu-id="d8d2e-268">Tworzenie strony weryfikacji</span><span class="sxs-lookup"><span data-stu-id="d8d2e-268">Creating the Verification Page</span></span>

<span data-ttu-id="d8d2e-269">Nasze ostatnim zadaniem jest tworzenie `Verification.aspx` strony.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-269">Our final task is to create the `Verification.aspx` page.</span></span> <span data-ttu-id="d8d2e-270">Dodaj tę stronę do folderu głównego było możliwe skojarzenie go z `Site.master` strony wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-270">Add this page to the root folder, associating it with the `Site.master` master page.</span></span> <span data-ttu-id="d8d2e-271">Jak możemy wykonane z większością poprzedniej strony zawartości dodane do lokacji, usuń formant zawartości, który odwołuje się do `LoginContent` ContentPlaceHolder tak, aby strona zawartości używa strony wzorcowej domyślne zawartości.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-271">As we've done with most of the previous content pages added to the site, remove the Content control that references the `LoginContent` ContentPlaceHolder so that the content page uses the master page's default content.</span></span>

<span data-ttu-id="d8d2e-272">Dodawanie formantu etykiety w sieci Web do `Verification.aspx` ustaw jego `ID` do `StatusMessage` i wyczyszczenie właściwości text.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-272">Add a Label Web control to the `Verification.aspx` page, set its `ID` to `StatusMessage` and clear out its text property.</span></span> <span data-ttu-id="d8d2e-273">Następnie należy utworzyć `Page_Load` obsługi zdarzeń i Dodaj następujący kod:</span><span class="sxs-lookup"><span data-stu-id="d8d2e-273">Next, create the `Page_Load` event handler and add the following code:</span></span>

[!code-vb[Main](unlocking-and-approving-user-accounts-vb/samples/sample5.vb)]

<span data-ttu-id="d8d2e-274">Sprawdza zbiorczego powyższy kod UserId dostarczane za pośrednictwem ciąg zapytania, że istnieje i czy jest prawidłową `Guid` wartość i że jego odwołuje się do istniejącego konta użytkownika.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-274">The bulk of the above code verifies that the UserId supplied through the querystring exists, that it is a valid `Guid` value, and that it references an existing user account.</span></span> <span data-ttu-id="d8d2e-275">Jeśli wszystkie te kontroli przekazać, konto użytkownika zostało zatwierdzone; w przeciwnym razie zostanie wyświetlony komunikat odpowiedni stan.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-275">If all of these checks pass, the user account is approved; otherwise, a suitable status message is displayed.</span></span>

<span data-ttu-id="d8d2e-276">Rysunek nr 7 przedstawia `Verification.aspx` strony po odwiedzeniu za pośrednictwem przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-276">Figure 7 shows the `Verification.aspx` page when visited through a browser.</span></span>


<span data-ttu-id="d8d2e-277">[![Nowe konta jest teraz zatwierdzony](unlocking-and-approving-user-accounts-vb/_static/image20.png)](unlocking-and-approving-user-accounts-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="d8d2e-277">[![The New User's Account is Now Approved](unlocking-and-approving-user-accounts-vb/_static/image20.png)](unlocking-and-approving-user-accounts-vb/_static/image19.png)</span></span>

<span data-ttu-id="d8d2e-278">**Rysunek 7**: nowe konto użytkownika jest teraz zatwierdzone ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](unlocking-and-approving-user-accounts-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="d8d2e-278">**Figure 7**: The New User's Account is Now Approved  ([Click to view full-size image](unlocking-and-approving-user-accounts-vb/_static/image21.png))</span></span>


## <a name="summary"></a><span data-ttu-id="d8d2e-279">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="d8d2e-279">Summary</span></span>

<span data-ttu-id="d8d2e-280">Wszystkie konta użytkowników członkostwa mają dwa stany, które określają, czy użytkownik może zalogować się do witryny: `IsLockedOut` i `IsApproved`.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-280">All Membership user accounts have two statuses that determine whether the user can log into the site: `IsLockedOut` and `IsApproved`.</span></span> <span data-ttu-id="d8d2e-281">Obie te właściwości musi być `True` do logowania użytkownika.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-281">Both of these properties must be `True` for the user to login.</span></span>

<span data-ttu-id="d8d2e-282">Zablokowane przez użytkownika stanu jest używany ze względów bezpieczeństwa, aby zmniejszyć prawdopodobieństwo haker okazji do witryny za pomocą metod siłowych.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-282">The user's locked out status is used as a security measure to reduce the likelihood of a hacker breaking into a site through brute force methods.</span></span> <span data-ttu-id="d8d2e-283">W szczególności użytkownika jest zablokowane, jeśli istnieje wiele nieudanych prób logowania w przedziale czasu.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-283">Specifically, a user is locked out if there are a certain number of invalid login attempts within a certain window of time.</span></span> <span data-ttu-id="d8d2e-284">Te granice są konfigurowane za pomocą ustawień dostawcy członkostwa w `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-284">These bounds are configurable through the Membership provider settings in `Web.config`.</span></span>

<span data-ttu-id="d8d2e-285">Stan zatwierdzone jest najczęściej używany jako środek do uniemożliwić logowanie do momentu upłynął niektóre akcje nowych użytkowników.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-285">The approved status is commonly used as a means to prohibit new users from logging in until some action has transpired.</span></span> <span data-ttu-id="d8d2e-286">Prawdopodobnie lokacji wymaga, aby nowe konta najpierw zostać zatwierdzone przez administratora lub jako widzieliśmy w kroku 3, sprawdzając swój adres e-mail.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-286">Perhaps the site requires that new accounts first be approved by the administrator or, as we saw in Step 3, by verifying their email address.</span></span>

<span data-ttu-id="d8d2e-287">Programowanie przyjemność!</span><span class="sxs-lookup"><span data-stu-id="d8d2e-287">Happy Programming!</span></span>

### <a name="about-the-author"></a><span data-ttu-id="d8d2e-288">Informacje o autorze</span><span class="sxs-lookup"><span data-stu-id="d8d2e-288">About the Author</span></span>

<span data-ttu-id="d8d2e-289">Scott Bento, Utwórz wiele książek ASP/ASP.NET i twórcę 4GuysFromRolla.com, pracuje z technologii Microsoft Web od 1998.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-289">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="d8d2e-290">Scott działa jako niezależnego konsultanta trainer i składnika zapisywania.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-290">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="d8d2e-291">Jest jego najnowszej książki  *[Sams nauczyć się ASP.NET 2.0 w ciągu 24 godzin](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-291">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="d8d2e-292">Scott jest osiągalny w [ mitchell@4guysfromrolla.com ](mailto:mitchell@4guysfromrolla.com) lub za pośrednictwem jego blogu w [ http://ScottOnWriting.NET ](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="d8d2e-292">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="d8d2e-293">Specjalne podziękowania dla...</span><span class="sxs-lookup"><span data-stu-id="d8d2e-293">Special Thanks To…</span></span>

<span data-ttu-id="d8d2e-294">Ten samouczek serii zostało sprawdzone przez wiele recenzentów przydatne.</span><span class="sxs-lookup"><span data-stu-id="d8d2e-294">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="d8d2e-295">Zainteresowani recenzowania Moje nadchodzących artykuły MSDN?</span><span class="sxs-lookup"><span data-stu-id="d8d2e-295">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="d8d2e-296">Jeśli tak, Porzuć mnie linii w [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="d8d2e-296">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="d8d2e-297">Poprzednie</span><span class="sxs-lookup"><span data-stu-id="d8d2e-297">Previous</span></span>](recovering-and-changing-passwords-vb.md)
