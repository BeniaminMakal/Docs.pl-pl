---
uid: web-forms/overview/older-versions-getting-started/getting-started-with-ef/the-entity-framework-and-aspnet-getting-started-part-4
title: Wprowadzenie do korzystania z bazy danych programu Entity Framework 4.0 najpierw i platformy ASP.NET 4 sieci Web Forms — część 4 | Dokumentacja firmy Microsoft
author: tdykstra
description: Przykładową aplikację sieci web firmy Contoso University przedstawia sposób tworzenia aplikacji formularzy sieci Web ASP.NET przy użyciu programu Entity Framework. Przykładowa aplikacja jest...
ms.author: aspnetcontent
manager: wpickett
ms.date: 12/03/2010
ms.topic: article
ms.assetid: ceb9e60f-957c-4d25-9331-cc527de96a33
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/older-versions-getting-started/getting-started-with-ef/the-entity-framework-and-aspnet-getting-started-part-4
msc.type: authoredcontent
ms.openlocfilehash: 6bea5f4faeb0a9c11a406a7e4e87c4929eda6a18
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/06/2018
---
<a name="getting-started-with-entity-framework-40-database-first-and-aspnet-4-web-forms---part-4"></a><span data-ttu-id="1293a-104">Wprowadzenie do korzystania z bazy danych programu Entity Framework 4.0 najpierw i formularzy sieci Web 4 ASP.NET - część 4</span><span class="sxs-lookup"><span data-stu-id="1293a-104">Getting Started with Entity Framework 4.0 Database First and ASP.NET 4 Web Forms - Part 4</span></span>
====================
<span data-ttu-id="1293a-105">Przez [Dykstra niestandardowy](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="1293a-105">by [Tom Dykstra](https://github.com/tdykstra)</span></span>

> <span data-ttu-id="1293a-106">Przykładową aplikację sieci web firmy Contoso University przedstawia sposób tworzenia aplikacji formularzy sieci Web ASP.NET przy użyciu programu Entity Framework 4.0 i Visual Studio 2010.</span><span class="sxs-lookup"><span data-stu-id="1293a-106">The Contoso University sample web application demonstrates how to create ASP.NET Web Forms applications using the Entity Framework 4.0 and Visual Studio 2010.</span></span> <span data-ttu-id="1293a-107">Informacje o samouczek serii, zobacz [pierwszy samouczek z tej serii](the-entity-framework-and-aspnet-getting-started-part-1.md)</span><span class="sxs-lookup"><span data-stu-id="1293a-107">For information about the tutorial series, see [the first tutorial in the series](the-entity-framework-and-aspnet-getting-started-part-1.md)</span></span>


## <a name="working-with-related-data"></a><span data-ttu-id="1293a-108">Praca z danymi pokrewne</span><span class="sxs-lookup"><span data-stu-id="1293a-108">Working with Related Data</span></span>

<span data-ttu-id="1293a-109">W poprzednich samouczku użyto `EntityDataSource` formant filtru, sortowania i grupowania danych.</span><span class="sxs-lookup"><span data-stu-id="1293a-109">In the previous tutorial you used the `EntityDataSource` control to filter, sort, and group data.</span></span> <span data-ttu-id="1293a-110">W tym samouczku możesz wyświetlić i zaktualizować powiązanych danych.</span><span class="sxs-lookup"><span data-stu-id="1293a-110">In this tutorial you'll display and update related data.</span></span>

<span data-ttu-id="1293a-111">Utworzysz strony instruktorów, który zawiera listę instruktorów.</span><span class="sxs-lookup"><span data-stu-id="1293a-111">You'll create the Instructors page that shows a list of instructors.</span></span> <span data-ttu-id="1293a-112">Po wybraniu instruktora, możesz wyświetlić listę kursy nauczanych przy tym instruktora.</span><span class="sxs-lookup"><span data-stu-id="1293a-112">When you select an instructor, you see a list of courses taught by that instructor.</span></span> <span data-ttu-id="1293a-113">Po wybraniu kursu możesz wyświetlić szczegóły dla porach i listy studentów zarejestrowane w toku.</span><span class="sxs-lookup"><span data-stu-id="1293a-113">When you select a course, you see details for the course and a list of students enrolled in the course.</span></span> <span data-ttu-id="1293a-114">Można edytować instruktora nazwa, data zatrudnienia i przypisania pakietu office.</span><span class="sxs-lookup"><span data-stu-id="1293a-114">You can edit the instructor name, hire date, and office assignment.</span></span> <span data-ttu-id="1293a-115">Przypisanie pakietu office to zestaw niezależna dostępnej za pośrednictwem właściwości nawigacji.</span><span class="sxs-lookup"><span data-stu-id="1293a-115">The office assignment is a separate entity set that you access through a navigation property.</span></span>

<span data-ttu-id="1293a-116">Możesz połączyć dane główne do szczegółowych danych w znaczniku lub w kodzie.</span><span class="sxs-lookup"><span data-stu-id="1293a-116">You can link master data to detail data in markup or in code.</span></span> <span data-ttu-id="1293a-117">W tej części samouczka użyjesz obu metod.</span><span class="sxs-lookup"><span data-stu-id="1293a-117">In this part of the tutorial, you'll use both methods.</span></span>

<span data-ttu-id="1293a-118">[![Image01](the-entity-framework-and-aspnet-getting-started-part-4/_static/image2.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="1293a-118">[![Image01](the-entity-framework-and-aspnet-getting-started-part-4/_static/image2.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image1.png)</span></span>

## <a name="displaying-and-updating-related-entities-in-a-gridview-control"></a><span data-ttu-id="1293a-119">Wyświetlanie i aktualizowanie powiązanych jednostek w kontrolce GridView</span><span class="sxs-lookup"><span data-stu-id="1293a-119">Displaying and Updating Related Entities in a GridView Control</span></span>

<span data-ttu-id="1293a-120">Tworzenie nowej strony sieci web o nazwie *Instructors.aspx* używającą *Site.Master* strony wzorcowej i Dodaj następujący kod do `Content` formantu o nazwie `Content2`:</span><span class="sxs-lookup"><span data-stu-id="1293a-120">Create a new web page named *Instructors.aspx* that uses the *Site.Master* master page, and add the following markup to the `Content` control named `Content2`:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample1.aspx)]

<span data-ttu-id="1293a-121">Tworzy tego znacznika `EntityDataSource` formant, który wybiera instruktorów i umożliwia aktualizacji.</span><span class="sxs-lookup"><span data-stu-id="1293a-121">This markup creates an `EntityDataSource` control that selects instructors and enables updates.</span></span> <span data-ttu-id="1293a-122">`div` Element konfiguruje znaczników renderowania po lewej stronie, aby można później dodać kolumnę po prawej stronie.</span><span class="sxs-lookup"><span data-stu-id="1293a-122">The `div` element configures markup to render on the left so that you can add a column on the right later.</span></span>

<span data-ttu-id="1293a-123">Między `EntityDataSource` znaczników i zamykania `</div>` tagów, Dodaj następujący kod znaczników, który tworzy `GridView` kontroli i `Label` formant, który ma być używany dla komunikatów o błędach:</span><span class="sxs-lookup"><span data-stu-id="1293a-123">Between the `EntityDataSource` markup and the closing `</div>` tag, add the following markup that creates a `GridView` control and a `Label` control that you'll use for error messages:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample2.aspx)]

<span data-ttu-id="1293a-124">To `GridView` kontroli umożliwia zaznaczenie wiersza, wyróżnia wybranego wiersza z kategorii lekkich szary kolor tła i określa obsługę (które należy utworzyć później) `SelectedIndexChanged` i `Updating` zdarzenia.</span><span class="sxs-lookup"><span data-stu-id="1293a-124">This `GridView` control enables row selection, highlights the selected row with a light gray background color, and specifies handlers (which you'll create later) for the `SelectedIndexChanged` and `Updating` events.</span></span> <span data-ttu-id="1293a-125">Określa również `PersonID` dla `DataKeyNames` właściwości, dzięki czemu mogą być przekazywane wartości klucza wybranego wiersza inny formant, który będzie później dodać.</span><span class="sxs-lookup"><span data-stu-id="1293a-125">It also specifies `PersonID` for the `DataKeyNames` property, so that the key value of the selected row can be passed to another control that you'll add later.</span></span>

<span data-ttu-id="1293a-126">Ostatnia kolumna zawiera instruktora przypisanie pakietu office, które są przechowywane we właściwości nawigacji `Person` jednostki, ponieważ pochodzi on z skojarzonej jednostki.</span><span class="sxs-lookup"><span data-stu-id="1293a-126">The last column contains the instructor's office assignment, which is stored in a navigation property of the `Person` entity because it comes from an associated entity.</span></span> <span data-ttu-id="1293a-127">Zwróć uwagę, że `EditItemTemplate` określa element `Eval` zamiast `Bind`, ponieważ `GridView` kontroli bezpośrednio nie można powiązać właściwości nawigacji w celu ich aktualizacji.</span><span class="sxs-lookup"><span data-stu-id="1293a-127">Notice that the `EditItemTemplate` element specifies `Eval` instead of `Bind`, because the `GridView` control cannot directly bind to navigation properties in order to update them.</span></span> <span data-ttu-id="1293a-128">Będzie aktualizowana przypisania pakietu office w kodzie.</span><span class="sxs-lookup"><span data-stu-id="1293a-128">You'll update the office assignment in code.</span></span> <span data-ttu-id="1293a-129">Aby to zrobić, należy odwołanie do `TextBox` kontrolki, na które będzie uzyskać i zapisać w `TextBox` formantu `Init` zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="1293a-129">To do that, you'll need a reference to the `TextBox` control, and you'll get and save that in the `TextBox` control's `Init` event.</span></span>

<span data-ttu-id="1293a-130">Po `GridView` formant jest `Label` formant, który jest używany dla komunikatów o błędach.</span><span class="sxs-lookup"><span data-stu-id="1293a-130">Following the `GridView` control is a `Label` control that's used for error messages.</span></span> <span data-ttu-id="1293a-131">Kontrolki `Visible` właściwość jest `false`, a stan widoku jest wyłączona, dzięki czemu etykiety będą wyświetlane tylko po kodzie ułatwia widoczny w odpowiedzi na błąd.</span><span class="sxs-lookup"><span data-stu-id="1293a-131">The control's `Visible` property is `false`, and view state is turned off, so that the label will appear only when code makes it visible in response to an error.</span></span>

<span data-ttu-id="1293a-132">Otwórz *Instructors.aspx.cs* pliku i dodaj następującą `using` instrukcji:</span><span class="sxs-lookup"><span data-stu-id="1293a-132">Open the *Instructors.aspx.cs* file and add the following `using` statement:</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample3.cs)]

<span data-ttu-id="1293a-133">Dodawanie pola Klasa prywatna bezpośrednio po deklaracji Nazwa klasy częściowe do przechowywania odwołanie do pola tekstowego przypisania pakietu office.</span><span class="sxs-lookup"><span data-stu-id="1293a-133">Add a private class field immediately after the partial-class name declaration to hold a reference to the office assignment text box.</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample4.cs)]

<span data-ttu-id="1293a-134">Dodawanie klasy zastępczej dla `SelectedIndexChanged` obsługi zdarzeń do użycia później dodasz kod.</span><span class="sxs-lookup"><span data-stu-id="1293a-134">Add a stub for the `SelectedIndexChanged` event handler that you'll add code for later.</span></span> <span data-ttu-id="1293a-135">Również dodać obsługę przypisania office `TextBox` formantu `Init` zdarzeń, dzięki czemu można przechowywać odwołanie do `TextBox` formantu.</span><span class="sxs-lookup"><span data-stu-id="1293a-135">Also add a handler for the office assignment `TextBox` control's `Init` event so that you can store a reference to the `TextBox` control.</span></span> <span data-ttu-id="1293a-136">Użyjesz tego odwołania można pobrać wartość użytkownika wprowadzona w celu zaktualizowania jednostki skojarzonej z właściwości nawigacji.</span><span class="sxs-lookup"><span data-stu-id="1293a-136">You'll use this reference to get the value the user entered in order to update the entity associated with the navigation property.</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample5.cs)]

<span data-ttu-id="1293a-137">Użyjesz `GridView` formantu `Updating` zdarzeń, aby zaktualizować `Location` właściwości skojarzonego `OfficeAssignment` jednostki.</span><span class="sxs-lookup"><span data-stu-id="1293a-137">You'll use the `GridView` control's `Updating` event to update the `Location` property of the associated `OfficeAssignment` entity.</span></span> <span data-ttu-id="1293a-138">Dodaj następujące obsługę `Updating` zdarzeń:</span><span class="sxs-lookup"><span data-stu-id="1293a-138">Add the following handler for the `Updating` event:</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample6.cs)]

<span data-ttu-id="1293a-139">Ten kod jest uruchamiany, gdy użytkownik kliknie **aktualizacji** w `GridView` wiersza.</span><span class="sxs-lookup"><span data-stu-id="1293a-139">This code is run when the user clicks **Update** in a `GridView` row.</span></span> <span data-ttu-id="1293a-140">W kodzie użyto LINQ to Entities można pobrać `OfficeAssignment` jednostki, który został skojarzony z bieżącym `Person` jednostki, przy użyciu `PersonID` zaznaczonego wiersza w argumencie zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="1293a-140">The code uses LINQ to Entities to retrieve the `OfficeAssignment` entity that's associated with the current `Person` entity, using the `PersonID` of the selected row from the event argument.</span></span>

<span data-ttu-id="1293a-141">Kod następnie przyjmuje jeden z następujących czynności w zależności od wartości w `InstructorOfficeTextBox` sterowania:</span><span class="sxs-lookup"><span data-stu-id="1293a-141">The code then takes one of the following actions depending on the value in the `InstructorOfficeTextBox` control:</span></span>

- <span data-ttu-id="1293a-142">Jeśli pole ma wartość i jest nie `OfficeAssignment` jednostki do zaktualizowania, tworzy go.</span><span class="sxs-lookup"><span data-stu-id="1293a-142">If the text box has a value and there's no `OfficeAssignment` entity to update, it creates one.</span></span>
- <span data-ttu-id="1293a-143">Jeśli pole ma wartość i jest `OfficeAssignment` jednostki, aktualizuje `Location` wartości właściwości.</span><span class="sxs-lookup"><span data-stu-id="1293a-143">If the text box has a value and there's an `OfficeAssignment` entity, it updates the `Location` property value.</span></span>
- <span data-ttu-id="1293a-144">Jeśli pole tekstowe jest pusta i `OfficeAssignment` jednostka istnieje, usuwa jednostki.</span><span class="sxs-lookup"><span data-stu-id="1293a-144">If the text box is empty and an `OfficeAssignment` entity exists, it deletes the entity.</span></span>

<span data-ttu-id="1293a-145">Następnie zapisuje zmiany w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="1293a-145">After this, it saves the changes to the database.</span></span> <span data-ttu-id="1293a-146">Jeśli wystąpi wyjątek, wyświetla komunikat o błędzie.</span><span class="sxs-lookup"><span data-stu-id="1293a-146">If an exception occurs, it displays an error message.</span></span>

<span data-ttu-id="1293a-147">Uruchom strony.</span><span class="sxs-lookup"><span data-stu-id="1293a-147">Run the page.</span></span>

<span data-ttu-id="1293a-148">[![Image02](the-entity-framework-and-aspnet-getting-started-part-4/_static/image4.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="1293a-148">[![Image02](the-entity-framework-and-aspnet-getting-started-part-4/_static/image4.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image3.png)</span></span>

<span data-ttu-id="1293a-149">Kliknij przycisk **Edytuj** i zmień wszystkich pól do pól tekstowych.</span><span class="sxs-lookup"><span data-stu-id="1293a-149">Click **Edit** and all fields change to text boxes.</span></span>

<span data-ttu-id="1293a-150">[![Image03](the-entity-framework-and-aspnet-getting-started-part-4/_static/image6.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="1293a-150">[![Image03](the-entity-framework-and-aspnet-getting-started-part-4/_static/image6.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image5.png)</span></span>

<span data-ttu-id="1293a-151">Zmienić dowolne z tych wartości, w tym **przypisania Office**.</span><span class="sxs-lookup"><span data-stu-id="1293a-151">Change any of these values, including **Office Assignment**.</span></span> <span data-ttu-id="1293a-152">Kliknij przycisk **aktualizacji** , a zmiany zostaną uwzględnione na liście.</span><span class="sxs-lookup"><span data-stu-id="1293a-152">Click **Update** and you'll see the changes reflected in the list.</span></span>

## <a name="displaying-related-entities-in-a-separate-control"></a><span data-ttu-id="1293a-153">Wyświetlanie w formancie oddzielne powiązanych jednostek</span><span class="sxs-lookup"><span data-stu-id="1293a-153">Displaying Related Entities in a Separate Control</span></span>

<span data-ttu-id="1293a-154">Każdy instruktora nauczyć szkoleń w co najmniej jednego, należy dodać `EntityDataSource` kontroli i `GridView` formantu Lista kursów skojarzone z dowolną wskazaną instruktora wybrano Instruktorzy `GridView` formantu.</span><span class="sxs-lookup"><span data-stu-id="1293a-154">Each instructor can teach one or more courses, so you'll add an `EntityDataSource` control and a `GridView` control to list the courses associated with whichever instructor is selected in the instructors `GridView` control.</span></span> <span data-ttu-id="1293a-155">W celu utworzenia nagłówka i `EntityDataSource` sterowania dla jednostek kursy, Dodaj następujący kod między komunikat o błędzie `Label` kontroli i zamykania `</div>` tagu:</span><span class="sxs-lookup"><span data-stu-id="1293a-155">To create a heading and the `EntityDataSource` control for courses entities, add the following markup between the error message `Label` control and the closing `</div>` tag:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample7.aspx)]

<span data-ttu-id="1293a-156">`Where` Parametru zawiera wartość `PersonID` instruktora wiersz, którego jest wybierany w `InstructorsGridView` formantu.</span><span class="sxs-lookup"><span data-stu-id="1293a-156">The `Where` parameter contains the value of the `PersonID` of the instructor whose row is selected in the `InstructorsGridView` control.</span></span> <span data-ttu-id="1293a-157">`Where` Właściwość zawiera polecenie podrzędnego wyboru, które pobiera wszystkie skojarzone `Person` jednostek z `Course` jednostki `People` właściwość nawigacji i wybiera `Course` jednostki tylko wtedy, gdy jeden z skojarzone`Person`jednostek zawiera wybranego `PersonID` wartość.</span><span class="sxs-lookup"><span data-stu-id="1293a-157">The `Where` property contains a subselect command that gets all associated `Person` entities from a `Course` entity's `People` navigation property and selects the `Course` entity only if one of the associated `Person` entities contains the selected `PersonID` value.</span></span>

<span data-ttu-id="1293a-158">Aby utworzyć `GridView` kontroli. Dodaj następujący kod bezpośrednio po `CoursesEntityDataSource` kontroli (przed zamknięciem `</div>` tagu):</span><span class="sxs-lookup"><span data-stu-id="1293a-158">To create the `GridView` control., add the following markup immediately following the `CoursesEntityDataSource` control (before the closing `</div>` tag):</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample8.aspx)]

<span data-ttu-id="1293a-159">Ponieważ kursy nie będzie wyświetlana, jeśli instruktora nie jest zaznaczone, `EmptyDataTemplate` element jest dołączony.</span><span class="sxs-lookup"><span data-stu-id="1293a-159">Because no courses will be displayed if no instructor is selected, an `EmptyDataTemplate` element is included.</span></span>

<span data-ttu-id="1293a-160">Uruchom strony.</span><span class="sxs-lookup"><span data-stu-id="1293a-160">Run the page.</span></span>

<span data-ttu-id="1293a-161">[![Image04](the-entity-framework-and-aspnet-getting-started-part-4/_static/image8.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="1293a-161">[![Image04](the-entity-framework-and-aspnet-getting-started-part-4/_static/image8.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image7.png)</span></span>

<span data-ttu-id="1293a-162">Wybierz instruktora, który ma co najmniej jeden kursy przypisany, i kursu lub kursy znajdują się na liście.</span><span class="sxs-lookup"><span data-stu-id="1293a-162">Select an instructor who has one or more courses assigned, and the course or courses appear in the list.</span></span> <span data-ttu-id="1293a-163">(Uwaga: mimo że schemat bazy danych umożliwia wielu kursy, w danych testowych dostarczony wraz z bazy danych nie instruktora faktycznie zawiera więcej niż jeden plan.</span><span class="sxs-lookup"><span data-stu-id="1293a-163">(Note: although the database schema allows multiple courses, in the test data supplied with the database no instructor actually has more than one course.</span></span> <span data-ttu-id="1293a-164">Można dodać szkoleń w bazie danych użytkownika za pomocą **Eksploratora serwera** okna lub *CoursesAdd.aspx* strony, która zostanie dodana w samouczku nowsze.)</span><span class="sxs-lookup"><span data-stu-id="1293a-164">You can add courses to the database yourself using the **Server Explorer** window or the *CoursesAdd.aspx* page, which you'll add in a later tutorial.)</span></span>

<span data-ttu-id="1293a-165">[![Image05](the-entity-framework-and-aspnet-getting-started-part-4/_static/image10.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="1293a-165">[![Image05](the-entity-framework-and-aspnet-getting-started-part-4/_static/image10.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image9.png)</span></span>

<span data-ttu-id="1293a-166">`CoursesGridView` Formant zawiera tylko kilka pól kursu.</span><span class="sxs-lookup"><span data-stu-id="1293a-166">The `CoursesGridView` control shows only a few course fields.</span></span> <span data-ttu-id="1293a-167">Aby wyświetlić szczegóły kursu, użyjesz `DetailsView` kontroli dla porach przez użytkownika.</span><span class="sxs-lookup"><span data-stu-id="1293a-167">To display all the details for a course, you'll use a `DetailsView` control for the course that the user selects.</span></span> <span data-ttu-id="1293a-168">W *Instructors.aspx*, Dodaj następujący kod po upływie `</div>` tag (Upewnij się, umieść ten kod znaczników **po** div zamykający tag, nie przed):</span><span class="sxs-lookup"><span data-stu-id="1293a-168">In *Instructors.aspx*, add the following markup after the closing `</div>` tag (make sure you place this markup **after** the closing div tag, not before it):</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample9.aspx)]

<span data-ttu-id="1293a-169">Tworzy tego znacznika `EntityDataSource` formant, który jest powiązany z `Courses` zestawu jednostek.</span><span class="sxs-lookup"><span data-stu-id="1293a-169">This markup creates an `EntityDataSource` control that's bound to the `Courses` entity set.</span></span> <span data-ttu-id="1293a-170">`Where` Właściwości wybiera kursu przy użyciu `CourseID` wartość wybranego wiersza, w tym `GridView` formantu.</span><span class="sxs-lookup"><span data-stu-id="1293a-170">The `Where` property selects a course using the `CourseID` value of the selected row in the courses `GridView` control.</span></span> <span data-ttu-id="1293a-171">Kod znaczników Określa program obsługi `Selected` zdarzeń, który zostanie później użyty do wyświetlania ocen studentów, który jest inny poziom w dół hierarchii.</span><span class="sxs-lookup"><span data-stu-id="1293a-171">The markup specifies a handler for the `Selected` event, which you'll use later for displaying student grades, which is another level lower in the hierarchy.</span></span>

<span data-ttu-id="1293a-172">W *Instructors.aspx.cs*, utwórz następujące klasy zastępczej dla `CourseDetailsEntityDataSource_Selected` metody.</span><span class="sxs-lookup"><span data-stu-id="1293a-172">In *Instructors.aspx.cs*, create the following stub for the `CourseDetailsEntityDataSource_Selected` method.</span></span> <span data-ttu-id="1293a-173">(Będzie wypełniania tej klasy zastępczej później w samouczku; teraz, należy go tak, aby strona zostanie kompilowanie i uruchamianie).</span><span class="sxs-lookup"><span data-stu-id="1293a-173">(You'll fill this stub out later in the tutorial; for now, you need it so that the page will compile and run.)</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample10.cs)]

<span data-ttu-id="1293a-174">Uruchom strony.</span><span class="sxs-lookup"><span data-stu-id="1293a-174">Run the page.</span></span>

<span data-ttu-id="1293a-175">[![Image06](the-entity-framework-and-aspnet-getting-started-part-4/_static/image12.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="1293a-175">[![Image06](the-entity-framework-and-aspnet-getting-started-part-4/_static/image12.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image11.png)</span></span>

<span data-ttu-id="1293a-176">Ponieważ wybrano nie kursu Brak początkowo szczegółów kursu.</span><span class="sxs-lookup"><span data-stu-id="1293a-176">Initially there are no course details because no course is selected.</span></span> <span data-ttu-id="1293a-177">Wybierz instruktora, który ma przypisane kursu, a następnie wybierz plan, aby wyświetlić szczegóły.</span><span class="sxs-lookup"><span data-stu-id="1293a-177">Select an instructor who has a course assigned, and then select a course to see the details.</span></span>

<span data-ttu-id="1293a-178">[![Image07](the-entity-framework-and-aspnet-getting-started-part-4/_static/image14.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="1293a-178">[![Image07](the-entity-framework-and-aspnet-getting-started-part-4/_static/image14.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image13.png)</span></span>

## <a name="using-the-entitydatasource-selected-event-to-display-related-data"></a><span data-ttu-id="1293a-179">Przy użyciu obiektu EntityDataSource "zaznaczone" zdarzenia, aby wyświetlić powiązane dane</span><span class="sxs-lookup"><span data-stu-id="1293a-179">Using the EntityDataSource "Selected" Event to Display Related Data</span></span>

<span data-ttu-id="1293a-180">Na koniec mają być wyświetlane wszystkie zarejestrowane studentów i ich klas dla porach wybrane.</span><span class="sxs-lookup"><span data-stu-id="1293a-180">Finally, you want to show all of the enrolled students and their grades for the selected course.</span></span> <span data-ttu-id="1293a-181">Aby to zrobić, użyjesz `Selected` zdarzenie `EntityDataSource` formant powiązany z ciągu `DetailsView`.</span><span class="sxs-lookup"><span data-stu-id="1293a-181">To do this, you'll use the `Selected` event of the `EntityDataSource` control bound to the course `DetailsView`.</span></span>

<span data-ttu-id="1293a-182">W *Instructors.aspx*, Dodaj następujący kod po `DetailsView` sterowania:</span><span class="sxs-lookup"><span data-stu-id="1293a-182">In *Instructors.aspx*, add the following markup after the `DetailsView` control:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample11.aspx)]

<span data-ttu-id="1293a-183">Tworzy tego znacznika `ListView` kontrolkę wyświetlającą listę studentów i ich klas dla porach wybrane.</span><span class="sxs-lookup"><span data-stu-id="1293a-183">This markup creates a `ListView` control that displays a list of students and their grades for the selected course.</span></span> <span data-ttu-id="1293a-184">Zostanie określone żadne źródło danych, ponieważ będzie databind formantu w kodzie.</span><span class="sxs-lookup"><span data-stu-id="1293a-184">No data source is specified because you'll databind the control in code.</span></span> <span data-ttu-id="1293a-185">`EmptyDataTemplate` Komunikat do wyświetlenia po wybraniu kursu nie zawiera elementu — w takim przypadku nie istnieją żadne studentów do wyświetlenia.</span><span class="sxs-lookup"><span data-stu-id="1293a-185">The `EmptyDataTemplate` element provides a message to display when no course is selected—in that case, there are no students to display.</span></span> <span data-ttu-id="1293a-186">`LayoutTemplate` Elementu tworzy tabeli HTML do wyświetlenia na liście i `ItemTemplate` Określa kolumny do wyświetlenia.</span><span class="sxs-lookup"><span data-stu-id="1293a-186">The `LayoutTemplate` element creates an HTML table to display the list, and the `ItemTemplate` specifies the columns to display.</span></span> <span data-ttu-id="1293a-187">Identyfikator dla użytkowników domowych i uczniów klasy pochodzą z `StudentGrade` oraz typy jednostek i nazwa uczniów pochodzi z `Person` jednostki, która udostępnia programu Entity Framework w `Person` właściwość nawigacji `StudentGrade` jednostki.</span><span class="sxs-lookup"><span data-stu-id="1293a-187">The student ID and the student grade are from the `StudentGrade` entity, and the student name is from the `Person` entity that the Entity Framework makes available in the `Person` navigation property of the `StudentGrade` entity.</span></span>

<span data-ttu-id="1293a-188">W *Instructors.aspx.cs*, Zastąp zastąpić jej metodą zastępczą poza `CourseDetailsEntityDataSource_Selected` metodę z następującym kodem:</span><span class="sxs-lookup"><span data-stu-id="1293a-188">In *Instructors.aspx.cs*, replace the stubbed-out `CourseDetailsEntityDataSource_Selected` method with the following code:</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample12.cs)]

<span data-ttu-id="1293a-189">Argument zdarzenia dla tego zdarzenia zawiera wybranych danych w formularzu kolekcji, które będą miały zawierały elementów, jeśli nic nie zaznaczono lub jeden element Jeśli `Course` wybrano jednostki.</span><span class="sxs-lookup"><span data-stu-id="1293a-189">The event argument for this event provides the selected data in the form of a collection, which will have zero items if nothing is selected or one item if a `Course` entity is selected.</span></span> <span data-ttu-id="1293a-190">Jeśli `Course` wybrano jednostki, w kodzie użyto `First` do przekonwertowania kolekcji do pojedynczego obiektu.</span><span class="sxs-lookup"><span data-stu-id="1293a-190">If a `Course` entity is selected, the code uses the `First` method to convert the collection to a single object.</span></span> <span data-ttu-id="1293a-191">Następnie pobiera `StudentGrade` jednostek z właściwości nawigacji konwertuje je do kolekcji i wiąże `GradesListView` sterowania do kolekcji.</span><span class="sxs-lookup"><span data-stu-id="1293a-191">It then gets `StudentGrade` entities from the navigation property, converts them to a collection, and binds the `GradesListView` control to the collection.</span></span>

<span data-ttu-id="1293a-192">Takie ustawienie wystarczy do wyświetlania klasami, ale chce mieć pewność, że ten komunikat w szablonie pusty danych jest wyświetlany po raz pierwszy ta strona jest wyświetlana i zawsze, gdy nie wybrano kursu.</span><span class="sxs-lookup"><span data-stu-id="1293a-192">This is sufficient to display grades, but you want to make sure that the message in the empty data template is displayed the first time the page is displayed and whenever a course is not selected.</span></span> <span data-ttu-id="1293a-193">W tym celu należy utworzyć następujące metody, która będzie wywoływana z dwóch miejscach:</span><span class="sxs-lookup"><span data-stu-id="1293a-193">To do that, create the following method, which you'll call from two places:</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample13.cs)]

<span data-ttu-id="1293a-194">Wywołanie tej nowej metody z `Page_Load` metodę w celu wyświetlenia czas szablonu pierwszy danych pusta strona jest wyświetlana.</span><span class="sxs-lookup"><span data-stu-id="1293a-194">Call this new method from the `Page_Load` method to display the empty data template the first time the page is displayed.</span></span> <span data-ttu-id="1293a-195">I wywołać go z `InstructorsGridView_SelectedIndexChanged` metody ponieważ to zdarzenie jest zgłaszane, gdy wybrano instruktora, co oznacza, że nowe kursy są ładowane do kursów `GridView` kontroli, a nie wybrano jeszcze.</span><span class="sxs-lookup"><span data-stu-id="1293a-195">And call it from the `InstructorsGridView_SelectedIndexChanged` method because that event is raised when an instructor is selected, which means new courses are loaded into the courses `GridView` control and none is selected yet.</span></span> <span data-ttu-id="1293a-196">Poniżej przedstawiono dwa wywołania:</span><span class="sxs-lookup"><span data-stu-id="1293a-196">Here are the two calls:</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample14.cs)]

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample15.cs)]

<span data-ttu-id="1293a-197">Uruchom strony.</span><span class="sxs-lookup"><span data-stu-id="1293a-197">Run the page.</span></span>

<span data-ttu-id="1293a-198">[![Image08](the-entity-framework-and-aspnet-getting-started-part-4/_static/image16.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="1293a-198">[![Image08](the-entity-framework-and-aspnet-getting-started-part-4/_static/image16.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image15.png)</span></span>

<span data-ttu-id="1293a-199">Wybierz instruktora, który ma przypisane kursu, a następnie wybierz kursu.</span><span class="sxs-lookup"><span data-stu-id="1293a-199">Select an instructor that has a course assigned, and then select the course.</span></span>

<span data-ttu-id="1293a-200">[![Image09](the-entity-framework-and-aspnet-getting-started-part-4/_static/image18.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="1293a-200">[![Image09](the-entity-framework-and-aspnet-getting-started-part-4/_static/image18.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image17.png)</span></span>

<span data-ttu-id="1293a-201">Ma teraz widoczna na kilka sposobów, aby pracować z danymi powiązane.</span><span class="sxs-lookup"><span data-stu-id="1293a-201">You have now seen a few ways to work with related data.</span></span> <span data-ttu-id="1293a-202">Następujące samouczka, dowiesz się, jak można dodać relacji między obiektami istniejących, jak usunąć relacje i jak dodać nową jednostkę, która ma relację do istniejącego obiektu.</span><span class="sxs-lookup"><span data-stu-id="1293a-202">In the following tutorial, you'll learn how to add relationships between existing entities, how to remove relationships, and how to add a new entity that has a relationship to an existing entity.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="1293a-203">[Poprzednie](the-entity-framework-and-aspnet-getting-started-part-3.md)
> [dalej](the-entity-framework-and-aspnet-getting-started-part-5.md)</span><span class="sxs-lookup"><span data-stu-id="1293a-203">[Previous](the-entity-framework-and-aspnet-getting-started-part-3.md)
[Next](the-entity-framework-and-aspnet-getting-started-part-5.md)</span></span>
