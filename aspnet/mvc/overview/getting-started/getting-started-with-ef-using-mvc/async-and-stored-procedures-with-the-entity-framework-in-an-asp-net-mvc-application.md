---
uid: mvc/overview/getting-started/getting-started-with-ef-using-mvc/async-and-stored-procedures-with-the-entity-framework-in-an-asp-net-mvc-application
title: "Async i procedur składowanych z programu Entity Framework w aplikacji platformy ASP.NET MVC | Dokumentacja firmy Microsoft"
author: tdykstra
description: "Przykładową aplikację sieci web firmy Contoso University przedstawia sposób tworzenia aplikacji ASP.NET MVC 5 za pomocą Entity Framework 6 Code First i Visual Studio..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 11/07/2014
ms.topic: article
ms.assetid: 27d110fc-d1b7-4628-a763-26f1e6087549
ms.technology: dotnet-mvc
ms.prod: .net-framework
msc.legacyurl: /mvc/overview/getting-started/getting-started-with-ef-using-mvc/async-and-stored-procedures-with-the-entity-framework-in-an-asp-net-mvc-application
msc.type: authoredcontent
ms.openlocfilehash: 7412b32ac29179dfa319544781d4c7165c58196b
ms.sourcegitcommit: 060879fcf3f73d2366b5c811986f8695fff65db8
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 01/24/2018
---
<a name="async-and-stored-procedures-with-the-entity-framework-in-an-aspnet-mvc-application"></a><span data-ttu-id="818d0-103">Async i procedur składowanych z programu Entity Framework w aplikacji platformy ASP.NET MVC</span><span class="sxs-lookup"><span data-stu-id="818d0-103">Async and Stored Procedures with the Entity Framework in an ASP.NET MVC Application</span></span>
====================
<span data-ttu-id="818d0-104">przez [Dykstra niestandardowy](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="818d0-104">by [Tom Dykstra](https://github.com/tdykstra)</span></span>

<span data-ttu-id="818d0-105">[Pobieranie ukończone projektu](http://code.msdn.microsoft.com/ASPNET-MVC-Application-b01a9fe8) lub [pobierania plików PDF](http://download.microsoft.com/download/0/F/B/0FBFAA46-2BFD-478F-8E56-7BF3C672DF9D/Getting%20Started%20with%20Entity%20Framework%206%20Code%20First%20using%20MVC%205.pdf)</span><span class="sxs-lookup"><span data-stu-id="818d0-105">[Download Completed Project](http://code.msdn.microsoft.com/ASPNET-MVC-Application-b01a9fe8) or [Download PDF](http://download.microsoft.com/download/0/F/B/0FBFAA46-2BFD-478F-8E56-7BF3C672DF9D/Getting%20Started%20with%20Entity%20Framework%206%20Code%20First%20using%20MVC%205.pdf)</span></span>

> <span data-ttu-id="818d0-106">Przykładową aplikację sieci web firmy Contoso University przedstawia sposób tworzenia aplikacji ASP.NET MVC 5 za pomocą Entity Framework 6 Code First i Visual Studio 2013.</span><span class="sxs-lookup"><span data-stu-id="818d0-106">The Contoso University sample web application demonstrates how to create ASP.NET MVC 5 applications using the Entity Framework 6 Code First and Visual Studio 2013.</span></span> <span data-ttu-id="818d0-107">Informacje o samouczek serii, zobacz [pierwszy samouczek z tej serii](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application.md).</span><span class="sxs-lookup"><span data-stu-id="818d0-107">For information about the tutorial series, see [the first tutorial in the series](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application.md).</span></span>


<span data-ttu-id="818d0-108">W starszych samouczkach przedstawiono sposób odczytywanie i aktualizowanie danych za pomocą modelu programowania synchronicznego.</span><span class="sxs-lookup"><span data-stu-id="818d0-108">In earlier tutorials you learned how to read and update data using the synchronous programming model.</span></span> <span data-ttu-id="818d0-109">W tym samouczku widzisz implementowania model programowania asynchronicznego.</span><span class="sxs-lookup"><span data-stu-id="818d0-109">In this tutorial you see how to implement the asynchronous programming model.</span></span> <span data-ttu-id="818d0-110">Asynchroniczne kod może pomóc w aplikacji działać lepiej, ponieważ zapewnia lepsze wykorzystanie zasobów serwera.</span><span class="sxs-lookup"><span data-stu-id="818d0-110">Asynchronous code can help an application perform better because it makes better use of server resources.</span></span>

<span data-ttu-id="818d0-111">W tym samouczku widoczne jest również sposób użycia procedury składowane insert, update i operacji usuwania w jednostce.</span><span class="sxs-lookup"><span data-stu-id="818d0-111">In this tutorial you'll also see how to use stored procedures for insert, update, and delete operations on an entity.</span></span>

<span data-ttu-id="818d0-112">Na koniec będzie ponownie wdrożyć aplikację na platformie Azure, wraz ze wszystkich zmian w bazie danych, które zostały zaimplementowane od czasu pierwszej wdrożonej.</span><span class="sxs-lookup"><span data-stu-id="818d0-112">Finally, you'll redeploy the application to Azure, along with all of the database changes that you've implemented since the first time you deployed.</span></span>

<span data-ttu-id="818d0-113">Na poniższych ilustracjach przedstawiono niektóre stron, którymi będzie współpracować.</span><span class="sxs-lookup"><span data-stu-id="818d0-113">The following illustrations show some of the pages that you'll work with.</span></span>

![Strona działów](async-and-stored-procedures-with-the-entity-framework-in-an-asp-net-mvc-application/_static/image1.png)

![Utwórz działu](async-and-stored-procedures-with-the-entity-framework-in-an-asp-net-mvc-application/_static/image2.png)

## <a name="why-bother-with-asynchronous-code"></a><span data-ttu-id="818d0-116">Dlaczego odblokowane kodem asynchroniczne</span><span class="sxs-lookup"><span data-stu-id="818d0-116">Why bother with asynchronous code</span></span>

<span data-ttu-id="818d0-117">Serwer sieci web ma ograniczoną liczbę dostępnych wątków, a w sytuacjach wysokie obciążenie wszystkich dostępnych wątków może być używana.</span><span class="sxs-lookup"><span data-stu-id="818d0-117">A web server has a limited number of threads available, and in high load situations all of the available threads might be in use.</span></span> <span data-ttu-id="818d0-118">W takim przypadku serwer nie może przetworzyć nowe żądania aż wątki są zwalniane.</span><span class="sxs-lookup"><span data-stu-id="818d0-118">When that happens, the server can't process new requests until the threads are freed up.</span></span> <span data-ttu-id="818d0-119">Z kodem synchroniczne wiele wątków może powiązany, gdy nie są faktycznie wykonują pracę, ponieważ ich oczekiwania operacji We/Wy zakończyć.</span><span class="sxs-lookup"><span data-stu-id="818d0-119">With synchronous code, many threads may be tied up while they aren't actually doing any work because they're waiting for I/O to complete.</span></span> <span data-ttu-id="818d0-120">Asynchroniczne kodu podczas procesu jest oczekiwania operacji We/Wy zakończyć, jego wątku zostanie zwolniona dla serwera na potrzeby przetwarzania innych żądań.</span><span class="sxs-lookup"><span data-stu-id="818d0-120">With asynchronous code, when a process is waiting for I/O to complete, its thread is freed up for the server to use for processing other requests.</span></span> <span data-ttu-id="818d0-121">W związku z tym kod asynchroniczny umożliwia zasobów serwera można efektywniej przy użyciu, a serwer jest skonfigurowany do obsługi ruchu więcej bez opóźnień.</span><span class="sxs-lookup"><span data-stu-id="818d0-121">As a result, asynchronous code enables server resources to be use more efficiently, and the server is enabled to handle more traffic without delays.</span></span>

<span data-ttu-id="818d0-122">We wcześniejszych wersjach programu .NET, zapisywanie i testowanie kodu asynchroniczne był zbyt złożony, błąd podatnych na błędy i trudne do debugowania.</span><span class="sxs-lookup"><span data-stu-id="818d0-122">In earlier versions of .NET, writing and testing asynchronous code was complex, error prone, and hard to debug.</span></span> <span data-ttu-id="818d0-123">W programie .NET 4.5 więc znacznie łatwiejsze, że należy zwykle zapisać kod asynchroniczny chyba że nie masz powód jest pisanie, testowanie i debugowanie kodu asynchronicznego.</span><span class="sxs-lookup"><span data-stu-id="818d0-123">In .NET 4.5, writing, testing, and debugging asynchronous code is so much easier that you should generally write asynchronous code unless you have a reason not to.</span></span> <span data-ttu-id="818d0-124">Asynchroniczne kod wprowadzić z małej ilości obciążenie, ale w sytuacjach ruchu niskiej wydajności trafień jest niewielka, podczas w sytuacjach dużego natężenia ruchu sieciowego jest znacząca, potencjalne zwiększenie wydajności.</span><span class="sxs-lookup"><span data-stu-id="818d0-124">Asynchronous code does introduce a small amount of overhead, but for low traffic situations the performance hit is negligible, while for high traffic situations, the potential performance improvement is substantial.</span></span>

<span data-ttu-id="818d0-125">Aby uzyskać więcej informacji na temat programowania asynchronicznego, zobacz [Użyj .NET 4.5 asynchronicznej obsługi celu unikania blokowania połączeń](../../../../aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/web-development-best-practices.md#async).</span><span class="sxs-lookup"><span data-stu-id="818d0-125">For more information about asynchronous programming, see [Use .NET 4.5's async support to avoid blocking calls](../../../../aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/web-development-best-practices.md#async).</span></span>

## <a name="create-the-department-controller"></a><span data-ttu-id="818d0-126">Tworzenie kontrolera działu</span><span class="sxs-lookup"><span data-stu-id="818d0-126">Create the Department controller</span></span>

<span data-ttu-id="818d0-127">Tworzenie kontrolera działu, wybierz ten sam sposób jak starszych kontrolerów, z wyjątkiem teraz **Użyj kontrolera asynchronicznego** pole wyboru akcje.</span><span class="sxs-lookup"><span data-stu-id="818d0-127">Create a Department controller the same way you did the earlier controllers, except this time select the **Use async controller** actions check box.</span></span>

![Dział szkieletu kontrolera](async-and-stored-procedures-with-the-entity-framework-in-an-asp-net-mvc-application/_static/image3.png)

<span data-ttu-id="818d0-129">Następujące najważniejsze funkcje Pokaż, co zostało dodane do synchroniczne kod `Index` metody dokonanie asynchronicznych:</span><span class="sxs-lookup"><span data-stu-id="818d0-129">The following highlights show what was added to the synchronous code for the `Index` method to make it asynchronous:</span></span>

[!code-csharp[Main](async-and-stored-procedures-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample1.cs?highlight=1,4)]

<span data-ttu-id="818d0-130">Cztery zmiany zostały zastosowane umożliwiające kwerendy bazy danych programu Entity Framework do wykonania asynchronicznie:</span><span class="sxs-lookup"><span data-stu-id="818d0-130">Four changes were applied to enable the Entity Framework database query to execute asynchronously:</span></span>

- <span data-ttu-id="818d0-131">Metoda jest oznaczona atrybutem `async` — słowo kluczowe, które informuje kompilator, aby wygenerować wywołań zwrotnych dla części treści metody i do automatycznego tworzenia `Task<ActionResult>` obiekt, który jest zwracany.</span><span class="sxs-lookup"><span data-stu-id="818d0-131">The method is marked with the `async` keyword, which tells the compiler to generate callbacks for parts of the method body and to automatically create the `Task<ActionResult>` object that is returned.</span></span>
- <span data-ttu-id="818d0-132">Zwracany typ został zmieniony z `ActionResult` do `Task<ActionResult>`.</span><span class="sxs-lookup"><span data-stu-id="818d0-132">The return type was changed from `ActionResult` to `Task<ActionResult>`.</span></span> <span data-ttu-id="818d0-133">`Task<T>` Typu reprezentuje trwającej pracy z wyniku typu `T`.</span><span class="sxs-lookup"><span data-stu-id="818d0-133">The `Task<T>` type represents ongoing work with a result of type `T`.</span></span>
- <span data-ttu-id="818d0-134">`await` — Słowo kluczowe została zastosowana do wywołania usługi sieci web.</span><span class="sxs-lookup"><span data-stu-id="818d0-134">The `await` keyword was applied to the web service call.</span></span> <span data-ttu-id="818d0-135">Gdy kompilator widzi to słowo kluczowe, w tle dzieli metody na dwie części.</span><span class="sxs-lookup"><span data-stu-id="818d0-135">When the compiler sees this keyword, behind the scenes it splits the method into two parts.</span></span> <span data-ttu-id="818d0-136">Pierwsza część kończy operację, który jest uruchamiany asynchronicznie.</span><span class="sxs-lookup"><span data-stu-id="818d0-136">The first part ends with the operation that is started asynchronously.</span></span> <span data-ttu-id="818d0-137">Druga część są umieszczane w metodę wywołania zwrotnego, która jest wywoływana po zakończeniu operacji.</span><span class="sxs-lookup"><span data-stu-id="818d0-137">The second part is put into a callback method that is called when the operation completes.</span></span>
- <span data-ttu-id="818d0-138">Wersja asynchroniczna elementu `ToList` wywołano metodę rozszerzenie.</span><span class="sxs-lookup"><span data-stu-id="818d0-138">The asynchronous version of the `ToList` extension method was called.</span></span>

<span data-ttu-id="818d0-139">Dlaczego jest `departments.ToList` instrukcji zmodyfikowany, ale nie `departments = db.Departments` instrukcji?</span><span class="sxs-lookup"><span data-stu-id="818d0-139">Why is the `departments.ToList` statement modified but not the `departments = db.Departments` statement?</span></span> <span data-ttu-id="818d0-140">Przyczyną jest to, że tylko instrukcji, które powodują zapytań i poleceń do wysłania do bazy danych są wykonywane asynchronicznie.</span><span class="sxs-lookup"><span data-stu-id="818d0-140">The reason is that only statements that cause queries or commands to be sent to the database are executed asynchronously.</span></span> <span data-ttu-id="818d0-141">`departments = db.Departments` Instrukcji konfiguruje kwerendy, ale zapytanie nie jest wykonywany do momentu `ToList` metoda jest wywoływana.</span><span class="sxs-lookup"><span data-stu-id="818d0-141">The `departments = db.Departments` statement sets up a query but the query is not executed until the `ToList` method is called.</span></span> <span data-ttu-id="818d0-142">W związku z tym tylko `ToList` metody jest wykonywane asynchronicznie.</span><span class="sxs-lookup"><span data-stu-id="818d0-142">Therefore, only the `ToList` method is executed asynchronously.</span></span>

<span data-ttu-id="818d0-143">W `Details` — metoda i `HttpGet` `Edit` i `Delete` metod `Find` metoda jest ten, który powoduje, że zapytania do wysłania do bazy danych, w taki sposób, aby metody, który jest wykonywany asynchronicznie:</span><span class="sxs-lookup"><span data-stu-id="818d0-143">In the `Details` method and the `HttpGet` `Edit` and `Delete` methods, the `Find` method is the one that causes a query to be sent to the database, so that's the method that gets executed asynchronously:</span></span>

[!code-csharp[Main](async-and-stored-procedures-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample2.cs?highlight=7)]

<span data-ttu-id="818d0-144">W `Create`, `HttpPost Edit`, i `DeleteConfirmed` metod jest `SaveChanges` wywołania metody, która powoduje, że polecenie do wykonania, nie instrukcjach, takich jak `db.Departments.Add(department)` co tylko spowodować jednostek w pamięci, do zmodyfikowania.</span><span class="sxs-lookup"><span data-stu-id="818d0-144">In the `Create`, `HttpPost Edit`, and `DeleteConfirmed` methods, it is the `SaveChanges` method call that causes a command to be executed, not statements such as `db.Departments.Add(department)` which only cause entities in memory to be modified.</span></span>

[!code-csharp[Main](async-and-stored-procedures-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample3.cs?highlight=6)]

<span data-ttu-id="818d0-145">Otwórz *Views\Department\Index.cshtml*i Zastąp kod szablonu z następującym kodem:</span><span class="sxs-lookup"><span data-stu-id="818d0-145">Open *Views\Department\Index.cshtml*, and replace the template code with the following code:</span></span>

[!code-cshtml[Main](async-and-stored-procedures-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample4.cshtml?highlight=3,5,20-22,36-38)]

<span data-ttu-id="818d0-146">Ten kod zmienia tytuł od indeksu do działów, przenosi nazwa administratora po prawej stronie i zapewnia pełną nazwę administratora.</span><span class="sxs-lookup"><span data-stu-id="818d0-146">This code changes the title from Index to Departments, moves the Administrator name to the right, and provides the full name of the administrator.</span></span>

<span data-ttu-id="818d0-147">Tworzenia, usuwania, uzyskać szczegółowe informacje i edytować widoków, zmienianie podpisu dla `InstructorID` na taki sam sposób jak zmienić pole nazwy działu "Dział" w widokach kursu "Administrator".</span><span class="sxs-lookup"><span data-stu-id="818d0-147">In the Create, Delete, Details, and Edit views, change the caption for the `InstructorID` field to "Administrator" the same way you changed the department name field to "Department" in the Course views.</span></span>

<span data-ttu-id="818d0-148">Tworzenie i Edycja widoków użyć poniższego kodu:</span><span class="sxs-lookup"><span data-stu-id="818d0-148">In the Create and Edit views use the following code:</span></span>

[!code-cshtml[Main](async-and-stored-procedures-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample5.cshtml)]

<span data-ttu-id="818d0-149">W widokach Delete i szczegóły użyć poniższego kodu:</span><span class="sxs-lookup"><span data-stu-id="818d0-149">In the Delete and Details views use the following code:</span></span>

[!code-cshtml[Main](async-and-stored-procedures-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample6.cshtml)]

<span data-ttu-id="818d0-150">Uruchom aplikację, a następnie kliknij przycisk **działów** kartę.</span><span class="sxs-lookup"><span data-stu-id="818d0-150">Run the application, and click the **Departments** tab.</span></span>

![Strona działów](async-and-stored-procedures-with-the-entity-framework-in-an-asp-net-mvc-application/_static/image4.png)

<span data-ttu-id="818d0-152">Wszystko, co działa tak samo jak inne kontrolery, ale w tym kontrolerze wszystkie zapytania SQL są wykonywane asynchronicznie.</span><span class="sxs-lookup"><span data-stu-id="818d0-152">Everything works the same as in the other controllers, but in this controller all of the SQL queries are executing asynchronously.</span></span>

<span data-ttu-id="818d0-153">Należy pamiętać o podczas, używania programowanie asynchroniczne z programu Entity Framework w kilku kwestiach:</span><span class="sxs-lookup"><span data-stu-id="818d0-153">Some things to be aware of when you are using asynchronous programming with the Entity Framework:</span></span>

- <span data-ttu-id="818d0-154">Kod asynchronicznej nie jest bezpieczne dla wątków.</span><span class="sxs-lookup"><span data-stu-id="818d0-154">The async code is not thread safe.</span></span> <span data-ttu-id="818d0-155">Innymi słowy innymi słowy, nie należy próbować wykonać wiele operacji z użyciem tego samego wystąpienia kontekstu.</span><span class="sxs-lookup"><span data-stu-id="818d0-155">In other words, in other words, don't try to do multiple operations in parallel using the same context instance.</span></span>
- <span data-ttu-id="818d0-156">Jeśli chcesz skorzystać z zalet wydajności async kodu, upewnij się, że wszystkie biblioteki pakietami, które używasz (takie jak w przypadku stronicowania), również korzystają asynchronicznego, jeśli wywołują wszystkie metody powodują zapytania do bazy danych programu Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="818d0-156">If you want to take advantage of the performance benefits of async code, make sure that any library packages that you're using (such as for paging), also use async if they call any Entity Framework methods that cause queries to be sent to the database.</span></span>

## <a name="use-stored-procedures-for-inserting-updating-and-deleting"></a><span data-ttu-id="818d0-157">Użyj procedury składowanej wstawiania, aktualizowania i usuwania</span><span class="sxs-lookup"><span data-stu-id="818d0-157">Use stored procedures for inserting, updating, and deleting</span></span>

<span data-ttu-id="818d0-158">Niektóre deweloperów i DBAs preferowane procedur składowanych na potrzeby dostępu do bazy danych.</span><span class="sxs-lookup"><span data-stu-id="818d0-158">Some developers and DBAs prefer to use stored procedures for database access.</span></span> <span data-ttu-id="818d0-159">We wcześniejszych wersjach programu Entity Framework można pobrać danych przy użyciu procedury składowanej przez [wykonywania raw zapytania SQL](advanced-entity-framework-scenarios-for-an-mvc-web-application.md), ale nie może nakazać EF procedur składowanych na potrzeby operacji aktualizacji.</span><span class="sxs-lookup"><span data-stu-id="818d0-159">In earlier versions of Entity Framework you can retrieve data using a stored procedure by [executing a raw SQL query](advanced-entity-framework-scenarios-for-an-mvc-web-application.md), but you can't instruct EF to use stored procedures for update operations.</span></span> <span data-ttu-id="818d0-160">EF 6 jest łatwa do skonfigurowania Code First, aby użyć procedur składowanych.</span><span class="sxs-lookup"><span data-stu-id="818d0-160">In EF 6 it's easy to configure Code First to use stored procedures.</span></span>

1. <span data-ttu-id="818d0-161">W *DAL\SchoolContext.cs*, wyróżniony kod, aby dodać `OnModelCreating` metody.</span><span class="sxs-lookup"><span data-stu-id="818d0-161">In *DAL\SchoolContext.cs*, add the highlighted code to the `OnModelCreating` method.</span></span>

    [!code-csharp[Main](async-and-stored-procedures-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample7.cs?highlight=9)]

    <span data-ttu-id="818d0-162">Ten kod nakazuje Entity Framework do procedury przechowywane w operacjach wstawiania, aktualizowania i usuwania operacji na `Department` jednostki.</span><span class="sxs-lookup"><span data-stu-id="818d0-162">This code instructs Entity Framework to use stored procedures for insert, update, and delete operations on the `Department` entity.</span></span>
2. <span data-ttu-id="818d0-163">W konsoli Zarządzanie pakietów wprowadź następujące polecenie:</span><span class="sxs-lookup"><span data-stu-id="818d0-163">In Package Manage Console, enter the following command:</span></span>

    `add-migration DepartmentSP`

    <span data-ttu-id="818d0-164">Otwórz *migracje\&lt; sygnatura czasowa&gt;\_DepartmentSP.cs* wyświetlić kod w `Up` metodę, która tworzy wstawiania, aktualizowania i usuwania procedur składowanych:</span><span class="sxs-lookup"><span data-stu-id="818d0-164">Open *Migrations\&lt;timestamp&gt;\_DepartmentSP.cs* to see the code in the `Up` method that creates Insert, Update, and Delete stored procedures:</span></span>

    [!code-csharp[Main](async-and-stored-procedures-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample8.cs?highlight=3-4,26-27,42-43)]
- <span data-ttu-id="818d0-165">W konsoli Zarządzanie pakietów wprowadź następujące polecenie:</span><span class="sxs-lookup"><span data-stu-id="818d0-165">In Package Manage Console, enter the following command:</span></span>

    `update-database`
- <span data-ttu-id="818d0-166">Uruchom aplikację w trybie debugowania, kliknij przycisk **działów** , a następnie kliknij pozycję **Utwórz nowy**.</span><span class="sxs-lookup"><span data-stu-id="818d0-166">Run the application in debug mode, click the **Departments** tab, and then click **Create New**.</span></span>
- <span data-ttu-id="818d0-167">Wprowadź dane dla nowego działu, a następnie kliknij przycisk **Utwórz**.</span><span class="sxs-lookup"><span data-stu-id="818d0-167">Enter data for a new department, and then click **Create**.</span></span>

    ![Utwórz działu](async-and-stored-procedures-with-the-entity-framework-in-an-asp-net-mvc-application/_static/image5.png)
- <span data-ttu-id="818d0-169">W programie Visual Studio można znaleźć w dziennikach w **dane wyjściowe** okna, aby zobaczyć, czy procedury składowanej zostało użyte do wstawienia nowego wiersza działu.</span><span class="sxs-lookup"><span data-stu-id="818d0-169">In Visual Studio, look at the logs in the **Output** window to see that a stored procedure was used to insert the new Department row.</span></span>

    ![SP Insert działu](async-and-stored-procedures-with-the-entity-framework-in-an-asp-net-mvc-application/_static/image6.png)

<span data-ttu-id="818d0-171">Kod najpierw tworzy domyślną przechowywane procedury nazwy.</span><span class="sxs-lookup"><span data-stu-id="818d0-171">Code First creates default stored procedure names.</span></span> <span data-ttu-id="818d0-172">Jeśli korzystasz z istniejącej bazy danych, konieczne może być Dostosowywanie nazw procedury składowanej, aby można było używać procedury składowane już zdefiniowana w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="818d0-172">If you are using an existing database, you might need to customize the stored procedure names in order to use stored procedures already defined in the database.</span></span> <span data-ttu-id="818d0-173">Aby dowiedzieć się, jak to zrobić, zobacz [Entity Framework kod pierwszego wstawiania/aktualizacji/usuwania procedur składowanych](https://msdn.microsoft.com/data/dn468673).</span><span class="sxs-lookup"><span data-stu-id="818d0-173">For information about how to do that, see [Entity Framework Code First Insert/Update/Delete Stored Procedures](https://msdn.microsoft.com/data/dn468673).</span></span>

<span data-ttu-id="818d0-174">Jeśli chcesz dostosować generowane co czy procedury składowane można edytować kod z utworzonym szkieletem migracji `Up` metodę, która tworzy procedury składowanej.</span><span class="sxs-lookup"><span data-stu-id="818d0-174">If you want to customize what generated stored procedures do, you can edit the scaffolded code for the migrations `Up` method that creates the stored procedure.</span></span> <span data-ttu-id="818d0-175">W ten sposób zmiany zostaną odzwierciedlone zawsze, gdy zostanie uruchomione migracji, a zostaną zastosowane do produkcyjnej bazy danych podczas migracji automatycznie uruchamia się w środowisku produkcyjnym po zakończeniu wdrożenia.</span><span class="sxs-lookup"><span data-stu-id="818d0-175">That way your changes are reflected whenever that migration is run and will be applied to your production database when migrations runs automatically in production after deployment.</span></span>

<span data-ttu-id="818d0-176">Jeśli chcesz zmienić istniejącą procedurę składowaną, który został utworzony w poprzedniej migracji, można wygenerować puste migracji za pomocą polecenia Add-Migration i ręcznie napisać kod, który wywołuje [AlterStoredProcedure](https://msdn.microsoft.com/library/system.data.entity.migrations.dbmigration.alterstoredprocedure.aspx) — metoda .</span><span class="sxs-lookup"><span data-stu-id="818d0-176">If you want to change an existing stored procedure that was created in a previous migration, you can use the Add-Migration command to generate a blank migration, and then manually write code that calls the [AlterStoredProcedure](https://msdn.microsoft.com/library/system.data.entity.migrations.dbmigration.alterstoredprocedure.aspx) method.</span></span>

## <a name="deploy-to-azure"></a><span data-ttu-id="818d0-177">Wdrażanie na platformie Azure</span><span class="sxs-lookup"><span data-stu-id="818d0-177">Deploy to Azure</span></span>

<span data-ttu-id="818d0-178">W tej sekcji wymaga zakończył opcjonalny **wdrażania aplikacji na platformie Azure** sekcji [migracji i wdrażania](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application.md) samouczek z tej serii.</span><span class="sxs-lookup"><span data-stu-id="818d0-178">This section requires you to have completed the optional **Deploying the app to Azure** section in the [Migrations and Deployment](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application.md) tutorial of this series.</span></span> <span data-ttu-id="818d0-179">Jeśli były migracje błędów, które można rozwiązać przez usunięcie bazy danych w projekcie lokalnego, Pomiń tę sekcję.</span><span class="sxs-lookup"><span data-stu-id="818d0-179">If you had migrations errors that you resolved by deleting the database in your local project, skip this section.</span></span>

1. <span data-ttu-id="818d0-180">W programie Visual Studio, kliknij prawym przyciskiem myszy projekt w **Eksploratora rozwiązań** i wybierz **publikowania** z menu kontekstowego.</span><span class="sxs-lookup"><span data-stu-id="818d0-180">In Visual Studio, right-click the project in **Solution Explorer** and select **Publish** from the context menu.</span></span>
2. <span data-ttu-id="818d0-181">Kliknij przycisk **publikowania**.</span><span class="sxs-lookup"><span data-stu-id="818d0-181">Click **Publish**.</span></span>

    <span data-ttu-id="818d0-182">Program Visual Studio wdroży aplikację na platformie Azure i uruchamiania aplikacji w domyślnej przeglądarce, działające na platformie Azure.</span><span class="sxs-lookup"><span data-stu-id="818d0-182">Visual Studio deploys the application to Azure, and the application opens in your default browser, running in Azure.</span></span>
3. <span data-ttu-id="818d0-183">Testowanie aplikacji w celu weryfikacji działa.</span><span class="sxs-lookup"><span data-stu-id="818d0-183">Test the application to verify it's working.</span></span>

    <span data-ttu-id="818d0-184">Przy pierwszym uruchomieniu strony uzyskuje dostęp do bazy danych, Entity Framework uruchamia wszystkie migracja `Up` metody wymagane do bazy danych na bieżąco z bieżącym modelem danych.</span><span class="sxs-lookup"><span data-stu-id="818d0-184">The first time you run a page that accesses the database, the Entity Framework runs all of the migrations `Up` methods required to bring the database up to date with the current data model.</span></span> <span data-ttu-id="818d0-185">Teraz można używać wszystkich stron sieci web dodanych od czasu ostatniego wdrożone, w tym strony działu, dodane w tym samouczku.</span><span class="sxs-lookup"><span data-stu-id="818d0-185">You can now use all of the web pages that you added since the last time you deployed, including the Department pages that you added in this tutorial.</span></span>

## <a name="summary"></a><span data-ttu-id="818d0-186">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="818d0-186">Summary</span></span>

<span data-ttu-id="818d0-187">W tym samouczku przedstawiono sposób poprawiania wydajności serwera przez napisanie kodu, który wykonuje asynchronicznie i sposobu użycia procedury składowanej Wstawianie, aktualizowanie i usuwanie operacji.</span><span class="sxs-lookup"><span data-stu-id="818d0-187">In this tutorial you saw how to improve server efficiency by writing code that executes asynchronously, and how to use stored procedures for insert, update, and delete operations.</span></span> <span data-ttu-id="818d0-188">W następnym samouczku zobaczysz sposób zapobiec utracie danych, gdy wielu użytkowników próby edytowania tego samego rekordu w tym samym czasie.</span><span class="sxs-lookup"><span data-stu-id="818d0-188">In the next tutorial, you'll see how to prevent data loss when multiple users try to edit the same record at the same time.</span></span>

<span data-ttu-id="818d0-189">Linki do innych zasobów programu Entity Framework, można znaleźć w [dostępu do danych programu ASP.NET - zalecane zasobów](../../../../whitepapers/aspnet-data-access-content-map.md).</span><span class="sxs-lookup"><span data-stu-id="818d0-189">Links to other Entity Framework resources can be found in the [ASP.NET Data Access - Recommended Resources](../../../../whitepapers/aspnet-data-access-content-map.md).</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="818d0-190">[Poprzednie](updating-related-data-with-the-entity-framework-in-an-asp-net-mvc-application.md)
[dalej](handling-concurrency-with-the-entity-framework-in-an-asp-net-mvc-application.md)</span><span class="sxs-lookup"><span data-stu-id="818d0-190">[Previous](updating-related-data-with-the-entity-framework-in-an-asp-net-mvc-application.md)
[Next](handling-concurrency-with-the-entity-framework-in-an-asp-net-mvc-application.md)</span></span>
